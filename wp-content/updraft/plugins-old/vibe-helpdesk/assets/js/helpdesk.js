!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){e.exports=function(){"use strict";(function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),r=Math.max(0,16-(i-e)),a=window.setTimeout(function(){t(i+r)},r);return e=i+r,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})(),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),function(e){try{return new CustomEvent("test"),!1}catch(e){}function t(t,n){n=n||{bubbles:!1,cancelable:!1};var i=document.createEvent("MouseEvent");return i.initMouseEvent(t,n.bubbles,n.cancelable,e,0,0,0,0,0,!1,!1,!1,!1,0,null),i}t.prototype=Event.prototype,e.MouseEvent=t}(window);var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),n=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0},i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(r)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function t(n,i,r,a){e(this,t);var o=this;function l(e){e.stopPropagation(),document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",s),o.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{handle:o}}))}function s(e){e.stopPropagation(),o.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:e.clientX,mouseY:e.clientY}}))}this.position=n,this.constraints=i,this.cursor=r,this.eventBus=a,this.el=document.createElement("div"),this.el.className="croppr-handle",this.el.style.cursor=r,this.el.addEventListener("mousedown",function(e){e.stopPropagation(),document.addEventListener("mouseup",l),document.addEventListener("mousemove",s),o.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:o}}))})},o=function(){function n(t,i,r,a){e(this,n),this.x1=t,this.y1=i,this.x2=r,this.y2=a}return t(n,[{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.x1=null==e?this.x1:e,this.y1=null==t?this.y1:t,this.x2=null==n?this.x2:n,this.y2=null==i?this.y2:i,this}},{key:"width",value:function(){return Math.abs(this.x2-this.x1)}},{key:"height",value:function(){return Math.abs(this.y2-this.y1)}},{key:"resize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],i=this.x1+this.width()*n[0],r=this.y1+this.height()*n[1];return this.x1=i-e*n[0],this.y1=r-t*n[1],this.x2=this.x1+e,this.y2=this.y1+t,this}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=this.width()*e,i=this.height()*e;return this.resize(n,i,t),this}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.width(),i=this.height();return e=null===e?this.x1:e,t=null===t?this.y1:t,this.x1=e,this.y1=t,this.x2=e+n,this.y2=t+i,this}},{key:"getRelativePoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.width()*e[0],n=this.height()*e[1];return[t,n]}},{key:"getAbsolutePoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.x1+this.width()*e[0],n=this.y1+this.height()*e[1];return[t,n]}},{key:"constrainToRatio",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"height";if(null!==e){switch(this.width(),this.height(),n){case"height":this.resize(this.width(),this.width()*e,t);break;case"width":this.resize(1*this.height()/e,this.height(),t);break;default:this.resize(this.width(),this.width()*e,t)}return this}}},{key:"constrainToBoundary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],i=this.getAbsolutePoint(n),a=r(i,2),o=a[0],l=a[1],s=o,c=l,p=e-o,u=t-l,m=-2*n[0]+1,d=-2*n[1]+1,h=null,f=null;switch(m){case-1:h=s;break;case 0:h=2*Math.min(s,p);break;case 1:h=p}switch(d){case-1:f=c;break;case 0:f=2*Math.min(c,u);break;case 1:f=u}if(this.width()>h){var v=h/this.width();this.scale(v,n)}if(this.height()>f){var w=f/this.height();this.scale(w,n)}return this}},{key:"constrainToSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(a&&(a>1?(e=1*t/a,i*=a):a<1&&(t=e*a,n=1*i/a)),e&&this.width()>e){var o=e,l=null===a?this.height():t;this.resize(o,l,r)}if(t&&this.height()>t){var s=null===a?this.width():e,c=t;this.resize(s,c,r)}if(n&&this.width()<n){var p=n,u=null===a?this.height():i;this.resize(p,u,r)}if(i&&this.height()<i){var m=null===a?this.width():n,d=i;this.resize(m,d,r)}return this}}]),n}();function l(e){e.preventDefault();var t=e.changedTouches[0];t.target.dispatchEvent(new MouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[e.type],{bubbles:!0,cancelable:!0,view:window,clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY}))}var s=[{position:[0,0],constraints:[1,0,0,1],cursor:"nw-resize"},{position:[.5,0],constraints:[1,0,0,0],cursor:"n-resize"},{position:[1,0],constraints:[1,1,0,0],cursor:"ne-resize"},{position:[1,.5],constraints:[0,1,0,0],cursor:"e-resize"},{position:[1,1],constraints:[0,1,1,0],cursor:"se-resize"},{position:[.5,1],constraints:[0,0,1,0],cursor:"s-resize"},{position:[0,1],constraints:[0,0,1,1],cursor:"sw-resize"},{position:[0,.5],constraints:[0,0,0,1],cursor:"w-resize"}];function c(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}return function(r){function a(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,n,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,r),t(a,[{key:"getValue",value:function(e){return n(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"getValue",this).call(this,e)}},{key:"setImage",value:function(e){return n(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"setImage",this).call(this,e)}},{key:"destroy",value:function(){return n(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",this).call(this)}},{key:"moveTo",value:function(e,t){return this.box.move(e,t),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"resizeTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[.5,.5];return this.box.resize(e,t,n),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"scaleBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5];return this.box.scale(e,t),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"reset",value:function(){return this.box=this.initializeBox(this.options),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}}]),a}(function(){function n(t,i){var r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e(this,n),this.options=n.parseOptions(i||{}),!t.nodeName&&null==(t=document.querySelector(t)))throw"Unable to find element.";if(!t.getAttribute("src"))throw"Image src not provided.";this._initialized=!1,this._restore={parent:t.parentNode,element:t},a||(0===t.width||0===t.height?t.onload=function(){r.initialize(t)}:this.initialize(t))}return t(n,[{key:"initialize",value:function(e){this.createDOM(e),this.options.convertToPixels(this.cropperEl),this.attachHandlerEvents(),this.attachRegionEvents(),this.attachOverlayEvents(),this.box=this.initializeBox(this.options),this.redraw(),this._initialized=!0,null!==this.options.onInitialize&&this.options.onInitialize(this)}},{key:"createDOM",value:function(e){var t;this.containerEl=document.createElement("div"),this.containerEl.className="croppr-container",this.eventBus=this.containerEl,(t=this.containerEl).addEventListener("touchstart",l),t.addEventListener("touchend",l),t.addEventListener("touchmove",l),this.cropperEl=document.createElement("div"),this.cropperEl.className="croppr",this.imageEl=document.createElement("img"),this.imageEl.setAttribute("src",e.getAttribute("src")),this.imageEl.setAttribute("alt",e.getAttribute("alt")),this.imageEl.className="croppr-image",this.imageClippedEl=this.imageEl.cloneNode(),this.imageClippedEl.className="croppr-imageClipped",this.regionEl=document.createElement("div"),this.regionEl.className="croppr-region",this.overlayEl=document.createElement("div"),this.overlayEl.className="croppr-overlay";var n=document.createElement("div");n.className="croppr-handleContainer",this.handles=[];for(var i=0;i<s.length;i++){var r=new a(s[i].position,s[i].constraints,s[i].cursor,this.eventBus);this.handles.push(r),n.appendChild(r.el)}this.cropperEl.appendChild(this.imageEl),this.cropperEl.appendChild(this.imageClippedEl),this.cropperEl.appendChild(this.regionEl),this.cropperEl.appendChild(this.overlayEl),this.cropperEl.appendChild(n),this.containerEl.appendChild(this.cropperEl),e.parentElement.replaceChild(this.containerEl,e)}},{key:"setImage",value:function(e){var t=this;return this.imageEl.onload=function(){t.box=t.initializeBox(t.options),t.redraw()},this.imageEl.src=e,this.imageClippedEl.src=e,this}},{key:"destroy",value:function(){this._restore.parent.replaceChild(this._restore.element,this.containerEl)}},{key:"initializeBox",value:function(e){var t=e.startSize.width,n=e.startSize.height,i=new o(0,0,t,n);i.constrainToRatio(e.aspectRatio,[.5,.5]);var r=e.minSize,a=e.maxSize;i.constrainToSize(a.width,a.height,r.width,r.height,[.5,.5],e.aspectRatio);var l=this.cropperEl.offsetWidth,s=this.cropperEl.offsetHeight;i.constrainToBoundary(l,s,[.5,.5]);var c=this.cropperEl.offsetWidth/2-i.width()/2,p=this.cropperEl.offsetHeight/2-i.height()/2;return i.move(c,p),i}},{key:"redraw",value:function(){var e=this,t=Math.round(this.box.width()),n=Math.round(this.box.height()),i=Math.round(this.box.x1),r=Math.round(this.box.y1),a=Math.round(this.box.x2),o=Math.round(this.box.y2);window.requestAnimationFrame(function(){e.regionEl.style.transform="translate("+i+"px, "+r+"px)",e.regionEl.style.width=t+"px",e.regionEl.style.height=n+"px",e.imageClippedEl.style.clip="rect("+r+"px, "+a+"px, "+o+"px, "+i+"px)";for(var l=e.box.getAbsolutePoint([.5,.5]),s=l[0]-e.cropperEl.offsetWidth/2>>31,c=l[1]-e.cropperEl.offsetHeight/2>>31,p=-2*((s^c)+c+c+4)+8,u=0;u<e.handles.length;u++){var m=e.handles[u],d=m.el.offsetWidth,h=m.el.offsetHeight,f=i+t*m.position[0]-d/2,v=r+n*m.position[1]-h/2;m.el.style.transform="translate("+Math.round(f)+"px, "+Math.round(v)+"px)",m.el.style.zIndex=p==u?5:4}})}},{key:"attachHandlerEvents",value:function(){var e=this.eventBus;e.addEventListener("handlestart",this.onHandleMoveStart.bind(this)),e.addEventListener("handlemove",this.onHandleMoveMoving.bind(this)),e.addEventListener("handleend",this.onHandleMoveEnd.bind(this))}},{key:"attachRegionEvents",value:function(){var e=this.eventBus;function t(t){t.stopPropagation(),e.dispatchEvent(new CustomEvent("regionmove",{detail:{mouseX:t.clientX,mouseY:t.clientY}}))}function n(i){i.stopPropagation(),document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",t),e.dispatchEvent(new CustomEvent("regionend",{detail:{mouseX:i.clientX,mouseY:i.clientY}}))}this.regionEl.addEventListener("mousedown",function(i){i.stopPropagation(),document.addEventListener("mouseup",n),document.addEventListener("mousemove",t),e.dispatchEvent(new CustomEvent("regionstart",{detail:{mouseX:i.clientX,mouseY:i.clientY}}))}),e.addEventListener("regionstart",this.onRegionMoveStart.bind(this)),e.addEventListener("regionmove",this.onRegionMoveMoving.bind(this)),e.addEventListener("regionend",this.onRegionMoveEnd.bind(this))}},{key:"attachOverlayEvents",value:function(){var e=4,t=this,n=null;function i(e){e.stopPropagation(),t.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:e.clientX,mouseY:e.clientY}}))}function r(e){e.stopPropagation(),document.removeEventListener("mouseup",r),document.removeEventListener("mousemove",i),1!==t.box.width()||1!==t.box.height()?t.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{mouseX:e.clientX,mouseY:e.clientY}})):t.box=n}this.overlayEl.addEventListener("mousedown",function(a){a.stopPropagation(),document.addEventListener("mouseup",r),document.addEventListener("mousemove",i);var l=t.cropperEl.getBoundingClientRect(),s=a.clientX-l.left,c=a.clientY-l.top;n=t.box,t.box=new o(s,c,s+1,c+1),t.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:t.handles[e]}}))})}},{key:"onHandleMoveStart",value:function(e){var t=e.detail.handle,n=[1-t.position[0],1-t.position[1]],i=this.box.getAbsolutePoint(n),a=r(i,2),o=a[0],l=a[1];this.activeHandle={handle:t,originPoint:n,originX:o,originY:l},null!==this.options.onCropStart&&this.options.onCropStart(this.getValue())}},{key:"onHandleMoveMoving",value:function(e){var t=e.detail,n=t.mouseX,i=t.mouseY,r=this.cropperEl.getBoundingClientRect();n-=r.left,i-=r.top,n<0?n=0:n>r.width&&(n=r.width),i<0?i=0:i>r.height&&(i=r.height);var a=this.activeHandle.originPoint.slice(),l=this.activeHandle.originX,s=this.activeHandle.originY,c=this.activeHandle.handle,p=1===c.constraints[0],u=1===c.constraints[1],m=1===c.constraints[2],d=1===c.constraints[3],h=(d||u)&&(p||m),f=d||u?l:this.box.x1,v=d||u?l:this.box.x2,w=p||m?s:this.box.y1,b=p||m?s:this.box.y2;f=d?n:f,v=u?n:v,w=p?i:w,b=m?i:b;var g=!1,y=!1;if((d||u)&&(g=d?n>l:n<l),(p||m)&&(y=p?i>s:i<s),g){var E=f;f=v,v=E,a[0]=1-a[0]}if(y){var _=w;w=b,b=_,a[1]=1-a[1]}var k=new o(f,w,v,b);if(this.options.aspectRatio){var O=this.options.aspectRatio,N=!1;h?N=i>k.y1+O*k.width()||i<k.y2-O*k.width():(p||m)&&(N=!0);var x=N?"width":"height";k.constrainToRatio(O,a,x)}var C=this.options.minSize,S=this.options.maxSize;k.constrainToSize(S.width,S.height,C.width,C.height,a,this.options.aspectRatio);var j=this.cropperEl.offsetWidth,P=this.cropperEl.offsetHeight;k.constrainToBoundary(j,P,a),this.box=k,this.redraw(),null!==this.options.onCropMove&&this.options.onCropMove(this.getValue())}},{key:"onHandleMoveEnd",value:function(e){null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue())}},{key:"onRegionMoveStart",value:function(e){var t=e.detail,n=t.mouseX,i=t.mouseY,r=this.cropperEl.getBoundingClientRect();n-=r.left,i-=r.top,this.currentMove={offsetX:n-this.box.x1,offsetY:i-this.box.y1},null!==this.options.onCropStart&&this.options.onCropStart(this.getValue())}},{key:"onRegionMoveMoving",value:function(e){var t=e.detail,n=t.mouseX,i=t.mouseY,r=this.currentMove,a=r.offsetX,o=r.offsetY,l=this.cropperEl.getBoundingClientRect();n-=l.left,i-=l.top,this.box.move(n-a,i-o),this.box.x1<0&&this.box.move(0,null),this.box.x2>l.width&&this.box.move(l.width-this.box.width(),null),this.box.y1<0&&this.box.move(null,0),this.box.y2>l.height&&this.box.move(null,l.height-this.box.height()),this.redraw(),null!==this.options.onCropMove&&this.options.onCropMove(this.getValue())}},{key:"onRegionMoveEnd",value:function(e){null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue())}},{key:"getValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e&&(e=this.options.returnMode),"real"==e){var t=this.imageEl.naturalWidth,n=this.imageEl.naturalHeight,i=this.imageEl.getBoundingClientRect(),r=i.width,a=i.height,o=t/r,l=n/a;return{x:Math.round(this.box.x1*o),y:Math.round(this.box.y1*l),width:Math.round(this.box.width()*o),height:Math.round(this.box.height()*l)}}if("ratio"==e){var s=this.imageEl.getBoundingClientRect(),p=s.width,u=s.height;return{x:c(this.box.x1/p,3),y:c(this.box.y1/u,3),width:c(this.box.width()/p,3),height:c(this.box.height()/u,3)}}if("raw"==e)return{x:Math.round(this.box.x1),y:Math.round(this.box.y1),width:Math.round(this.box.width()),height:Math.round(this.box.height())}}}],[{key:"parseOptions",value:function(e){var t=null,n={width:null,height:null},i={width:null,height:null},r={width:100,height:100,unit:"%"},a="real",o=null,l=null,s=null,c=null,p=null;void 0!==e.aspectRatio&&("number"==typeof e.aspectRatio?p=e.aspectRatio:e.aspectRatio instanceof Array&&(p=e.aspectRatio[1]/e.aspectRatio[0]));var u=null;void 0!==e.maxSize&&null!==e.maxSize&&(u={width:e.maxSize[0]||null,height:e.maxSize[1]||null,unit:e.maxSize[2]||"px"});var m=null;void 0!==e.minSize&&null!==e.minSize&&(m={width:e.minSize[0]||null,height:e.minSize[1]||null,unit:e.minSize[2]||"px"});var d=null;void 0!==e.startSize&&null!==e.startSize&&(d={width:e.startSize[0]||null,height:e.startSize[1]||null,unit:e.startSize[2]||"%"});var h=null;"function"==typeof e.onInitialize&&(h=e.onInitialize);var f=null;"function"==typeof e.onCropStart&&(f=e.onCropStart);var v=null;"function"==typeof e.onCropEnd&&(v=e.onCropEnd);var w=null;"function"==typeof e.onUpdate&&(console.warn("Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead."),w=e.onUpdate),"function"==typeof e.onCropMove&&(w=e.onCropMove);var b=null;if(void 0!==e.returnMode){var g=e.returnMode.toLowerCase();if(-1===["real","ratio","raw"].indexOf(g))throw"Invalid return mode.";b=g}var y=function(e,t){return null!==e?e:t};return{aspectRatio:y(p,t),maxSize:y(u,n),minSize:y(m,i),startSize:y(d,r),returnMode:y(b,a),onInitialize:y(h,o),onCropStart:y(f,l),onCropMove:y(w,s),onCropEnd:y(v,c),convertToPixels:function(e){for(var t=e.offsetWidth,n=e.offsetHeight,i=["maxSize","minSize","startSize"],r=0;r<i.length;r++){var a=i[r];null!==this[a]&&("%"==this[a].unit&&(null!==this[a].width&&(this[a].width=this[a].width/100*t),null!==this[a].height&&(this[a].height=this[a].height/100*n)),delete this[a].unit)}}}}}]),n}())}()},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(1);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=wp.element,o=(a.createElement,a.useState),l=a.useEffect,s=(a.Fragment,a.render,a.useRef),c=wp.data,p=(c.dispatch,c.select),u=function(e){var t=r(o(""),2),n=t[0],i=t[1];return l(function(){var t="",n="";switch(e.type){case"friends":n="user",t=e.id.item_id;break;case"group":n="group",t=e.id.item_id;break;case"activity":n="user",t=e.id.secondary_item_id;break;case"member":case"name":case"user_tip":case"user":n="user",t=e.id.user_id;break;default:n=e.type,t=e.id.item_id}localforage.getItem(n+"_"+t).then(function(t){null!==t?i(JSON.parse(t)):fetch("".concat(window.vibebp.api.url,"/avatar"),{method:"post",body:JSON.stringify({type:e.type,ids:e.id,token:p("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(e){e.status&&(localforage.setItem(e.key,JSON.stringify(e.value)),i(e.value))})})},[]),"member"==e.type?wp.element.createElement("span",{className:"vibebp_member",title:n.name},wp.element.createElement("img",{src:n.avatar,className:"vibebp_avatar",onClick:e.click,alt:n.name,title:n.name}),wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:n.name}})):"user_tip"==e.type?wp.element.createElement("span",{className:"vibebp_member tip",title:n.name},wp.element.createElement("img",{src:n.avatar,className:"vibebp_avatar",onClick:e.click,alt:n.name,title:n.name})):"name"==e.type?wp.element.createElement("span",null,n.name):wp.element.createElement("img",{src:n.avatar,className:"vibebp_avatar",onClick:e.click,alt:n.name,title:n.name})},m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=s(Date.now());l(function(){var n=setTimeout(function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())},t-(Date.now()-r.current));return function(){clearTimeout(n)}},[t].concat(i(n)))},d=function(e,t,n){var i;return function(){var r=this,a=arguments,o=function(){i=null,n||e.apply(r,a)},l=n&&!i;clearTimeout(i),i=setTimeout(o,t||200),l&&e.apply(r,a)}},h=wp.element,f=(h.createElement,h.useState,h.useEffect,h.Fragment,h.render,wp.data),v=(f.dispatch,f.select,function e(t){return wp.element.createElement("div",{className:"vibebp_sub_forum"},wp.element.createElement("div",{className:"vibebp_sub_forum_details"},wp.element.createElement("strong",null,t.forum.post_title),wp.element.createElement("div",{dangerouselySetInnerHTML:{__html:t.forum.post_content}})),wp.element.createElement("div",{className:"vibebp_topic_count"},wp.element.createElement("span",{className:"vicon vicon-comments"}),t.forum.topic_count),t.forum.hasOwnProperty("forums")&&t.forums.forums.length?t.forums.forums.map(function(t){return wp.element.createElement(e,{forum:t})}):"")}),w=n(0),b=n.n(w);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var k=wp.element,O=(k.createElement,k.useState),N=k.useEffect,x=k.useRef,C=k.Fragment,S=(k.render,wp.data),j=(S.dispatch,S.select,Math.round(100*Math.random())),P=function(e){var t=x(null),n=_(O(!0),2),i=n[0],r=n[1],a=_(O(!1),2),o=a[0],l=a[1],s=_(O(!1),2),c=s[0],p=s[1],u=_(O(""),2),m=u[0],d=u[1],h=_(O(""),2),f=h[0],v=h[1],w=_(O(""),2),g=(w[0],w[1]),E=_(O(""),2),k=E[0],S=E[1],P=_(O({x:0,y:0,width:0,height:0,type:"image"}),2),A=P[0],T=P[1],M=_(O(""),2),z=M[0],I=M[1],L=_(O(window.vibebp.translations.select_image),2),D=L[0],R=L[1];N(function(){e.hasOwnProperty("crop")&&e.crop&&l(!0)},[]),N(function(){if(c&&z&&o)new b.a(z,{returnMode:"ratio",onCropEnd:function(t){var n=y({},A);n.x=100*t.x,n.y=100*t.y,n.height=100*t.height,n.width=100*t.width,T(n);var i={x:z.naturalWidth*t.x,y:z.naturalHeight*t.y,width:z.naturalWidth*t.width,height:z.naturalHeight*t.height};e.update(k,i)}})},[c,z]);var H={backgroundPosition:A.x+"% "+A.y+"%",backgroundSize:1e4/A.width+"% "+1e4/A.height+"% ",backgroundImage:"url("+m+")"};return wp.element.createElement("div",{className:"uploader"},i?wp.element.createElement("label",{for:"fileupload_"+j,className:"upload_file"},D,"image"==e.type?wp.element.createElement("input",{id:"fileupload_"+j,"data-type":e.type,ref:t,type:"file",accept:"image/*",onChange:function(n){t.current.files[0].size<window.vibebp.settings.upload_limit?(d(window.URL.createObjectURL(t.current.files[0])),r(!1),S(t.current.files),e.update(t.current.files,y({},A,{key:"image"}))):(R(window.vibebp.translations.image_size_error),setTimeout(function(){R(window.vibebp.translations.select_image)},3500))}}):"video"==e.type?wp.element.createElement("input",{id:"fileupload_"+j,"data-type":e.type,ref:t,type:"file",accept:"video/*",onChange:function(n){t.current.files[0].size<window.vibebp.settings.upload_limit?(v(window.URL.createObjectURL(t.current.files[0])),r(!1),S(t.current.files),e.update(t.current.files,y({},A,{key:"video"}))):(R(window.vibebp.translations.image_size_error),setTimeout(function(){R(window.vibebp.translations.select_image)},3500))}}):wp.element.createElement("input",{id:"fileupload_"+j,"data-type":e.type,ref:t,type:"file",onChange:function(n){t.current.files[0].size<window.vibebp.settings.upload_limit?(g(window.URL.createObjectURL(t.current.files[0])),r(!1),S(t.current.files),e.update(t.current.files,y({},A,{key:"attachment"}))):(R(window.vibebp.translations.image_size_error),setTimeout(function(){R(window.vibebp.translations.select_image)},3500))}})):wp.element.createElement("div",{className:"uploaded_src"},"image"==e.type?wp.element.createElement(C,null,o?wp.element.createElement(C,null,wp.element.createElement("div",{className:"uploaded_image",style:H}),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){p(!c)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){l(!1),r(!0),I(""),d(""),T({x:0,y:0,width:0,height:0})}})),c?wp.element.createElement("div",{className:"cropimage",id:"cropper"},wp.element.createElement("img",{src:m,ref:function(e){I(e)}})):""):wp.element.createElement("img",{src:m})):"video"==e.type?wp.element.createElement(C,null,wp.element.createElement("video",{src:f})):wp.element.createElement(C,null,wp.element.createElement("i",{className:"vicon vicon-clip"}))))};function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var T=wp.element,M=(T.createElement,T.useState),z=T.useEffect,I=T.Fragment,L=(T.render,wp.data),D=(L.dispatch,L.select),R=function(e){var t=A(M(e.reply),2),n=t[0],i=(t[1],A(M([]),2)),r=(i[0],i[1],A(M(!1),2)),a=(r[0],r[1],D("vibebp").getUser());return z(function(){},[]),wp.element.createElement("div",{className:"vibebp_reply"},wp.element.createElement(u,{type:"member",id:{user_id:parseInt(n.author)}}),wp.element.createElement("div",{className:n.hasOwnProperty("is_private")&&n.is_private?"is_private vibebp_reply_content":"vibebp_reply_content"},wp.element.createElement("div",{className:"vibebp_reply_content_meta"},wp.element.createElement("a",{href:n.permalink,className:"vicon vicon-link"}),wp.element.createElement("span",null,n.last_update),a.id===parseInt(n.author)?wp.element.createElement(I,null,wp.element.createElement("span",{className:"vicon vicon-pencil"}),wp.element.createElement("span",{className:"vicon vicon-trash"})):""),wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:n.post_content},onClick:function(){e.hasOwnProperty("open")&&e.open(n.topic_id)}}),n.attachments.length?wp.element.createElement("div",{className:"vibebp_reply_attachments"},n.attachments.map(function(e){return wp.element.createElement("div",{className:"vibebp_reply_attachment"},"image"==e.key?wp.element.createElement("a",{href:e.value,target:"_blank"},wp.element.createElement("img",{src:e.value})):wp.element.createElement("a",{href:e.value,target:"_blank",className:"vicon vicon-link"}))})):""))};function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach(function(t){J(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var X=wp.element,Y=(X.createElement,X.useState),U=X.useEffect,V=(X.Fragment,X.render,wp.data),q=V.dispatch,W=V.select,G=function(e){var t=B(Y(!1),2),n=t[0],i=t[1],r=B(Y([]),2),a=r[0],o=r[1],l=B(Y({post_title:"",post_content:"",forum_id:0}),2),s=l[0],c=l[1];U(function(){fetch("".concat(window.helpdesk.api.url,"/bbp/forums"),{method:"post",body:JSON.stringify({token:W("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(e){e.status&&o(e.data)})},[]),U(function(){e.hasOwnProperty("topic")&&c({post_title:e.topic.post_title,post_content:e.topic.post_content,forum_id:e.topic.forum_id,topic_id:e.topic.id})},[]);return wp.element.createElement("div",{className:"vibebp_new_topic"},wp.element.createElement("div",{className:"vibebp_new_topic_header"},wp.element.createElement("span",{className:"vicon vicon-arrow-left",onClick:function(){return e.back()}}),wp.element.createElement("div",{className:"vibebp_topic_actions"},wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){c(F({},s,{post_title:"",post_content:""}))}}))),wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",value:s.post_title,placeholder:window.helpdesk.translations.topic_title,onChange:function(e){c(F({},s,{post_title:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},a.length?wp.element.createElement("select",{onChange:function(e){c(F({},s,{forum_id:e.target.value}))},value:s.forum_id,placeholder:window.helpdesk.translations.select_forum},wp.element.createElement("option",null,window.helpdesk.translations.select_forum),a.map(function(e){if(e.access)return wp.element.createElement("option",{value:e.id},e.title)})):""),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("textarea",{value:s.post_content,placeholder:window.helpdesk.translations.topic_content,onChange:function(e){c(F({},s,{post_content:e.target.value}))}})),wp.element.createElement("a",{className:n?"button is-primary is-loading":"button is-primary",onClick:function(){i(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/topics/create"),{method:"post",body:JSON.stringify(F({},s,{token:W("vibebp").getToken()}))}).then(function(e){return e.json()}).then(function(t){i(!1),t.status?(e.hasOwnProperty("update")&&e.update(t.data),e.back("mytopics")):t.hasOwnProperty("message")&&q("vibebp").addNotification({text:t.message})})}},window.helpdesk.translations.submit)))};function K(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(n,!0).forEach(function(t){$(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ne=wp.element,ie=(ne.createElement,ne.useState),re=ne.useEffect,ae=ne.Fragment,oe=(ne.render,wp.data),le=oe.dispatch,se=oe.select,ce=function(e){var t=te(ie(e.topic),2),n=t[0],i=t[1],r=te(ie(!1),2),a=r[0],o=r[1],l=te(ie([]),2),s=l[0],c=l[1],p=te(ie(!0),2),m=p[0],h=p[1],f=te(ie({post_content:"",topic_id:0,forum_id:0,meta:[]}),2),v=f[0],w=f[1],b=te(ie(!0),2),g=b[0],y=(b[1],te(ie(!1),2)),E=y[0],_=y[1],k=te(ie({paged:1,post_parent:0,order:"DESC"}),2),O=k[0],N=k[1],x=te(ie([]),2),C=x[0],S=x[1],j=te(ie(""),2),A=j[0],T=j[1],M=se("vibebp").getUser(),z=te(ie(!1),2),I=z[0],L=z[1],D=te(ie(""),2),H=D[0],F=D[1],J=te(ie(),2),B=J[0],X=J[1],Y=te(ie(!1),2),U=Y[0],V=Y[1],q=te(ie(!1),2),W=q[0],Q=q[1];re(function(){"object"===ee(e.topic)?(console.log("object"),i(e.topic),N(Z({},O,{post_parent:e.topic.id})),w(Z({},v,{topic_id:e.topic.id,forum_id:e.topic.forum_id})),h(!1)):(N(Z({},O,{post_parent:e.topic})),fetch("".concat(window.helpdesk.api.url,"/bbp/topic"),{method:"post",body:JSON.stringify({topic_id:e.topic,token:se("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){t.status&&(h(!1),i(t.topic),N(Z({},O,{post_parent:e.topic.id})))}))},[]),re(function(){if(O.post_parent){h(!0),_(!1);var e=Z({},O);e.token=se("vibebp").getToken(),fetch("".concat(window.helpdesk.api.url,"/bbp/replies"),{method:"post",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){if(h(!1),e.status)if(g){var t=K(s);e.replies.map(function(e){t.push(e)}),t.length<e.total?_(!0):_(!1),c(t)}else c(e.replies);else e.hasOwnProperty("message")&&le("vibebp").addNotification({text:e.message})})}},[O]);var $=function(e){},ne=d(function(){if(v.post_content&&H){var e={canned_title:H,canned_response:v.post_content,token:se("vibebp").getToken()};v.hasOwnProperty("canned_id")&&(e.canned_id=v.canned_id),fetch("".concat(window.helpdesk.api.url,"/bbp/replies/save_canned"),{method:"post",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){e.status&&V(!1),e.hasOwnProperty("message")&&le("vibebp").addNotification({text:e.message})})}},500,null),oe=d(function(e){e&&fetch("".concat(window.helpdesk.api.url,"/bbp/replies/search_canned"),{method:"post",body:JSON.stringify({search_terms:e,token:se("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(e){e.status&&e.data&&Array.isArray(e.data)&&X(e.data),e.hasOwnProperty("message")&&le("vibebp").addNotification({text:e.message})})},500,null);return wp.element.createElement("div",{className:"vibebp_full_topic"},a?wp.element.createElement(G,{back:function(){o(!1)},topic:n,update:function(t){i(t),e.update(t)}}):wp.element.createElement(ae,null,wp.element.createElement("div",{className:"vibebp_full_topic_header"},wp.element.createElement("span",{onClick:e.back},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),wp.element.createElement("span",null,window.helpdesk.translations.back_to_all_topics)),wp.element.createElement("div",{className:"vibebp_topic_actions"},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:n.last_update}}),wp.element.createElement("span",{className:n.hasOwnProperty("favorite")&&n.favorite?"vicon vicon-star active":"vicon vicon-star",onClick:function(){isFavorite?fetch("".concat(window.helpdesk.api.url,"/bbp/topics/unfavorite"),{method:"post",body:JSON.stringify({topic_id:n.id,token:se("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(e){e.status&&i(Z({},n,{favorite:!1})),e.hasOwnProperty("message")&&le("vibebp").addNotification({text:e.message})}):fetch("".concat(window.helpdesk.api.url,"/bbp/topics/favorite"),{method:"post",body:JSON.stringify({topic_id:n.id,token:se("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(e){e.status&&i(Z({},n,{favorite:!0})),e.hasOwnProperty("message")&&le("vibebp").addNotification({text:e.message})})}}),n.hasOwnProperty("author")&&n.author==M.id?wp.element.createElement(ae,null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){o(n)}}),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){e.back()}})):"")),wp.element.createElement("div",{className:"vibebp_main_topic"},wp.element.createElement(u,{type:"member",id:{user_id:n.author}}),wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:n.post_content}})),s.length?s.map(function(e,t){return wp.element.createElement(R,{reply:e,update:$})}):"",m?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",E?wp.element.createElement("a",{className:"link",onClick:function(){var e=Z({},O);e.paged=O.paged+1,N(e)}},window.helpdesk.translations.more):"",wp.element.createElement("div",{className:"vibebp_reply_form"},wp.element.createElement("div",{className:"vibe_reply_editor"},wp.element.createElement(ae,null,I?wp.element.createElement("div",{className:"canned_response_search"},wp.element.createElement("div",{className:"canned_search_header"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{placeholder:window.helpdesk.translations.search,onChange:function(e){return oe(e.target.value)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return L(!1)}})),B&&Array.isArray(B)?wp.element.createElement("div",{className:"canned_responses"},B.map(function(e,t){return wp.element.createElement("span",{className:"canned_response",onClick:function(){w(Z({},v,{canned_id:e.ID,post_content:e.post_content}))}},e.post_title)})):""):window.helpdesk.settings.canned_responses?wp.element.createElement("span",{className:"vicon vicon-search",onClick:function(){return L(!0)}}):""),wp.element.createElement("textarea",{value:v.post_content,onChange:function(e){w(Z({},v,{post_content:e.target.value}))}}),wp.element.createElement("div",{className:"vibebp_reply_form_actions"},wp.element.createElement("div",{className:"vibebp_reply_form_attachments"},wp.element.createElement(ae,null,wp.element.createElement("div",{className:"attachment_action"},wp.element.createElement("a",{className:"vicon vicon-clip",onClick:function(){var e=K(C);e.push("attachment"),S(e)}}),wp.element.createElement("a",{className:"vicon vicon-video-camera",onClick:function(){var e=K(C);e.push("video"),S(e)}}),wp.element.createElement("a",{className:"vicon vicon-image",onClick:function(){var e=K(C);e.push("image"),S(e)}}))),C.length?C.map(function(e,t){return wp.element.createElement("div",{className:"vibebp_reply_form_attachment"},"image"==e?wp.element.createElement("a",{className:"vicon vicon-image upload_type"}):"video"==e?wp.element.createElement("a",{className:"vicon vicon-video-camera upload_type"}):wp.element.createElement("a",{className:"vicon vicon-clip upload_type"}),wp.element.createElement(P,{type:e,update:function(n,i){var r=K(A);r[t]=new File([n[0]],n[0].name),T(r);var a=K(v.meta);a.push({key:e,value:t}),w(Z({},v,{meta:a}))}}),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){var e=K(C);e.splice(t,1);var n=K(A);n.splice(t,1),T(n),S(e)}}))}):""),wp.element.createElement("div",{className:"vibebp_reply_form_buttons"},window.helpdesk.settings.private_plugin_active?wp.element.createElement("div",{className:"vibebp_form_field helpdesk_private_reply"},wp.element.createElement("span",null,window.helpdesk.translations.make_reply_private),wp.element.createElement("div",{className:"switch"},v.hasOwnProperty("is_private")&&v.is_private?wp.element.createElement("input",{type:"checkbox",id:"helpdesk_private_reply",checked:!0,onClick:function(){w(Z({},v,{is_private:!1}))}}):wp.element.createElement("input",{type:"checkbox",id:"helpdesk_private_reply",onClick:function(){w(Z({},v,{is_private:!0}))}}),wp.element.createElement("label",{for:"helpdesk_private_reply",className:"slider"}))):"",window.helpdesk.settings.canned_responses?wp.element.createElement(ae,null,v.post_content.length?wp.element.createElement(ae,null,U?wp.element.createElement("div",{className:"canned_response_form"},wp.element.createElement("input",{value:H,placeholder:window.helpdesk.translations.enter_canned_title,onChange:function(e){F(e.target.value)}}),wp.element.createElement("div",null,wp.element.createElement("a",{className:"button is-primary",onClick:ne},window.helpdesk.translations.save_as_canned_response),wp.element.createElement("a",{className:"link",onClick:function(){return V(!1)}},window.helpdesk.translations.cancel))):v.hasOwnProperty("newReply")?wp.element.createElement("a",{className:"link",onClick:function(){return V(!0)}},window.helpdesk.translations.update_canned_response):wp.element.createElement("a",{className:"link",onClick:function(){return V(!0)}},window.helpdesk.translations.save_as_canned_response)):""):"",v.post_content?wp.element.createElement("a",{className:W?"button is-primary is-loading":"button is-primary",onClick:function(){var e=new FormData;e.append("body",JSON.stringify({args:Z({},v),token:se("vibebp").getToken()})),A.length&&A.map(function(t,n){e.append("files_"+n,t)}),Q(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/replies/create"),{method:"post",body:e}).then(function(e){return e.json()}).then(function(e){if(Q(!1),e.status){var t=K(s);t.push(e.reply),c(t),w(Z({},v,{post_content:"",meta:[]})),S([]),T("")}else e.hasOwnProperty("message")&&le("vibebp").addNotification({text:e.message})})}},window.helpdesk.translations.submit):""))))))};function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(n,!0).forEach(function(t){me(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function de(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var fe=wp.element,ve=(fe.createElement,fe.useState),we=fe.useEffect,be=fe.Fragment,ge=(fe.render,wp.data),ye=ge.dispatch,Ee=ge.select,_e=function(e){var t=he(ve(!1),2),n=t[0],i=t[1],r=he(ve({type:e.type,sorter:"",paged:1,s:"",order:"DESC"}),2),a=r[0],o=r[1],l=he(ve([]),2),s=l[0],c=l[1],p=he(ve(!0),2),h=p[0],f=(p[1],he(ve(!1),2)),v=f[0],w=f[1],b=he(ve(!1),2),g=b[0],y=b[1],E=he(ve(0),2),_=E[0],k=E[1],O=he(ve(!1),2),N=O[0],x=(O[1],he(ve(!1),2)),C=x[0],S=x[1],j=Ee("vibebp").getUser(),P=he(ve([]),2),A=P[0],T=P[1],M=he(ve([]),2),z=M[0],I=M[1],L=he(ve([]),2),D=L[0],R=L[1],H=he(ve({}),2),F=H[0],J=H[1];we(function(){e.hasOwnProperty("forum")&&S(e.forum.subscribed)},[]),m(function(){var t=de(s);1==a.paged&&c(t=[]),i(!0);var n=ue({},a,{type:e.type});"forum"===e.type&&(n.post_parent=e.forum.id),e.label&&(n.label=e.label),n.token=Ee("vibebp").getToken(),fetch("".concat(window.helpdesk.api.url,"/bbp/topics"),{method:"post",body:JSON.stringify(n)}).then(function(e){return e.json()}).then(function(e){if(i(!1),e.status)if(h){var n=de(t);e.topics.map(function(e){n.push(e)}),c(n),n.length<e.total?w(!0):w(!1)}else c(e.topics);else c([])}),"assigned"==n.type&&fetch("".concat(window.helpdesk.api.url,"/bbp/topics/topic_labels"),{method:"post",body:JSON.stringify(n)}).then(function(e){return e.json()}).then(function(e){e.status&&Array.isArray(e.data)&&e.data.length&&T(e.data)})},500,[a,e.type,e.label]);var B=function(e){var t=de(s),n=t.findIndex(function(t,n){return t.id==e.id});n>-1?t.splice(n,1,e):t.push(e),c(t)},X=function(e,t,n){"assign"==n?fetch("".concat(window.helpdesk.api.url,"/bbp/topics/assign_topic_label"),{method:"post",body:JSON.stringify({topic_id:e.id,label:t.label,action:n,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){if(t.status){var n=de(s),i=n.findIndex(function(t){return t.id==e.id});i>-1&&(n[i].assigned_topic_labels=t.data,c(n))}else t.hasOwnProperty("message")&&ye("vibebp").addNotification({text:t.message})}):"unassign"==n&&fetch("".concat(window.helpdesk.api.url,"/bbp/topics/assign_topic_label"),{method:"post",body:JSON.stringify({topic_id:e.id,label:t.label,action:n,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){if(t.status){var n=de(s),i=n.findIndex(function(t){return t.id==e.id});i>-1&&(n[i].assigned_topic_labels=t.data,c(n))}else t.hasOwnProperty("message")&&ye("vibebp").addNotification({text:t.message})})},Y=d(function(e,t){e&&t&&fetch("".concat(window.helpdesk.api.url,"/bbp/topics/search_topic_assignable_user"),{method:"post",body:JSON.stringify({topic_id:e,search_term:t,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){if(t.status){if(t.hasOwnProperty("data")&&Array.isArray(t.data)){var n=ue({},F);n[e]=t.data,J(n)}}else t.hasOwnProperty("message")&&ye("vibebp").addNotification({text:t.message})})},500,null);return wp.element.createElement("div",{className:"vibebp_topics"},e.hasOwnProperty("forum")?wp.element.createElement("div",{className:"vibebp_topics_header"},wp.element.createElement("span",{onClick:e.back},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),wp.element.createElement("span",null,window.helpdesk.translations.back_to_all_forums)),wp.element.createElement("span",{className:C?"subscribe active":"subscribe",onClick:function(){fetch("".concat(window.helpdesk.api.url,"/bbp/forums/subscribe"),{method:"post",body:JSON.stringify({forum_id:e.forum.id,subscribe:!C,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(e){e.status&&S(!C)})}},C?window.helpdesk.translations.subscribed:window.helpdesk.translations.subscribe)):"",_?"":wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:N?"search_me control is-loading":"search_me"},wp.element.createElement("input",{type:"text",value:a.s,onChange:function(e){o({paged:1,s:e.target.value})},placeholder:window.helpdesk.translations.search_topics}),wp.element.createElement("span",{className:"vicon vicon-search"}))),_?wp.element.createElement(ce,{topic:_,back:function(){k(!1)},update:B}):g?wp.element.createElement(G,{back:function(){y(!1)},topic:s[g],update:B}):wp.element.createElement(be,null,s.length?s.map(function(t,n){return wp.element.createElement("div",{className:"vibebp_topic_wrapper"},wp.element.createElement(u,{type:"member",id:{user_id:t.author}}),wp.element.createElement("div",{className:"vibebp_topic"},wp.element.createElement("div",{className:"vibebp_topic_title"},wp.element.createElement("strong",{onClick:function(){k(t)}},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:t.post_title}})),wp.element.createElement(be,null,"unassigned"==e.type||"recent_assigned"==e.type?wp.element.createElement(be,null,wp.element.createElement("span",{className:de(D).indexOf(t.id)>-1?"vicon vicon-user assign_label active":"vicon vicon-user assign_label",onClick:function(){var e=de(D),n=e.indexOf(t.id);n<0?e.push(t.id):e.splice(n,1),R(e)}}),D.includes(t.id)?wp.element.createElement("span",{className:"topic_labels all"},wp.element.createElement("input",{type:"text",onChange:function(e){return Y(t.id,e.target.value)}}),F.hasOwnProperty(t.id)?F[t.id].map(function(e,n){return wp.element.createElement("span",{className:"s_users",onClick:function(){return n=t.id,i=e.id,void(n&&i&&fetch("".concat(window.helpdesk.api.url,"/bbp/topics/assign_topic"),{method:"post",body:JSON.stringify({topic_id:n,user_ids:[i],action:"assign",token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(e){if(e.status){var t=ue({},F);if(t.hasOwnProperty(n)&&t[n]){var r=t[n].findIndex(function(e){return e.id==i});r>-1&&t[n].splice(r,1),J(t)}}else e.hasOwnProperty("message")&&ye("vibebp").addNotification({text:e.message})}));var n,i}},e.name)}):""):""):"","assigned"==e.type?wp.element.createElement(be,null,wp.element.createElement("span",{className:de(z).indexOf(t.id)>-1?"vicon vicon-plus assign_label active":"vicon vicon-plus assign_label",onClick:function(){var e=de(z),n=e.indexOf(t.id);n<0?e.push(t.id):e.splice(n,1),I(e)}},A&&A.length&&z.includes(t.id)?wp.element.createElement("span",{className:"topic_labels all"},A.map(function(e,n){return t.assigned_topic_labels&&t.assigned_topic_labels.length?t.assigned_topic_labels.findIndex(function(t){return t.label==e.label})<0?wp.element.createElement("span",{className:"topic_label",style:{background:e.color},onClick:function(){X(t,e,"assign")}},wp.element.createElement("span",null,e.label)):"":wp.element.createElement("span",{className:"topic_label",style:{background:e.color},onClick:function(){X(t,e,"assign")}},wp.element.createElement("span",null,e.label))})):""),t.assigned_topic_labels&&t.assigned_topic_labels.length?wp.element.createElement("span",{className:"topic_labels assigned"},t.assigned_topic_labels.map(function(e,n){return wp.element.createElement("span",{className:"topic_label",style:{background:e.color},onClick:function(){X(t,e,"unassign")}},wp.element.createElement("span",null,e.label))})):""):""),wp.element.createElement("span",null,wp.element.createElement("span",{className:t.favorite?"vicon vicon-star active":"vicon vicon-star",onClick:function(){!function(e){e.favorite?fetch("".concat(window.helpdesk.api.url,"/bbp/topics/unfavorite"),{method:"post",body:JSON.stringify({topic_id:e.id,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){if(t.status){var n=de(s);n[n.findIndex(function(t){return t.id===e.id})].favorite=!1,c(n)}t.hasOwnProperty("message")&&ye("vibebp").addNotification({text:t.message})}):fetch("".concat(window.helpdesk.api.url,"/bbp/topics/favorite"),{method:"post",body:JSON.stringify({topic_id:e.id,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){if(t.status){var n=de(s);n[n.findIndex(function(t){return t.id===e.id})].favorite=!0,c(n)}t.hasOwnProperty("message")&&ye("vibebp").addNotification({text:t.message})})}(t)}}),wp.element.createElement("span",{className:t.subscribed?"subscribe active":"subscribe",onClick:function(){!function(e){fetch("".concat(window.helpdesk.api.url,"/bbp/topics/subscribe"),{method:"post",body:JSON.stringify({topic_id:s[e].id,subscribe:!s[e].subscribed,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){if(t.status){var n=de(s);n[e].subscribed=!n[e].subscribed,c(n)}else t.hasOwnProperty("message")&&ye("vibebp").addNotification({text:t.message})})}(n)}},t.subscribed?window.helpdesk.translations.subscribed:window.helpdesk.translations.subscribe),wp.element.createElement("span",{className:"vicon vicon-comment-alt",onClick:function(){k(t)}}),wp.element.createElement("strong",{onClick:function(){k(t)}},t.reply_count))),wp.element.createElement("div",{className:"vibebp_topic_actions"},wp.element.createElement("a",{href:t.permalink,target:"_blank",className:"vicon vicon-link"}),wp.element.createElement("span",null,wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:t.last_update}})),j.id===parseInt(t.author)?wp.element.createElement(be,null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){y(n)}}),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){!function(e){var t=de(s);fetch("".concat(window.helpdesk.api.url,"/bbp/topics/delete"),{method:"post",body:JSON.stringify({topic_id:e.id,token:Ee("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(n){n.status?(t=t.splice(t.findIndex(function(t){return e.id===t.id}),1),c(t)):n.hasOwnProperty("message")&&ye("vibebp").addNotification({text:n.message})})}(n)}})):"")))}):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_topics_found),n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",v?wp.element.createElement("a",{className:"link",onClick:function(){w(!1);var e=ue({},a);e.paged=a.paged+1,o(e)}},window.helpdesk.translations.more):""))};function ke(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(n,!0).forEach(function(t){xe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Se=wp.element,je=(Se.createElement,Se.useState),Pe=Se.useEffect,Ae=Se.Fragment,Te=(Se.render,wp.data),Me=Te.dispatch,ze=Te.select,Ie=function(e){var t=Ce(je(!0),2),n=t[0],i=t[1],r=Ce(je([]),2),a=r[0],o=r[1],l=Ce(je(!1),2),s=l[0],c=l[1],p=Ce(je({paged:1,s:""}),2),u=p[0],d=p[1],h=Ce(je(""),2),f=h[0],w=h[1],b=Ce(je(!1),2),g=b[0],y=b[1],E=Ce(je(!1),2),_=E[0],k=E[1],O=Ce(je(!1),2),N=O[0],x=(O[1],Ce(je([]),2));x[0],x[1];Pe(function(){if("forums"==ze("vibebp").getAction()&&ze("vibebp").getId()){var e=ze("vibebp").getId();e&&d(Ne({},u,{post__in:[e]}))}},[]),m(function(){i(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/forums"),{method:"post",body:JSON.stringify(Ne({},u,{token:ze("vibebp").getToken()}))}).then(function(e){return e.json()}).then(function(e){if(i(!1),e.status)if(_){var t=ke(a);e.data.map(function(e){t.push(e)}),o(t),k(!1),ntopics.length<e.total?y(!0):y(!1)}else o(e.data),u.post__in&&1==u.post__in.length&&c(e.data[0]),w(e.message)})},500,[u]);var C=function(e){fetch("".concat(window.helpdesk.api.url,"/bbp/forums/subscribe"),{method:"post",body:JSON.stringify({subscribe:!a[e].subscribed,forum_id:a[e].id,token:ze("vibebp").getToken()})}).then(function(e){return e.json()}).then(function(t){if(t.status){var n=ke(a);n[e].subscribed=!a[e].subscribed,o(n)}else t.hasOwnProperty("message")&&Me("vibebp").addNotification({text:t.message})})};return wp.element.createElement("div",{className:"vibebp_forums"},s?wp.element.createElement(_e,{type:"forum",forum:s,back:function(){if(c(!1),u.post__in){var e=Ne({},u);delete e.post__in,d(e)}}}):wp.element.createElement(Ae,null,wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:N?"search_me control is-loading":"search_me"},wp.element.createElement("input",{type:"text",value:u.s,onChange:function(e){d({paged:1,s:e.target.value})},placeholder:window.helpdesk.translations.search_text}),wp.element.createElement("span",{className:"vicon vicon-search"}))),n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(Ae,null,a.length?a.map(function(e,t){return wp.element.createElement("div",{className:"vibebp_forum"},wp.element.createElement("div",{className:"vibebp_forum_details"},wp.element.createElement("strong",{onClick:function(){e.access&&c(e)}},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:e.title}})),wp.element.createElement("div",{className:"vibebp_forum_description",dangerouslySetInnerHTML:{__html:e.description}}),wp.element.createElement("div",{className:"vibebp_forum_meta"},e.private?wp.element.createElement("span",{className:"vicon vicon-key"}):"",e.subscribed?wp.element.createElement("span",{onClick:function(){C(t)},className:"active subscribe"},window.helpdesk.translations.subscribed):wp.element.createElement("span",{onClick:function(){C(t)},className:"subscribe"},window.helpdesk.translations.subscribe),e.access?wp.element.createElement("span",{className:"vicon vicon-eye"}):wp.element.createElement("span",{className:"vicon vicon-na"}),e.forums_count?wp.element.createElement("span",null,wp.element.createElement("span",{className:"vicon vicon-comment-alt"})," ",e.forums_count):"",e.hasOwnProperty("forums")&&e.forums.length?wp.element.createElement("div",{class:"sub_forums"},e.forums.map(function(e){return wp.element.createElement(v,{forum:e})})):"")),wp.element.createElement("div",{className:"vibebp_topic_count"},wp.element.createElement("span",{className:"vicon vicon-comments"}),e.topic_count))}):wp.element.createElement("div",{className:"vbp_message"},f),g?wp.element.createElement("a",{className:"link",onClick:function(){var e=Ne({},u);e.paged=u.paged+1,k(!0),d(e)}},window.helpdesk.translations.more):"")))};function Le(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(n,!0).forEach(function(t){He(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Je=wp.element,Be=(Je.createElement,Je.useState),Xe=Je.useEffect,Ye=Je.Fragment,Ue=(Je.render,wp.data),Ve=(Ue.dispatch,Ue.select),qe=function(e){var t=Fe(Be({type:e.type,sorter:"",paged:1,s:"",order:"DESC"}),2),n=t[0],i=t[1],r=Fe(Be(!1),2),a=r[0],o=r[1],l=Fe(Be([]),2),s=l[0],c=l[1],p=Fe(Be(!0),2),u=p[0],d=p[1],h=Fe(Be(!1),2),f=h[0],v=h[1],w=Fe(Be(0),2),b=w[0],g=w[1],y=Fe(Be(!1),2),E=y[0];y[1];m(function(){1==n.paged&&c([]),o(!0);var e=Re({},n);e.token=Ve("vibebp").getToken(),fetch("".concat(window.helpdesk.api.url,"/bbp/replies"),{method:"post",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){if(o(!1),e.status)if(u){var t=Le(s);e.replies.map(function(e){t.push(e)}),c(t),t.length<e.total?v(!0):v(!1)}else c(e.replies)})},500,[n]),Xe(function(){},[n]);var _=function(){};return wp.element.createElement(Ye,null,b?wp.element.createElement(ce,{topic:b,back:function(){g(!1)}}):wp.element.createElement("div",{className:"vibebp_replies"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:E?"search_me control is-loading":"search_me"},wp.element.createElement("input",{type:"text",value:n.s,onChange:function(e){i({paged:1,s:e.target.value})},placeholder:window.helpdesk.translations.search_replies}),wp.element.createElement("span",{className:"vicon vicon-search"}))),s&&s.length?s.map(function(e,t){return wp.element.createElement(R,{reply:e,update:_,open:function(){g(e.topic_id)}})}):wp.element.createElement("div",{className:"vbp_message"},window.helpdesk.translations.no_replies_found),a?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",f?wp.element.createElement("a",{className:"link",onClick:function(){v(!1);var e=Re({},n);e.paged=n.paged+1,d(!0),i(e)}},window.helpdesk.translations.more):""))},We=function(e){var t="unassigned",n="recent_assigned";return wp.element.createElement("div",{className:"vibe_assign_topic_wrapper"},wp.element.createElement("div",{className:"unassigned_wrapper"},wp.element.createElement("div",{className:"title"},window.helpdesk.translations.unassigned_tickets),wp.element.createElement(_e,{type:t})),wp.element.createElement("div",{className:"recent_assigned_wrapper"},wp.element.createElement("div",{className:"title"},window.helpdesk.translations.recently_assigned_tickets),wp.element.createElement(_e,{type:n})))};function Ge(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $e=wp.element,et=($e.createElement,$e.useState),tt=$e.useEffect,nt=($e.Fragment,$e.render,wp.data),it=nt.dispatch,rt=nt.select,at=function(e){var t=Ze(et({}),2),n=t[0],i=t[1],r=Ze(et([]),2),a=r[0],o=r[1],l=Ze(et(!1),2),s=l[0],c=l[1],p=Ze(et(""),2),u=p[0],m=p[1],d=Ze(et(""),2),h=d[0],f=d[1],v=Ze(et([]),2),w=v[0],b=(v[1],rt("vibebp").getUser());tt(function(){var e=rt("vibebp").getMenu().filter(function(e){return"forums"===e.parent&&e.css_id&&"engagements"!=e.css_id});y()&&e.push({name:window.helpdesk.translations.assign_tickets,slug:window.helpdesk.settings.assign_tickets.slug,parent_slug:window.helpdesk.settings.assign_tickets.parent_slug,css_id:window.helpdesk.settings.assign_tickets.id,class:["menu-child"],parent:window.helpdesk.settings.assign_tickets.parent_slug,icon:"vicon vicon-ticket"}),g()&&e.push({name:window.helpdesk.translations.assigned_tickets,slug:window.helpdesk.settings.assigned_tickets.slug,parent_slug:window.helpdesk.settings.assigned_tickets.parent_slug,css_id:window.helpdesk.settings.assigned_tickets.id,class:["menu-child"],parent:window.helpdesk.settings.assigned_tickets.parent_slug,icon:"vicon vicon-ticket"}),o(e);var t=rt("vibebp").getAction();t&&m(t),t?e.findIndex(function(e){return e.css_id==t})>-1&&e[e.findIndex(function(e){return e.css_id==t})].class.push("current-menu-item"):(n.token=rt("vibebp").getToken(),-1==e[0].class.indexOf("current-menu-item")&&e[0].class.push("current-menu-item")),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar"),o(e)},[]);var g=function(){return!!b.caps.hasOwnProperty(window.helpdesk.settings.agents_cap)},y=function(){return!!b.caps.hasOwnProperty(window.helpdesk.settings.supervisor_cap)};return wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.helpdesk.label),wp.element.createElement("a",{className:"button is-primary new_mail",onClick:function(){c(!0)}},window.helpdesk.translations.new_topic),wp.element.createElement("a",{className:"button is-link new_mail",onClick:function(){m("forums")}},window.helpdesk.translations.all_forums),a.map(function(e,t){var r=e.class.join(" ")+" "+e.css_id;return wp.element.createElement("a",{className:r,onClick:function(r){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(n,!0).forEach(function(t){Qe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n);l.filter=e.css_id,l.paged=1,n.css_id!==l.filter&&i(l),m(e.css_id),it("vibebp").setAction(e.css_id);var s=Ge(a),c=s.findIndex(function(e){return e.class.indexOf("current-menu-item")>-1});s[c].class.splice(s[c].class.indexOf("current-menu-item"),1),s[t].class.push("current-menu-item"),o(s)}},e.name)}),w.length?wp.element.createElement("div",{className:"labels"},wp.element.createElement("div",{class:"labels_title"},wp.element.createElement("span",null,window.helpdesk.translations.labels)),wp.element.createElement("ul",{className:"topic_labels"},w.map(function(e,t){var n="";return h&&h==e.label&&(n="active"),wp.element.createElement("li",{className:n},wp.element.createElement("span",{onClick:function(){f("active"==n?"":e.label)},style:"active"==n?{borderColor:e.color}:{}},e.label,wp.element.createElement("span",{className:"topic_label_color",style:{background:e.color}})))}))):"")),wp.element.createElement("div",{className:"vibebp_main"},s?wp.element.createElement(G,{back:function(e){"created"==e&&m(e),c(!1)}}):"forums"===u?wp.element.createElement(Ie,{label:h}):"replies"===u?wp.element.createElement(qe,{type:"mine",label:h}):"engagements"===u?wp.element.createElement(_e,{type:"engagements",label:h}):"favorites"===u?wp.element.createElement(_e,{type:"favorites",label:h}):"subscriptions"===u?wp.element.createElement(_e,{type:"subscriptions",label:h}):"assigned"===u?wp.element.createElement(_e,{type:"assigned",label:h}):"assign"===u?wp.element.createElement(We,null):wp.element.createElement(_e,{type:"mine"})))},ot=wp.element,lt=(ot.createElement,ot.render);ot.useState,ot.useEffect,ot.Fragment,ot.useContext;document.addEventListener("component_loaded",function(e){"forums"===e.detail.component&&setTimeout(function(){lt(wp.element.createElement(at,null),document.querySelector("#forums_component"))},200)},!1)}]);