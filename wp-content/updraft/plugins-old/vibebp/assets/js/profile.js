!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=wp.element,o=(i.createElement,i.useRef),l=i.useEffect,c=(i.Fragment,i.render,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=o(Date.now());l((function(){var n=setTimeout((function(){Date.now()-a.current>=t&&(e(),a.current=Date.now())}),t-(Date.now()-a.current));return function(){clearTimeout(n)}}),[t].concat(r(n)))}),s=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},m=function(e){var t,n,r=e.progress;switch(e.size){case"xs":t=10,n=1;break;case"sm":t=25,n=2.5;break;case"med":t=50,n=5;break;case"lg":t=75,n=7.5;break;case"xl":t=100,n=10;break;default:t=50,n=5}var a=t-2*n,i=2*a*Math.PI,o=i-r/100*i;return wp.element.createElement("div",{className:"react-progress-circle"},wp.element.createElement("svg",{height:2*t,width:2*t},wp.element.createElement("circle",{className:"ReactProgressCircle_circleBackground",strokeWidth:n,style:{strokeDashoffset:o},r:a,cx:t,cy:t}),wp.element.createElement("circle",{className:"ReactProgressCircle_circle",strokeWidth:n,strokeDasharray:i+" "+i,style:{strokeDashoffset:o},r:a,cx:t,cy:t})))};function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=wp.element,g=(y.createElement,y.useState),h=y.useEffect,E=(y.Fragment,y.render,wp.data),_=E.dispatch,O=E.select,j=function(e){var t=b(g(!0),2),n=(t[0],t[1],b(g(e.field),2)),r=n[0],a=(n[1],b(g(!1),2)),i=a[0],o=a[1],l=b(g({icon:"",url:""}),2),c=l[0],s=l[1],m=b(g([]),2),p=m[0],d=m[1];h((function(){"string"==typeof e.field.value&&e.field.value.length&&d(JSON.parse(e.field.value))}),[]);var v,w=function(e){console.log(p),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:r.id,value:JSON.stringify(e),token:O("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){_("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"vibebp_profile_field social"},p.length?wp.element.createElement("div",{className:"social_icons_list"},p.map((function(e,t){return wp.element.createElement("div",{className:"social_icon_wrapper"},wp.element.createElement("div",{className:"social_icon"},wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.url)),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=f(p);e.splice(t,1),d(e),w(e)}}))}))):"",wp.element.createElement("a",{className:i?"vicon vicon-close":"vicon vicon-plus",onClick:function(){o(!i)}}),i?wp.element.createElement("div",{className:"add_social_icon"},wp.element.createElement("div",{className:"social_icons"},window.vibebp.social_icons.map((function(e){return wp.element.createElement("div",{className:c.icon===e.icon?"social_icon selected":"social_icon",onClick:function(){s(u(u({},c),{},{icon:e.icon}))}},wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.label))}))),wp.element.createElement("div",{className:!c.url.length||(v=c.url,/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(v))?"social_icon_url":"social_icon_url error"},wp.element.createElement("input",{type:"text",onChange:function(e){s(u(u({},c),{},{url:e.target.value}))},value:c.url})),wp.element.createElement("a",{className:"button is-primary",onClick:function(){if(c.url.length){var e=f(p);e.push(c),d(e),o(!1),s({icon:"",url:""}),w(e)}}},window.vibebp.translations.set_icon)):"")};function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=wp.element,T=(C.createElement,C.useState),D=C.useEffect,L=(C.Fragment,C.render,wp.data),M=L.dispatch,J=L.select,U=function(e){var t=A(T(!0),2),n=(t[0],t[1],A(T(e.field),2)),r=n[0],a=(n[1],A(T(!1),2)),i=a[0],o=a[1],l=A(T({icon:"",title:"",description:""}),2),c=l[0],s=l[1],m=A(T([]),2),p=m[0],u=m[1];D((function(){"string"==typeof e.field.value&&e.field.value.length&&u(JSON.parse(e.field.value))}),[]);var d=function(e){console.log(p),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:r.id,value:JSON.stringify(e),token:J("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){M("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"vibebp_profile_field repeatable"},p.length?wp.element.createElement("div",{className:"repeatable_icons_list"},p.map((function(e,t){return wp.element.createElement("div",{className:"repeatable_icon_wrapper"},wp.element.createElement("div",{className:"repeatable_icon"},e.icon.length>100?wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:e.icon}}):wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,wp.element.createElement("h4",null,e.title),wp.element.createElement("p",null,e.description))),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=P(p);e.splice(t,1),u(e),d(e)}}))}))):"",wp.element.createElement("a",{className:i?"vicon vicon-close":"vicon vicon-plus",onClick:function(){o(!i)}}),i?wp.element.createElement("div",{className:"add_repeatable_icon"},wp.element.createElement("div",{className:"repeatable_icons"},window.vibebp.repeatable_icons.map((function(e){if(!(e.length>100))return wp.element.createElement("div",{className:c.icon===e?"repeatable_icon selected":"repeatable_icon",onClick:function(){s(S(S({},c),{},{icon:e}))}},wp.element.createElement("span",{className:e}));wp.element.createElement("div",{className:c.icon===e?"repeatable_icon selected":"repeatable_icon",onClick:function(){s(S(S({},c),{},{icon:e}))}},wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:e}}))}))),wp.element.createElement("div",{className:"repeatable_title"},c.icon?c.icon.length>100?wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:c.icon}}):wp.element.createElement("span",{className:c.icon}):"",wp.element.createElement("span",null,wp.element.createElement("input",{type:"text",onChange:function(e){s(S(S({},c),{},{title:e.target.value}))},value:c.title,placeholder:window.vibebp.translations.title}),wp.element.createElement("input",{type:"text",onChange:function(e){s(S(S({},c),{},{description:e.target.value}))},value:c.description,placeholder:window.vibebp.translations.description}))),wp.element.createElement("a",{className:"button is-primary",onClick:function(){if(c.title.length){var e=P(p);e.push(c),u(e),o(!1),s({icon:"",title:"",description:""}),d(e)}}},window.vibebp.translations.set_icon)):"")};function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||R(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||R(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var X=wp.element,B=(X.createElement,X.useState),K=X.useEffect,G=(X.Fragment,X.render,wp.data),Y=G.dispatch,V=G.select,Q=function(e){var t=H(B(!0),2),n=t[0],r=t[1],a=H(B(e.field),2),i=a[0],o=a[1],l=H(B(),2),s=l[0],m=l[1],p=H(B(),2),u=p[0],d=p[1],f=H(B(),2),b=f[0],v=f[1],w=H(B(),2),y=w[0],g=w[1],h=H(B(""),2),E=h[0],_=h[1],O=H(B([]),2),j=O[0],N=O[1];c((function(){n||e.field.value===i.value||fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:i.id,type:"location",value:i.value,token:V("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Y("vibebp").addNotification({text:e.message})}))}),500,[i.value]),c((function(){if(!n){var e=new google.maps.places.AutocompleteService;E.length&&e.getQueryPredictions({input:E},(function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){var n=$(j);e.forEach((function(e){n.push(e.description)})),N(n)}}))}}),500,[E]),K((function(){if(s)if(window.hasOwnProperty("google")&&window.google.hasOwnProperty("maps")){var e={lat:-34.397,lng:150.644},t={zoom:16,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,imageDefaultUI:!0},n=new google.maps.Map(s,t);d(n);var a=new google.maps.Marker({map:n,position:e,animation:google.maps.Animation.DROP});v(a),r(!1),g(new google.maps.Geocoder)}else{var i=window.document.createElement("script");i.src="https://maps.googleapis.com/maps/api/js?key=".concat(window.vibebp.settings.google_maps_api_key,"&libraries=places"),i.async=!0,window.document.body.appendChild(i),i.addEventListener("load",(function(){var e={lat:-34.397,lng:150.644},t={zoom:16,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,imageDefaultUI:!0},n=new google.maps.Map(s,t);d(n);var a={url:window.vibebp.settings.map_marker,size:new google.maps.Size(51,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(21,30)},i=new google.maps.Marker({map:n,position:e,animation:google.maps.Animation.DROP,draggable:!0,icon:a});v(i),r(!1),g(new google.maps.Geocoder)}))}}),[s]),K((function(){if(!n){if(i.value){var e=i.value;if(Array.isArray(e)||e.split(","),e.length){var t=F({},i);6===e.length&&(t.value={lat:e[0],lng:e[1],address:e[2],zipcode:e[3],city:e[4],country:e[5]});var r=new google.maps.LatLng(e[0],e[1]);o(t),u.setCenter(r),b.setPosition(r)}}else k();window.google.maps.event.addListener(b,"dragend",(function(e){(new google.maps.Geocoder).geocode({location:e.latLng},(function(e,t){"OK"==t&&(console.log(e),u.setCenter(e[0].geometry.location),o(F(F({},i),{},{value:{lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),address:e[0].formatted_address,zipcode:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("postal_code")}))].long_name,city:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("locality")}))].long_name,country:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("country")}))].long_name}})))}))}))}}),[n]);var S=function(){y&&(new google.maps.Geocoder).geocode({address:E},(function(e,t){"OK"==t&&(u.setCenter(e[0].geometry.location),b.setPosition(e[0].geometry.location)),N([])}))},k=function(){console.log("...locating"),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(e){var t=F({},i);console.log(e),t.value=[e.coords.latitude,e.coords.longitude],o(t);var n=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);console.log(n),u.setCenter(n),b.setPosition(n)}))};return wp.element.createElement("div",{className:"vibebp_profile_field location"},wp.element.createElement("div",{className:"search_me"},wp.element.createElement("span",{className:"vicon vicon-target",onClick:k}),wp.element.createElement("input",{type:"text",value:E,onChange:function(e){_(e.target.value)}}),E.length?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){_(""),N([])}}):"",wp.element.createElement("span",{className:E.length?"vicon vicon-search is_active":"vicon vicon-search",onClick:S})),j.length?wp.element.createElement("div",{className:"vibebp_autocomplete_results"},j.map((function(e){return wp.element.createElement("div",{className:"vibebp_autocomplete_result",onClick:function(){_(e),N([]),S()}},e)}))):"",wp.element.createElement("div",{className:"google_map_locator"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",wp.element.createElement("div",{ref:function(e){e&&!s&&m(e)},style:{height:"400px",width:"100%"}})),wp.element.createElement("div",{className:"google_map_details"},wp.element.createElement("textarea",{placeholder:window.vibebp.translations.address,onChange:function(e){o(F(F({},i),{},{value:F(F({},i.value),{},{address:e.target.value})}))},value:i.value.hasOwnProperty("address")?i.value.address:""}),wp.element.createElement("div",{className:"gmap_fields"},wp.element.createElement("input",{type:"text",onChange:function(e){o(F(F({},i),{},{value:F(F({},i.value),{},{zipcode:e.target.value})}))},placeholder:window.vibebp.translations.zipcode,value:i.value.hasOwnProperty("zipcode")?i.value.zipcode:""}),wp.element.createElement("input",{type:"text",onChange:function(e){o(F(F({},i),{},{value:F(F({},i.value),{},{city:e.target.value})}))},placeholder:window.vibebp.translations.city,value:i.value.hasOwnProperty("city")?i.value.city:""}),wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.country,value:i.value.hasOwnProperty("country")?i.value.country:""}))))};function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e){return function(e){if(Array.isArray(e))return ie(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ae(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||ae(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){if(e){if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oe=wp.element,le=(oe.createElement,oe.render,oe.useState),ce=oe.useEffect;oe.useContext,oe.Fragment,oe.RawHTML;function se(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))if(n){for(var r=0;r<t.length;r++)if(t[r][n]===e[n])return r}else for(var a=0;a<t.length;a++)if(t[a].name===e.name)return a;return-1}var me=function(e){var t=re(le({}),2),n=t[0],r=t[1],a=re(le(""),2),i=(a[0],a[1]),o=re(le([]),2),l=o[0],c=o[1],s=re(le([]),2),m=s[0],p=s[1],u=re(le(!1),2),d=u[0],f=u[1],b=re(le(!1),2),v=b[0],w=b[1],y=re(le(!1),2),g=(y[0],y[1]);ce((function(){if(e.field&&e.field.hasOwnProperty("value")&&e.field.value.length&&e.field.options&&e.field.options.length){var t=[];e.field.value.map((function(n){e.field.options.map((function(e){e.value!=n&&e.name!=n||t.push(e)}))})),p(t)}e.field.options&&e.field.options.length&&Array.isArray(e.field.options)&&(f(!0),c(ne(e.field.options)),f(!1)),r(e.field),g(!0)}),[e.field]);var h="search_results";return v&&(h="search_results active"),wp.element.createElement("div",{className:"selectcptfield multiselect"},wp.element.createElement("div",{className:"selectcptfield_list"},m.length?wp.element.createElement("div",{className:"selectcptfield_items"},m.map((function(t){var a=n.cpt?n.multiselect:"";return wp.element.createElement("span",{type:a,onClick:function(){var a=ne(m),i=ne(l);a.splice(se(t,m,"name"),1),i.push(t),c(i),p(a);var o=ee({},n);if(a&&a.length){var s=[];a.map((function(e){e.hasOwnProperty("name")&&s.push(e.name)})),o.value=s,o.show_value=a,r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}else o.value=[],o.show_value=[],r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}},t.name)}))):""),wp.element.createElement("div",{className:"selectimitate",onClick:function(){w(!v)}},v?wp.element.createElement("i",{class:"vicon vicon-angle-up","aria-hidden":"true"}):wp.element.createElement("i",{class:"vicon vicon-angle-down","aria-hidden":"true"}),l.length?wp.element.createElement("div",{className:h},l.map((function(t,a){if(-1===se(t,m,"name"))return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){i("");var o=ne(m);if(-1===se(t,o,"name")){o.push(t),l.splice(a,1),p(o);var c=ee({},n);if(o&&o.length){var s=[];o.map((function(e){e.hasOwnProperty("name")&&s.push(e.name)})),c.value=s,c.show_value=o,r(c),e.update(c,e.fieldIndex,"fieldvaluechanged")}}}},wp.element.createElement("span",null,t.name))}))):d?"......":""))};function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var de=wp.element,fe=(de.createElement,de.render,de.useState),be=de.useEffect,ve=de.Fragment,we=(de.useContext,wp.data),ye=we.dispatch,ge=we.select,he=function(e){var t=pe(fe(!1),2),n=(t[0],t[1],pe(fe({}),2)),r=n[0],a=n[1],i=pe(fe(!1),2),o=(i[0],i[1],pe(fe(0),2)),l=o[0],c=(o[1],pe(fe(""),2)),s=c[0],m=c[1];be((function(){s.length&&setTimeout((function(){m("")}),5e3)}),[s]),be((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.hasOwnProperty("url")&&a(e.field.value)}),[e.field]);var p=function(t){void 0===t&&(t=r),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:e.field.id,type:e.field.type,value:t,token:ge("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){ye("vibebp").addNotification({text:e.message})}))},u=function(){a({}),fetch("".concat(window.vibebp.api.url,"/user/delete_media?post"),{method:"post",body:JSON.stringify({token:ge("vibebp").getToken(),media:r})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&ye("vibebp").addNotification({text:e.message})}))};return wp.element.createElement(ve,null,r&&r.hasOwnProperty("url")?wp.element.createElement("div",{className:"single_media"},function(e){if(e.hasOwnProperty("url"))return wp.element.createElement("div",{className:"media_snapashot"},wp.element.createElement("a",{href:e.url,target:"_blank"},e.name),wp.element.createElement("span",{className:"vicon vicon-close",onClick:u}))}(r)):wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media",style:{border:"1px dotted var(--darkborder)",padding:"1rem"}},l?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:l+"%"}})),wp.element.createElement("span",null,l,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(t){return function(t){if(t.target.files[0]){var n=t.target.files[0],r=n.size/1024/1024,i=[];if(e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(t){e.field.all_upload_types.hasOwnProperty(t)&&e.field.all_upload_types[t].length&&e.field.all_upload_types[t].map((function(e){i.push(e)}))})),-1===i.indexOf(n.type))return m(window.vibebp.translations.file_type_not_allowed),!1;if(parseInt(e.field.upload_size)<r)return m(window.vibebp.translations.file_size_error+" "+e.field.upload_size+"MB"),!1;var o=new FormData;o.append("file",t.target.files[0]),o.append("body",JSON.stringify({token:ge("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media?upload"),{method:"post",body:o}).then((function(e){return e.json()})).then((function(e){e.status?(a(e.data),p(e.data)):e.hasOwnPropoerty("message")&&ye("vibebp").addNotification({text:e.message})}))}}(t)},style:{display:"none"}}),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(ve,null,wp.element.createElement("span",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(ve,null,wp.element.createElement("span",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),s&&s.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},s):""))};function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e){return function(e){if(Array.isArray(e))return Pe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pe(e,t):void 0}}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ae=wp.element,xe=(Ae.createElement,Ae.render,Ae.useState),Ie=Ae.useEffect,Ce=Ae.Fragment,Te=(Ae.useContext,wp.data),De=Te.dispatch,Le=Te.select,Me=function(e){var t=Se(xe(!1),2),n=t[0],r=t[1],a=Se(xe([]),2),i=a[0],o=a[1],l=Se(xe([]),2),s=l[0],m=(l[1],Se(xe(!1),2)),p=m[0],u=m[1],d=Se(xe(!1),2),f=d[0],b=d[1],v=Se(xe(0),2),w=v[0],y=v[1],g=Se(xe("media"),2),h=g[0],E=g[1],_=Se(xe((function(){var t={posts_per_page:20,paged:1,search_terms:"",orderby:""};return e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&(t.post_mime_type=e.post_mime_type),t})),2),O=_[0],j=_[1],N=Se(xe(""),2),S=N[0],k=N[1],P=Se(xe([]),2),A=(P[0],P[1],Se(xe({name:"",url:"",type:"file"}),2)),x=A[0],I=A[1];c((function(){fetch("".concat(window.vibebp.api.url,"/user/fetch_media?").concat(O.search_terms.length?"nocache":encodeURIComponent(JSON.stringify(je(je({},O),{},{search_terms:""})))),{method:"post",body:JSON.stringify(je(je({},O),{},{token:Le("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(r(!1),e.status)if(f){var t=_e(i);e.data.map((function(e){t.push(e)})),o(t),b(!1),t.length<parseInt(data.total)?u(!0):u(!1)}else o(e.data),e.data.length<parseInt(e.total)?u(!0):u(!1)}))}),500,[O]);var C=function(){j(je({},O))};Ie((function(){return document.addEventListener("vibebp_component_reload",C),function(){document.removeEventListener("vibebp_component_reload",C)}})),Ie((function(){S.length&&setTimeout((function(){k("")}),5e3)}),[S]);var T=function(t){e.share(t)},D=function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("video",{class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"}));case"audio":return wp.element.createElement("audio",{class:"audio_plyr"},wp.element.createElement("source",{src:e.url,type:"audio/mp3"}));case"document":return wp.element.createElement("span",{class:"modal_document"},e.name)}};return wp.element.createElement("div",{className:"vibe_editor_modal"},wp.element.createElement("span",{onClick:function(t){e.close(!1)}}),wp.element.createElement("div",{className:"ve_modal-content"},wp.element.createElement("div",{className:"ve_modal-header"},wp.element.createElement("div",null,window.vibebp.settings.media_tabs?Object.keys(window.vibebp.settings.media_tabs).map((function(t){if("upload"!=t||!window.vibebp.settings.hasOwnProperty("upload_capability")||!window.vibebp.settings.upload_capability)return wp.element.createElement("a",{className:h==t?"active":"",onClick:function(){E(t)}},window.vibebp.settings.media_tabs[t]);var n=Le("vibebp").getUser();if(void 0!==n&&n.hasOwnProperty("caps")&&void 0!==n.caps){var r=0;if(Array.isArray(n.caps)?n.caps.findIndex((function(e,t){return e==window.vibebp.settings.upload_capability}))>-1&&(r=1):"object"===Ee(n.caps)&&Object.keys(n.caps).map((function(e,t){e===window.vibebp.settings.upload_capability&&n.caps[e]&&(r=1)})),e.hasOwnProperty("allow_upload")&&e.allow_upload&&(r=1),r)return wp.element.createElement("a",{className:h==t?"active":"",onClick:function(){E(t)}},window.vibebp.settings.media_tabs[t])}})):""),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(t){e.close(!1)}})),wp.element.createElement("div",{className:"ve_modal-body"},"media"==h?wp.element.createElement(Ce,null,wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,onChange:function(e){return j(je(je({},O),{},{search_terms:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("select",{onChange:function(e){j(je(je({},O),{},{order:e.target.value}))}},Object.keys(window.vibeEditor.media_order).map((function(e){return wp.element.createElement("option",{value:e},window.vibeEditor.media_order[e])}))))),n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):i&&i.length?wp.element.createElement("div",{className:"allMedia"},i.map((function(t,n){return wp.element.createElement("div",{className:"single_media"},wp.element.createElement("span",{onClick:function(n){T(t),e.hasOwnProperty("autoclose")||e.close(!1)}},D(t)),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return function(e){var t=_e(i);t.splice(t.findIndex((function(t){return t.id==e.id})),1),o(t),fetch("".concat(window.vibebp.api.url,"/user/delete_media"),{method:"post",body:JSON.stringify({token:Le("vibebp").getToken(),media:e})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&De("vibebp").addNotification({text:e.message})}))}(t)}}))}))):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_media),p?wp.element.createElement("a",{className:"link",onClick:function(){j(je(je({},O),{},{paged:O.paged+1})),b(!0)}},window.vibebp.translations.more):""):"upload"===h?wp.element.createElement(Ce,null,wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media"},window.vibebp.translations.upload_media,w?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:w+"%"}})),wp.element.createElement("span",null,w,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(t){return function(t){var n=e.post_mime_type,r=e.allowed_file_size;if(void 0===r&&(r=window.vibebp.settings.upload_limit),void 0===n||!Array.isArray(n)){var a=n;(n=[]).push(a)}if(t.target.files[0]){var l=t.target.files[0].size/1024/1024;if(n.indexOf(t.target.files[0].type)<=-1)return k(window.vibebp.translations.allowed_file_types+" "+n.join(",")),!1;if(r<l)return k(window.vibebp.translations.file_size_error+" "+r+"Mb"),!1;if(tus.isSupported&&tus.canStoreURLs&&l>4){var c="".concat(window.vibebp.api.url,"/user/upload_media_stream?upload"),s=new tus.Upload(t.target.files[0],{endpoint:c,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:Le("vibebp").getToken(),filename:t.target.files[0].name,filetype:t.target.files[0].type},onError:function(e){e.hasOwnProperty("message")&&De("vibebp").addNotification({text:e.message})},onProgress:function(t,n){var r=(t/n*100).toFixed(2);y(r),100==r&&setTimeout((function(){var t={posts_per_page:20,paged:1,search_terms:"",orderby:""};e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&(t.post_mime_type=e.post_mime_type),j(t),y(0),E("media")}),500)},onSuccess:function(){localStorage.removeItem(s._urlStorageKey),s.url=s.url.replace("?upload",""),fetch("".concat(s.url,"/complete_stream?nocache"),{method:"post",body:JSON.stringify({token:Le("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&e.post_mime_type,y(0),E("media")}t.hasOwnProperty("message")&&De("vibebp").addNotification({text:t.message})}))}});s.findPreviousUploads().then((function(e){e.length>0&&s.resumeFromPreviousUpload(e[0]),s.start()})),tus.Upload.terminate(c).then((function(){})).catch((function(e){}))}else{var m=new FormData;m.append("file",t.target.files[0]),m.append("body",JSON.stringify({token:Le("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media"),{method:"post",body:m}).then((function(e){return e.json()})).then((function(e){if(e.status){var t=_e(i);t.unshift(e.data),o(t),E("media")}else e.hasOwnPropoerty("message")&&De("vibebp").addNotification({text:e.message})}))}}}(t)}}),s&&s.length?wp.element.createElement("div",{className:"uploaded"},wp.element.createElement("strong",null,window.vibebp.translations.uploaded_media),wp.element.createElement("div",{className:"uploaded_files"},s.map((function(e,t){return wp.element.createElement("div",{className:"single_media",onClick:function(t){T(e)}},D(e))})))):""),S&&S.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},S):""):"embed"===h?wp.element.createElement(Ce,null,wp.element.createElement("div",{className:"embed_media"},wp.element.createElement("label",{for:"vibe_editor_embed_name"}," ",window.vibebp.translations.enter_emabed_name," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_name",onChange:function(e){return I(je(je({},x),{},{name:e.target.value}))}}),wp.element.createElement("label",{for:"vibe_editor_embed_url"}," ",window.vibebp.translations.enter_embed_url," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_url",onChange:function(e){return I(je(je({},x),{},{url:e.target.value}))}}),wp.element.createElement("select",{onChange:function(e){return I(je(je({},x),{},{type:e.target.value}))},value:x.type},e.hasOwnProperty("embed_options")?e.embed_options.map((function(e){return wp.element.createElement("option",{value:e},e.charAt(0).toUpperCase()+e.slice(1))})):Object.keys(window.vibeEditor.embed_types).map((function(t){if(e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type)if(Array.isArray(e.post_mime_type)){if(e.post_mime_type.indexOf(t)<0)return}else if(e.post_mime_type.split(",").indexOf(t)<0)return;return wp.element.createElement("option",{value:t},window.vibeEditor.embed_types[t])}))),Object.values(x).findIndex((function(e){return""==e||null==e}))>-1?"":wp.element.createElement("button",{className:"button is-primary",onClick:function(){T(x),e.close(!1)}},window.vibebp.translations.embed))):wp.element.createElement("div",{className:h}))))};function Je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qe=wp.element,Fe=(qe.createElement,qe.render,qe.useState),ze=qe.useEffect,$e=qe.Fragment,He=(qe.useContext,qe.useRef),Re=wp.data,We=Re.dispatch,Xe=Re.select,Be=function(e){var t=He(null),n=Je(Fe(!1),2),r=(n[0],n[1],Je(Fe({}),2)),a=r[0],i=r[1],o=Je(Fe(!1),2),l=(o[0],o[1],Je(Fe(0),2)),c=(l[0],l[1],Je(Fe(""),2)),s=c[0],m=c[1],p=Je(Fe(!1),2),u=p[0],d=p[1],f=Je(Fe([]),2),b=f[0],v=f[1],w=Je(Fe(null),2),y=w[0],g=w[1];ze((function(){s.length&&setTimeout((function(){m("")}),5e3)}),[s]),ze((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.hasOwnProperty("url")&&i(e.field.value);var t=[];e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(n){e.field.all_upload_types.hasOwnProperty(n)&&e.field.all_upload_types[n].length&&e.field.all_upload_types[n].map((function(e){t.push(e)}))})),t.push("video"),v(t)}),[e.field]),ze((function(){if(a&&a.hasOwnProperty("type")&&t.current){if("video"==a.type){var e=new Plyr(t.current);g(e)}if("youtube"==a.type){var n=new Plyr(t.current);g(n)}if("vimeo"==a.type){var r=new Plyr(t.current);g(r)}}}),[a]);var h=function(t){void 0===t&&(t=a),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save"),{method:"post",body:JSON.stringify({field_id:e.field.id,type:e.field.type,value:t,token:Xe("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){We("vibebp").addNotification({text:e.message})}))},E=function(e){var t=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/);return!(!t||!t.length)&&t[1]};return wp.element.createElement("div",{className:"video_field"},a&&a.hasOwnProperty("url")?wp.element.createElement("div",null,wp.element.createElement("div",{className:"single_media"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"remove vicon vicon-close",onClick:function(){y&&(y.destroy(),g(null)),h(null),i({})}}),wp.element.createElement("div",null,"  ",wp.element.createElement("div",null," ",function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:t,class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"})));case"youtube":var n=E(a.url);return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("div",{ref:t,"data-plyr-provider":"youtube","data-plyr-embed-id":n}));case"vimeo":var r=e.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/);return wp.element.createElement("div",{className:"video_wrapper"}," ",wp.element.createElement("div",{ref:t,"data-plyr-provider":"vimeo","data-plyr-embed-id":r[4]}));case"audio":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("audio",{class:"audio_plyr",controls:!0},wp.element.createElement("source",{src:e.url,type:"audio/mp3"})));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}}(a)))," "))):wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media",style:{border:"1px dotted var(--darkborder)",padding:"1rem"},onClick:function(){d(!0)}},wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement($e,null,wp.element.createElement("span",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement($e,null,wp.element.createElement("span",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),s&&s.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},s):"",u?wp.element.createElement(Me,{post_mime_type:b,allowed_file_size:e.field.upload_size,close:function(){d(!1)},share:function(e){if(e.hasOwnProperty("type")&&["youtube","vimeo"].includes(e.type))if("youtube"==e.type){if(!E(e.url))return m(window.vibebp.translations.invalid_url),!1}else if("vimeo"==e.type){if(!e.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/))return m(window.vibebp.translations.invalid_url),!1}i(e),h(e)},embed_options:["video","youtube","vimeo"]}):""))};function Ke(e){return function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ye(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Ye(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){if(e){if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qe=wp.element,Ze=(Qe.createElement,Qe.render,Qe.useState),et=Qe.useEffect,tt=Qe.Fragment,nt=(Qe.useContext,Qe.useRef),rt=wp.data,at=rt.dispatch,it=rt.select,ot=function(e){var t=nt(null),n=Ge(Ze(!1),2),r=(n[0],n[1],Ge(Ze([]),2)),a=r[0],i=r[1],o=Ge(Ze(!1),2),l=(o[0],o[1],Ge(Ze(0),2)),c=(l[0],l[1],Ge(Ze(""),2)),s=c[0],m=c[1],p=Ge(Ze(!1),2),u=p[0],d=p[1],f=Ge(Ze([]),2),b=f[0],v=f[1];et((function(){s.length&&setTimeout((function(){m("")}),5e3)}),[s]),et((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.length&&i(e.field.value);var t=[];e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(n){e.field.all_upload_types.hasOwnProperty(n)&&e.field.all_upload_types[n].length&&e.field.all_upload_types[n].map((function(e){t.push(e)}))})),t.push("image"),v(t)}),[e.field]);var w=function(t){void 0===t&&(t=a),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:e.field.id,type:e.field.type,value:t,token:it("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){at("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"gallery_field"},wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media",style:{border:"1px dotted var(--darkborder)",padding:"1rem"},onClick:function(){d(!0)}},wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(tt,null,wp.element.createElement("span",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(tt,null,wp.element.createElement("span",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),s&&s.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},s):"",u?wp.element.createElement(Me,{post_mime_type:b,autoclose:"1",allowed_file_size:e.field.upload_size,close:function(){d(!1)},share:function(e){if(e.hasOwnProperty("type")&&e.hasOwnProperty("url")){var t=Ke(a);t.push(e),i(t),w(t)}},embed_options:["video","youtube","vimeo"]}):""),a&&a.length?wp.element.createElement("div",{className:"media_gallery"},a.map((function(e,n){return wp.element.createElement("div",null,wp.element.createElement("div",{className:"single_media"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"remove vicon vicon-close",onClick:function(){var e=Ke(a);e.splice(n,1),w(e),i(e)}}),wp.element.createElement("div",null,"  ",wp.element.createElement("div",null," ",function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:t,class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"})));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}}(e)))," ")))}))):"")};function lt(e){return function(e){if(Array.isArray(e))return dt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ut(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||ut(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){if(e){if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dt(e,t):void 0}}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ft=wp.element,bt=(ft.createElement,ft.useState),vt=ft.useEffect,wt=(ft.Fragment,ft.render,ft.useRef),yt=wp.data,gt=yt.dispatch,ht=yt.select,Et=function(e){var t=pt(bt(!1),2),n=t[0],r=t[1],a=pt(bt(!1),2),i=a[0],o=a[1],l=pt(bt(e.field),2),s=l[0],m=l[1],p=wt(null);vt((function(){"checkbox"!=s.type&&"selectbox"!=s.type&&"radio"!=s.type&&"multiselect"!=s.type&&"location"!=s.type&&"multiselectbox"!=s.type||fetch("".concat(window.vibebp.api.url,"/xprofile/field/options?field_id=").concat(s.id),{method:"post",body:JSON.stringify({field_id:s.id,type:s.type,token:ht("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&m(st(st({},s),{},{options:e.values}))}));var e=new CustomEvent("field_loaded",{detail:{field:s}});document.dispatchEvent(e)}),[]);vt((function(){if(p&&p.hasOwnProperty("current")&&p.current){var e={altInput:!0,dateFormat:"Y-m-d",defaultDate:s.hasOwnProperty("value")&&s.value.length?s.value:[],onChange:u};flatpickr(p.current,e)}}),[s]),c((function(){n&&(o(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:s.id,type:s.type,value:s.value,token:ht("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){o(!1),document.dispatchEvent(new CustomEvent("xprofile_field_saved",{detail:{field_id:s.id}})),e.hasOwnProperty("update")&&e.update(s),t.hasOwnProperty("message")&&gt("vibebp").addNotification({icon:t.status?"vicon vicon-check-box":"vicon vicon-alert",text:t.message})})))}),1500,[s.value,n]);var u=function(e){var t=st({},s);if(e&&e.length){var n=e[0].getDate();(n=n.toString()).length<2&&(n="0"+n);var a=e[0].getMonth()+1;(a=a.toString()).length<2&&(a="0"+a);var i=e[0].getFullYear()+"-"+a+"-"+n;t.value=i}else t.value="";m(t),r(!0)};return wp.element.createElement("div",{className:i?"vibebp_form_field control is-loading":"vibebp_form_field control"},wp.element.createElement("label",null,wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:s.name}})," ",wp.element.createElement("span",null,window.vibebp.components.xprofile.visibility[s.visibility])),wp.element.createElement("div",{className:"field_description",dangerouslySetInnerHTML:{__html:s.description}}),"textbox"===s.type?wp.element.createElement("input",{type:"text",value:s.value,onChange:function(e){m(st(st({},s),{},{value:e.target.value})),r(!0)}}):"number"===s.type||"telephone"===s.type?wp.element.createElement("input",{type:"number",value:s.value,onChange:function(e){m(st(st({},s),{},{value:e.target.value})),r(!0)}}):"url"===s.type?wp.element.createElement("input",{type:"text",value:s.value,onChange:function(e){m(st(st({},s),{},{value:e.target.value})),r(!0)}}):"textarea"===s.type?wp.element.createElement("textarea",{onChange:function(e){m(st(st({},s),{},{value:e.target.value})),r(!0)}},s.value):"selectbox"===s.type?wp.element.createElement("select",{onChange:function(e){m(st(st({},s),{},{value:e.target.value})),r(!0)},value:s.value},s.hasOwnProperty("options")?s.options.map((function(e,t){return wp.element.createElement("option",{value:e.name},e.name)})):""):"radio"===s.type?wp.element.createElement("div",{className:"vibebp_field_group"},s.hasOwnProperty("options")?s.options.map((function(e,t){return wp.element.createElement("div",{className:"radio"},wp.element.createElement("input",{id:e.id,type:"radio",value:e.name,checked:s.value===e.name,onChange:function(e){m(st(st({},s),{},{value:e.target.value})),r(!0)}}),wp.element.createElement("label",{for:e.id},e.name))})):""):"checkbox"===s.type?wp.element.createElement("div",{className:"vibebp_field_group"},s.hasOwnProperty("options")?s.options.map((function(e,t){return wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:e.id,value:e.name,checked:-1!==s.value.indexOf(e.name),onChange:function(t){if(s.value&&-1===s.value.indexOf(e.name)){var n=lt(s.value);n.push(e.name),m(st(st({},s),{},{value:n}))}else{var a=lt(s.value);a.splice(s.value.indexOf(e.name),1),m(st(st({},s),{},{value:a}))}r(!0)}}),wp.element.createElement("label",{for:e.id},e.name))})):""):"multiselectbox"===s.type?wp.element.createElement(me,{update:function(e,t,n){m(st(st({},s),{},{value:e.value})),r(!0)},field:s}):"datebox"===s.type?wp.element.createElement("input",{type:"text",ref:p}):"country"===s.type?wp.element.createElement("select",{onChange:function(e){m(st(st({},s),{},{value:e.target.value})),r(!0)},value:s.value},Object.keys(window.vibebp.components.xprofile.countries).length?Object.keys(window.vibebp.components.xprofile.countries).map((function(e,t){return wp.element.createElement("option",{value:e},window.vibebp.components.xprofile.countries[e])})):""):"color"===s.type?wp.element.createElement("span",{className:"vibebp_color_field",style:{background:s.value},ref:function(e){new Picker(e).onChange=function(t){e.style.background=t.rgbaString,m(st(st({},s),{},{value:t.rgbaString})),r(!0)}}}):"location"===s.type?wp.element.createElement(Q,{field:s}):"social"===s.type?wp.element.createElement(j,{field:s}):"repeatable"===s.type?wp.element.createElement(U,{field:s}):"upload"===s.type?wp.element.createElement(he,{field:s}):"video"===s.type?wp.element.createElement(Be,{field:s}):"gallery"===s.type?wp.element.createElement(ot,{field:s}):"")};function _t(e){return function(e){if(Array.isArray(e))return Nt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||jt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||jt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(e,t){if(e){if("string"==typeof e)return Nt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nt(e,t):void 0}}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var St=wp.element,kt=(St.createElement,St.useState),Pt=St.useEffect,At=St.Fragment,xt=(St.render,wp.data),It=(xt.dispatch,xt.select),Ct=function(e){var t=Ot(kt(!1),2),n=t[0],r=t[1],a=Ot(kt(!1),2),i=a[0],o=a[1],l=Ot(kt([]),2),c=l[0],s=l[1],p=Ot(kt({complete:0,total:0,total_field_count:1}),2),u=p[0],d=p[1],f=Ot(kt(100),2),b=f[0],v=f[1];It("vibebp").getUser();Pt((function(){fetch("".concat(window.vibebp.api.url,"/getProfileCompleteness?nocache"),{method:"post",body:JSON.stringify({token:It("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(v(e.completeness),e.fields.length&&(s(e.fields),d({complete:0,total:e.fields.length,total_field_count:e.total_field_count}),o(e.fields[0].id)))}))}),[]);return wp.element.createElement(At,null,b<100?wp.element.createElement("div",{className:n?"active completeProgress":"completeProgress",onClick:function(){return r(!0)}},wp.element.createElement("label",null,window.vibebp.translations.complete_profile),wp.element.createElement(m,{progress:b,size:"xs"}),b," %"):"",n?wp.element.createElement("div",{className:"profile_completeness_wrapper"},wp.element.createElement("span",{onClick:function(){return r(!1)}}),wp.element.createElement("div",{className:"profile_completeness"},wp.element.createElement("div",{className:"profile_completeness_heading"},wp.element.createElement("h2",null,window.vibebp.translations.complete_your_profile," ",wp.element.createElement("span",null,u.complete+"/"+u.total)),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return r(!1)}})),wp.element.createElement("div",{className:"profile_completeness_content"},c.map((function(e,t){if(e.id==i)return wp.element.createElement("div",{className:"profile_field"},wp.element.createElement(Et,{field:e,update:function(e){return function(e,t){var n=_t(c);n[t]=e,s(n);var r=b+Math.round(100/u.total_field_count,2);r>100&&(r=100),v(r),d({complete:parseInt(u.complete)+1,total:u.total})}(e,t)}}))}))),wp.element.createElement("div",{className:"xprofile_pagination"},i&&c.findIndex((function(e){return e.id==i}))>0?wp.element.createElement("span",{className:"prev_next",onClick:function(){return o(c[c.findIndex((function(e){return e.id==i}))-1].id)}},wp.element.createElement("span",{className:"vicon vicon-arrow-left"})):wp.element.createElement("span",null),i&&c.findIndex((function(e){return e.id==i}))<c.length-1?wp.element.createElement("span",{className:"prev_next",onClick:function(){return o(c[c.findIndex((function(e){return e.id==i}))+1].id)}},wp.element.createElement("span",{className:"vicon vicon-arrow-right"})):wp.element.createElement("span",null)))):"")},Tt=(0,wp.element.createContext)({});function Dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mt=wp.element,Jt=(Mt.createElement,Mt.useState),Ut=Mt.useEffect,qt=(Mt.Fragment,Mt.render,wp.data),Ft=(qt.dispatch,qt.select),zt=function(e){var t=Dt(Jt(""),2),n=t[0],r=t[1];return Ut((function(){var t="",n="";switch(e.type){case"friends":n="user",t=e.id.item_id;break;case"forum":n="forum",t=e.id.item_id;break;case"group":n="group",t=e.id.item_id;break;case"activity":n="user",t=e.id.secondary_item_id;break;case"member":case"name":case"user_tip":case"user":n="user",t=e.id.user_id;break;default:n=e.type,t=e.id.item_id}localforage.getItem(n+"_"+t).then((function(a){null!==a?r(JSON.parse(a)):fetch("".concat(window.vibebp.api.url,"/avatar?id=").concat(n+"_"+t),{method:"post",body:JSON.stringify({type:e.type,ids:e.id,token:Ft("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(localforage.setItem(e.key,JSON.stringify(e.value)).then((function(){e.key!=n+"_"+t&&localforage.setItem(n+"_"+t,JSON.stringify(e.value))})),r(e.value))}))}))}),[e]),"member"==e.type?wp.element.createElement("span",{className:"vibebp_member"},wp.element.createElement("img",{src:n.avatar,className:"vibebp_avatar",onClick:e.click,alt:n.name,title:n.name}),wp.element.createElement("span",null,n.name)):"user_tip"==e.type?wp.element.createElement("span",{className:"vibebp_member tip",title:n.name},wp.element.createElement("img",{src:n.avatar,className:"vibebp_avatar",onClick:e.click,alt:n.name,title:n.name})):"name"==e.type||"forum"==e.type?wp.element.createElement("span",null,n.name):wp.element.createElement("img",{src:n.avatar,className:"vibebp_avatar",onClick:e.click,alt:n.name,title:n.name})};function $t(e){return function(e){if(Array.isArray(e))return Wt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Rt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Rt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){if(e){if("string"==typeof e)return Wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wt(e,t):void 0}}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xt=wp.element,Bt=(Xt.createElement,Xt.useState),Kt=Xt.useEffect,Gt=Xt.Fragment,Yt=(Xt.render,Xt.useContext),Vt=wp.data,Qt=Vt.dispatch,Zt=Vt.select,en=function(e){var t=Yt(Tt),n=Ht(Bt([]),2),r=n[0],a=n[1],i=Ht(Bt(""),2),o=i[0],l=i[1],c=Ht(Bt(""),2),s=(c[0],c[1],Ht(Bt(Zt("vibebp").getToken()),2)),m=s[0],p=s[1],u=Ht(Bt(!0),2),d=u[0],f=u[1],b=Ht(Bt(!1),2),v=b[0],w=b[1],y=Ht(Bt(!1),2),g=y[0],h=y[1],E=Ht(Bt([]),2),_=E[0],O=E[1],j=Ht(Bt({}),2),N=j[0];j[1];Kt((function(){d||-1!=document.querySelector("body").classList.contains("dark_vibebp")?document.querySelector("body").classList.remove("dark_vibebp"):document.querySelector("body").classList.add("dark_vibebp")}),[d]),Kt((function(){window.vibebp.expanded_menu&&window.innerWidth>768&&w(!0),window.addEventListener("resize",(function(){window.innerWidth>768&&w(!0)})),window.vibebp.dark_mode&&(f(!1),t.update("dark",!0));var e=setTimeout((function(){O(Zt("vibebp").getData("loggedinMenu"))}),500);return function(){clearTimeout(e)}}),[]),Kt((function(){window.vibebp.expanded_menu&&window.innerWidth>768&&w(!0)}),[v]),Kt((function(){document.addEventListener("userLoaded",(function(){m||p(Zt("vibebp").getToken())})),m&&(fetch("".concat(window.vibebp.api.url,"/profilemenu"),{method:"post",body:JSON.stringify({token:m})}).then((function(e){return e.json()})).then((function(e){e.status&&(window.vibebp.components.default_component&&e.menu.map((function(t,n){t.css_id===window.vibebp.components.default_component&&e.menu[n].classes.push("is_active")})),a(e.menu),Qt("vibebp").setMenu(e.bpmenu))})),document.addEventListener("component_loaded",(function(e){l(e.detail.component)})))}),[m]);var S=function(){fetch("".concat(window.vibebp.api.url,"/profilemenu?force"),{method:"post",body:JSON.stringify({token:m})}).then((function(e){return e.json()})).then((function(e){e.status&&(window.vibebp.components.default_component&&e.menu.map((function(t,n){t.css_id===window.vibebp.components.default_component&&e.menu[n].classes.push("is_active")})),a(e.menu),Qt("vibebp").setMenu(e.bpmenu))}))};Kt((function(){var e=window.location.href.split("#");if(e.length>1){var t=e[1].split("&"),n=[];t.map((function(e,t){"component"===(n=e.split("="))[0]&&"settings"==n[1]&&document.addEventListener("vibebp_component_reload",S)}))}return function(){document.removeEventListener("vibebp_component_reload",S)}}),[]),Kt((function(){if(r.length){if(!o){var e=r[0].css_id;"xprofile"===e&&(e="profile"),l(e)}if(-1!==window.location.href.indexOf("#")){var t=window.location.href.split("#");if(t.length>1){var n=t[1].split("&"),a=[];n.map((function(e,t){"component"===(a=e.split("="))[0]&&(Zt("vibebp").getComponent()||(r.map((function(e,t){e.css_id==a[1]&&P(t)})),Qt("vibebp").setComponent(a[1])))}))}}}}),[r]);var k=function(e){e.hasOwnProperty("css_id")?(Qt("vibebp").setComponent(e.css_id),Qt("vibebp").setAction(!1),Qt("vibebp").setId(!1)):Qt("vibebp").setComponent(e.type+"__"+e.object+"__"+e.object_id)};Kt((function(){o&&(Qt("vibebp").setComponent(o),localforage.createInstance({name:"vibebp_last_requests"}).clear())}),[o]);var P=function(e){var t=$t(r);t.map((function(e){e.classes.indexOf("is_active")>-1&&e.classes.splice(e.classes.indexOf("is_active"),1)})),t[e].classes.push("is_active"),a(t)},A=function(){Zt("vibebp").logout(),w(!1),document.querySelector("body").classList.add("vibebp_logout");var e=new CustomEvent("userLoaded",{detail:{userLoaded:!0}});document.dispatchEvent(e)},x="profile_menu";return v&&"slick"!==window.vibebp.settings.customizer.theme&&(x+=" active"),g&&(x+=" show_loggedin_menu"),wp.element.createElement("div",{className:x,onMouseEnter:function(){window.vibebp.expanded_menu||"slick"==window.vibebp.settings.customizer.theme||w(!0)},onMouseLeave:function(){window.vibebp.expanded_menu||"slick"==window.vibebp.settings.customizer.theme||w(!1)}},window.vibebp.settings.customizer.profile_menu_promo&&window.vibebp.settings.customizer.profile_menu_promo.length?wp.element.createElement("div",{className:"site_logo"},wp.element.createElement("img",{src:window.vibebp.settings.customizer.profile_menu_promo,style:N})):"",wp.element.createElement("div",{className:"menu_items"},Array.isArray(r)&&r.length?r.map((function(e,t){if(e.menu_item_parent=parseInt(e.menu_item_parent),!e.menu_item_parent){"xprofile"===e.css_id&&(e.css_id="profile");var n=r.filter((function(t){return t.menu_item_parent===e.ID}));return n.length&&-1===e.classes.indexOf("hasChildren")&&e.classes.push("hasChildren"),wp.element.createElement("div",{id:e.css_id,className:e.classes.join(" ")},wp.element.createElement("span",{className:"menu_item_"+e.css_id},e.classes.indexOf("external_link")>-1?wp.element.createElement("span",{onClick:function(){window.location.href=e.url}},wp.element.createElement("span",{className:"vicon vicon-new-window"}),wp.element.createElement("span",null,e.title)):wp.element.createElement(Gt,null,wp.element.createElement("span",{onClick:function(){k(e),w(!1),P(t)}},/svg/.test(e.icon)?wp.element.createElement("span",{className:"icon",dangerouslySetInnerHTML:{__html:e.icon}}):wp.element.createElement("span",{className:"icon "+e.icon}),wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.title}})),n.length?wp.element.createElement("span",{class:"vicon vicon-angle-right",onClick:function(){var e=$t(r);-1==e[t].classes.indexOf("open")?e[t].classes.push("open"):e[t].classes.splice(e[t].classes.indexOf("open"),1),a(e)}}):"")),n.length?wp.element.createElement("div",{className:"sub_nav_items"},n.map((function(e){return wp.element.createElement("div",{onClick:function(){k(e),w(!1),P(t)},className:e.classes.join(" ")},/svg/.test(e.icon)?wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.icon}}):wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.title))}))):"")}})):""),"slick"!==window.vibebp.settings.customizer.theme?wp.element.createElement("span",{className:v?"vicon vicon-angle-double-right reversed":"vicon vicon-angle-double-right",onClick:function(){return w(!v)}}):"",wp.element.createElement("div",{className:"menu_bottom"},"slick"==window.vibebp.settings.customizer.theme?"":wp.element.createElement(Gt,null,d?wp.element.createElement("div",{className:"menu_item",onClick:function(){f(!1),t.update("dark",!0),w(!v)}},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:window.vibebp.icons.dark_mode}}),wp.element.createElement("span",null,window.vibebp.translations.dark_mode)):wp.element.createElement("div",{className:"menu_item",onClick:function(){f(!0),t.update("dark",!1)}},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:window.vibebp.icons.light_mode}}),wp.element.createElement("span",null,window.vibebp.translations.light_mode))),"slick"==window.vibebp.settings.customizer.theme?wp.element.createElement("div",{className:"menu_item",onClick:function(){k({css_id:"settings"}),w(!1),P("settings")}},wp.element.createElement("span",null,wp.element.createElement("span",{className:"icon"},wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0",y:"0",enableBackground:"new 0 0 64 64",version:"1.1",viewBox:"0 0 64 64",xmlSpace:"preserve"}," ",wp.element.createElement("path",{d:"M32.1 19.7c-6.8 0-12.3 5.5-12.3 12.3 0 6.8 5.5 12.3 12.3 12.3 6.8 0 12.3-5.5 12.3-12.3-.1-6.7-5.6-12.3-12.3-12.3zm0 21.1c-4.8 0-8.8-3.9-8.8-8.8s3.9-8.8 8.8-8.8 8.8 3.9 8.8 8.8c-.1 4.9-4 8.8-8.8 8.8z"})," ",wp.element.createElement("path",{d:"M61.5 38.9l-6.2-3.4c.2-1.3.3-2.5.3-3.7 0-1.4-.1-2.6-.3-3.8l6.3-3.5c1.1-.6 1.5-1.9 1-3.1l-6-10.1c-.6-1-1.9-1.4-3.1-1L47 13.9c-.4-.3-.8-.7-1.2-1-1.1-1-2.2-1.9-3.7-2.6-.3-.1-.5-.5-.5-.8V5.6c0-2.4-2-4.4-4.4-4.4H26.8c-2.4 0-4.4 2-4.4 4.4v4c0 .3-.2.6-.5.8-1.5.7-2.6 1.6-3.8 2.7-.3.3-.7.6-1.1.9l-5.8-3.3c-1.9-1-3.2-.3-3.8.7l-5.7 9.8c-.3.6-.4 1.3-.2 1.9.2.6.6 1.2 1.2 1.5l6.2 3.5c-.2 1.1-.3 2.3-.3 3.7 0 1.3.1 2.5.2 3.7L2.4 39c-1.1.6-1.5 1.9-1 3.1l5.9 10.1c.6 1 1.9 1.4 3.1 1l6.5-3.6c.4.3.8.6 1.1.9 1.2 1 2.2 1.9 3.8 2.6.3.1.5.5.5.8v4.4c0 2.4 2 4.4 4.4 4.4h10.5c2.4 0 4.4-2 4.4-4.4v-4.6c0-.3.2-.6.5-.8 1.5-.7 2.5-1.6 3.7-2.6.4-.3.7-.6 1.1-1l5.8 3.3c1.9 1 3.2.3 3.7-.6l5.8-9.8c.3-.6.4-1.2.3-1.9 0-.6-.5-1.1-1-1.4zm-7.4 10.5l-5.5-3.1c-1.2-.7-2.7-.5-3.7.3-.5.4-.9.8-1.3 1.1-1.1.9-1.8 1.6-2.9 2.1-1.5.7-2.5 2.3-2.5 3.9v4.6c0 .5-.4.9-.9.9H26.8c-.5 0-.9-.4-.9-.9v-4.4c0-1.7-1-3.2-2.5-3.9-1.1-.5-2-1.2-3-2.1-.4-.3-.8-.7-1.3-1.1-.6-.5-1.4-.8-2.1-.8-.6 0-1.1.1-1.6.4l-5.5 3.1-4.7-8 5.3-3c1.3-.7 1.9-2.1 1.8-3.5-.1-1-.2-2.1-.2-3.2 0-1.2.1-2.2.2-3.1.3-1.5-.4-3-1.7-3.7l-5.3-2.9 4.7-8 5.5 3.1c1.2.7 2.7.5 3.7-.3.4-.4.8-.7 1.2-1 1.1-.9 1.9-1.6 3-2.2 1.5-.7 2.5-2.3 2.5-3.9v-4c0-.5.4-.9.9-.9h10.5c.5 0 .9.4.9.9v3.9c0 1.7 1 3.2 2.5 3.9 1.1.5 1.9 1.2 2.9 2.1.4.4.9.7 1.4 1.1 1 .8 2.5 1 3.7.3l5.5-3.1 4.7 8-5.3 2.9c-1.3.7-2 2.2-1.7 3.7.2.9.2 2 .2 3.1 0 1-.1 2.1-.3 3.2-.3 1.5.5 3 1.8 3.7l5.2 2.8-4.7 8z"})," "))),wp.element.createElement("span",null,window.vibebp.translations.settings)):"","slick"==window.vibebp.settings.customizer.theme?wp.element.createElement("div",{className:"menu_item"},wp.element.createElement("span",{className:"vibebp_current_user",onClick:function(){return h(!g)}},v?wp.element.createElement(zt,{type:"member",id:{user_id:Zt("vibebp").getUser().id}}):wp.element.createElement(zt,{type:"user",id:{user_id:Zt("vibebp").getUser().id}})),g?wp.element.createElement("div",{className:"vibebp_member_menu"},wp.element.createElement("div",{className:"vibebp_member_card_wrapper"},wp.element.createElement(zt,{type:"user",id:{user_id:Zt("vibebp").getUser().id}}),wp.element.createElement("div",{className:"member_menu_buttons"},wp.element.createElement(zt,{type:"name",id:{user_id:Zt("vibebp").getUser().id}}),wp.element.createElement(Ct,null),window.vibebp.settings.firebase_config?wp.element.createElement("span",{className:"login_extras",onClick:function(){document.dispatchEvent(new CustomEvent("loginExtras",{detail:{loginExtras:!0}}))}},wp.element.createElement("span",{className:"member_button",onClick:function(){var e=new CustomEvent("loginExtras",{detail:{loginExtras:!0}});document.dispatchEvent(e)}},wp.element.createElement("span",{className:"vicon vicon-comments"})," ",wp.element.createElement("span",null,window.vibebp.translations.chat))):"")),wp.element.createElement("div",{className:"vibebp_loggedin_menu_wrapper"},wp.element.createElement("div",{className:"vibebp_loggedin_usermenu_content"},_.length?_.map((function(e){return wp.element.createElement("span",{className:e.classes.join(" "),onClick:function(){return function(e){h(!1),e.classes.indexOf("bp-menu")>-1?(l(e.css_id),Qt("vibebp").setComponent(e.css_id)):window.location.href=e.url}(e)},dangerouslySetInnerHTML:{__html:e.title}})})):"")),wp.element.createElement("button",{className:"button is-primary",onClick:A},wp.element.createElement("i",{className:"icon",dangerouslySetInnerHTML:{__html:window.vibebp.icons.logout}}),wp.element.createElement("span",null,window.vibebp.translations.logout))):""):wp.element.createElement("div",{className:"menu_item",onClick:A},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:window.vibebp.icons.logout}}),wp.element.createElement("span",null,window.vibebp.translations.logout))))};function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){rn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function an(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return on(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return on(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ln=wp.element,cn=(ln.createElement,ln.useState),sn=ln.useEffect,mn=ln.Fragment,pn=(ln.render,ln.useContext,wp.data),un=(pn.dispatch,pn.select),dn=function(e){var t=an(cn(!1),2),n=t[0],r=t[1],a=an(cn(e.move),2),i=a[0],o=a[1],l=an(cn([]),2),c=l[0],s=l[1],m=an(cn({}),2),p=m[0],u=m[1],d=an(cn(""),2),f=d[0],b=d[1];return sn((function(){o(e.move)}),[e.move]),sn((function(){e.widget.link&&(r(!0),e.setloading(!0),fetch("".concat(e.widget.link),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:un("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(r(!1),t.status)if(window.vibebp.components.dashboard.widgets.indexOf(t.widget.id_base)>-1){b(t.widget.id_base),s(nn(nn({},t.widget),{},{link:e.widget.link})),e.widget.hasOwnProperty("style")&&void 0!==e.widget.style&&e.widget.style&&e.widget.style.hasOwnProperty("width_class")&&void 0!==e.widget.style.width_class&&e.widget.style.width_class||e.update("defaultWidth",nn(nn({},t.widget),{},{link:e.widget.link}),e.all_widgets);var n=new CustomEvent(t.widget.id_base,{detail:{widget:t.widget}});document.dispatchEvent(n),e.setloading(!1)}else t.widget.hasOwnProperty("html")&&s(t.widget)})))}),[e.widget.link]),sn((function(){u(e.widget)}),[e.widget]),wp.element.createElement("div",{class:"dashboard_widget dash_"+f},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(mn,null,wp.element.createElement("div",{className:"dashboard_widget_header"},wp.element.createElement("span",{className:i?"vicon vicon-move":"vicon vicon-pin2",onClick:function(){return e.update("move",c,e.all_widgets)}}),wp.element.createElement("span",null,i?wp.element.createElement(mn,null,p.hasOwnProperty("style")&&p.style.column>1?wp.element.createElement("span",{className:"vicon vicon-arrow-left",onClick:function(){return e.update("column_minus",c,e.all_widgets)}}):"",wp.element.createElement("span",{className:"vicon vicon-arrow-right",onClick:function(){return e.update("column",c,e.all_widgets)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return e.update("remove",c,e.all_widgets)}})):"")),c.hasOwnProperty("html")?wp.element.createElement("div",{className:c.id_base+" "+c.id,dangerouslySetInnerHTML:{__html:c.html}}):f?wp.element.createElement("div",{className:f+" "+c.id}):""))};function fn(e){return function(e){if(Array.isArray(e))return wn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||vn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||vn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vn(e,t){if(e){if("string"==typeof e)return wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wn(e,t):void 0}}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yn=wp.element,gn=(yn.createElement,yn.useState),hn=yn.useEffect,En=(yn.useContext,yn.Fragment),_n=(yn.render,wp.data),On=_n.dispatch,jn=_n.select,Nn=function(e){var t=bn(gn(null),2),n=t[0],r=t[1],a=bn(gn(!1),2),i=a[0],o=a[1],l=bn(gn(!1),2),c=l[0],s=l[1],m=bn(gn(!0),2),p=(m[0],m[1]),u=bn(gn([]),2),d=u[0],f=u[1],b=bn(gn(null),2),v=b[0],w=b[1],y=bn(gn([]),2),g=y[0],h=y[1],E=bn(gn(e.isCustomized),2),_=E[0],O=E[1];hn((function(){r(e.widgets)}),[e.widgets]),hn((function(){document.addEventListener("vibebp_widget_loaded",(function(){j()}))}),[]);var j=function(){var t=document.querySelector(".dashboard");if(v)v.layout();else{var r=new Packery(t,{percentPosition:!0,gutter:0,stagger:30});if(r){var a=[];r.items.forEach((function(e){var t=new Draggabilly(e.element,{containment:".dashboard-wrapper"});t.disable(),a.push(t),r.bindDraggabillyEvents(t)})),h(a),t.addEventListener("dragItemPositioned",(function(){var t=r.Packery("getShiftPositions","data-widget-id");if(Array.isArray(t)){var a=[];t.map((function(e){a.push(n[n.findIndex((function(t){return t.id==e}))])})),console.log("update"),e.update(a)}localStorage.setItem("dragPositions",JSON.stringify(t))})),w(r)}}};return wp.element.createElement(En,null,n&&n.length?wp.element.createElement(En,null,_&&i?wp.element.createElement("div",{className:"",style:{width:"100%",display:"flex","justify-content":"center","align-items":"center"}},wp.element.createElement("a",{className:c?"button is-primary is-loading":"button is-primary",onClick:function(){s(!0),fetch("".concat(window.vibebp.api.url,"/save_sidebar?post"),{method:"post",body:JSON.stringify({widgets:null,sidebar_id:window.vibebp.components.dashboard.sidebar,token:jn("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.status&&(On("vibebp").addNotification({text:t.message}),O(!1),e.reset(),v&&v.shiftLayout()),s(!1)}))}},window.vibebp.translations.reset_to_default)):"",wp.element.createElement("div",{className:"dashboard"},n.map((function(t,a){var l={link:""};return"string"==typeof t?l.link=t:t&&t.hasOwnProperty("style")&&(l=t),wp.element.createElement("div",{className:t.hasOwnProperty("style")&&t.style.hasOwnProperty("width_class")&&void 0!==t.style.width_class&&t.style.width_class&&t.style.width_class.length?"dashboard_widget_wrapper "+t.style.width_class:"dashboard_widget_wrapper col-md-4",ref:function(e){if(e&&!d[a]){var t=fn(d);t[a]=e,f(t)}},"data-widget-id":t.id,key:a,style:{}},wp.element.createElement(dn,{widget:l,move:i,update:function(t,n,l){!function(t,n,a,l){if("move"==t&&(o(!i),i&&v&&g.length&&g.map((function(e){e.disable(),v.unbindDraggabillyEvents(e)})),i||g.map((function(e){console.log("##"),e.enable(),v.bindDraggabillyEvents(e)}))),"remove"==t&&(l.splice(n,1),e.add({link:a.link,name:a.name,style:{row:1,column:1}})),"column"==t){if("string"==typeof l[n]){var c=window.vibebp.settings.widget_classes.findIndex((function(e){return e===a.options.width}));-1==c&&(c=1),l[n]={link:l[n]},l[n].style={row:1,column:1},l[n].style.column++,c>=0&&void 0!==window.vibebp.settings.widget_classes[c+1]&&(l[n].style.width_class=window.vibebp.settings.widget_classes[c+1])}else{var s=window.vibebp.settings.widget_classes.findIndex((function(e){return e===l[n].style.width_class}));l[n].style.column++,s>=0&&void 0!==window.vibebp.settings.widget_classes[s+1]&&(l[n].style.width_class=window.vibebp.settings.widget_classes[s+1])}v.shiftLayout()}if("column_minus"==t){var m=window.vibebp.settings.widget_classes.findIndex((function(e){return e===l[n].style.width_class}));m>=0&&(l[n].style.width_class=window.vibebp.settings.widget_classes[m-1]),l[n].style.column--,v.shiftLayout()}if("row"==t&&("string"==typeof l[n]?(l[n]={link:l[n]},l[n].style={row:1,column:1},l[n].style.row++):l[n].style.row++,v.shiftLayout()),"row_minus"==t&&(l[n].style.row--,v.shiftLayout()),"defaultWidth"==t){var p={id:a.id_base,name:a.name,description:a.description,link:a.link,style:{row:5,column:1,width_class:a.options.width}};a.options.hasOwnProperty("width")&&a.options.width&&(a.options.width.indexOf("col-md-6")>-1&&(p.style={row:10,column:2}),a.options.width.indexOf("col-md-8")>-1&&(p.style.column=3,p.style.row=10),a.options.width.indexOf("col-md-12")>-1&&(p.style.column=4,p.style.row=10),p.style.width_class=a.options.width),l.splice(n,1,p),v&&v.shiftLayout(),r(fn(l))}"defaultWidth"!=t&&(O(!0),r(fn(l)),e.update(fn(l)))}(t,a,n,l)},all_widgets:n,setloading:function(e){p(e)}}))})))):"")};function Sn(e){return function(e){if(Array.isArray(e))return An(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Pn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Pn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pn(e,t){if(e){if("string"==typeof e)return An(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?An(e,t):void 0}}function An(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Packery.prototype.unbindDraggabillyEvents=function(e){e.off("dragStart",this.handleDraggabilly.dragStart),e.off("dragMove",this.handleDraggabilly.dragMove),e.off("dragEnd",this.handleDraggabilly.dragEnd)};var xn=wp.element,In=(xn.createElement,xn.useState),Cn=xn.useEffect,Tn=(xn.useContext,xn.Fragment),Dn=(xn.render,wp.data),Ln=Dn.dispatch,Mn=Dn.select,Jn=function(e){var t=kn(In(!1),2),n=t[0],r=t[1],a=kn(In([]),2),i=a[0],o=a[1],l=kn(In(""),2),c=l[0],s=l[1],m=kn(In(!1),2),p=m[0],u=m[1],d=kn(In([]),2),f=d[0],b=d[1],v=kn(In(!1),2),w=v[0],y=v[1];Cn((function(){document.querySelector("body").classList.value.indexOf("withsidebar")>-1&&document.querySelector("body").classList.remove("withsidebar");var e=!0,t=window.location.href.split("#");if(t.length>1){var n=t[1].split("&"),r=[];n.map((function(t,n){"component"===(r=t.split("="))[0]&&"dashboard"!=r[1]&&(e=!1)}))}return e&&g(),document.addEventListener("vibebp_component_reload",g),function(){document.removeEventListener("vibebp_component_reload",g)}}),[]);var g=function(){r(!0),fetch("".concat(window.vibebp.api.url,"/sidebar/").concat(window.vibebp.components.dashboard.sidebar),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:Mn("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(o(e.widgets),e.unusedwidgets&&b(e.unusedwidgets),e.hasOwnProperty("customized")&&y(!0)),r(!1)}))};return wp.element.createElement(Tn,null,wp.element.createElement("div",{className:"dashboard-wrapper"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):i&&i.length?wp.element.createElement(Tn,null,wp.element.createElement(Nn,{widgets:i,add:function(e){var t=Sn(f);t.push(e),b(t)},update:function(e){o(e),fetch("".concat(window.vibebp.api.url,"/save_sidebar?post"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:"",body:JSON.stringify({widgets:e,sidebar_id:window.vibebp.components.dashboard.sidebar,token:Mn("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&Ln("vibebp").addNotification({text:e.message})}))},reset:function(){g()},isCustomized:w}),f.length?wp.element.createElement("span",{className:"widget_move_spot"},p?wp.element.createElement("span",null,wp.element.createElement("select",{onChange:function(e){var t=Sn(i),n=Sn(f);t.push(e.target.value),o(t),n.splice(n.findIndex((function(t){return t.link==e.target.value})),1),b(n),s(""),u(!1)},value:c},wp.element.createElement("option",null,window.vibebp.translations.select_widget),f.map((function(e){return wp.element.createElement("option",{value:e.link},e.name)}))),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){u(!1)}})):wp.element.createElement("span",{className:"vicon vicon-plus",onClick:function(){u(!0)}})):""):wp.element.createElement("div",{className:"vibebp_message"},window.vibebp.translations.empty_dashboard)))};function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){Fn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $n(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hn=wp.element,Rn=(Hn.createElement,Hn.useState),Wn=Hn.useEffect,Xn=Hn.useRef,Bn=Hn.Fragment,Kn=(Hn.render,wp.data),Gn=(Kn.dispatch,Kn.select,Math.round(100*Math.random())),Yn=function(e){var t=Xn(null),n=React.createRef(),r=zn(Rn(!0),2),a=r[0],i=r[1],o=zn(Rn(!1),2),l=o[0],c=o[1],s=zn(Rn(!1),2),m=s[0],p=s[1],u=zn(Rn(""),2),d=u[0],f=u[1],b=zn(Rn(""),2),v=b[0],w=b[1],y=zn(Rn(""),2),g=(y[0],y[1]),h=zn(Rn(""),2),E=h[0],_=h[1],O=zn(Rn({x:0,y:0,width:0,height:0,type:"image"}),2),j=O[0],N=O[1],S=zn(Rn(window.vibebp.translations.select_image),2),k=S[0],P=S[1];Wn((function(){e.hasOwnProperty("crop")&&e.crop&&c(!0)}),[]),Wn((function(){if(m&&l){var t=n.current;new Croppr(t,{aspectRatio:1,returnMode:"raw",maxSize:[460,460,"px"],minSize:[150,150,"px"],onCropEnd:function(t){var n=qn({},j);n.x=t.x,n.y=t.y,n.height=t.height,n.width=t.width,N(n);var r={x:t.x,y:t.y,width:t.width,height:t.height};e.update(E,r)}})}}),[m]);return wp.element.createElement("div",{className:"uploader"},a?wp.element.createElement("label",{for:"fileupload_"+Gn,className:"upload_file"},k,"image"==e.type?wp.element.createElement("input",{id:"fileupload_"+Gn,"data-type":e.type,ref:t,type:"file",accept:"image/*",onChange:function(n){t.current.files[0].size<window.vibebp.settings.upload_limit?(f(window.URL.createObjectURL(t.current.files[0])),i(!1),_(t.current.files),e.update(t.current.files,qn(qn({},j),{},{key:"image"}))):(P(window.vibebp.translations.image_size_error),setTimeout((function(){P(window.vibebp.translations.select_image)}),3500))}}):"video"==e.type?wp.element.createElement("input",{id:"fileupload_"+Gn,"data-type":e.type,ref:t,type:"file",accept:"video/*",onChange:function(n){t.current.files[0].size<window.vibebp.settings.upload_limit?(w(window.URL.createObjectURL(t.current.files[0])),i(!1),_(t.current.files),e.update(t.current.files,qn(qn({},j),{},{key:"video"}))):(P(window.vibebp.translations.image_size_error),setTimeout((function(){P(window.vibebp.translations.select_image)}),3500))}}):wp.element.createElement("input",{id:"fileupload_"+Gn,"data-type":e.type,ref:t,type:"file",onChange:function(n){t.current.files[0].size<window.vibebp.settings.upload_limit?(g(window.URL.createObjectURL(t.current.files[0])),i(!1),_(t.current.files),e.update(t.current.files,qn(qn({},j),{},{key:"attachment"}))):(P(window.vibebp.translations.image_size_error),setTimeout((function(){P(window.vibebp.translations.select_image)}),3500))}})):wp.element.createElement("div",{className:"uploaded_src"},"image"==e.type?wp.element.createElement(Bn,null,l?wp.element.createElement(Bn,null,wp.element.createElement("div",{className:"uploaded_image"},wp.element.createElement("img",{src:d})),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){p(!m)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){c(!1),i(!0),setImgRef(""),f(""),N({x:0,y:0,width:0,height:0})}})),m?wp.element.createElement("div",{className:"cropimage",id:"cropper"},wp.element.createElement("img",{src:d,ref:n})):""):wp.element.createElement("img",{src:d})):"video"==e.type?wp.element.createElement(Bn,null,wp.element.createElement("video",{className:"content_to_html_video",ref:function(e){e&&new Plyr(e)}},wp.element.createElement("source",{src:v,type:"video/mp4"}))):wp.element.createElement(Bn,null,wp.element.createElement("i",{className:"vicon vicon-clip"}))))};function Vn(e){return function(e){if(Array.isArray(e))return rr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||nr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(n),!0).forEach((function(t){er(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||nr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(e,t){if(e){if("string"==typeof e)return rr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rr(e,t):void 0}}function rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ar=wp.element,ir=(ar.createElement,ar.useState),or=ar.useEffect,lr=ar.Fragment,cr=(ar.render,wp.data),sr=cr.dispatch,mr=cr.select,pr=function(e){var t=tr(ir(!1),2),n=t[0],r=t[1],a=tr(ir([]),2),i=a[0],o=a[1],l=tr(ir([]),2),c=l[0],s=l[1],m=tr(ir(""),2),p=m[0],u=m[1],d=tr(ir({content:"",component:"activity",component_id:"",parent_id:"",meta:[]}),2),f=d[0],b=d[1];or((function(){e.hasOwnProperty("activity_id")&&b({content:"",component:"activity_comment",component_id:e.comment_id,parent_id:e.activity_id,meta:[]}),e.hasOwnProperty("component")&&"personal"!=e.component&&b(Zn(Zn({},f),{},{component:e.component,component_id:e.id}))}),[]),or((function(){f.component.length&&"activity"!==f.component&&"activity_comment"!==f.component&&fetch("".concat(window.vibebp.api.url,"/").concat(f.component,"/user/").concat(mr("vibebp").getUser().id,"/get_items"),{method:"post",body:JSON.stringify({token:mr("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&Array.isArray(e.groups)&&o(e.groups)}))}),[f.component]);return wp.element.createElement("div",{className:"portal activity_post"},wp.element.createElement("div",{className:"portal_body"},wp.element.createElement("textarea",{placeholder:window.vibebp.translations.whats_new,onChange:function(e){var t=Zn({},f);t.content=e.target.value,b(t)}},f.content)),wp.element.createElement("div",{className:"portal_footer"},e.hasOwnProperty("activity_id")||"activity"!==f.component?"":wp.element.createElement("div",{className:"footer_main"},wp.element.createElement("select",{value:f.component,onChange:function(e){var t=Zn({},f);t.component=e.target.value,b(t)}},Object.keys(window.vibebp.components.activity.post.components).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.activity.post.components[e])}))),i.length?wp.element.createElement("select",{value:f.component_id,onChange:function(e){var t=Zn({},f);t.component_id=e.target.value,b(t)}},wp.element.createElement("option",null,window.vibebp.translations.select_component),i.map((function(e){return wp.element.createElement("option",{value:e.id},e.label)}))):""),wp.element.createElement("div",{className:"footer_links"},c.length?c.map((function(e,t){return wp.element.createElement(lr,null,"image"==e?wp.element.createElement("a",{className:"vicon vicon-image upload_type"}):"video"==e?wp.element.createElement("a",{className:"vicon vicon-video-camera upload_type"}):wp.element.createElement("a",{className:"vicon vicon-clip upload_type"}),wp.element.createElement(Yn,{type:e,update:function(n,r){var a=Vn(p);a[t]=new File([n[0]],n[0].name),u(a),b(Zn(Zn({},f),{},{meta:[].concat(Vn(f.meta),[{key:e,value:t}])}))}}),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){var e=Vn(c);e.splice(t,1);var n=Vn(p);n.splice(t,1),u(n),s(e)}}))})):"",wp.element.createElement(lr,null,wp.element.createElement("a",{className:"vicon vicon-clip",onClick:function(){var e=Vn(c);e.push("attachment"),s(e)}}),wp.element.createElement("a",{className:"vicon vicon-video-camera",onClick:function(){var e=Vn(c);e.push("video"),s(e)}}),wp.element.createElement("a",{className:"vicon vicon-image",onClick:function(){var e=Vn(c);e.push("image"),s(e)}})),wp.element.createElement("a",{className:n?"button is-primary is-loading":"button is-primary",onClick:function(){if(f.content.length){var t=new FormData;t.append("body",JSON.stringify({args:f,token:mr("vibebp").getToken()})),p.length&&p.map((function(e,n){t.append("files_"+n,e)})),r(!0),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.activity,"/add?upload"),{method:"post",body:t}).then((function(e){return e.json()})).then((function(t){t.status&&(e.update(t.activity,"add"),b(Zn(Zn({},f),{},{content:"",meta:[]})),u([]),r(!1),sr("vibebp").addNotification({text:t.activity.action}))}))}}},window.vibebp.translations.post_update),e.hasOwnProperty("activity_id")?wp.element.createElement("a",{className:"button is-text",onClick:function(){e.update("","cancel")}},window.vibebp.translations.cancel):"")))};function ur(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fr=wp.element,br=(fr.createElement,fr.useState),vr=fr.useEffect,wr=(fr.Fragment,fr.render,function(e){var t=ur(br(""),2),n=t[0],r=t[1],a=ur(br({s:0,m:0,h:0,d:0,w:0,mn:0,y:0}),2),i=a[0],o=a[1];vr((function(){l()}),[e.time]),vr((function(){var e=setInterval((function(){l(),r(n+60)}),6e4);return function(){return clearInterval(e)}}),[]);var l=function(){var t={s:0,m:0,h:0,d:0,mn:0,y:0},n=Math.floor(((new Date).getTime()-Date.parse(e.time)+6e4*(new Date).getTimezoneOffset())/1e3);n>31536e3&&(t.y=Math.floor(n/31536e3),n-=86400*t.y*365),n>2592e3&&(t.mn=Math.floor(n/2592e3),n-=86400*t.mn*30),n>604800&&(t.w=Math.floor(n/604800),n-=86400*t.w*7),n>86400&&(t.d=Math.floor(n/86400),n-=86400*t.d),n>3600&&(t.h=Math.floor(n/3600),n-=3600*t.h),n>60&&(t.m=Math.floor(n/60),n-=60*t.m),t.s=n,o(t)};return wp.element.createElement("div",{className:"datetime"},i.y||i.mn||i.w||i.d||i.h||i.m?"":window.vibebp.translations.justnow,i.y?wp.element.createElement("span",{className:"years"},i.y," ",i.y>1?window.vibebp.translations.years:window.vibebp.translations.year):"",i.mn?wp.element.createElement("span",{className:"months"},i.mn," ",i.mn>1?window.vibebp.translations.months:window.vibebp.translations.month):"",i.w?wp.element.createElement("span",{className:"weeks"},i.w," ",i.w>1?window.vibebp.translations.weeks:window.vibebp.translations.week):"",i.d?wp.element.createElement("span",{className:"days"},i.d," ",i.d>1?window.vibebp.translations.days:window.vibebp.translations.day):"",i.h?wp.element.createElement("span",{className:"hours"},i.h," ",i.h>1?window.vibebp.translations.hours:window.vibebp.translations.hour):"",i.m?wp.element.createElement("span",{className:"minutes"},i.m," ",i.m>1?window.vibebp.translations.minutes:window.vibebp.translations.minute):"")});function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Er(e){return function(e){if(Array.isArray(e))return jr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Or(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Or(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Or(e,t){if(e){if("string"==typeof e)return jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jr(e,t):void 0}}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Nr=wp.element,Sr=(Nr.createElement,Nr.useState),kr=Nr.useEffect,Pr=Nr.Fragment,Ar=(Nr.render,wp.data),xr=Ar.dispatch,Ir=Ar.select,Cr=function e(t){var n=_r(Sr({}),2),r=n[0],a=n[1],i=_r(Sr(!1),2),o=i[0],l=i[1],c=_r(Sr(!1),2),s=c[0],m=c[1],p=_r(Sr(!1),2),u=p[0],d=p[1],f=_r(Sr([]),2),b=f[0],v=f[1];kr((function(){a(t.activity),localforage.getItem("favorite_activities_"+Ir("vibebp").getUser().id).then((function(e){e&&(e=JSON.parse(e),d(e))})),localforage.getItem("liked_activities_"+Ir("vibebp").getUser().id).then((function(e){e&&(e=JSON.parse(e),v(e))}))}),[t.activity]);var w=function(e,n){var i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gr(Object(n),!0).forEach((function(t){hr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r);if("add"===n&&(i.children?i.children[Object.keys(i.children).length]=e:("object"===yr(i.children)&&null!==i.children||(i.children={}),i.children[0]=e),m(!1),a(i),t.update(i,"update")),"remove"===n){var o=Object.keys(i.children).findIndex((function(t){return i.children[t].id===e.id}));-1!==o&&(delete i.children[o],a(i))}if("update"===n){var l=Object.keys(i.children).findIndex((function(t){return i.children[t].id===e.id}));-1!==l&&(i.children[l]=e,a(i),t.update(i,"update"))}"cancel"===n&&m(!1)};r.hasOwnProperty("date_recorded")||(r.date_recorded=(new Date).getTime());var y="activity_item "+r.type+" "+r.component;return r.hasOwnProperty("content")&&r.content.length&&(y+=" with_activity_content"),o&&(y+=" removed"),wp.element.createElement("div",{className:y,"data-activity-id":r.id},wp.element.createElement("div",{className:"activity_avatar"},wp.element.createElement("img",{src:r.avatar})),wp.element.createElement("div",{className:"activity_body"},wp.element.createElement("div",{className:"activity_header"},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:r.action}})),r.hasOwnProperty("content")&&r.content.length?wp.element.createElement("div",{className:"activity_content"},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:r.content}}),wp.element.createElement("div",{className:"activity_attachments"},r.hasOwnProperty("meta")&&Object.keys(r.meta).length?Object.keys(r.meta).map((function(e){return wp.element.createElement(Pr,null,r.meta[e].map((function(t){if(t&&t.length>3){if("image"==e)return wp.element.createElement("img",{src:t,className:"activity_meta image"});if("video"==e)return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{className:"activity_meta video",ref:function(e){e&&new Plyr(e)}},wp.element.createElement("source",{src:t,type:"video/mp4"})));if("audio"==e)return wp.element.createElement("audio",{className:"activity_meta audio",ref:function(e){e&&new Plyr(e)}},wp.element.createElement("source",{src:t,type:"audio/mp3"}));if("attachment"==e)return wp.element.createElement("a",{href:t,target:"_blank",className:"vicon vicon-clip activity_meta"})}})))})):"")):"",wp.element.createElement(wr,{time:r.date_recorded}),wp.element.createElement("div",{className:"activity_actions"},window.vibebp.settings.likes?wp.element.createElement("a",{className:-1===b.indexOf(r.id)?"vicon vicon-thumb-up":"vicon vicon-thumb-up filled",onClick:function(){var e=[],n=-1;b&&(e=Er(b),n=b.indexOf(r.id));var a="add-like";-1===n?e.push(r.id):(a="remove-like",t.update(r,"remove-like"),e.splice(n,1)),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.activity,"/").concat(a),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:"",body:JSON.stringify({activity_id:r.id,token:Ir("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.hasOwnProperty("message")&&xr("vibebp").addNotification({text:t.message}),localforage.setItem("liked_activities_"+Ir("vibebp").getUser().id,JSON.stringify(e))})),v(e)}}):"",wp.element.createElement("a",{className:r.hasOwnProperty("children")&&r.children?"vicon vicon-comment-alt":"vicon vicon-comment",onClick:function(){m(!s)}}),wp.element.createElement("a",{className:u&&-1!==u.indexOf(r.id)?"vicon vicon-star filled":"vicon vicon-star",onClick:function(){var e=[],n=-1;u&&(e=Er(u),n=u.indexOf(r.id));var a="add-favorite";-1===n?e.push(r.id):(a="remove-favorite",t.update(r,"remove-favorite"),e.splice(n,1)),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.activity,"/").concat(a),{method:"post",body:JSON.stringify({activity_id:r.id,token:Ir("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.hasOwnProperty("message")&&xr("vibebp").addNotification({text:t.message}),localforage.setItem("favorite_activities_"+Ir("vibebp").getUser().id,JSON.stringify(e)),d(e)}))}}),wp.element.createElement("a",{className:"vicon vicon-trash",onClick:function(){fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.activity,"/remove"),{method:"post",body:JSON.stringify({activity_id:r.id,parent_id:t.rootActivityId,token:Ir("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&xr("vibebp").addNotification({text:e.message}),l(!0),t.update(r,"remove")}))}})),s?wp.element.createElement(pr,{activity_id:t.rootActivityId,update:w,comment_id:r.id}):"",r.hasOwnProperty("children")&&r.children?wp.element.createElement("div",{class:"activity_list"},Object.keys(r.children).map((function(n){return wp.element.createElement(e,{activity:r.children[n],rootActivityId:t.rootActivityId,update:w})}))):""))};function Tr(e){return function(e){if(Array.isArray(e))return qr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ur(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(n),!0).forEach((function(t){Mr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Ur(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ur(e,t){if(e){if("string"==typeof e)return qr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qr(e,t):void 0}}function qr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fr=wp.element,zr=(Fr.createElement,Fr.useState),$r=Fr.useEffect,Hr=(Fr.Fragment,Fr.render,wp.data),Rr=Hr.dispatch,Wr=Hr.select,Xr=function(e){var t=Jr(zr([]),2),n=t[0],r=t[1],a=Jr(zr({}),2),i=a[0],o=a[1],l=Jr(zr(!1),2),s=l[0],m=l[1],p=Jr(zr(!0),2),u=p[0],d=p[1],f=Jr(zr(null),2),b=f[0],v=f[1],w=Jr(zr(!1),2),y=w[0],g=w[1],h=Jr(zr([]),2),E=h[0],_=h[1];$r((function(){"personal"===e.type&&o({filter:"just-me",search:"",sorter:"",page:1}),"groups"===e.type&&o({filter:"groups",item_id:e.id,search:"",sorter:"",page:1}),"course"===e.type&&o({filter:"course",item_id:e.id,search:"",sorter:"",page:1});var t=Wr("vibebp").getMenu().filter((function(e){return"activity"===e.parent_slug}));window.vibebp.settings.followers&&t.push({class:["menu-child"],css_id:"activity-following",name:window.vibebp.translations.following,parent:"activity"}),window.vibebp.settings.likes&&t.push({class:["menu-child"],css_id:"activity-likes",name:window.vibebp.translations.liked,parent:"activity"}),t.map((function(e,n){if(-1===t.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))){t[n].class.push("current-menu-item");var r=new CustomEvent("action_loaded",{detail:{component:window.vibebp.api.endpoints.activity,action:t[n].class}});document.dispatchEvent(r)}}));var n=Wr("vibebp").getUser();n.caps.hasOwnProperty("manage_options")&&t.push({class:["menu-child"],css_id:"all_activity",name:window.vibebp.translations.site_activity,parent:"activity"}),t.map((function(e,r){e.hasOwnProperty("caps")&&(n.caps.hasOwnProperty(e.caps)||t.splice(r,1))})),_(t),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]);var O=function(){o(Lr(Lr({},i),{},{page:1}))};$r((function(){return document.addEventListener("vibebp_component_reload",O),function(){document.removeEventListener("vibebp_component_reload",O)}})),c((function(){if(Object.keys(i).length){var e=Lr({},i);e.token=Wr("vibebp").getToken(),b&&b.abort();var t={},a=new AbortController;b&&(t={signal:a.signal}),v(a),d(!0),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.activity,"?args=").concat(i.search.length?"nocache":encodeURIComponent(JSON.stringify(Lr(Lr({},i),{},{search:""}))),"&force"),Lr(Lr({method:"post"},t),{},{headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(e)})).then((function(e){return e.json()})).then((function(e){if(d(!1),e.status){var t=[];if(y)t=Tr(n),e.data.activities.map((function(e){t.push(e)})),g(!1);else{if("activity-favs"===i.filter){var a=[];localforage.getItem("favorite_activities_"+Wr("vibebp").getUser().id).then((function(t){t&&((t=JSON.parse(t))&&t.length&&(a=Tr(t)),e.data.activities.map((function(e){-1===a.indexOf(e.id)&&a.push(e.id)})),localforage.setItem("favorite_activities_"+Wr("vibebp").getUser().id,JSON.stringify(a)))}))}if("activity-likes"===i.filter){var o=[];localforage.getItem("liked_activities_"+Wr("vibebp").getUser().id).then((function(t){t&&((t=JSON.parse(t))&&t.length&&(o=Tr(t)),e.data.activities.map((function(e){-1===o.indexOf(e.id)&&o.push(e.id)})),localforage.setItem("liked_activities_"+Wr("vibebp").getUser().id,JSON.stringify(o)))}))}t=e.data.activities}r(t),m(e.data.has_more_items)}else e.hasOwnProperty("message")&&Rr("vibebp").addNotification({text:e.message})}))}}),500,[i]);var j=function(e,t){var a=Tr(n),o="".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.activity,"?args=").concat(encodeURIComponent(JSON.stringify(Lr(Lr({},i),{},{search:""}))));if("remove"===t||"remove-favorite"==t&&"activity-favs"==i.filter){var l=Tr(n),c=l.findIndex((function(t){return t.id===e.id}));if(-1!==c&&(l.splice(c,1),r(l),!i.search.length)){"".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.activity,"?args=").concat(encodeURIComponent(JSON.stringify(Lr(Lr({},i),{},{search:""}))));localforage.getItem(o).then((function(e){var t=JSON.parse(e);t.data.activities=l,localforage.setItem(o,JSON.stringify(t))}))}}"add"===t&&(a.unshift(e),r(a),i.search.length||localforage.getItem(o).then((function(e){var t=JSON.parse(e);t.data.activities=a,localforage.setItem(o,JSON.stringify(t))})),"undefined"!=typeof navigator&&navigator.onLine&&"undefined"!=typeof firebase&&firebase.database().ref("tracker/".concat(Wr("vibebp").getUser().id,"/component/activity"),{timestamp:(new Date).getTime()})),"update"==t&&(a[a.findIndex((function(t){return t.id==e.id}))]=e,i.search.length||localforage.getItem(o).then((function(e){var t=JSON.parse(e);t.data.activities=a,localforage.setItem(o,JSON.stringify(t))})))},N=Tr(n);return i.hasOwnProperty("search")&&i.search.length&&(N=n.filter((function(e){return e.action.indexOf(i.search)>-1||e.content.indexOf(i.search)>-1}))),i.hasOwnProperty("sorter")&&i.sorter.length&&(N=n.filter((function(e){return e.type==i.sorter>-1}))),wp.element.createElement("div",{className:"vibebp_sidebars"},"personal"===e.type?wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.activity.label),E.map((function(e,t){return wp.element.createElement("a",{className:e.class.join(" "),onClick:function(n){var r=Lr({},i);r.filter=e.css_id,r.page=1,o(r);var a=Tr(E),l=a.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));a[l].class.splice(a[l].class.indexOf("current-menu-item"),1),a[t].class.push("current-menu-item"),_(a)}},e.name)})))):"",wp.element.createElement("div",{className:"vibebp_main"},wp.element.createElement(pr,{component:e.type,id:e.id,update:j}),wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("div",{className:"header_links"},wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:i.search,onChange:function(e){var t=Lr({},i);t.search=e.target.value,t.page=1,o(t)}}))),wp.element.createElement("div",{className:"header_extras"},wp.element.createElement("select",{onChange:function(e){return t=e.target.value,void o(Lr(Lr({},i),{},{sorter:t}));var t}},Object.keys(window.vibebp.components.activity.sorters).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.activity.sorters[e])}))))),wp.element.createElement("div",{className:"portal_body"},u?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",N.length?wp.element.createElement("div",{className:"activity_list"},N.map((function(e){return wp.element.createElement(Cr,{activity:e,rootActivityId:e.id,update:j})})),s?wp.element.createElement("a",{className:"link",onClick:function(){var e=Lr({},i);e.page=i.page+1,g(!0),o(e)}},window.vibebp.translations.more):""):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_activity_found)))))};function Br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Kr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Gr=wp.element,Yr=(Gr.createElement,Gr.useState),Vr=Gr.useEffect,Qr=(Gr.Fragment,Gr.render,wp.data),Zr=(Qr.dispatch,Qr.select),ea=function(e){var t=Br(Yr(!1),2),n=t[0],r=t[1],a=Br(Yr(""),2),i=a[0],o=a[1];Vr((function(){l()}),[]);var l=function(){r(!0);var t={token:Zr("vibebp").getToken()};e.hasOwnProperty("id")&&(t.id=e.id),r(!0),fetch("".concat(window.vibebp.api.url,"/profile/"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:Zr("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),o(e)}))};return Vr((function(){return document.addEventListener("vibebp_component_reload",l),function(){document.removeEventListener("vibebp_component_reload",l)}})),wp.element.createElement("div",{className:"user_profile"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:i}}))};function ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function na(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ra(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return aa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ia=wp.element,oa=(ia.createElement,ia.useState),la=ia.useEffect,ca=ia.Fragment,sa=(ia.render,wp.data),ma=(sa.dispatch,sa.select),pa=function(e){var t=ra(oa(!1),2),n=t[0],r=t[1],a=ra(oa({avatar:{},groups:[],fields:[],cover:{}}),2),i=a[0],o=a[1];la((function(){l(),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]);var l=function(){r(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/allfields"),{method:"post",body:JSON.stringify({token:ma("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(r(!1),e.status){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ta(Object(n),!0).forEach((function(t){na(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ta(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},i);t.groups=e.groups,t.fields=e.fields,o(t)}}))};return la((function(){return document.addEventListener("vibebp_component_reload",l),function(){document.removeEventListener("vibebp_component_reload",l)}}),[]),wp.element.createElement("div",{className:"edit_profile"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(ca,null,i.groups.length?i.groups.map((function(e){if(i.fields.filter((function(t){return t.group_id==e.id})).length)return wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("strong",null,e.name)),wp.element.createElement("div",{className:"portal_body"},i.fields.filter((function(t){return t.group_id==e.id})).length?wp.element.createElement("ul",{className:"vibebp_form"},i.fields.filter((function(t){return t.group_id==e.id})).map((function(e){return wp.element.createElement(Et,{field:e})}))):""))})):""))};function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function da(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ba(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ba(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var va=wp.element,wa=(va.createElement,va.useState),ya=va.useEffect,ga=va.useRef,ha=va.Fragment,Ea=(va.render,wp.data),_a=(Ea.dispatch,Ea.select),Oa=Math.round(100*Math.random()),ja=function(e){var t=ga(null),n=ga(null),r=ga(null),a=fa(wa(!0),2),i=a[0],o=a[1],l=fa(wa(!1),2),c=l[0],s=l[1],m=fa(wa(""),2),p=m[0],u=m[1],d=fa(wa(""),2),f=(d[0],d[1],fa(wa(""),2)),b=(f[0],f[1],fa(wa(!1),2)),v=b[0],w=b[1],y=fa(wa(""),2),g=(y[0],y[1],fa(wa({x:0,y:0,width:0,height:0,type:"image"}),2)),h=g[0],E=g[1],_=fa(wa(window.vibebp.translations.select_image),2),O=_[0],j=_[1];ya((function(){if(c){var e=n.current;new Croppr(e,{aspectRatio:1,returnMode:"raw",maxSize:[460,460,"px"],minSize:[150,150,"px"],onCropEnd:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(n),!0).forEach((function(t){da(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},h);t.x=e.x,t.y=e.y,t.height=e.height,t.width=e.width,E(t);e.x,e.y,e.width,e.height}})}}),[c]);return wp.element.createElement("div",{className:"uploader",ref:r},i?wp.element.createElement("label",{for:"fileupload_"+Oa,className:"upload_file"},O,wp.element.createElement("input",{id:"fileupload_"+Oa,"data-type":e.type,ref:t,type:"file",accept:"image/*",onChange:function(e){if(t.current.files[0].size<window.vibebp.settings.upload_limit){var a={token:_a("vibebp").getToken()};r.current&&(a.ui_available_width=r.current.offsetWidth),j(window.vibebp.translations.uploading);var i=new FormData;i.append("body",JSON.stringify(a)),i.append("file",t.current.files[0]),fetch("".concat(window.vibebp.api.url,"/profile/avatar/upload"),{method:"post",body:i}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("original_file")?(o(!1),u(e.original_file),s(!0),setTimeout((function(){n.current.scrollIntoView()}),200)):_a("vibebp").addNotification({text:e.message}),j(window.vibebp.translations.select_image)}))}else j(window.vibebp.translations.image_size_error),setTimeout((function(){j(window.vibebp.translations.select_image)}),3500)}})):wp.element.createElement("div",{className:"uploaded_src"},wp.element.createElement(ha,null,wp.element.createElement(ha,null,wp.element.createElement("div",{className:"uploaded_image"},wp.element.createElement("img",{src:p})),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){s(!c)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){setisCrop(!1),o(!0),u(""),E({x:0,y:0,width:0,height:0})}})),c?wp.element.createElement("div",{className:"cropimage",id:"cropper"},wp.element.createElement("img",{src:p,ref:n})):"",wp.element.createElement("a",{className:"crop"==v?"button is-primary is-loading":"button is-primary",onClick:function(){var t={cropdata:h,token:_a("vibebp").getToken(),original_file:p},n=new FormData;n.append("body",JSON.stringify(t)),w("crop"),fetch("".concat(window.vibebp.api.url,"/profile/avatar/crop"),{method:"post",body:n}).then((function(e){return e.json()})).then((function(t){t.hasOwnProperty("avatar")?e.update(t):_a("vibebp").addNotification({text:t.message}),w(!1)}))}},window.vibebp.translations.upload)))))};function Na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Sa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ka=wp.element,Pa=(ka.createElement,ka.useState),Aa=ka.useEffect,xa=(ka.Fragment,ka.render,wp.data),Ia=xa.dispatch,Ca=xa.select,Ta=function(e){var t=Na(Pa(!1),2),n=t[0],r=t[1],a=Na(Pa(""),2),i=a[0],o=a[1],l=Na(Pa(""),2),c=l[0],s=(l[1],Na(Pa({}),2)),m=s[0],p=(s[1],Na(Pa(!1),2)),u=p[0],d=p[1],f=Na(Pa(!1),2),b=f[0],v=f[1],w=Ca("vibebp").getUser();Aa((function(){localforage.getItem("user_"+w.id).then((function(e){null!==e?(e=JSON.parse(e),o(e.avatar)):fetch("".concat(window.vibebp.api.url,"/avatar?ids=").concat(w.id),{method:"post",body:JSON.stringify({type:"user",ids:w.id,token:Ca("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(localforage.setItem("user_"+w.id,JSON.stringify(e.value)),o(e.value))}))}))}),[]);var y=function(){fetch("".concat(window.vibebp.api.url,"/avatar"),{method:"post",body:JSON.stringify({type:"user",ids:w.id,token:Ca("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(localforage.setItem("user_"+w.id,JSON.stringify(e.value)),o(e.value))}))};Aa((function(){return document.addEventListener("vibebp_component_reload",y),function(){document.removeEventListener("vibebp_component_reload",y)}}));return wp.element.createElement("div",{className:"profile_avatar_wrapper"},wp.element.createElement("div",{className:"profile_avatar"},n?wp.element.createElement(ja,{type:"image",crop:"1",update:function(e){o(e.avatar);var t=Ca("vibebp").getUser();t.avatar=e.avatar,localforage.setItem("bp_user",JSON.stringify(t));var n=t.username;t.hasOwnProperty("displayname")&&t.displayname.length&&(n=t.displayname),localforage.setItem("user_"+t.id,JSON.stringify({avatar:e.avatar,name:n})),Ca("vibebp").setUser(t),r(!1)}}):wp.element.createElement("img",{src:i})),wp.element.createElement("div",{className:"profile_avatar_actions buttons"},wp.element.createElement("a",{className:n?"button is-danger":"button is-info",onClick:function(){r(!n)}},n?window.vibebp.translations.cancel:window.vibebp.translations.change_image),b?wp.element.createElement("a",{className:u?"button is-loading is-primary":"button is-primary",onClick:function(){d(!0);var e={cropdata:m,token:Ca("vibebp").getToken()},t=new FormData;t.append("body",JSON.stringify(e)),t.append("file",c),fetch("".concat(window.vibebp.api.url,"/profile/avatar?upload"),{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){if(d(!1),e.status&&(v(!1),e.hasOwnProperty("message")&&Ia("vibebp").addNotification({text:e.message}),e.hasOwnProperty("avatar"))){o(e.avatar);var t=Ca("vibebp").getUser();t.avatar=e.avatar,localforage.setItem("bp_user",JSON.stringify(t));var n=t.username;t.hasOwnProperty("displayname")&&t.displayname.length&&(n=t.displayname),localforage.setItem("user_"+t.id,JSON.stringify({avatar:e.avatar,name:n})),Ca("vibebp").setUser(t)}}))}},window.vibebp.translations.update_image):""))};function Da(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return La(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return La(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function La(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ma=wp.element,Ja=(Ma.createElement,Ma.useState),Ua=Ma.useEffect,qa=(Ma.Fragment,Ma.render,wp.data),Fa=qa.dispatch,za=qa.select,$a=function(e){var t=Da(Ja(!1),2),n=t[0],r=t[1],a=Da(Ja(""),2),i=a[0],o=a[1],l=Da(Ja(""),2),c=l[0],s=l[1],m=Da(Ja({}),2),p=(m[0],m[1],Da(Ja(!1),2)),u=p[0],d=p[1],f=Da(Ja(!1),2),b=f[0],v=f[1],w=za("vibebp").getUser();Ua((function(){localforage.getItem("user_cover"+w.id).then((function(e){null!==e?o(e):fetch("".concat(window.vibebp.api.url,"/cover?ids=").concat(w.id),{method:"post",body:JSON.stringify({type:"user",ids:w.id,token:za("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&e.value.hasOwnProperty("cover")&&e.value.cover&&(o(e.value.cover),localforage.setItem("user_cover"+w.id,JSON.stringify(e.value)))}))}))}),[]);var y=function(){fetch("".concat(window.vibebp.api.url,"/cover"),{method:"post",body:JSON.stringify({type:"user",ids:w.id,token:za("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&e.value.hasOwnProperty("cover")&&e.value.cover&&(o(e.value.cover),localforage.setItem("user_cover"+w.id,JSON.stringify(e.value)))}))};Ua((function(){return document.addEventListener("vibebp_component_reload",y),function(){document.removeEventListener("vibebp_component_reload",y)}}));return wp.element.createElement("div",{className:"profile_avatar_wrapper"},wp.element.createElement("div",{className:"profile_cover"},n?wp.element.createElement(Yn,{type:"image",update:function(e){v(!0),s(e[0])}}):wp.element.createElement("img",{src:i})),wp.element.createElement("div",{className:"profile_avatar_actions buttons"},wp.element.createElement("a",{className:n?"button is-danger":"button is-info",onClick:function(){r(!n)}},n?window.vibebp.translations.cancel:window.vibebp.translations.change_image),b?wp.element.createElement("a",{className:u?"button is-loading is-primary":"button is-primary",onClick:function(){d(!0);var e={token:za("vibebp").getToken()},t=new FormData;t.append("body",JSON.stringify(e)),t.append("file",c),fetch("".concat(window.vibebp.api.url,"/component/cover?upload"),{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){if(d(!1),e.success&&(v(!1),r(!1),e.hasOwnProperty("error")&&Fa("vibebp").addNotification({text:e.error}),e.hasOwnProperty("data"))){var t=za("vibebp").getUser();t.cover=e.data.url,localforage.setItem("bp_user",JSON.stringify(t)),za("vibebp").setUser(t),localforage.setItem("user_cover"+t.id,e.data.url),o(e.data.url)}}))}},window.vibebp.translations.update_image):""))};function Ha(e){return function(e){if(Array.isArray(e))return Xa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Wa(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ra(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Wa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wa(e,t){if(e){if("string"==typeof e)return Xa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xa(e,t):void 0}}function Xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ba=wp.element,Ka=(Ba.createElement,Ba.useState),Ga=Ba.useEffect,Ya=(Ba.Fragment,Ba.render,wp.data),Va=Ya.dispatch,Qa=Ya.select,Za=function(e){var t=Ra(Ka(!1),2),n=t[0],r=(t[1],Ra(Ka(window.vibebp.components.profile.default_component),2)),a=r[0],i=r[1],o=Ra(Ka([]),2),l=o[0],c=o[1];return Ga((function(){var e=Qa("vibebp").getAction(),t=Qa("vibebp").getMenu().filter((function(e){return"profile"===e.parent}));t.map((function(n,r){e?t.findIndex((function(t){return t.css_id==e}))>-1&&(i(t[t.findIndex((function(t){return t.css_id==e}))].css_id),t[t.findIndex((function(t){return t.css_id==e}))].class.push("current-menu-item")):-1==t[0].class.indexOf("current-menu-item")&&t[0].class.push("current-menu-item")})),c(t),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[Qa("vibebp").getMenu()]),wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.profile.label),l.map((function(e,t){return wp.element.createElement("a",{className:e.class.join(" "),onClick:function(e){var n=Ha(l),r=n.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));n[r].class.splice(n[r].class.indexOf("current-menu-item"),1),n[t].class.push("current-menu-item"),c(n),i(n[t].css_id),Va("vibebp").setAction(n[t].css_id)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"edit"===a?wp.element.createElement(pa,null):"change-avatar"===a?wp.element.createElement(Ta,null):"change-cover-image"===a?wp.element.createElement($a,null):wp.element.createElement(ea,null)))};function ei(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ti(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ti(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ti(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ni=wp.element,ri=(ni.createElement,ni.useState),ai=ni.useEffect,ii=(ni.Fragment,ni.render,function(e){var t=ei(ri(""),2),n=t[0],r=t[1];return ai((function(){e.notification&&void 0!==e.notification.content&&e.notification.content&&e.notification.content.hasOwnProperty("text")?r(e.notification.content.text):r(e.notification.content)}),[e.notification.content]),wp.element.createElement("div",{className:"notification",dangerouslySetInnerHTML:{__html:n}})});function oi(e){return function(e){if(Array.isArray(e))return ui(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||pi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?li(Object(n),!0).forEach((function(t){si(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function si(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||pi(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pi(e,t){if(e){if("string"==typeof e)return ui(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ui(e,t):void 0}}function ui(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var di=wp.element,fi=(di.createElement,di.useState),bi=di.useEffect,vi=(di.Fragment,di.render,wp.data),wi=(vi.dispatch,vi.select),yi=function(e){var t=mi(fi([]),2),n=t[0],r=t[1],a=mi(fi([]),2),i=a[0],o=a[1],l=mi(fi(!1),2),s=l[0],m=l[1],p=mi(fi({filter:"unread",sorter:"",page:1,search:""}),2),u=p[0],d=p[1],f=mi(fi(!1),2),b=f[0],v=f[1],w=mi(fi([]),2),y=w[0],g=w[1],h=mi(fi(!0),2),E=h[0],_=h[1],O=mi(fi(""),2),j=O[0],N=O[1],S=mi(fi(!1),2),k=S[0],P=S[1],A=mi(fi(!1),2),x=A[0],I=A[1],C=mi(fi(null),2),T=C[0],D=C[1];bi((function(){console.log(wi("vibebp").getMenu());var e=wi("vibebp").getMenu().filter((function(e){return"notifications"===e.parent}));e.map((function(t,n){-1===e.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&e[n].class.push("current-menu-item")})),o(e),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),c((function(){var e=ci({},u);e.token=wi("vibebp").getToken(),T&&T.abort();var t={},a=new AbortController;T&&(t={signal:a.signal}),D(a),_(!0),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"?").concat(u.search.length?"nocache":encodeURIComponent(JSON.stringify(ci(ci({},u),{},{search:""})))),ci(ci({method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{}},t),{},{body:JSON.stringify(e)})).then((function(e){return e.json()})).then((function(e){if(_(!1),e.status)if(x){var t=oi(n);e.data.notifications.map((function(e){t.push(e)})),r(t),I(!1),t.length<e.data.total?P(!0):P(!1)}else r(e.data.notifications),e.data.notifications.length<e.data.total?P(!0):P(!1);else r([])}))}),500,[u]);var L=function(){d(ci(ci({},u),{},{page:1}))};bi((function(){return document.addEventListener("vibebp_component_reload",L),function(){document.removeEventListener("vibebp_component_reload",L)}}));var M=function(e,t){m(!1);var a=oi(n);"read"===t&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/mark-read-unread?post"),{method:"post",body:JSON.stringify({is_new:0,id:e,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),"unread"===t&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/mark-read-unread?post"),{method:"post",body:JSON.stringify({is_new:1,id:e,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),"delete"===t&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/delete-notification?post"),{method:"post",body:JSON.stringify({id:e,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),a.splice(a.findIndex((function(t){return t.id===e})),1),r(a)};return wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.notifications.label),i.map((function(e,t){var n=e.class.join(" ")+" "+e.css_id;return wp.element.createElement("a",{className:n,onClick:function(n){var r=ci({},u);r.filter=e.css_id,"notifications-my-notifications"===e.css_id&&(r.filter="unread"),r.page=1,d(r);var a=oi(i),l=a.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));a[l].class.splice(a[l].class.indexOf("current-menu-item"),1),a[t].class.push("current-menu-item"),v(!1),g([]),N(""),o(a)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},wp.element.createElement("div",{className:"vibebp_main_head"},wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",value:u.search,onChange:function(e){return d(ci(ci({},u),{},{search:e.target.value}))},placeholder:window.vibebp.translations.search_text})),wp.element.createElement("select",{onChange:function(e){var t=ci({},u);t.sorter=e.target.value,d(t)}},Object.keys(window.vibebp.components.notifications.sorters).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.notifications.sorters[e])})))),n.length||E?wp.element.createElement("div",{className:"table_block"},wp.element.createElement("table",{className:"table"},wp.element.createElement("thead",null,wp.element.createElement("th",null,wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{id:"selectall",type:"checkbox",checked:b?"checked":"",onClick:function(){b?v(!1):(v(!0),g([]))}}),wp.element.createElement("label",{for:"selectall"}))),wp.element.createElement("th",null,window.vibebp.translations.owner),wp.element.createElement("th",null,window.vibebp.components.notifications.label),wp.element.createElement("th",null,window.vibebp.translations.date),wp.element.createElement("th",null,wp.element.createElement("a",{className:"vicon vicon-more rotate90"}))),wp.element.createElement("tbody",null,E?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):n.length?n.map((function(e){return wp.element.createElement("tr",null,wp.element.createElement("td",{valign:"center"},wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",onClick:function(){var t=oi(y);b&&(v(!1),n.map((function(e){t.push(e.id)}))),-1===y.indexOf(e.id)?(t.push(e.id),g(t)):(t.splice(y.indexOf(e.id),1),g(t))},checked:b||-1!==y.indexOf(e.id)?"checked":"",id:e.id}),wp.element.createElement("label",{for:e.id}))),wp.element.createElement("td",{valign:"center"},wp.element.createElement(zt,{type:e.component_name,id:{item_id:e.item_id,secondary_item_id:e.secondary_item_id,user_id:e.user_id}})),wp.element.createElement("td",{valign:"center"},wp.element.createElement(ii,{notification:e,update:M})),wp.element.createElement("td",{valign:"center"},wp.element.createElement(wr,{time:e.date_notified})),wp.element.createElement("td",{valign:"center"},wp.element.createElement("a",{className:"vicon vicon-more rotate90",onClick:function(){m(!s&&e.id)}}),s===e.id?wp.element.createElement("ul",{className:"target_menu"},Object.keys(window.vibebp.components.notifications.actions).map((function(t){if(t!==u.filter)return wp.element.createElement("li",{value:t,onClick:function(){M(e.id,t)}},window.vibebp.components.notifications.actions[t])}))):""))})):"")),b||y.length?wp.element.createElement("div",{className:"bulk_actions"},wp.element.createElement("select",{onChange:function(e){N(e.target.value)}},wp.element.createElement("option",null,window.vibebp.translations.selectaction),Object.keys(window.vibebp.components.notifications.actions).map((function(e){if(e!==u.filter)return wp.element.createElement("option",{value:e},window.vibebp.components.notifications.actions[e])}))),wp.element.createElement("a",{className:"button is-primary",onClick:function(){var e=oi(n);if(console.log(j),j)if(b){if(r([]),"read"===j&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/markall-read-unread?post"),{method:"post",body:JSON.stringify({is_new:0,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),"unread"===j&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/markall-read-unread?post"),{method:"post",body:JSON.stringify({is_new:1,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),"delete"===j){var t=[];n.map((function(e){t.push(e.id)})),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/deleteall?post"),{method:"post",body:JSON.stringify({ids:t,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){}))}}else y.length&&(y.map((function(t){e.splice(e.findIndex((function(e){return t===e.id})),1)})),r(e),"read"===j&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/mark-read-unread?post"),{method:"post",body:JSON.stringify({is_new:0,id:y,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),"unread"===j&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/mark-read-unread?post"),{method:"post",body:JSON.stringify({is_new:1,id:y,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),"delete"===j&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.notifications,"/delete-notification?post"),{method:"post",body:JSON.stringify({id:y,token:wi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})))}},window.vibebp.translations.apply)):"",k?wp.element.createElement("a",{className:"link",onClick:function(){var e=ci({},u);e.page+=1,d(e),I(!0)}},window.vibebp.translations.more):""):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_notifications_found)))};function gi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return hi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hi(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ei=wp.element,_i=(Ei.createElement,Ei.useState),Oi=(Ei.useEffect,Ei.Fragment),ji=(Ei.render,wp.data),Ni=(ji.dispatch,ji.select,function(e){var t=gi(_i(JSON.parse(e.object)),2),n=t[0];t[1];return wp.element.createElement(Oi,null,n&&n.hasOwnProperty("blocks")&&void 0!==n.blocks&&n.blocks.length&&void 0!==n.blocks[0]&&"unstyled"===n.blocks[0].type?wp.element.createElement("div",{className:"blocktext"},n.blocks[0].text):"")});function Si(e){return function(e){if(Array.isArray(e))return Ai(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Pi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ki(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Pi(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pi(e,t){if(e){if("string"==typeof e)return Ai(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ai(e,t):void 0}}function Ai(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xi=wp.element,Ii=(xi.createElement,xi.useState),Ci=xi.useEffect,Ti=xi.Fragment,Di=(xi.render,xi.useContext),Li=wp.data,Mi=Li.dispatch,Ji=Li.select,Ui=function(e){var t=Di(Tt),n=ki(Ii(0),2),r=n[0],a=n[1],i=ki(Ii(!1),2),o=i[0],l=i[1],c=ki(Ii(e.message.labels),2),m=c[0],p=c[1];Ci((function(){Object.keys(e.message.recipients).map((function(t){e.message.recipients[t].user_id===Ji("vibebp").getUser()&&e.message.recipients[t].unread_count&&a(1)}))}),[]);var u="message_add_label vicon vicon-plus";return o&&(u="message_add_label vicon vicon-close"),wp.element.createElement(Ti,null,t.messageLabels&&t.messageLabels.length?wp.element.createElement("div",{className:"message_labels"},m.length?m.map((function(n){var r=t.messageLabels[t.messageLabels.findIndex((function(e){return e.slug===n}))];return wp.element.createElement("span",{style:{background:r.color},onClick:function(){return function(t){var n=Si(m);n.splice(n.indexOf(t),1),p(n),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/actions?post"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({id:e.message.thread_id,action:"remove_label",label:t,token:Ji("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(n){e.updateLabels(t,0),n.hasOwnProperty("message")&&Mi("vibebp").addNotification({text:n.message,icon:"vicon vicon-save"})}))}(n)}},r.name)})):"",wp.element.createElement("a",{className:u,onClick:function(){l(!o)}}),o?wp.element.createElement("ul",{className:"allmessage_labels"},t.messageLabels.map((function(t){if(-1===m.indexOf(t.slug))return wp.element.createElement("li",{onClick:function(){return function(t){l(!1);var n=Si(m);n.push(t.slug),p(n),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/actions?post"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({id:e.message.thread_id,action:"add_label",label:t.slug,token:Ji("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(n){e.updateLabels(t.slug,1),n.hasOwnProperty("message")&&Mi("vibebp").addNotification({text:n.message,icon:"vicon vicon-save"})}))}(t)},style:{background:t.color}},t.name)}))):""):"",wp.element.createElement("div",{className:"message",onClick:function(){e.show()}},r?wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:e.message.last_message_subject}}):wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:e.message.last_message_subject}}),s(e.message.last_message_content)?wp.element.createElement(Ni,{object:e.message.last_message_content,type:"text"}):wp.element.createElement("div",{className:"message_content",dangerouslySetInnerHTML:{__html:e.message.last_message_content}})))};function qi(e){return function(e){if(Array.isArray(e))return Wi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ri(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fi(Object(n),!0).forEach((function(t){$i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Ri(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ri(e,t){if(e){if("string"==typeof e)return Wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wi(e,t):void 0}}function Wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xi=wp.element,Bi=(Xi.createElement,Xi.useState),Ki=Xi.useEffect,Gi=Xi.Fragment,Yi=(Xi.render,wp.data),Vi=Yi.dispatch,Qi=Yi.select,Zi=function(e){var t=Hi(Bi(""),2),n=t[0],r=t[1],a=Hi(Bi(!1),2),i=a[0],o=a[1],l=Hi(Bi(!1),2),s=l[0],m=l[1],p=Hi(Bi([]),2),u=p[0],d=p[1],f=Hi(Bi({content:"",recipients:[],subject:"",thread_id:0,meta:[]}),2),b=f[0],v=f[1],w=Hi(Bi([]),2),y=w[0],g=w[1],h=Hi(Bi(""),2),E=h[0],_=h[1];Ki((function(){if(e.hasOwnProperty("thread_id")){var t=zi({},b);t.thread_id=e.thread_id,t.recipients=e.recipients,v(t)}}),[]),c((function(){n.length>4&&(m(!0),fetch("".concat(window.vibebp.api.url,"/search?nocache"),{method:"post",body:JSON.stringify({search:n,type:"user",token:Qi("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){m(!1),e.status&&Array.isArray(e.results)&&(e.results.map((function(e){localforage.setItem("user_"+e.id,JSON.stringify(e))})),d(e.results))})))}),500,[n]);var O=function(){var t=1;if(b.content.length||(t=0,Vi("vibebp").addNotification({text:window.vibebp.translations.missing_content})),b.recipients.length||2==e.type||(t=0,Vi("vibebp").addNotification({text:window.vibebp.translations.missing_recipients})),b.subject.length||b.thread_id||(t=0,Vi("vibebp").addNotification({text:window.vibebp.translations.missing_subject})),t){var n=zi({},b);2==e.type&&(n.notice=1),o(!0);var r=new FormData;r.append("body",JSON.stringify({args:n,token:Qi("vibebp").getToken()})),E.length&&E.map((function(e,t){r.append("files_"+t,e)})),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/send?upload"),{method:"post",body:r}).then((function(e){return e.json()})).then((function(t){o(!1),e.update(t,b),g([]),_(""),v(zi(zi({},b),{},{content:"",subject:""}))}))}};return wp.element.createElement("div",{className:"newmessage_form"},e.recipients||2==e.type?"":wp.element.createElement("div",{className:"recipients"},wp.element.createElement("label",null,window.vibebp.translations.recipients),wp.element.createElement("div",{className:"recipients_list"},wp.element.createElement("div",{className:"recipient_items"},b.recipients.map((function(e){return wp.element.createElement(zt,{type:"member",click:function(){var t=zi({},b);t.recipients.splice(t.recipients.indexOf(e),1),v(t)},id:{user_id:e}})}))),wp.element.createElement("div",{className:s?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:n,placeholder:window.vibebp.translations.search_member,onChange:function(e){r(e.target.value)}}))),u.length?wp.element.createElement("div",{className:"search_results"},u.map((function(e,t){return wp.element.createElement("div",{className:"search_result user",onClick:function(){r("");var n=qi(u),a=zi({},b);-1===a.recipients.indexOf(e.id)&&(a.recipients.push(e.id),v(a),n.splice(t,1),d(n))}},wp.element.createElement("img",{src:e.avatar}),wp.element.createElement("span",null,e.name))}))):""),e.hasOwnProperty("thread_id")?"":wp.element.createElement("div",{className:"subject"},wp.element.createElement("label",null,window.vibebp.translations.subject),wp.element.createElement("input",{type:"text",value:b.subject,onChange:function(e){var t=zi({},b);t.subject=e.target.value,v(t)}})),wp.element.createElement("div",{className:"message_body",id:"message_body"},wp.element.createElement("label",{onClick:function(){document.querySelector(".message_editor").focus()}},window.vibebp.translations.message),wp.element.createElement("div",{className:"message_editor"},wp.element.createElement("textarea",{value:b.content,onChange:function(e){v(zi(zi({},b),{},{content:e.target.value}))},onKeyDown:function(e){13!=e.keyCode||e.shiftKey||O()}}))),wp.element.createElement("div",{className:"message_actions"},wp.element.createElement("div",{className:"message_Attachments"},wp.element.createElement(Gi,null,wp.element.createElement("a",{className:"vicon vicon-clip",onClick:function(){var e=qi(y);e.push("attachment"),g(e)}}),wp.element.createElement("a",{className:"vicon vicon-video-camera",onClick:function(){var e=qi(y);e.push("video"),g(e)}}),wp.element.createElement("a",{className:"vicon vicon-image",onClick:function(){var e=qi(y);e.push("image"),g(e)}})),y.length?y.map((function(e,t){return wp.element.createElement("div",{className:"message_attachment"},"image"==e?wp.element.createElement("a",{className:"vicon vicon-image upload_type"}):"video"==e?wp.element.createElement("a",{className:"vicon vicon-video-camera upload_type"}):wp.element.createElement("a",{className:"vicon vicon-clip upload_type"}),wp.element.createElement(Yn,{type:e,update:function(n,r){var a=qi(E);a[t]=new File([n[0]],n[0].name),_(a),v(zi(zi({},b),{},{meta:[].concat(qi(b.meta),[{key:e,value:t}])}))}}),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){var e=qi(y);e.splice(t,1);var n=qi(E);n.splice(t,1),_(n),g(e)}}))})):""),wp.element.createElement("div",{className:"message_buttons"},b.thread_id?"":wp.element.createElement("a",{className:"link",onClick:e.cancel},window.vibebp.translations.cancel),wp.element.createElement("a",{className:i?"button is-primary is-loading":"button is-primary",onClick:O},window.vibebp.translations.send_message))))};function eo(e){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function to(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function no(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ro(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ao(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ao(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var io=wp.element,oo=(io.createElement,io.useState),lo=io.useEffect,co=io.Fragment,so=(io.render,wp.data),mo=(so.dispatch,so.select),po=function(e){var t=ro(oo(e.message),2),n=t[0],r=t[1],a=ro(oo(0),2),i=a[0],o=a[1],l=ro(oo([]),2),c=l[0],m=l[1];lo((function(){var t=[],n=mo("vibebp").getUser(),a=Object.keys(e.message.recipients);void 0!==e.message&&a.length&&a.map((function(r){e.message.recipients[r].user_id===n.id?e.message.recipients[r].unread_count&&o(1):t.push(e.message.recipients[r].user_id)})),m(t),r(e.message)}),[e.message]);var p=mo("vibebp").getUser();return wp.element.createElement("div",{className:"fullmessage"},wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("div",{className:"header_left"},c.length?c.map((function(e){if(e!=mo("vibebp").getUser().id)return wp.element.createElement(zt,{type:"member",id:{user_id:e}})})):""),wp.element.createElement("div",{className:"header_right"},wp.element.createElement("i",{className:"vicon vicon-arrow-left",onClick:function(){e.show()}}),wp.element.createElement("a",{href:"#message_body",className:"vicon vicon-back-left"}),wp.element.createElement("i",{className:"vicon vicon-trash",onClick:function(){return e.action("delete")}}))),wp.element.createElement("div",{className:"portal_body"},n.messages.map((function(e,t){return wp.element.createElement("div",{className:e.sender_id!=p.id?"notmine":"mine"},wp.element.createElement("div",{className:"portal_message_wrapper"},wp.element.createElement(zt,{type:"user",id:{user_id:e.sender_id}}),wp.element.createElement("div",{className:"portal_message"},wp.element.createElement("div",{className:"portal_title"},0==t?wp.element.createElement(co,null,wp.element.createElement("div",{className:"message_subject"},i?wp.element.createElement("strong",null,e.subject):wp.element.createElement("span",null,e.subject)),wp.element.createElement(wr,{time:e.date_sent})):wp.element.createElement("div",{className:"message_subject"},i?wp.element.createElement("strong",null,wp.element.createElement(wr,{time:e.date_sent})):wp.element.createElement("span",null,wp.element.createElement(wr,{time:e.date_sent})))),wp.element.createElement("div",{className:"portal_content"},s(e.message)?wp.element.createElement(Ni,{object:e.message}):wp.element.createElement("div",{className:"portal_content",dangerouslySetInnerHTML:{__html:e.message}})),wp.element.createElement("div",{className:"message_attachments"},"object"===eo(e.meta)&&null!==e.meta?Object.keys(e.meta).map((function(t){return wp.element.createElement(co,null,e.meta[t].map((function(e){if(e.length>3){if("image"==t)return wp.element.createElement("img",{src:e,className:"activity_meta image"});if("video"==t)return wp.element.createElement("video",{src:e,className:"activity_meta video"});if("attachment"==t)return wp.element.createElement("a",{href:e,target:"_blank",className:"vicon vicon-clip activity_meta"})}})))})):""))),wp.element.createElement("div",null))})))),c.length?wp.element.createElement(Zi,{thread_id:n.thread_id,update:function(e,t){if(e.status){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(Object(n),!0).forEach((function(t){no(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);a.messages=e.data,r(a)}},recipients:c}):"")};function uo(e){return function(e){if(Array.isArray(e))return go(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||yo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fo(Object(n),!0).forEach((function(t){vo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||yo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yo(e,t){if(e){if("string"==typeof e)return go(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?go(e,t):void 0}}function go(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ho=wp.element,Eo=(ho.createElement,ho.useState),_o=ho.useEffect,Oo=ho.Fragment,jo=(ho.rende,ho.useContext),No=wp.data,So=No.dispatch,ko=No.select,Po=function(e){var t=jo(Tt),n=wo(Eo([]),2),r=n[0],a=n[1],i=wo(Eo([]),2),o=i[0],l=i[1],s=wo(Eo(!1),2),m=s[0],p=s[1],u=wo(Eo({filter:"unread",sorter:"",page:1,search:"",label:""}),2),d=u[0],f=u[1],b=wo(Eo(!1),2),v=b[0],w=b[1],y=wo(Eo([]),2),g=y[0],h=y[1],E=wo(Eo(!0),2),_=E[0],O=E[1],j=wo(Eo(""),2),N=j[0],S=j[1],k=wo(Eo(!1),2),P=k[0],A=k[1],x=wo(Eo(!1),2),I=x[0],C=x[1],T=wo(Eo(!1),2),D=T[0],L=T[1],M=wo(Eo(0),2),J=M[0],U=M[1],q=wo(Eo(!1),2),F=q[0],z=q[1],$=wo(Eo({text:"",color:"#000"}),2),H=$[0],R=$[1],W=wo(Eo([]),2),X=W[0],B=W[1],K=wo(Eo(window.vibebp.components.messages.actions),2),G=K[0],Y=(K[1],wo(Eo(!1),2)),V=Y[0],Q=Y[1],Z=wo(Eo(null),2),ee=Z[0],te=Z[1];_o((function(){var e=ko("vibebp").getMenu().filter((function(e){return"messages"===e.parent}));e.map((function(t,n){"notices"==t.slug&&e.splice(n,1),-1===e.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&e[n].class.push("current-menu-item")})),l(e),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),c((function(){var e=bo({},d);e.token=ko("vibebp").getToken(),O(!0),ee&&ee.abort();var t={},n=new AbortController;ee&&(t={signal:n.signal}),te(n),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"?").concat(encodeURIComponent(JSON.stringify(bo(bo({},d),{},{search:""})))),bo(bo({method:"post"},t),{},{headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(e)})).then((function(e){return e.json()})).then((function(e){if(O(!1),e.status)if(I){var t=uo(r);e.data.threads.map((function(e){t.push(e)})),a(t),J||U(0),C(!1),t.length<e.data.total?A(!0):A(!1)}else a(e.data.threads),J||U(0),e.data.threads.length<e.data.total?A(!0):A(!1);else a([])}))}),500,[d]);var ne=function(){f(bo(bo({},d),{},{page:1}))};_o((function(){return document.addEventListener("vibebp_component_reload",ne),function(){document.removeEventListener("vibebp_component_reload",ne)}})),_o((function(){J&&document.querySelector("#vibebp_member").scrollTo({top:document.querySelector(".fullmessage").getBoundingClientRect().top,left:0,behavior:"smooth"})}),[J]),_o((function(){fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/labels"),{method:"post",body:JSON.stringify({token:ko("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&Array.isArray(e.labels)&&e.labels.length&&(B(e.labels),t.update("messageLabels",e.labels))}))}),[d]);var re=function(e,t){p(!1);var n=uo(r);if(!Array.isArray(e)){var i=[];i.push(e),e=i}if("star"===t||"unstar"===t){var o=[];e.map((function(e,t){Q(e),n[n.findIndex((function(t){return t.thread_id===e}))].messages.map((function(e,t){o.push(e.id)}))})),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/actions?post"),{method:"post",body:JSON.stringify({id:o,action:t,token:ko("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(r){Q(!1),r.status&&("unstar"===t&&e.map((function(e,t){n[n.findIndex((function(t){return t.thread_id===e}))].star=0})),"star"===t&&e.map((function(e,t){n[n.findIndex((function(t){return t.thread_id===e}))].star=1})))}))}"read"===t&&(e.map((function(e,t){n[n.findIndex((function(t){return t.thread_id===e}))].unread_count=0})),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/actions?post"),{method:"post",body:JSON.stringify({id:e,action:t,token:ko("vibebp").getToken()})})),"unread"===t&&(e.map((function(e,t){n[n.findIndex((function(t){return t.thread_id===e}))].unread_count++})),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/actions?post"),{method:"post",body:JSON.stringify({id:e,action:t,token:ko("vibebp").getToken()})})),"delete"===t&&(e.map((function(e,t){n.splice(n.findIndex((function(t){return t.thread_id===e})),1)})),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/actions?post"),{method:"post",body:JSON.stringify({id:e,action:t,token:ko("vibebp").getToken()})})),a(n)},ae=function(e){var t=bo({},d);t.label===e.slug?t.label="":t.label=e.slug,f(t)},ie=function(e){return!1!==J&&J===e?"message_block active":"message_block"};return wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.messages.label),wp.element.createElement("a",{className:"button is-primary new_mail",onClick:function(){L(1)}},window.vibebp.translations.new_message),o.map((function(e,t){var n=e.class.join(" ")+" "+e.css_id;if("compose"!==e.css_id)return wp.element.createElement("a",{className:n,onClick:function(n){var r=bo({},d);r.filter=e.css_id,r.page=1,U(!1),L(!1),d.css_id!==r.filter&&f(r);var a=uo(o),i=a.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));a[i].class.splice(a[i].class.indexOf("current-menu-item"),1),a[t].class.push("current-menu-item"),w(!1),h([]),S(""),l(a)}},e.name)})),wp.element.createElement("div",{className:"labels"},wp.element.createElement("div",{class:"labels_title"},wp.element.createElement("span",null,window.vibebp.translations.labels),wp.element.createElement("a",{className:"link",onClick:function(){z(!F)}},window.vibebp.translations.add_new)),F?wp.element.createElement("div",{className:"newlabel_form"},wp.element.createElement("input",{type:"text",value:H.text,onChange:function(e){var t=bo({},H);t.text=e.target.value,R(t)}}),wp.element.createElement("label",{style:{background:H.color}},wp.element.createElement("input",{type:"color",onChange:function(e){var t=bo({},H);t.color=e.target.value,R(t)}})),wp.element.createElement("a",{className:"button is-primary vicon vicon-plus",onClick:function(){z(!1),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/label/add?post"),{method:"post",body:JSON.stringify(bo(bo({},H),{},{token:ko("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(e.status){if(e.labels.length){var n=uo(X);e.labels.map((function(e){-1==n.findIndex((function(t){return t.slug==e.slug}))&&n.push(e)})),B(e.labels)}t.update("messageLabels",e.labels)}e.hasOwnProperty("message")&&So("vibebp").addNotification({text:e.message})}))}})):"",X&&X.length?wp.element.createElement("ul",{className:"message_labels"},X.map((function(e,n){var r="";return d.label==e.slug&&(r="active"),wp.element.createElement("li",{className:r},wp.element.createElement("label",null,wp.element.createElement("strong",{onClick:function(){return ae(e)}},wp.element.createElement("span",{style:{borderColor:e.color}}),e.name),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){return function(e){var n=uo(X);n.splice(e,1),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/label/remove?post"),{method:"post",body:JSON.stringify({slug:X[e].slug,token:ko("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){})),B(n),t.update("messageLabels",n)}(n)}})),wp.element.createElement("span",{onClick:function(){return ae(e)}},e.count))}))):""))),wp.element.createElement("div",{className:"vibebp_main"},wp.element.createElement("div",{className:"message_left_right"},wp.element.createElement("div",{className:"message_list_left"},wp.element.createElement("div",{className:"message_list_head"},v||g.length?"":wp.element.createElement(Oo,null,wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",value:d.search,placeholder:window.vibebp.translations.search_text,onChange:function(e){var t=bo({},d);t.search=e.target.value,f(t)}})),wp.element.createElement("select",{onChange:function(e){var t=bo({},d);t.sorter=e.target.value,f(t)}},Object.keys(window.vibebp.components.messages.sorters).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.messages.sorters[e])})))),wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{id:"selectall",type:"checkbox",checked:v?"checked":"",onClick:function(){v?w(!1):(w(!0),h([]))}}),wp.element.createElement("label",{for:"selectall"})),v||g.length?wp.element.createElement("div",{className:"bulk_actions"},wp.element.createElement("select",{onChange:function(e){S(e.target.value)}},wp.element.createElement("option",null,window.vibebp.translations.selectaction),Object.keys(G).map((function(e){if(e!==d.filter)return wp.element.createElement("option",{value:e},G[e])}))),wp.element.createElement("a",{className:"button is-primary",onClick:function(){var e=uo(r),t=[];N&&(v?e.map((function(e,n){t.push(e.thread_id)})):g.length&&e.map((function(e,n){g.indexOf(e.thread_id)>-1&&t.push(e.thread_id)})),re(t,N))}},window.vibebp.translations.apply)):""),wp.element.createElement("div",{className:"messages"},r.length||_?wp.element.createElement(Oo,null,_?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):r.length?r.map((function(e,n){var a="vicon vicon-star";return a=V==e.thread_id?"vicon vicon-more":"vicon vicon-star",e.star&&(a+=" filled"),wp.element.createElement("div",{className:ie(n)},wp.element.createElement("div",{className:"message_avatars"},Object.keys(e.sender_ids).length?Object.keys(e.sender_ids).map((function(t,n){return Object.keys(e.sender_ids)>3?n<3?wp.element.createElement(zt,{type:"user",id:{user_id:t}}):void 0:wp.element.createElement(zt,{type:"user",id:{user_id:t}})})):"",e.hasOwnProperty("userlinks")?wp.element.createElement("div",{className:"userlinks"},e.userlinks.map((function(e,t){return wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e}})}))):"",Object.keys(e.sender_ids).length>3?wp.element.createElement("span",null,"+"+(Object.keys(e.sender_ids).length-3)+" "+window.vibebp.translations.more):""),wp.element.createElement("div",{className:"message_block_main"},wp.element.createElement("div",{className:"message_block_head"},wp.element.createElement(wr,{time:e.last_message_date}),wp.element.createElement("div",null,wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",onClick:function(){var t=uo(g);v&&(w(!1),r.map((function(e){t.push(e.thread_id)}))),-1===g.indexOf(e.thread_id)?(t.push(e.thread_id),h(t)):(t.splice(g.indexOf(e.thread_id),1),h(t))},checked:v||-1!==g.indexOf(e.thread_id)?"checked":"",id:e.thread_id}),wp.element.createElement("label",{for:e.thread_id})),wp.element.createElement("a",{onClick:function(){e.star?re(e.thread_id,"unstar"):re(e.thread_id,"star")},className:a}),wp.element.createElement("a",{className:"vicon vicon-more rotate90",onClick:function(){p(!m&&e.thread_id)}}),wp.element.createElement(Oo,null,m===e.thread_id?wp.element.createElement("ul",{className:"target_menu"},Object.keys(G).map((function(t){if("unread"!==t&&"read"!==t&&"star"!==t&&"unstar"!==t&&"remove_label"!==t||"unread"===t&&!e.unread_count||"read"===t&&e.unread_count||"unstar"===t&&e.star||"star"===t&&!e.star)return wp.element.createElement("li",{value:t,onClick:function(){re(e.thread_id,t)}},G[t])}))):""))),wp.element.createElement(Ui,{message:e,labels:X,updateLabels:function(e,n){!function(e,n){var r=uo(X);n?r[r.findIndex((function(t){return t.slug===e}))].count++:r[r.findIndex((function(t){return t.slug===e}))].count--,B(r),t.update("messageLabels",r)}(e,n)},show:function(){U(n)}})))})):"",P?wp.element.createElement("a",{className:"link",onClick:function(){var e=bo({},d);e.page+=1,f(e),C(!0)}},window.vibebp.translations.more):""):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_messages_found))),wp.element.createElement("div",{className:"message_main"},D?wp.element.createElement(Zi,{type:D,cancel:function(){L(!1)},update:function(e,t){var n=uo(r);if(e.status){var i={};t.recipients.map((function(t){i[1]={user_id:t,unread_count:1},i[2]={user_id:e.data[0].sender_id,unread_count:0}}));var o={thread_id:e.data[0].thread_id,last_message_date:e.data[0].date_sent,last_message_subject:e.data[0].subject,last_message_content:e.data[0].message,star:0,recipients:i,sender_ids:{0:e.data[0].sender_id},messages:e.data,unread_count:0};n.unshift(o),a(n),U(0),L(!1)}}}):!_&&r.length&&!1!==J?wp.element.createElement(po,{message:r[J],show:function(){U(!1)},action:function(e){return function(e,t){"delete"==t&&fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.messages,"/actions?post"),{method:"post",body:JSON.stringify({id:r[e].thread_id,action:"delete",token:ko("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){var n=uo(r);n.splice(e,1),a(n),U(!1),t.hasOwnProperty("message")&&So("vibebp").addNotification({text:t.message,icon:"vicon vicon-save"})}))}(J,e)}}):""))))};function Ao(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ao(Object(n),!0).forEach((function(t){Io(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ao(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Io(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Co(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return To(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return To(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function To(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Do=wp.element,Lo=(Do.createElement,Do.useState),Mo=Do.useEffect,Jo=Do.Fragment,Uo=(Do.render,wp.data),qo=Uo.dispatch,Fo=Uo.select,zo=function(e){var t=Co(Lo({unfriend:!1,accept:!1,reject:!1,cancel:!1,follow:!1,unfollow:!1}),2),n=t[0],r=t[1],a=Co(Lo(!1),2),i=(a[0],a[1]),o=Co(Lo(e.member),2),l=o[0],c=o[1],s=Co(Lo(!1),2);s[0],s[1];Mo((function(){c(e.member)}),[e.member]);var m=function(t){e.action&&e.action(t);var a=xo({},n);a[t]=!0,r(a),fetch("".concat(window.vibebp.api.url,"/followers/action?post"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({action:t,user:l,token:Fo("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){var a=xo({},n);a[t]=!1,r(a),e.status&&("follow"===t&&(c(xo(xo({},l),{},{is_following:!0})),qo("vibebp").addNotification({message:e.message}),qo("vibebp").sendRealTimeNotification(e.rtm.user_id,e.rtm.message)),"unfollow"===t&&(c(xo(xo({},l),{},{is_following:!1})),qo("vibebp").addNotification({message:e.message}),qo("vibebp").sendRealTimeNotification(e.rtm.user_id,e.rtm.message)))}))};return wp.element.createElement("div",{className:"membercard",onClick:function(){i(!0)}},wp.element.createElement("img",{src:l.avatar}),wp.element.createElement("div",{className:"member_details"},wp.element.createElement("strong",null,l.display_name?l.display_name:l.name?l.name:""),wp.element.createElement(Jo,null,l.hasOwnProperty("is_admin")?l.is_admin?wp.element.createElement("span",{className:"is-highlight is-admin"},window.vibebp.translations.admin):l.is_mod?wp.element.createElement("span",{className:"is-highlight is-mod"},window.vibebp.translations.mod):"":""),wp.element.createElement(Jo,null,l.hasOwnProperty("latest_update")&&l.latest_update?wp.element.createElement("span",null,l.latest_update.content):""),wp.element.createElement("div",{className:"request_actions"},l.hasOwnProperty("is_friend")?wp.element.createElement("a",{className:n.unfriend?"button is-warning is-small vicon vicon-na is-loading":"button is-warning is-small vicon vicon-na",onClick:e.unfriend}):l.hasOwnProperty("is_friend_request")?wp.element.createElement(Jo,null,wp.element.createElement("a",{className:n.accept?"button is-success is-small vicon vicon-face-smile is-loading":"button is-success is-small vicon vicon-face-smile",onClick:function(){return e.action("accept")}}),wp.element.createElement("a",{className:n.reject?"button is-warning is-small vicon vicon-face-sad is-loading":"button is-warning is-small vicon vicon-face-sad",onClick:function(){return e.action("reject")}})):l.hasOwnProperty("is_my_friend_request")?wp.element.createElement(Jo,null,wp.element.createElement("a",{className:n.cancel?"button is-warning is-small vicon vicon-na is-loading":"button is-warning is-small vicon vicon-na",onClick:function(){return e.action("cancel")}})):"",window.vibebp.settings.followers&&!e.hasOwnProperty("no_follow")?l.hasOwnProperty("is_following")&&l.is_following?wp.element.createElement("a",{className:n.unfollow?"button is-info is-small vicon vicon-thumb-down is-loading":"button is-info is-small vicon vicon-thumb-down",onClick:function(){return m("unfollow")}}):wp.element.createElement("a",{className:n.follow?"button is-info is-small vicon vicon-thumb-up is-loading":"button is-info is-small vicon vicon-thumb-up",onClick:function(){return m("follow")}}):"")))};function $o(e){return function(e){if(Array.isArray(e))return Ko(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Bo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ho(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ro(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ho(Object(n),!0).forEach((function(t){Wo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ho(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Bo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bo(e,t){if(e){if("string"==typeof e)return Ko(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ko(e,t):void 0}}function Ko(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Go=wp.element,Yo=(Go.createElement,Go.useState),Vo=Go.useEffect,Qo=(Go.Fragment,Go.render,wp.data),Zo=Qo.dispatch,el=Qo.select,tl=function(e){var t=Xo(Yo(!1),2),n=t[0],r=t[1],a=Xo(Yo({page:1,search:"",sort:"active"}),2),i=a[0],o=a[1],l=Xo(Yo([]),2),c=l[0],s=l[1],m=Xo(Yo(!1),2),p=m[0],u=m[1],d=Xo(Yo(!1),2),f=d[0],b=d[1],v=Xo(Yo(null),2),w=v[0],y=v[1];Vo((function(){w&&w.abort();var e={},t=new AbortController;w&&(e={signal:t.signal}),y(t),r(!0),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.friends,"?").concat(i.search.length?"nocache&":"args="+encodeURIComponent(JSON.stringify(Ro(Ro({},i),{},{search:""})))),Ro(Ro({method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{}},e),{},{body:JSON.stringify(Ro(Ro({},i),{},{token:el("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){if(r(!1),e.status)if(p){u(!1);var t=$o(c);e.data.users.map((function(e){t.push(e)})),s(t),t.length<e.data.total?b(!0):b(!1)}else s(e.data.users),e.data.users.length<e.data.total?b(!0):b(!1)}))}),[i]);var g=function(){o(Ro(Ro({},i),{},{page:1}))};Vo((function(){return document.addEventListener("vibebp_component_reload",g),function(){document.removeEventListener("vibebp_component_reload",g)}}));return wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("div",{className:"header_links"},wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:i.search,onChange:function(e){var t=Ro({},i);t.search=e.target.value,t.page=1,o(t)}}))),wp.element.createElement("div",{className:"header_extras"},wp.element.createElement("select",{onChange:function(e){o(Ro(Ro({},i),{},{sort:e.target.value}))},value:i.sort},Object.keys(window.vibebp.components.friends.sorters).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.friends.sorters[e])}))))),wp.element.createElement("div",{className:"portal_body"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):c.length?wp.element.createElement("div",{className:"friend_list member_list"},c.map((function(e){return wp.element.createElement(zo,{member:Ro(Ro({},e),{},{is_friend:1}),unfriend:function(){!function(e){var t=$o(c);t.splice(c.findIndex((function(t){return t.id===e.id})),1),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.friends,"/removefriendship?post"),{method:"post",body:JSON.stringify({friend_userid:e.id,token:el("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Zo("vibebp").addNotification({text:e.message,icon:"vicon vicon-alert"})})),s(t)}(e)}})})),f?wp.element.createElement("a",{className:"link",onClick:function(){var e=Ro({},i);e.page=i.page+1,u(!0),o(e)}},window.vibebp.translations.more):""):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_friends_found)))};function nl(e){return function(e){if(Array.isArray(e))return cl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ll(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function al(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rl(Object(n),!0).forEach((function(t){il(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function il(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ol(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||ll(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ll(e,t){if(e){if("string"==typeof e)return cl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cl(e,t):void 0}}function cl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var sl=wp.element,ml=(sl.createElement,sl.useState),pl=sl.useEffect,ul=(sl.Fragment,sl.render,wp.data),dl=(ul.dispatch,ul.select),fl=function(e){var t=ol(ml(!1),2),n=t[0],r=t[1],a=ol(ml({requester:0,reload:0,sort:"DESC",page:1}),2),i=a[0],o=a[1],l=ol(ml([]),2),c=l[0],s=l[1],m=ol(ml(!1),2),p=m[0],u=m[1],d=ol(ml(!1),2),f=d[0],b=d[1],v=ol(ml(!1),2),w=v[0],y=v[1],g=ol(ml(!1),2),h=g[0],E=g[1],_=ol(ml([]),2),O=_[0],j=_[1],N=ol(ml(""),2),S=N[0],k=N[1],P=ol(ml([]),2),A=P[0],x=P[1],I=ol(ml(null),2),C=I[0],T=I[1];pl((function(){if(S.length>4){E(!0),C&&C.abort();var e={},t=new AbortController;C&&(e={signal:t.signal}),T(t),fetch("".concat(window.vibebp.api.url,"/search?nocache"),al(al({method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{}},e),{},{body:JSON.stringify({search:S,type:"user",token:dl("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(e){E(!1),e.status&&Array.isArray(e.results)&&(e.results.map((function(e){localforage.setItem("user_"+e.id,JSON.stringify(e))})),x(e.results))}))}}),[S]),pl((function(){fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.friends,"/requests?args=").concat(encodeURIComponent(JSON.stringify(al({},i)))),{method:"post",body:JSON.stringify(al(al({},i),{},{token:dl("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(r(!1),b(!1),e.status)if(p){if(u(!1),e.data.length){var t=nl(c);e.data.map((function(e){t.push(e)})),s(t),20===e.data.length&&b(!0)}}else s(e.data),20===e.data.length&&b(!0)}))}),[i]);var D=function(){o(al(al({},i),{},{page:1}))};pl((function(){return document.addEventListener("vibebp_component_reload",D),function(){document.removeEventListener("vibebp_component_reload",D)}}));var L=function(e,t){var n=c.findIndex((function(t){return t.friendship_id===e}));fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.friends,"/action?post"),{method:"post",body:JSON.stringify({friendship_id:e,action:t,friend_id:c[n].user.ID,token:dl("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){}));var r=nl(c);r.splice(n,1),s(r)};return wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("div",{className:"header_links"},wp.element.createElement("a",{onClick:function(){o(al(al({},i),{},{requester:0}))},className:i.requester?"":"active"},window.vibebp.translations.requestee),wp.element.createElement("a",{onClick:function(){o(al(al({},i),{},{requester:1}))},className:i.requester?"active":""},window.vibebp.translations.requester),wp.element.createElement("a",{onClick:function(){y(!0)},className:"button is-primary"},window.vibebp.translations.add_friend)),wp.element.createElement("div",{className:"header_extras"},wp.element.createElement("select",{onChange:function(e){o(al(al({},i),{},{sort:e.target.value}))},value:i.sort},Object.keys(window.vibebp.components.friends.requests_sorter).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.friends.requests_sorter[e])}))))),w?wp.element.createElement("div",{className:"recipients"},wp.element.createElement("div",{className:"recipients_list"},wp.element.createElement("div",{className:"recipient_items"},O.map((function(e){return wp.element.createElement(zt,{type:"user",click:function(){var t=nl(O);t.splice(t.indexOf(e),1),j(t)},id:{user_id:e}})})),O.length?wp.element.createElement("a",{className:"button is-primary",onClick:function(){fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.friends,"/addfriendship?post"),{method:"post",body:JSON.stringify({friends:O,token:dl("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){o(al(al({},i),{},{reload:1})),j([])})),y(!1)}},window.vibebp.translations.send_friend_request):""),wp.element.createElement("div",{className:h?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:S,placeholder:window.vibebp.translations.search_member,onChange:function(e){k(e.target.value)}}))),A.length?wp.element.createElement("div",{className:"search_results"},A.map((function(e,t){return wp.element.createElement("div",{className:"search_result user",onClick:function(){k("");var n=nl(A),r=nl(O);-1===r.indexOf(e.id)&&(r.push(e.id),j(r),n.splice(t,1),x(n))}},wp.element.createElement("img",{src:e.avatar}),wp.element.createElement("span",null,e.name))}))):""):"",wp.element.createElement("div",{className:"portal_body"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):c.length?wp.element.createElement("div",{className:"friend_list member_list"},c.map((function(e){return i.requester?wp.element.createElement(zo,{member:al(al({},e.user),{},{is_my_friend_request:1}),action:function(t){return L(e.friendship_id,t)},no_follow:1}):wp.element.createElement(zo,{member:al(al({},e.user),{},{is_friend_request:1}),action:function(t){return L(e.friendship_id,t)},no_follow:1})})),f?wp.element.createElement("a",{className:"link",onClick:function(){var e=al({},i);e.page=i.page+1,u(!0),o(e)}},window.vibebp.translations.more):""):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_requests_found)))};function bl(e){return function(e){if(Array.isArray(e))return hl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||gl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||gl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gl(e,t){if(e){if("string"==typeof e)return hl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hl(e,t):void 0}}function hl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var El=wp.element,_l=(El.createElement,El.useState),Ol=El.useEffect,jl=(El.Fragment,El.render,wp.data),Nl=(jl.dispatch,jl.select),Sl=function(e){var t=yl(_l({}),2),n=t[0],r=t[1],a=yl(_l([]),2),i=a[0],o=a[1],l=yl(_l(""),2),c=l[0],s=l[1];return Ol((function(){var e=Nl("vibebp").getMenu().filter((function(e){return"friends"===e.parent}));e.map((function(t,n){-1===e.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&e[n].class.push("current-menu-item")})),o(e),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.friends.label),i.map((function(e,t){var a=e.class.join(" ")+" "+e.css_id;if("compose"!==e.css_id)return wp.element.createElement("a",{className:a,onClick:function(a){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vl(Object(n),!0).forEach((function(t){wl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);l.filter=e.css_id,l.page=1,n.css_id!==l.filter&&r(l),s(e.css_id);var c=bl(i),m=c.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));c[m].class.splice(c[m].class.indexOf("current-menu-item"),1),c[t].class.push("current-menu-item"),o(c)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},"requests"===c?wp.element.createElement(fl,null):wp.element.createElement(tl,null)))};function kl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kl(Object(n),!0).forEach((function(t){Al(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Al(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Il(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Il(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Il(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Cl=wp.element,Tl=(Cl.createElement,Cl.useState),Dl=Cl.useEffect,Ll=(Cl.Fragment,Cl.render,wp.data),Ml=(Ll.dispatch,Ll.select),Jl=function(e){var t=xl(Tl(!1),2),n=t[0],r=t[1],a=xl(Tl({page:1,search:"",orderby:"active"}),2),i=a[0],o=a[1],l=xl(Tl([]),2),s=l[0],m=l[1];c((function(){r(!0),fetch("".concat(window.vibebp.api.url,"/followers?").concat(i.s.length?"nocache":encodeURIComponent(JSON.stringify(Pl(Pl({},i),{},{s:""})))),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(Pl(Pl({},i),{},{token:Ml("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&m(e.followers)}))}),500,[i]);var p=function(){o(Pl(Pl({},i),{},{page:1}))};return Dl((function(){return document.addEventListener("vibebp_component_reload",p),function(){document.removeEventListener("vibebp_component_reload",p)}})),wp.element.createElement("div",{className:"vibebp_followers_wrapper"},wp.element.createElement("div",{className:"vibebp_main_head vibebp_form"},wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_member,value:i.search,onChange:function(e){return o(Pl(Pl({},i),{},{search:e.target.value}))}})),wp.element.createElement("select",{onChange:function(e){return o(Pl(Pl({},i),{},{orderby:e.target.value}))}},Object.keys(window.vibebp.components.followers.sorters).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.followers.sorters[e])})))),wp.element.createElement("div",{className:"vibebp_followers"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):s.length?s.map((function(e){return wp.element.createElement(zo,{member:e})})):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_followers)))};function Ul(e){return function(e){if(Array.isArray(e))return Rl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Hl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ql(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ql(Object(n),!0).forEach((function(t){zl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ql(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Hl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hl(e,t){if(e){if("string"==typeof e)return Rl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rl(e,t):void 0}}function Rl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wl=wp.element,Xl=(Wl.createElement,Wl.useState),Bl=Wl.useEffect,Kl=(Wl.Fragment,Wl.render,wp.data),Gl=Kl.dispatch,Yl=Kl.select,Vl=function(e){var t=$l(Xl(!1),2),n=t[0],r=t[1],a=$l(Xl({page:1,search:"",orderby:"active"}),2),i=a[0],o=a[1],l=$l(Xl([]),2),s=l[0],m=l[1],p=$l(Xl(!1),2),u=p[0],d=p[1],f=$l(Xl([]),2),b=f[0],v=f[1],w=$l(Xl(""),2),y=w[0],g=w[1],h=$l(Xl([]),2),E=h[0],_=h[1],O=$l(Xl(!1),2),j=(O[0],O[1]),N=$l(Xl(!1),2),S=(N[0],N[1]),k=$l(Xl(null),2),P=k[0],A=k[1];c((function(){P&&P.abort();var e={},t=new AbortController;P&&(e={signal:t.signal}),A(t),r(!0),fetch("".concat(window.vibebp.api.url,"/following?").concat(i.s.length?"nocache":encodeURIComponent(JSON.stringify(Fl(Fl({},i),{},{s:""})))),Fl(Fl({method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{}},e),{},{body:JSON.stringify(Fl(Fl({},i),{},{token:Yl("vibebp").getToken()}))})).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&m(e.following)}))}),500,[i]);var x=function(){o(Fl(Fl({},i),{},{page:1}))};Bl((function(){return document.addEventListener("vibebp_component_reload",x),function(){document.removeEventListener("vibebp_component_reload",x)}})),c((function(){y.length>4&&(j(!0),fetch("".concat(window.vibebp.api.url,"/search"),{method:"post",body:JSON.stringify({search:y,type:"user",token:Yl("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){j(!1),e.status&&Array.isArray(e.results)&&(e.results.map((function(e){localforage.setItem("user_"+e.id,JSON.stringify(e))})),_(e.results))})))}),500,[y]);return wp.element.createElement("div",{className:"vibebp_followers_wrapper"},wp.element.createElement("div",{className:"vibebp_followers_header vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_member,value:i.search,onChange:function(e){return o(Fl(Fl({},i),{},{search:e.target.value}))}})),u?wp.element.createElement("div",{className:"add_member_wrapper recipients"},b.length?wp.element.createElement("div",{className:"add_following_wrapper"},b.map((function(e,t){return wp.element.createElement(zt,{type:"user",click:function(){var e=Ul(b);e.splice(t,1),v(e)},id:{user_id:e.id}})})),wp.element.createElement("a",{className:"vicon vicon-plus button is-link",onClick:function(){S(!0),fetch("".concat(window.vibebp.api.url,"/followers/action"),{method:"post",body:JSON.stringify({followers:b,action:"follow",token:Yl("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(S(!1),e.status){d(!1);var t=Ul(b);t.map((function(e,n){t[n].is_following=1}));var n=[].concat(Ul(s),Ul(t));m(n),e.hasOwnProperty("message")&&e.message.length&&e.message.map((function(e){Gl("vibebp").addNotification({icon:"vicon vicon-thumb-up",message:e})})),e.hasOwnProperty("rtm")&&e.rtm.length&&e.rtm.map((function(e){Gl("vibebp").sendRealTimeNotification(e.user_id,e.message)}))}else e.hasOwnProperty("message")&&Gl("vibebp").addNotification({text:e.message})}))}})):"",wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_member,value:y,onChange:function(e){return g(e.target.value)}}),E.length?wp.element.createElement("div",{className:"search_results"},E.map((function(e,t){return wp.element.createElement("div",{className:"search_result user",onClick:function(){g("");var n=Ul(E),r=Ul(b);-1===r.indexOf(e)&&(r.push(e),v(r),n.splice(t,1),_(n))}},wp.element.createElement("img",{src:e.avatar}),wp.element.createElement("span",null,e.name))}))):""):wp.element.createElement("a",{className:"button is-primary",onClick:function(){return d(!0)}},window.vibebp.translations.follow_members)),wp.element.createElement("select",{onChange:function(e){return o(Fl(Fl({},i),{},{orderby:e.target.value}))}},Object.keys(window.vibebp.components.followers.sorters).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.followers.sorters[e])})))),wp.element.createElement("div",{className:"vibebp_followers"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):s.length?s.map((function(e){return wp.element.createElement(zo,{member:e})})):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_following)))};function Ql(e){return function(e){if(Array.isArray(e))return rc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||nc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ec(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||nc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nc(e,t){if(e){if("string"==typeof e)return rc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rc(e,t):void 0}}function rc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ac=wp.element,ic=(ac.createElement,ac.useState),oc=ac.useEffect,lc=(ac.Fragment,ac.render,wp.data),cc=(lc.dispatch,lc.select),sc=function(e){var t=tc(ic({}),2),n=t[0],r=t[1],a=tc(ic([]),2),i=a[0],o=a[1],l=tc(ic(""),2),c=l[0],s=l[1];return oc((function(){var e=cc("vibebp").getMenu().filter((function(e){return"followers"===e.parent}));e.map((function(t,n){-1===e.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&e[n].class.push("current-menu-item")})),o(e),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.followers.label),i.map((function(e,t){var a=e.class.join(" ")+" "+e.css_id;return wp.element.createElement("a",{className:a,onClick:function(a){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zl(Object(n),!0).forEach((function(t){ec(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);l.filter=e.css_id,l.page=1,n.css_id!==l.filter&&r(l),s(e.css_id);var c=Ql(i),m=c.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));c[m].class.splice(c[m].class.indexOf("current-menu-item"),1),c[t].class.push("current-menu-item"),o(c)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},"following"===c?wp.element.createElement(Vl,null):wp.element.createElement(Jl,null)))};function mc(e){return function(e){if(Array.isArray(e))return vc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||bc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pc(Object(n),!0).forEach((function(t){dc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||bc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bc(e,t){if(e){if("string"==typeof e)return vc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vc(e,t):void 0}}function vc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wc=wp.element,yc=(wc.createElement,wc.useState),gc=wc.useEffect,hc=wc.Fragment,Ec=(wc.render,wp.data),_c=Ec.dispatch,Oc=Ec.select,jc=function(e){var t=fc(yc(!0),2),n=t[0],r=t[1],a=fc(yc({component:"",id:"",search_terms:"",type:"",role:"",page:1}),2),i=a[0],o=a[1],l=fc(yc([]),2),s=l[0],m=l[1],p=fc(yc(!1),2),u=p[0],d=p[1],f=fc(yc(!1),2),b=f[0],v=f[1],w=fc(yc([]),2),y=w[0],g=w[1],h=fc(yc(""),2),E=h[0],_=h[1],O=fc(yc([]),2),j=O[0],N=O[1],S=fc(yc([]),2),k=S[0],P=S[1],A=fc(yc({}),2),x=A[0],I=A[1],C=fc(yc(null),2),T=C[0],D=C[1],L=fc(yc(!1),2),M=L[0],J=L[1];gc((function(){if(e.hasOwnProperty("type")){var t=uc({},i);t.component=e.type,t.id=e.id,o(t)}}),[e.type,e.id]),c((function(){if(E.length>4){T&&T.abort();var e={},t=new AbortController;T&&(e={signal:t.signal}),D(t),fetch("".concat(window.vibebp.api.url,"/search?nocache"),uc(uc({method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{}},e),{},{body:JSON.stringify({search:E,type:"user",token:Oc("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(e){e.status&&Array.isArray(e.results)&&(e.results.map((function(e){localforage.setItem("user_"+e.id,JSON.stringify(e))})),N(e.results))}))}}),500,[E]),gc((function(){var t=uc({},i);t.token=Oc("vibebp").getToken();var n=Oc("vibebp").getUser();t.user_id=n.id,r(!0);var a=window.vibebp.api.endpoints.members;i.component!==window.vibebp.api.endpoints.members&&(a=e.type+"/members/"+e.id),T&&T.abort();var o={},l=new AbortController;T&&(o={signal:l.signal}),D(l),console.log(M),M&&(a+="?force"),fetch("".concat(window.vibebp.api.url,"/").concat(a),uc(uc({method:"post"},o),{},{body:JSON.stringify(t)})).then((function(e){return e.json()})).then((function(e){J(!1),r(!1),e.status&&(I(e.meta),m(e.data.members))}))}),[i]);return wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("div",{className:"header_links"},wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",value:i.search_terms,placeholder:window.vibebp.translations.search_member,onChange:function(e){var t=uc({},i);t.search_terms=e.target.value,o(t)}}))),wp.element.createElement("div",{className:"header_extras"},wp.element.createElement("select",{value:i.role,onChange:function(e){o(uc(uc({},i),{},{role:e.target.value}))}},Object.keys(window.vibebp.components[e.type].membertypes).map((function(t){return wp.element.createElement("option",{value:t},window.vibebp.components[e.type].membertypes[t])}))))),wp.element.createElement("div",{className:"portal_body"},wp.element.createElement("div",{className:"members"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):s.length?s.map((function(t){return e.hasOwnProperty("type")?wp.element.createElement("div",{className:k.indexOf(t.ID)>-1?"selected":"",onClick:function(){var e=mc(k);k.indexOf(t.ID)>-1?e.splice(k.indexOf(t.ID),1):e.push(t.ID),P(e)}},wp.element.createElement(zo,{member:t,type:e.type,id:e.id})):wp.element.createElement("div",{className:k.indexOf(t.ID)>-1?"selected":""},wp.element.createElement(zo,{member:t}))})):"")),wp.element.createElement("div",{className:"portal_footer"},"groups"===i.component?u?wp.element.createElement("div",{className:"recipients"},wp.element.createElement("div",{className:"recipients_list"},wp.element.createElement("div",{className:"recipient_items"},y.length?wp.element.createElement(hc,null,y.map((function(e){return wp.element.createElement(zt,{type:"user",click:function(){var t=mc(y);t.splice(t.indexOf(e),1),g(t)},id:{user_id:e}})})),wp.element.createElement("a",{className:b?"is-loading button":"button vicon vicon-control-forward",onClick:function(){"invite"==u&&(v(!0),fetch("".concat(window.vibebp.api.url,"/groups/invite_member/").concat(e.id,"/?").concat(encodeURIComponent(JSON.stringify(uc(uc({},i),{},{search_terms:""}))),"&post"),{method:"post",body:JSON.stringify({invitees:y,token:Oc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){v(!1),r(!1),e.status&&(d(!1),N([]),_([])),e.hasOwnProperty("message")&&_c("vibebp").addNotification({text:e.message}),J(!0);var t=uc({},i);t.page=1,o(t)}))),"add"==u&&(v(!0),fetch("".concat(window.vibebp.api.url,"/groups/join_group/").concat(e.id,"/?post"),{method:"post",body:JSON.stringify({invitees:y,token:Oc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){v(!1),r(!1),e.status&&(d(!1),N([]),_([])),e.hasOwnProperty("message")&&_c("vibebp").addNotification({text:e.message}),J(!0);var t=uc({},i);t.page=1,o(t)}))),"requests"==u&&(v(!0),fetch("".concat(window.vibebp.api.url,"/groups/requests/").concat(e.id,"/?").concat(encodeURIComponent(JSON.stringify(uc(uc({},i),{},{search_terms:""}))),"&post"),{method:"post",body:JSON.stringify({invitees:y,token:Oc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){v(!1),r(!1),e.status&&(d(!1),N([]),_([])),e.hasOwnProperty("message")&&_c("vibebp").addNotification({text:e.message}),J(!0);var t=uc({},i);t.page=1,o(t)})))}}),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){d(!1)}})):""),wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",value:E,placeholder:window.vibebp.translations.search_member,onChange:function(e){_(e.target.value)}})),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){d(!1)}}))),j.length?wp.element.createElement("div",{className:"search_results"},j.map((function(e,t){return wp.element.createElement("div",{className:"search_result user",onClick:function(){_("");var n=mc(j),r=mc(y);-1===r.indexOf(e.id)&&(r.push(e.id),g(r),n.splice(t,1),N(n))}},wp.element.createElement("img",{src:e.avatar}),wp.element.createElement("span",null,e.name))}))):""):wp.element.createElement("div",{className:"actions"},!k.length&&!u&&x.hasOwnProperty("can_invite")&&x.can_invite?wp.element.createElement("a",{onClick:function(){return d("invite")},className:"button is-primary"},window.vibebp.translations.invite_members):"",!u&&x.hasOwnProperty("can_add_members")&&x.can_add_members?wp.element.createElement(hc,null,k.length?"":wp.element.createElement("a",{onClick:function(){return d("add")},className:"button is-info"},window.vibebp.translations.add_members),k.length&&x.member_actions?wp.element.createElement("div",{className:"members_actions_block"},wp.element.createElement("select",{onChange:function(t){k.length&&e.memberActions(t.target.value,k).then((function(){J(!0),P([]),o(uc({},i))}))}},wp.element.createElement("option",null,window.vibebp.translations.select_action),Object.keys(x.member_actions).map((function(e){return wp.element.createElement("option",{value:e},x.member_actions[e])})))):""):""):""))};function Nc(e){return function(e){if(Array.isArray(e))return Ic(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||xc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sc(Object(n),!0).forEach((function(t){Pc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ac(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||xc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xc(e,t){if(e){if("string"==typeof e)return Ic(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ic(e,t):void 0}}function Ic(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Cc=wp.element,Tc=(Cc.createElement,Cc.useState),Dc=Cc.useEffect,Lc=Cc.Fragment,Mc=(Cc.render,wp.data),Jc=(Mc.dispatch,Mc.select),Uc=function(e){var t=Ac(Tc(!1),2),n=t[0],r=t[1],a=Ac(Tc({avatar:{url:"",cropdata:""},name:"",description:"",status:"public",invite_status:"members",group_type:"",invitees:[],meta:[]}),2),i=a[0],o=a[1],l=Ac(Tc(""),2),s=l[0],m=l[1],p=Ac(Tc(""),2),u=p[0],d=p[1],f=Ac(Tc([]),2),b=f[0],v=f[1],w=Ac(Tc(!1),2),y=w[0],g=w[1],h=Ac(Tc(!0),2),E=h[0],_=h[1],O=Ac(Tc(!1),2),j=O[0],N=O[1],S=Ac(Tc(!1),2),k=S[0],P=S[1],A=Ac(Tc([]),2),x=A[0],I=A[1],C=Ac(Tc(null),2),T=C[0],D=C[1];Dc((function(){if(e.hasOwnProperty("group")){var t={url:e.group.avatar,cropdata:""};e.group.avatar.length&&_(!1),o(kc(kc({},i),{},{id:e.group.id,name:e.group.name,description:e.group.description,status:e.group.status,avatar:t}))}}),[]),c((function(){if(window.helpdesk&&k.length>4){T&&T.abort();var e={},t=new AbortController;T&&(e={signal:t.signal}),D(t),N(!0),fetch("".concat(window.helpdesk.api.url,"/bbp/forums?nocache"),kc(kc({method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{}},e),{},{body:JSON.stringify({s:k,token:Jc("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(e){N(!1),I(e.data)}))}}),500,[k]),c((function(){if(u.length>3){g(!0),T&&T.abort();var e={},t=new AbortController;T&&(e={signal:t.signal}),D(t),fetch("".concat(window.vibebp.api.url,"/search?nocache"),kc(kc({method:"post"},e),{},{body:JSON.stringify({search:u,type:"user",token:Jc("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(e){e.status&&(g(!1),Array.isArray(e.results)&&(e.results.map((function(e){localforage.setItem("user_"+e.id,JSON.stringify(e))})),v(e.results)))}))}}),500,[u]);var L="button is-fullwidth is-primary is-rounded";n&&(L+=" is-loading");var M=!0;return e.hasOwnProperty("meta")&&e.meta.hasOwnProperty("can_invite")&&!e.meta.can_invite&&(M=!1),wp.element.createElement("div",{className:"vibebp_create_group create_form"},wp.element.createElement("div",{className:"create_form_head"},wp.element.createElement("div",{className:"left_side"},wp.element.createElement("i",{className:"vicon vicon-arrow-left",onClick:function(){e.newgroup(!1)}})),wp.element.createElement("div",{className:"right_side"})),wp.element.createElement("div",{className:"group_creation_steps"},wp.element.createElement("div",{className:"group_step"},wp.element.createElement("div",{className:"group_avatar"},i.avatar.url.length&&!E?wp.element.createElement(Lc,null,wp.element.createElement("img",{src:i.avatar.url}),wp.element.createElement("div",{onClick:function(){_(!0)},className:"vicon vicon-image"})):wp.element.createElement(Lc,null,wp.element.createElement(Yn,{type:"image",crop:"1",show:function(){return _(!1)},update:function(e,t){m(e);var n=kc({},i);n.avatar.cropdata=t,o(n)}}),wp.element.createElement("div",{onClick:function(){_(!1)},className:"vicon vicon-image"}))),wp.element.createElement("div",{className:"group_creation_step vibebp_form"},wp.element.createElement("div",{className:"group_name vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.group_name),wp.element.createElement("input",{type:"text",value:i.name,onChange:function(e){o(kc(kc({},i),{},{name:e.target.value}))}})),wp.element.createElement("div",{className:"group_description vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.group_description),wp.element.createElement("textarea",{onChange:function(e){o(kc(kc({},i),{},{description:e.target.value}))},value:i.description})))),wp.element.createElement("div",{className:"group_step vibebp_form"},Object.keys(window.vibebp.components.groups.type).length&&window.vibebp.components.groups.hasOwnProperty("type")?wp.element.createElement("div",{className:"group_name vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.group_type),wp.element.createElement("select",{onChange:function(e){o(kc(kc({},i),{},{group_type:e.target.value}))},value:i.group_type},wp.element.createElement("option",null,window.vibebp.translations.select_group_type),Object.keys(window.vibebp.components.groups.type).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.groups.type[e])})))):"",window.vibebp.components.groups.hasOwnProperty("forum")?wp.element.createElement("div",{className:"group_name vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.set_group_forum),i.meta.findIndex((function(e){return"forum_id"==e.meta_key}))>-1?wp.element.createElement("span",{onClick:function(){var e=kc({},i);e.meta.splice(i.meta.findIndex((function(e){return"forum_id"==e.meta_key})),1),o(e)}},wp.element.createElement(zt,{type:"forum",id:{post_id:i.meta[i.meta.findIndex((function(e){return"forum_id"==e.meta_key}))].meta_value}})):wp.element.createElement("div",{className:"search_forums"},wp.element.createElement("div",{className:j?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:k||"",placeholder:window.vibebp.translations.search_text,onChange:function(e){return P(e.target.value)}})),x.length?wp.element.createElement("div",{className:"group_forums"},x.map((function(e){return wp.element.createElement("span",{onClick:function(){var t=kc({},i);i.meta.findIndex((function(e){return"forum_id"==e.meta_key}))>-1&&t.meta.splice(i.meta.findIndex((function(e){return"forum_id"==e.meta_key})),1),t.meta.push({meta_key:"forum_id",meta_value:e.id}),o(t)}},e.title)}))):"")):"",wp.element.createElement("div",{className:"group_name vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.group_status),wp.element.createElement("select",{onChange:function(e){o(kc(kc({},i),{},{status:e.target.value}))},value:i.status},Object.keys(window.vibebp.components.groups.status).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.groups.status[e])})))),wp.element.createElement("div",{className:"group_name vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.group_invitations),wp.element.createElement("select",{onChange:function(e){o(kc(kc({},i),{},{invite_status:e.target.value}))},value:i.invite_status},Object.keys(window.vibebp.components.groups.invite_status).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.groups.invite_status[e])}))))),M?wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"group_name vibebp_form_field"},wp.element.createElement("div",{className:"recipients"},wp.element.createElement("label",null,window.vibebp.translations.invite_members),wp.element.createElement("div",{className:"recipients_list"},wp.element.createElement("div",{className:"recipient_items"},i.invitees.map((function(e){return wp.element.createElement(zt,{type:"user",click:function(){var t=kc({},i);t.invitees.splice(t.invitees.indexOf(e),1),o(t)},id:{user_id:e}})}))),wp.element.createElement("div",{className:y?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:u,placeholder:window.vibebp.translations.search_member,onChange:function(e){d(e.target.value)}}))),b.length?wp.element.createElement("div",{className:"search_results"},b.map((function(e,t){return wp.element.createElement("div",{className:"search_result user",onClick:function(){d("");var n=Nc(b),r=kc({},i);-1===r.invitees.indexOf(e.id)&&(r.invitees.push(e.id),o(r),n.splice(t,1),v(n))}},wp.element.createElement("img",{src:e.avatar}),wp.element.createElement("span",null,e.name))}))):""))):"",wp.element.createElement("br",null),wp.element.createElement("a",{onClick:function(){r(!0);var t=kc(kc({},i),{},{token:Jc("vibebp").getToken()}),n=new FormData;n.append("body",JSON.stringify(t)),n.append("file",s[0]),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"/create_update_group?upload"),{method:"post",body:n}).then((function(e){return e.json()})).then((function(t){r(!1),t.status&&e.newgroup(t.data)}))},className:L},window.vibebp.translations.create_group)))};function qc(e){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fc(Object(n),!0).forEach((function(t){$c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Rc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rc(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wc=wp.element,Xc=(Wc.createElement,Wc.useState),Bc=Wc.useEffect,Kc=Wc.Fragment,Gc=(Wc.render,Wc.useRef),Yc=wp.data,Vc=Yc.dispatch,Qc=Yc.select,Zc=Math.round(100*Math.random()),es=function(e){var t=Gc(null),n=Hc(Xc(!1),2),r=n[0],a=(n[1],Hc(Xc(!1),2)),i=a[0],o=a[1],l=Hc(Xc(""),2),c=(l[0],l[1],Hc(Xc({}),2)),s=c[0],m=c[1],p=Hc(Xc(null),2),u=p[0],d=p[1],f=Hc(Xc(!1),2),b=f[0],v=(f[1],Hc(Xc([]),2)),w=(v[0],v[1],Hc(Xc(zc({},e.group)),2)),y=w[0],g=w[1],h=Hc(Xc(!1),2),E=h[0],_=h[1],O=Hc(Xc({}),2),j=O[0],N=O[1],S=Hc(Xc(!1),2),k=S[0],P=S[1];Bc((function(){A()}),[]);var A=function(){fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"/").concat(y.id),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({context:"meta",token:Qc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(e.status&&(N(e.data),e.hasOwnProperty("tabs")&&(m(e.tabs),d(Object.keys(e.tabs)[0])),e.hasOwnProperty("cover")&&e.cover.length)){var t=zc({},y);t.cover=e.cover,g(t)}}))};Bc((function(){return document.addEventListener("vibebp_component_reload",A),function(){document.removeEventListener("vibebp_component_reload",A)}})),Bc((function(){if("home"!==u)if(u&&u.indexOf("#")>-1){var e=window.location.href.split("#");Array.isArray(e)&&e.length>1&&(console.log(u.split("#")[1].split("&")[0].split("=")[1]),u.split("#")[1].split("&")[0].split("=")[1]&&(window.location.href+=e[0].activeTab,Vc("vibebp").setComponent(u.split("#")[1].split("&")[0].split("=")[1])))}else{var t=new CustomEvent("group_tab",{detail:{tab:u,group:y}});document.dispatchEvent(t)}}),[u]);var x={};return y.hasOwnProperty("cover")&&y.cover.length&&(x={background:"linear-gradient(rgba(0, 0, 0, 0.05),rgba(0, 0, 0, 0.3)) , url("+y.cover+")"}),wp.element.createElement(Kc,null,E?wp.element.createElement(Uc,{group:y,newgroup:function(e){e?(g(e),_(!1)):_(!1)},meta:j}):wp.element.createElement("div",{className:"vibebp_full_group"},wp.element.createElement("div",{className:"group_head",style:x},wp.element.createElement("div",{className:"leftright_wrapper group_top"},wp.element.createElement("div",{className:"left_side"},wp.element.createElement("i",{className:"vicon vicon-arrow-left",onClick:function(){e.show()}})),wp.element.createElement("div",{className:"right_side"},window.vibebp.components.hasOwnProperty("groups")&&window.vibebp.components.groups.hasOwnProperty("cover")&&window.vibebp.components.groups.cover?wp.element.createElement("label",{for:"fileupload_"+Zc,className:i?"small button is-primary is-loading":"small button is-primary"},i?"":window.vibebp.translations.change_cover,wp.element.createElement("input",{id:"fileupload_"+Zc,ref:t,type:"file",accept:"image/*",onChange:function(e){if(t.current.files[0].size<window.vibebp.settings.upload_limit){o(!0);var n={token:Qc("vibebp").getToken(),item_id:y.id},r=new FormData;r.append("body",JSON.stringify(n)),r.append("file",t.current.files[0]),fetch("".concat(window.vibebp.api.url,"/component/cover"),{method:"post",body:r}).then((function(e){return e.json()})).then((function(e){if(o(!1),e.hasOwnProperty("data")&&e.data.hasOwnProperty("message")&&Vc("vibebp").addNotification({text:e.data.message}),e.success&&e.hasOwnProperty("data")){console.log(e.data),Qc("vibebp").getUser().cover=e.data.url;var t=zc({},y);t.cover=e.data.url,g(t)}}))}else Vc("vibebp").addNotification({text:window.vibebp.translations.image_size_error})},style:{display:"none"}})):"",wp.element.createElement("a",{onClick:function(){fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"/member_actions?post"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({action:"leave_group",members:[Qc("vibebp").getUser().id],group_id:y.id,token:Qc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.status&&e.show(),t.hasOwnProperty("message")&&Vc("vibebp").addNotification({text:t.message})}))},className:b?"small button is-primary is-loading":"small button is-primary"},b?"":window.vibebp.translations.leave_group),j&&j.hasOwnProperty("is_admin")&&j.is_admin?wp.element.createElement("a",{className:"button is-primary small",onClick:function(){_(!0)}},wp.element.createElement("span",{className:"vicon vicon-settings"})):"")),wp.element.createElement("div",{className:"group_bottom"},wp.element.createElement("div",{className:"group_avatar"},wp.element.createElement("img",{src:y.avatar})),wp.element.createElement("div",{className:"group_title"},wp.element.createElement("h1",{dangerouslySetInnerHTML:{__html:y.name}}),wp.element.createElement("div",{className:k?"group_description active":"group_description",onClick:function(){k&&P(!1)}},wp.element.createElement("p",{dangerouslySetInnerHTML:{__html:y.description}}),!k&&y.hasOwnProperty("description")&&y.description.length>180?wp.element.createElement("span",{className:"more",onClick:function(){P(!0)}},window.vibebp.translations.more):"")))),r?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement("div",{className:"group_content"},Object.keys(s).length>1?wp.element.createElement("div",{className:"content_tabs_wrapper"},Object.keys(s).map((function(e){return wp.element.createElement("div",{className:u==e?"content_tab active":"content_tab",onClick:function(){d(e)}},wp.element.createElement("span",null,s[e]))}))):"",u&&"home"!=u?wp.element.createElement("div",{className:"group_content_wrapper"},wp.element.createElement("div",{id:u})):wp.element.createElement("div",{className:"leftright_wrapper"},wp.element.createElement("span",null),wp.element.createElement("div",{className:"left_side"},wp.element.createElement(Xr,{type:"groups",id:e.group.id})),wp.element.createElement("div",{className:"right_side"},wp.element.createElement(jc,{type:"groups",id:y.id,object:y,memberActions:function(e,t){return fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"/member_actions?post"),{method:"post",body:JSON.stringify({action:e,members:t,group_id:y.id,token:Qc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&g(zc(zc({},y),{},{id:y.id})),e.hasOwnProperty("message")&&Vc("vibebp").addNotification({text:e.message})}))}}),"object"===qc(j)?Object.keys(j).map((function(e){if("invite_status"!==e&&"last_activity"!==e&&"total_member_count"!==e){var t=new CustomEvent("meta_key",{detail:j[e]});return document.dispatchEvent(t),wp.element.createElement("div",{id:e})}})):"")))))},ts=wp.element,ns=(ts.createElement,ts.useState,ts.useEffect,ts.Fragment,ts.render,wp.data),rs=(ns.dispatch,ns.select,function(e){return wp.element.createElement("div",{className:"vibebp_group",onClick:function(){e.show()}},wp.element.createElement("div",{className:"group_avatar"},wp.element.createElement("img",{src:e.group.avatar})),wp.element.createElement("div",{className:"group_name"},wp.element.createElement("strong",null,e.group.name)))}),as=wp.element,is=(as.createElement,as.useState,as.useEffect,as.Fragment,as.render,wp.data),os=(is.dispatch,is.select,function(e){return wp.element.createElement("div",{className:"vibebp_group_invite"},wp.element.createElement("div",{className:"group_avatar"},wp.element.createElement("img",{src:e.invite.item.avatar})),wp.element.createElement("div",{className:"group_name"},wp.element.createElement("strong",null,e.invite.item.name),wp.element.createElement("span",null,window.vibebp.components.groups[e.invite.item.status])),wp.element.createElement("div",{className:"inviter"},wp.element.createElement(zt,{type:"user",id:{user_id:e.invite.inviter_id}})),wp.element.createElement("div",{className:"group_invite_time"},wp.element.createElement(wr,{time:e.invite.item.date_modified})),wp.element.createElement("div",{className:"group_actions"},wp.element.createElement("a",{className:"vicon vicon-check",onClick:function(){e.action(e.invite.item.id,"accept",e.invite.id)}}),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){e.action(e.invite.item.id,"reject",e.invite.id)}}),wp.element.createElement("a",{className:"vicon vicon-trash",onClick:function(){e.action(e.invite.item.id,"delete",e.invite.id)}})))});function ls(e){return function(e){if(Array.isArray(e))return ds(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||us(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ss(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cs(Object(n),!0).forEach((function(t){ms(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ms(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ps(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||us(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function us(e,t){if(e){if("string"==typeof e)return ds(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ds(e,t):void 0}}function ds(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fs=wp.element,bs=(fs.createElement,fs.useState),vs=fs.useEffect,ws=fs.Fragment,ys=(fs.render,wp.data),gs=ys.dispatch,hs=ys.select,Es=function(e){var t=ps(bs([]),2),n=t[0],r=t[1],a=ps(bs({page:1,orderby:"",accepted:"pending"}),2),i=a[0],o=a[1],l=ps(bs(""),2),s=(l[0],l[1]),m=ps(bs([]),2),p=m[0],u=m[1],d=ps(bs(!1),2),f=d[0],b=d[1],v=ps(bs(window.vibebp.components.groups.actions),2),w=(v[0],v[1],ps(bs([]),2)),y=w[0],g=w[1],h=ps(bs(!1),2),E=(h[0],h[1],ps(bs({mine:"unread",type:"",include:"",page:1,search_terms:"",label:""}),2)),_=E[0],O=E[1],j=ps(bs(!1),2),N=j[0],S=j[1],k=ps(bs(!1),2),P=k[0],A=k[1],x=ps(bs(!1),2),I=x[0],C=x[1],T=ps(bs(!1),2),D=T[0],L=T[1],M=ps(bs(!1),2),J=(M[0],M[1],ps(bs({text:"",color:"#000"}),2)),U=(J[0],J[1],ps(bs(""),2)),q=U[0],F=U[1],z=ps(bs(!1),2),$=z[0],H=z[1],R=ps(bs(null),2),W=R[0],X=R[1];vs((function(){var e=hs("vibebp").getAction();if(e&&"view"==e){var t=hs("vibebp").getId();t&&O(ss(ss({},_),{},{include:[t]}))}else _.include&&O(ss(ss({},_),{},{include:""}));var n=hs("vibebp").getMenu().filter((function(e){return"groups"===e.parent}));n.map((function(e,t){-1===n.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&-1==n[0].class.indexOf("current-menu-item")&&n[0].class.push("current-menu-item")})),g(n),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),c((function(){if("invites"===q)b(!0),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"/").concat(q,"?").concat(encodeURIComponent(JSON.stringify(ss({},i)))),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(ss(ss({},i),{},{token:hs("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(b(!1),e.status)if(P){var t=ls(n);e.data.invites.map((function(e){t.push(e)})),r(ngroups),A(!1),t.length<e.data.total?S(!0):S(!1)}else r(e.data.invites),e.data.invites.length<e.data.total?S(!0):S(!1);else e.hasOwnProperty("message")&&s(e.message),r([])}));else{var e=ss({},_);e.token=hs("vibebp").getToken();var t=hs("vibebp").getUser();e.user_id=t.id,W&&W.abort();var a={},o=new AbortController;W&&(a={signal:o.signal}),X(o),b(!0),fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"?").concat(_.search_terms.length?"nocache":encodeURIComponent(JSON.stringify(ss(ss({},_),{},{search_terms:""})))),ss(ss({method:"post"},a),{},{body:JSON.stringify(e)})).then((function(e){return e.json()})).then((function(t){if(b(!1),t.status){if(P){var n=ls(p);t.data.groups.map((function(e){n.push(e)})),u(n),A(!1),n.length<t.data.total?S(!0):S(!1)}else u(t.data.groups),e.include&&L(0),t.data.groups.length<t.data.total?S(!0):S(!1);t.hasOwnProperty("can_create_groups")&&H(t.can_create_groups)}else u([])}))}}),500,[_,i,q]);var B=function(){O(ss(ss({},_),{},{page:1}))};vs((function(){return document.addEventListener("vibebp_component_reload",B),function(){document.removeEventListener("vibebp_component_reload",B)}}));var K=function(e,t,a){var i=ls(n);fetch("".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"/invite/").concat(e),{method:"post",body:JSON.stringify({token:hs("vibebp").getToken(),action:t})}).then((function(e){return e.json()})).then((function(e){e.status&&(i.splice(n.findIndex((function(e){return e.id===a})),1),r(i))}))};return wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.groups.label),y.map((function(e,t){var n=e.class.join(" ")+" "+e.css_id;if("compose"!==e.css_id)return wp.element.createElement("a",{className:n,onClick:function(n){var r=ss({},_);r.filter=e.css_id,r.page=1,L(!1),C(!1),_.css_id!==r.filter&&O(r),F(e.css_id);var a=ls(y),i=a.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));a[i].class.splice(a[i].class.indexOf("current-menu-item"),1),a[t].class.push("current-menu-item"),g(a)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},I?wp.element.createElement(Uc,{newgroup:function(e){if(e){var t=ls(p);t.unshift(e),u(t);var n="".concat(window.vibebp.api.url,"/").concat(window.vibebp.api.endpoints.groups,"?").concat(encodeURIComponent(JSON.stringify(ss(ss({},_),{},{search_terms:""}))));localforage.getItem(n).then((function(e){var r=JSON.parse(e);r.data.groups=t,localforage.setItem(n,JSON.stringify(r))})),C(!1),L(0)}else C(!1)}}):!1!==D?wp.element.createElement(es,{group:p[D],show:function(){L(!1),O(ss(ss({},_),{},{include:""})),gs("vibebp").setId(!1),gs("vibebp").setAction(!1)}}):wp.element.createElement(ws,null,wp.element.createElement("div",{className:"vibebp_main_head"},"invites"===q?wp.element.createElement(ws,null,wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",value:i.search_terms,placeholder:window.vibebp.translations.search_text,onChange:function(e){var t=ss({},i);t.search_terms=e.target.value,o(t)}})),wp.element.createElement("div",null,wp.element.createElement("select",{onChange:function(e){var t=ss({},i);t.accepted=e.target.value,o(t)}},Object.keys(window.vibebp.components.groups.invite_type).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.groups.invite_type[e])}))),wp.element.createElement("select",{onChange:function(e){var t=ss({},i);t.orderby=e.target.value,o(t)}},Object.keys(window.vibebp.components.groups.invite_sort).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.groups.invite_sort[e])}))))):wp.element.createElement(ws,null,wp.element.createElement("div",{className:"searchbox active"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",value:_.search_terms,placeholder:window.vibebp.translations.search_text,onChange:function(e){var t=ss({},_);t.search_terms=e.target.value,O(t)}})),wp.element.createElement("select",{onChange:function(e){var t=ss({},_);t.type=e.target.value,O(t)}},Object.keys(window.vibebp.components.groups.sorters).map((function(e){return wp.element.createElement("option",{value:e},window.vibebp.components.groups.sorters[e])}))))),f?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"invites"===q?wp.element.createElement("div",{className:"group_invites"},n.length||f?wp.element.createElement(ws,null,n.length?n.map((function(e,t){return wp.element.createElement(os,{invite:e,action:K})})):""):wp.element.createElement(ws,null,wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_groups_found))):wp.element.createElement("div",{className:"grouplist"},p.length||f?wp.element.createElement(ws,null,wp.element.createElement("div",{className:"vibebp_groups"},$?wp.element.createElement("div",{className:"vibebp_groups"},wp.element.createElement("div",{className:"new_group",onClick:function(){C(!0)}},wp.element.createElement("i",{className:"vicon vicon-plus"}))):"",p.length?p.map((function(e,t){return wp.element.createElement(rs,{group:e,show:function(){L(t),gs("vibebp").setAction("view"),gs("vibebp").setId(e.id)}})})):""),N?wp.element.createElement("a",{className:"link",onClick:function(){var e=ss({},_);e.page=_.page+1,A(!0),O(e)}},window.vibebp.translations.more):""):wp.element.createElement(ws,null,wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_groups_found),$?wp.element.createElement("div",{className:"vibebp_groups"},wp.element.createElement("div",{className:"new_group",onClick:function(){C(!0)}},wp.element.createElement("i",{className:"vicon vicon-plus"}))):"")))))};function _s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Os(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(n),!0).forEach((function(t){js(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function js(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ns(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ss(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ss(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ss(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ks=wp.element,Ps=(ks.createElement,ks.useState),As=(ks.useEffect,ks.Fragment),xs=(ks.render,wp.data),Is=xs.dispatch,Cs=xs.select,Ts=function(e){var t=Ns(Ps(!1),2),n=t[0],r=t[1],a=Ns(Ps(window.vibebp.translations.save_changes),2),i=a[0],o=a[1],l=Ns(Ps("email"),2),c=l[0],s=l[1],m=Cs("vibebp").getUser().email,p=Ns(Ps({email:m,pwd:"",pass1:"",pass2:""}),2),u=p[0],d=p[1],f=Ns(Ps(!1),2),b=f[0],v=f[1];return wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("strong",null,window.vibebp.translations.account_email)),wp.element.createElement("div",{className:"portal_body"},wp.element.createElement("div",{className:"settings_tabs"},wp.element.createElement("a",{className:"setting_tab "+("email"==c?"active":""),onClick:function(){s("email")}},window.vibebp.translations.change_email),wp.element.createElement("a",{className:"setting_tab "+("password"==c?"active":""),onClick:function(){s("password")}},window.vibebp.translations.change_password),wp.element.createElement("a",{className:"setting_tab "+("cleardata"==c?"active":""),onClick:function(){s("cleardata")}},window.vibebp.translations.clear_data),!Cs("vibebp").getUser().caps.hasOwnProperty("edit_posts")&&window.vibebp.settings.delete_account?wp.element.createElement("a",{className:"setting_tab "+("delete_account"==c?"active":""),onClick:function(){s("delete_account")}},window.vibebp.translations.delete_account):""),wp.element.createElement("div",{className:"vibebp_form tab_content"},"email"==c?wp.element.createElement(As,null,wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.account_email),wp.element.createElement("input",{type:"email",onChange:function(e){d(Os(Os({},u),{},{email:e.target.value}))},value:u.email}),u.email!==m?wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.confirm_old_password),wp.element.createElement("input",{type:"password",value:u.pwd,onChange:function(e){d(Os(Os({},u),{},{pwd:e.target.value}))}})):"")):"password"==c?wp.element.createElement(As,null,wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.change_password),wp.element.createElement("input",{type:"password",value:u.pass1,onChange:function(e){d(Os(Os({},u),{},{pass1:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.repeat_new_password),wp.element.createElement("input",{type:"password",value:u.pass2,onChange:function(e){d(Os(Os({},u),{},{pass2:e.target.value}))}}))):"cleardata"==c?wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("label",null,window.vibebp.translations.clear_saved_data),wp.element.createElement("a",{onClick:function(){v(!0);var e=localforage.createInstance({name:"vibebp_stale_requests",storeName:"user"}),t=localforage.createInstance({name:"vibebp_stale_requests",storeName:"global"});e.clear(),t.clear(),localforage.clear().then((function(){v(!1),Is("vibebp").addNotification({text:window.vibebp.translations.data_cleared})}))},className:b?"button is-primary is-loading":"button is-primary"},window.vibebp.translations.clear_data)):"",wp.element.createElement("a",{className:n?"button is-primary is-loading":"button is-primary",onClick:function(){r(!0),fetch("".concat(window.vibebp.api.url,"/settings/save?post"),{method:"post",body:JSON.stringify(Os(Os({},u),{},{token:Cs("vibebp").getToken(),type:c}))}).then((function(e){return e.json()})).then((function(e){r(!1),"delete_account"==c&&Is("vibebp").logout(),o(e.message),setTimeout((function(){o(window.vibebp.translations.save_changes)}),3e3)}))}},i))))};function Ds(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ls(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ls(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ls(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ms=wp.element,Js=(Ms.createElement,Ms.useState),Us=Ms.useEffect,qs=Ms.Fragment,Fs=(Ms.render,wp.data),zs=(Fs.dispatch,Fs.select),$s=function(e){var t=Ds(Js(!0),2),n=t[0],r=t[1],a=Ds(Js({status:"",label:"",exports:"",message:"",submessage:""}),2),i=a[0],o=a[1],l=Ds(Js(!1),2),c=l[0],s=l[1];Us((function(){m()}),[]),Us((function(){return document.addEventListener("vibebp_component_reload",m),function(){document.removeEventListener("vibebp_component_reload",m)}}));var m=function(){r(!0),fetch("".concat(window.vibebp.api.url,"/settings/export_data"),{method:"post",body:JSON.stringify({token:zs("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),o(e)}))};return wp.element.createElement("div",{class:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("strong",null,window.vibebp.translations.export_data_settings)),wp.element.createElement("div",{className:"portal_body"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(qs,null,i.hasOwnProperty("exports")&&i.exports.length?wp.element.createElement(qs,null,wp.element.createElement("div",{className:"export_data_items",dangerouslySetInnerHTML:{__html:i.exports}})):"",i.hasOwnProperty("message")&&i.message.length?wp.element.createElement("div",null,wp.element.createElement("div",{className:"export_data_message vbp_message",dangerouslySetInnerHTML:{__html:i.message}})):"",i.hasOwnProperty("can_make_new_request")&&i.can_make_new_request?wp.element.createElement("div",null,wp.element.createElement("a",{className:c?"button is-primary is-loading make_new_export_request":"button is-primary make_new_export_request",onClick:function(){s(!0),fetch("".concat(window.vibebp.api.url,"/settings/export_data/request"),{method:"post",body:JSON.stringify({token:zs("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){s(!1),m()}))}},i.label," ")):"",i.hasOwnProperty("report_link")&&i.report_link?wp.element.createElement("div",null,wp.element.createElement("a",{className:"link make_new_export_download",href:i.report_link,target:"__blank"},i.label," ")):"")))};function Hs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ws(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xs(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bs=wp.element,Ks=(Bs.createElement,Bs.useState),Gs=Bs.useEffect,Ys=Bs.Fragment,Vs=(Bs.render,wp.data),Qs=(Vs.dispatch,Vs.select),Zs=function(e){var t=Ws(Ks(!1),2),n=t[0],r=t[1],a=Ws(Ks({}),2),i=a[0],o=a[1];Gs((function(){l()}),[]);var l=function(){r(!0),fetch("".concat(window.vibebp.api.url,"/settings/email"),{method:"post",body:JSON.stringify({token:Qs("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),o(e)}))};Gs((function(){return document.addEventListener("vibebp_component_reload",l),function(){document.removeEventListener("vibebp_component_reload",l)}}));var c=function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hs(Object(n),!0).forEach((function(t){Rs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},i);n[e].value=t,o(n),fetch("".concat(window.vibebp.api.url,"/settings/email/set"),{method:"post",body:JSON.stringify({token:Qs("vibebp").getToken(),setting:e,value:t})}).then((function(e){return e.json()})).then((function(e){}))};return wp.element.createElement("div",{class:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("strong",null,window.vibebp.translations.send_email_notice)),wp.element.createElement("div",{className:"portal_body"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):Object.keys(i).length?wp.element.createElement(Ys,null,Object.keys(i).map((function(e){return wp.element.createElement("div",{className:"setting"},wp.element.createElement("label",null,i[e].label),wp.element.createElement("div",{className:"switch"},"yes"==i[e].value?wp.element.createElement("input",{type:"checkbox",id:e,checked:!0,onClick:function(){return c(e,"no")}}):wp.element.createElement("input",{type:"checkbox",id:e,onClick:function(){return c(e,"yes")}}),wp.element.createElement("label",{for:e,className:"slider"})))}))):""))};function em(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var am=wp.element,im=(am.createElement,am.useState),om=am.useEffect,lm=am.Fragment,cm=(am.render,wp.data),sm=(cm.dispatch,cm.select),mm=function(e){var t=nm(im(!1),2),n=t[0],r=t[1],a=nm(im({}),2),i=a[0],o=a[1];om((function(){l()}),[]);var l=function(){r(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/fields"),{method:"post",body:JSON.stringify({token:sm("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),o(e)}))};om((function(){return document.addEventListener("vibebp_component_reload",l),function(){document.removeEventListener("vibebp_component_reload",l)}}));var c=function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?em(Object(n),!0).forEach((function(t){tm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):em(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},i);n.fields[n.fields.findIndex((function(t){return t.id===e.id}))].visibility=t,o(n),fetch("".concat(window.vibebp.api.url,"/xprofile/fields/setvisibility"),{method:"post",body:JSON.stringify({token:sm("vibebp").getToken(),field_id:e.id,visibility:t})}).then((function(e){return e.json()})).then((function(e){}))};return wp.element.createElement("div",{class:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("strong",null,window.vibebp.translations.visibility_settings)),wp.element.createElement("div",{className:"portal_body"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):Object.keys(i).length?wp.element.createElement(lm,null,i.groups.map((function(e){return wp.element.createElement("div",{className:"setting_group"},wp.element.createElement("label",null,e.name),i.fields.filter((function(t){return t.group_id===e.id})).map((function(e){return wp.element.createElement("div",{className:"setting_field"},wp.element.createElement("strong",null,e.name),wp.element.createElement("select",{value:e.visibility,onChange:function(t){return c(e,t.target.value)}},Object.keys(window.vibebp.components.xprofile.visibility).map((function(t){return wp.element.createElement("option",{value:t,selected:e.visibility==t},window.vibebp.components.xprofile.visibility[t])}))))})))}))):""))},pm=wp.element,um=(pm.createElement,pm.useState,pm.useEffect),dm=(pm.Fragment,pm.render,wp.data),fm=(dm.dispatch,dm.select,function(e){return um((function(){var e=new CustomEvent("vibebp_profile_settings");document.dispatchEvent(e),document.querySelector("body").classList.value.includes("withsidebar")&&document.querySelector("body").classList.remove("withsidebar")}),[]),wp.element.createElement("div",{className:"profile_settings"},wp.element.createElement(Ts,null),wp.element.createElement(mm,null),wp.element.createElement(Zs,null),wp.element.createElement($s,null),window.vibebp.settings.profile_settings.map((function(e){return wp.element.createElement("div",{className:"portal"},wp.element.createElement("div",{className:"portal_header"},wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:e.label}})),wp.element.createElement("div",{className:"portal_body"},wp.element.createElement("div",{className:e.key})))})))}),bm=wp.element,vm=(bm.createElement,bm.useState,bm.useEffect,bm.Fragment),wm=(bm.render,wp.data),ym=(wm.dispatch,wm.select,function(e){return wp.element.createElement("div",{className:"vibebp_wc_full_order"},wp.element.createElement("div",{className:"vibebp_wc_order_header"},wp.element.createElement("span",{className:"vicon vicon-arrow-left",onClick:e.back}),wp.element.createElement("span",{className:"order_status "+e.order.status},window.vibebp.components.shop.order_statuses["wc-"+e.order.status])),wp.element.createElement("div",{className:"vibebp_order_details"},wp.element.createElement("div",{className:"vibebp_order_main"},wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_number),"#",e.order.order_number),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_date),e.order.created_at),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_status),wp.element.createElement("span",{className:"order_status "+e.order.status},window.vibebp.components.shop.order_statuses["wc-"+e.order.status])),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_amount),e.order.currency," ",e.order.total),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_payment_method),e.order.payment_details.method_title)),wp.element.createElement("div",{className:"vibebp_order_line_items"},e.order.line_items.length?e.order.line_items.map((function(e){return wp.element.createElement("div",{className:"vibebp_order_line_item"},wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.item_name),e.name," x ",e.quantity),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.item_total),e.subtotal," ","0.00"!==e.subtotal_tax?wp.element.createElement("span",{className:"subtotal_tax"},"[",e.subtotal_tax,"]"):""))})):""),e.order.fee_lines.length||e.order.shipping_lines.length||e.order.coupon_lines.length?wp.element.createElement("div",{className:"vibebp_order_extra_items"},e.order.coupon_lines.length?wp.element.createElement(vm,null,wp.element.createElement("strong",null,window.vibebp.translations.coupons_applied),e.order.coupon_lines.map((function(e){return wp.element.createElement("div",{className:"vibebp_order_coupon_item"},wp.element.createElement("span",null,e.code),wp.element.createElement("span",null,e.amount))}))):"",e.order.shipping_lines.length?wp.element.createElement(vm,null,wp.element.createElement("strong",null,window.vibebp.translations.shipping_rates),e.order.shipping_lines.map((function(e){return wp.element.createElement("div",{className:"vibebp_order_coupon_item"},wp.element.createElement("span",null,e.method_title),wp.element.createElement("span",null,e.total))}))):"",e.order.fee_lines.length?wp.element.createElement(vm,null,wp.element.createElement("strong",null,window.vibebp.translations.fees),e.order.fee_lines.map((function(e){return wp.element.createElement("div",{className:"vibebp_order_coupon_item"},wp.element.createElement("span",null,e.method_title),wp.element.createElement("span",null,e.total))}))):""):"",wp.element.createElement("div",{className:"vibebp_addresses"},wp.element.createElement("div",{className:"vibebp_billing_address"},wp.element.createElement("strong",null,window.vibebp.translations.billing_address),wp.element.createElement("span",null,e.order.billing_address.first_name," ",e.order.billing_address.last_name),wp.element.createElement("span",null,e.order.billing_address.email," ",e.order.billing_address.phone),e.order.billing_address.company.length?wp.element.createElement("span",null,e.order.billing_address.company):"",wp.element.createElement("span",null,e.order.billing_address.address_1),e.order.billing_address.address_2.length?wp.element.createElement("span",null,e.order.billing_address.address_2):"",wp.element.createElement("span",null,e.order.billing_address.city," ",e.order.billing_address.state," ",e.order.billing_address.country," ",e.order.billing_address.pincode)),e.order.shipping_address.first_name.length?wp.element.createElement("div",{className:"vibebp_shipping_address"},wp.element.createElement("strong",null,window.vibebp.translations.shipping_address),wp.element.createElement("span",null,e.order.shipping_address.first_name," ",e.order.shipping_address.last_name),wp.element.createElement("span",null,e.order.shipping_address.email," ",e.order.shipping_address.phone),e.order.shipping_address.company.length?wp.element.createElement("span",null,e.order.shipping_address.company):"",wp.element.createElement("span",null,e.order.shipping_address.address_1),e.order.shipping_address.address_2.length?wp.element.createElement("span",null,e.order.shipping_address.address_2):"",wp.element.createElement("span",null,e.order.shipping_address.city," ",e.order.shipping_address.state," ",e.order.shipping_address.country," ",e.order.shipping_address.pincode)):"")))});function gm(e){return function(e){if(Array.isArray(e))return Nm(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||jm(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Em(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hm(Object(n),!0).forEach((function(t){_m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Om(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||jm(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jm(e,t){if(e){if("string"==typeof e)return Nm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nm(e,t):void 0}}function Nm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Sm=wp.element,km=(Sm.createElement,Sm.useState),Pm=Sm.useEffect,Am=Sm.Fragment,xm=(Sm.render,Sm.useRef),Im=wp.data,Cm=(Im.dispatch,Im.select),Tm=function(e){var t=Om(km(!1),2),n=t[0],r=t[1],a=Om(km({page:1,order_date:"",status:"wc-completed",limit:window.vibebp.components.shop.per_page}),2),i=a[0],o=a[1],l=Om(km(!1),2),c=l[0],s=l[1],m=Om(km(!1),2),p=m[0],u=m[1],d=Om(km([]),2),f=d[0],b=d[1],v=Om(km([]),2),w=v[0],y=v[1],g=Om(km(!1),2),h=g[0],E=g[1],_=Om(km(!1),2),O=(_[0],_[1],xm());Pm((function(){if(O&&O.current&&"function"==typeof flatpickr&&(!f.length||f.length&&f.length>1)){var e={dateFormat:"m/d/Y",mode:"range",defaultDate:f,onChange:function(e){if(e&&e.length>1){b(e);var t=Em({},i);t.order_date={start_date:e[0].getTime(),end_date:e[e.length-1].getTime()},o(t)}}};flatpickr(O.current,e)}}),[f]),Pm((function(){var e=Em({},i);e.token=Cm("vibebp").getToken(),r(!0),fetch("".concat(window.vibebp.api.url,"/wc/orders"),{method:"post",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if(r(!1),e.status){if(p){if(e.orders.length){var t=gm(w);e.orders.map((function(e){t.push(e)})),y(t)}u(!1)}else y(e.orders),s(!0);e.orders.length<i.limit&&s(!1)}}))}),[i]);var j=function(){o(Em({},i))};return Pm((function(){return document.addEventListener("vibebp_component_reload",j),function(){document.removeEventListener("vibebp_component_reload",j)}})),wp.element.createElement("div",{className:"vibebp_shop_orders"},wp.element.createElement("div",{className:"vibebp_shop_orders_header vibebp_form vibebp_main_head"},wp.element.createElement("select",{value:i.timeline,onChange:function(e){o(Em(Em({},i),{},{timeline:e.target.value,page:1}))}},Object.keys(window.vibebp.components.shop.order_timelines).map((function(e){return wp.element.createElement("option",{selected:i.timeline==e,value:e},window.vibebp.components.shop.order_timelines[e])}))),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("div",{className:"date"},wp.element.createElement("input",{type:"text",ref:O}),i.order_date?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){b([]);var e=Em({},i);e.order_date=!1,o(e)}}):"")),wp.element.createElement("select",{value:i.status,onChange:function(e){o(Em(Em({},i),{},{status:e.target.value,page:1}))}},wp.element.createElement("option",null,window.vibebp.translations.select_order_status),Object.keys(window.vibebp.components.shop.order_statuses).map((function(e){return wp.element.createElement("option",{selected:i.status==e,value:e},window.vibebp.components.shop.order_statuses[e])})))),n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):h?wp.element.createElement(ym,{order:h,back:function(){E(!1)}}):w.length?wp.element.createElement(Am,null,w.map((function(e){var t=e[0];return wp.element.createElement("div",{className:"vibebp_wc_order",onClick:function(){E(t)}},wp.element.createElement("div",{className:"vibebp_order_details"},wp.element.createElement("a",{className:"vibebp_order_number link",href:t.view_order_url,target:"_blank"},wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_number),"#",t.order_number),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_date),t.created_at),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_status),wp.element.createElement("span",{className:"order_status "+t.status},window.vibebp.components.shop.order_statuses["wc-"+t.status])),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_quantity),t.total_line_items_quantity),wp.element.createElement("span",null,wp.element.createElement("span",{className:"vibebp_wc_order_label"},window.vibebp.translations.order_amount),t.currency," ",t.total)))})),c?wp.element.createElement("a",{className:"link",onClick:function(){u(!0),o(Em(Em({},i),{},{page:i.page+1}))}},window.vibebp.components.shop.translations.load_more):""):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_orders))};function Dm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mm=wp.element,Jm=(Mm.createElement,Mm.useState),Um=Mm.useEffect,qm=(Mm.Fragment,Mm.render,wp.data),Fm=(qm.dispatch,qm.select),zm=function(e){var t=Dm(Jm(!1),2),n=t[0],r=t[1],a=Dm(Jm([]),2),i=a[0],o=a[1];return Um((function(){r(!0),fetch("".concat(window.vibebp.api.url,"/wc/downloads"),{method:"post",body:JSON.stringify({token:Fm("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&o(e.downloads)}))}),[]),wp.element.createElement("div",{className:"vibebp_wc_downloads"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):i.length?i.map((function(e){return wp.element.createElement("div",{className:"vibebp_wc_download"},wp.element.createElement("strong",null,e.download_name),wp.element.createElement("span",null,wp.element.createElement("span",null,window.vibebp.translations.product_name),e.product_name),e.downloads_remaining?wp.element.createElement("span",null,wp.element.createElement("span",null,window.vibebp.translations.remaining_downloads),e.downloads_remaining):"",e.access_expires?wp.element.createElement("span",null,wp.element.createElement("span",null,window.vibebp.translations.access_expires),e.access_expires):"",wp.element.createElement("a",{href:e.file.file,target:"_blank",className:"button is-primary"},wp.element.createElement("span",{className:"vicon vicon-download"})," ",window.vibebp.translations.download))})):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_downloads))};function $m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xm=wp.element,Bm=(Xm.createElement,Xm.useState),Km=Xm.useEffect,Gm=(Xm.Fragment,Xm.render,wp.data),Ym=Gm.dispatch,Vm=Gm.select,Qm=function(e){var t=Rm(Bm(!1),2),n=t[0],r=t[1],a=Rm(Bm({}),2),i=a[0],o=a[1],l=Rm(Bm(),2),s=l[0],m=l[1],p=Rm(Bm(!1),2),u=p[0],d=p[1];Km((function(){f()}),[]);var f=function(){r(!0),fetch("".concat(window.vibebp.api.url,"/wc/addresses"),{method:"post",body:JSON.stringify({token:Vm("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&o(e.addresses)}))};return Km((function(){return document.addEventListener("vibebp_component_reload",f),function(){document.removeEventListener("vibebp_component_reload",f)}})),c((function(){if(u){var e=s.split("-");fetch("".concat(window.vibebp.api.url,"/wc/addresses/update?post"),{method:"post",body:JSON.stringify({token:Vm("vibebp").getToken(),address_type:e[0],field:e[1],value:i[e[0]][e[1]].value})}).then((function(e){return e.json()})).then((function(e){d(!1),e.status||e.hasOwnProperty("message")&&Ym("vibebp").addNotification({text:e.message})}))}}),500,[i]),wp.element.createElement("div",{className:"vibebp_wc_addresses"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):Object.keys(i).length?Object.keys(i).map((function(e){return wp.element.createElement("div",{className:"vibebp_wc_address"},wp.element.createElement("strong",null,window.vibebp.translations[e]),Object.keys(i[e]).map((function(t){return wp.element.createElement("div",{className:"vibebp_wc_address_field"},wp.element.createElement("span",{onClick:function(){m(s!==e+"-"+t&&e+"-"+t)}},i[e][t].label,s===e+"-"+t?wp.element.createElement("i",null,window.vibebp.translations.cancel):wp.element.createElement("span",{className:"vicon vicon-pencil"})),s===e+"-"+t?wp.element.createElement("div",{className:u?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:i[e][t].value,onChange:function(n){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$m(Object(n),!0).forEach((function(t){Hm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},i);r[e][t].value=n.target.value,o(r),d(!0)}})):wp.element.createElement("span",null,i[e][t].value))})))})):"")};function Zm(e){return function(e){if(Array.isArray(e))return ap(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||rp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ep(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function np(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||rp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rp(e,t){if(e){if("string"==typeof e)return ap(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ap(e,t):void 0}}function ap(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ip=wp.element,op=(ip.createElement,ip.useState),lp=ip.useEffect,cp=(ip.Fragment,ip.render,wp.data),sp=(cp.dispatch,cp.select),mp=function(e){var t=np(op({}),2),n=t[0],r=t[1],a=np(op([]),2),i=a[0],o=a[1],l=np(op(""),2),c=l[0],s=l[1];return lp((function(){var e=sp("vibebp").getMenu().filter((function(e){return"shop"===e.parent}));e.map((function(t,n){-1===e.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&e[n].class.push("current-menu-item")})),o(e),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.shop.label),i.map((function(e,t){var a=e.class.join(" ")+" "+e.css_id;return wp.element.createElement("a",{className:a,onClick:function(a){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ep(Object(n),!0).forEach((function(t){tp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ep(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);l.filter=e.css_id,l.page=1,n.css_id!==l.filter&&r(l),s(e.css_id);var c=Zm(i),m=c.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));c[m].class.splice(c[m].class.indexOf("current-menu-item"),1),c[t].class.push("current-menu-item"),o(c)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},"downloads"==c?wp.element.createElement(zm,null):"edit-address"==c?wp.element.createElement(Qm,null):wp.element.createElement(Tm,null)))};function pp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return up(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return up(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function up(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dp=wp.element,fp=(dp.createElement,dp.useState),bp=dp.useEffect,vp=dp.Fragment,yp=(dp.render,wp.data),gp=yp.dispatch,hp=yp.select,Ep=function(e){var t=pp(fp(!1),2),n=t[0],r=t[1],a=pp(fp({}),2),i=a[0],o=a[1],l=pp(fp({}),2),c=l[0],s=l[1];return bp((function(){r(!0),fetch("".concat(window.vibebp.api.url,"/pmpro/memberships"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:hp("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&o(e.data),e.hasOwnProperty("message")&&gp("vibebp").addNotification({text:e.message}),e.hasOwnProperty("all_levels_page")&&s(e.all_levels_page)}))}),[]),wp.element.createElement("div",{className:"vibebp_pmpro_memberships"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(vp,null,i.length?wp.element.createElement("table",{className:"memberships table"},wp.element.createElement("thead",null,wp.element.createElement("tr",null,wp.element.createElement("td",null,wp.element.createElement("strong",null,window.vibebp.components.pmpro.translations.level)),wp.element.createElement("td",null,wp.element.createElement("strong",null,window.vibebp.components.pmpro.translations.billing)),wp.element.createElement("td",null,wp.element.createElement("strong",null,window.vibebp.components.pmpro.translations.expiration)))),wp.element.createElement("tbody",null,i.map((function(e,t){return wp.element.createElement("tr",{className:"membership"},wp.element.createElement("td",null,wp.element.createElement("h3",{dangerouslySetInnerHTML:{__html:e.name}}),wp.element.createElement("div",{className:"actions"},e.hasOwnProperty("change_link")?wp.element.createElement("a",{target:"_blank",className:"button",href:e.change_link},window.vibebp.components.pmpro.translations.change):"",e.hasOwnProperty("cancel_link")?wp.element.createElement("a",{target:"_blank",className:"button",href:e.cancel_link},window.vibebp.components.pmpro.translations.cancel," "):"",e.hasOwnProperty("renew")?wp.element.createElement("a",{target:"_blank",className:"button",href:e.renew},window.vibebp.components.pmpro.translations.renew):"")),e.hasOwnProperty("billing_html")?wp.element.createElement("td",{dangerouslySetInnerHTML:{__html:e.billing_html}}):"",e.hasOwnProperty("expiration_html")?wp.element.createElement("td",{dangerouslySetInnerHTML:{__html:e.expiration_html}}):"")})))):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.components.pmpro.translations.no_memberships),c.length?wp.element.createElement("a",{target:"_blank",href:c},window.vibebp.components.pmpro.translations.view_all_levels):""))};function _p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Op(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Op(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Op(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jp=wp.element,Np=(jp.createElement,jp.useState),Sp=jp.useEffect,kp=(jp.Fragment,jp.render,wp.data),Pp=(kp.dispatch,kp.select),Ap=function(e){var t=_p(Np(!1),2),n=t[0],r=t[1],a=_p(Np({}),2),i=(a[0],a[1]),o=Pp("vibebp").getUser();return Sp((function(){r(!0),fetch("".concat(window.vibebp.api.url,"/pmpro/account"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:Pp("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&i(e.data)}))}),[]),wp.element.createElement("div",{className:"vibebp_pmpro_account"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement("table",{className:"table",style:{width:"auto"}},wp.element.createElement("tbody",null,wp.element.createElement("tr",null,wp.element.createElement("td",null,window.vibebp.components.pmpro.translations.username),wp.element.createElement("td",null,o.username)),wp.element.createElement("tr",null,wp.element.createElement("td",null,window.vibebp.components.pmpro.translations.email),wp.element.createElement("td",null,o.email)))))};function xp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ip(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ip(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ip(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Cp=wp.element,Tp=(Cp.createElement,Cp.useState),Dp=Cp.useEffect,Lp=Cp.Fragment,Mp=(Cp.render,wp.data),Jp=Mp.dispatch,Up=Mp.select,qp=function(e){var t=xp(Tp(!1),2),n=t[0],r=t[1],a=xp(Tp({}),2),i=a[0],o=a[1],l=xp(Tp({}),2);l[0],l[1];Dp((function(){r(!0),c()}),[]);var c=function(){fetch("".concat(window.vibebp.api.url,"/pmpro/invoices"),{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:Up("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&o(e.data),e.hasOwnProperty("message")&&Jp("vibebp").addNotification({text:e.message})}))};return Dp((function(){return document.addEventListener("vibebp_component_reload",c),function(){document.removeEventListener("vibebp_component_reload",c)}})),wp.element.createElement("div",{className:"vibebp_pmpro_invoices"},n?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(Lp,null,i.length?wp.element.createElement("table",{className:"memberships table"},wp.element.createElement("thead",null,wp.element.createElement("tr",null,wp.element.createElement("td",null,wp.element.createElement("strong",null,window.vibebp.components.pmpro.translations.date)),wp.element.createElement("td",null,wp.element.createElement("strong",null,window.vibebp.components.pmpro.translations.level)),wp.element.createElement("td",null,wp.element.createElement("strong",null,window.vibebp.components.pmpro.translations.amount)),wp.element.createElement("td",null,wp.element.createElement("strong",null,window.vibebp.components.pmpro.translations.status)))),wp.element.createElement("tbody",null,i.map((function(e,t){return wp.element.createElement("tr",{className:"membership"},wp.element.createElement("td",null,e.hasOwnProperty("date")?wp.element.createElement("a",{target:"_blank",className:"",href:e.invoice_link},e.date):""),e.hasOwnProperty("level")?wp.element.createElement("td",{dangerouslySetInnerHTML:{__html:e.level}}):"",e.hasOwnProperty("amount")?wp.element.createElement("td",{dangerouslySetInnerHTML:{__html:e.amount}}):"",e.hasOwnProperty("status")?wp.element.createElement("td",{dangerouslySetInnerHTML:{__html:e.status}}):"")})))):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.components.pmpro.translations.no_invoices)))};function Fp(e){return function(e){if(Array.isArray(e))return Wp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Rp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Rp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rp(e,t){if(e){if("string"==typeof e)return Wp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wp(e,t):void 0}}function Wp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xp=wp.element,Bp=(Xp.createElement,Xp.useState),Kp=Xp.useEffect,Gp=(Xp.Fragment,Xp.render,wp.data),Yp=(Gp.dispatch,Gp.select),Vp=function(e){var t=Hp(Bp({}),2),n=t[0],r=t[1],a=Hp(Bp([]),2),i=a[0],o=a[1],l=Hp(Bp(""),2),c=l[0],s=l[1];return Kp((function(){var e=Yp("vibebp").getMenu().filter((function(e){return"memberships"===e.parent}));e.map((function(t,n){-1===e.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&(e[n].class.push("current-menu-item"),""==c&&s(e[n].css_id))})),o(e),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibebp.components.pmpro.label),i.map((function(e,t){var a=e.class.join(" ")+" "+e.css_id;return wp.element.createElement("a",{className:a,onClick:function(a){var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zp(Object(n),!0).forEach((function(t){$p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);l.filter=e.css_id,l.page=1,n.css_id!==l.filter&&r(l),s(e.css_id);var c=Fp(i),m=c.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));c[m].class.splice(c[m].class.indexOf("current-menu-item"),1),c[t].class.push("current-menu-item"),o(c)}},e.name)})))),wp.element.createElement("div",{className:"vibebp_main"},"memberships"==c?wp.element.createElement(Ep,null):"account"==c?wp.element.createElement(Ap,null):"invoices"==c?wp.element.createElement(qp,null):""))};function Qp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var eu=wp.element,tu=(eu.createElement,eu.useState),nu=eu.useEffect,ru=(eu.Fragment,eu.render,wp.data),au=(ru.dispatch,ru.select),iu=function(e){var t=Qp(tu(),2),n=t[0],r=t[1],a=Qp(tu({}),2),i=a[0],o=a[1],l=Qp(tu({}),2),c=l[0],s=l[1],m=Qp(tu({}),2),p=m[0],u=m[1];return nu((function(){if(e.page){var t=e.page.split("__");fetch("".concat(window.vibebp.api.url,"/getPost/"),{method:"post",body:JSON.stringify({post_type:t[1],id:t[2],token:au("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(e.content),o(e.scripts),u(e.styles),s(e.objects)}))}}),[e.page]),nu((function(){c&&Object.keys(c).map((function(e){window[e]=c[e]}))}),[c]),nu((function(){i&&Object.keys(i).map((function(e){var t=document.createElement("script");t.src=i[e],t.id=e,document.body.appendChild(t),t.onload=function(){setTimeout((function(){document.dispatchEvent(new CustomEvent(e+"_loaded"))}),300)}}))}),[i]),nu((function(){p&&Object.keys(p).map((function(e){var t=document.createElement("link");t.rel="stylesheet",t.href=p[e],t.type="text/css",t.id=e,document.head.appendChild(t)}))}),[p]),wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:n}})};function ou(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return lu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var cu=wp.element,su=(cu.createElement,cu.useState),mu=cu.useEffect,pu=cu.Fragment,uu=(cu.render,cu.useContext),du=cu.useRef,fu=wp.data,bu=fu.dispatch,vu=fu.select,wu=function(e){var t=ou(su(window.vibebp.components.default_component),2),n=t[0],r=t[1],a=ou(su(!1),2),i=a[0],o=a[1],l=ou(su([]),2),c=l[0],s=l[1],m=ou(su(0),2),p=m[0],u=m[1],d=ou(su(!1),2),f=d[0],b=d[1],v=ou(su(!1),2),w=v[0],y=v[1],g=ou(su(!1),2),h=g[0],E=g[1],_=ou(su([]),2),O=_[0],j=_[1],N=ou(su(vu("vibebp").getUser()),2),S=N[0],k=N[1],P=ou(su(vu("vibebp").getToken()),2),A=P[0],x=P[1],I=ou(su({}),2),C=(I[0],I[1],ou(su(!1),2)),T=C[0],D=C[1],L=ou(su(!0),2),M=L[0],J=L[1],U=uu(Tt),q=ou(su(null),2),F=(q[0],q[1]),z=du(null);mu((function(){M||-1!=document.querySelector("body").classList.contains("dark_vibebp")?document.querySelector("body").classList.remove("dark_vibebp"):document.querySelector("body").classList.add("dark_vibebp")}),[M]),mu((function(){window.vibebp.dark_mode&&(J(!1),U.update("dark",!0))}),[]),mu((function(){document.addEventListener("userLoaded",(function(){A||(x(vu("vibebp").getToken()),k(vu("vibebp").getUser()))})),A&&(document.addEventListener("component_loaded",(function(e){r(e.detail.component)})),vu("vibebp").getData("loggedinMenu")?j(vu("vibebp").getData("loggedinMenu")):fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:A})}).then((function(e){return e.json()})).then((function(e){e.status&&(bu("vibebp").setData("loggedinMenu",e.menu),j(e.menu))})))}),[]),mu((function(){setTimeout((function(){s(vu("vibebp").getNotifications()),u(p+1)}),5e3)}),[p]),mu((function(){window.innerWidth<1280?(y(!0),-1==document.querySelector("body").classList.contains("leftsidebar_minimised")&&document.querySelector("body").classList.add("leftsidebar_minimised")):(y(!1),document.querySelector("body").classList.contains("leftsidebar_minimised")>-1&&document.querySelector("body").classList.remove("leftsidebar_minimised")),window.addEventListener("resize",(function(){window.innerWidth<1280?(y(!0),-1==document.querySelector("body").classList.contains("leftsidebar_minimised")&&document.querySelector("body").classList.add("leftsidebar_minimised")):(y(!1),document.querySelector("body").classList.contains("leftsidebar_minimised")>-1&&document.querySelector("body").classList.remove("leftsidebar_minimised"))}))}),[]);return mu((function(){if(T){var e=localforage.createInstance({name:"vibebp_last_requests"}),t=[];e.iterate((function(e,n,r){n&&n.length&&navigator.onLine&&t.push(localforage.removeItem(n))})).then((function(){Promise.all(t).then((function(){D(!1),console.log("dispatch"),document.dispatchEvent(new Event("vibebp_component_reload"))}))}))}}),[T]),mu((function(){if(z){var e=new Draggabilly(document.querySelector(".profile_grid"),{axis:"y",handle:".drag_to_refresh"});F(e),e.on("dragStart",(function(){})),e.on("dragMove",(function(e,t,n){n.y>=90&&(T||D(0))})),e.on("dragEnd",(function(){e.setPosition(0,0),0==T?(console.log("now true"),D(!0)):D(!1)}))}}),[z]),A?wp.element.createElement("div",{className:"profile_grid",ref:z},wp.element.createElement("span",{className:"drag_to_refresh"},wp.element.createElement("span",null,T?wp.element.createElement("div",{class:"lds-ripple"},wp.element.createElement("div",null),wp.element.createElement("div",null)):window.vibebp.translations.drag_to_refresh)),wp.element.createElement("div",{className:"profile_grid_header"},wp.element.createElement("div",{className:"start_block"},window.vibebp.profile_grid_promo&&window.vibebp.profile_grid_promo.length?wp.element.createElement("div",{className:"profile_grid_promo",dangerouslySetInnerHTML:{__html:window.vibebp.profile_grid_promo}}):"","dashboard"==n?wp.element.createElement("div",{className:"dashboard_intro"},wp.element.createElement("h4",null,wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.hello}})," ,"),wp.element.createElement("h3",null,S.displayname," 👋")):wp.element.createElement("span",{onClick:function(){y(!w),w?document.querySelector("body").classList.remove("leftsidebar_minimised"):document.querySelector("body").classList.add("leftsidebar_minimised")}},wp.element.createElement("span",{className:w?window.innerWidth<480?"vicon vicon-angle-down":"vicon vicon-angle-right":window.innerWidth<480?"vicon vicon-angle-up":"vicon vicon-angle-left"}),wp.element.createElement("span",null,w?window.vibebp.translations.show_panel:window.vibebp.translations.hide_panel))),wp.element.createElement("div",{className:"end_block"},wp.element.createElement("div",{className:"notifications",onClick:function(){return b(!f)}},c.length?wp.element.createElement("span",{className:"count"},c.length):"",wp.element.createElement("span",{className:"vicon vicon-bell"}),f&&c.length?wp.element.createElement("div",{className:"notification_list"},c.map((function(e){return wp.element.createElement("div",{className:"notification_item"},wp.element.createElement("span",{className:e.hasOwnProperty("icon")?e.icon:"vicon vicon-alert"}),e.hasOwnProperty("sub")?wp.element.createElement("span",null,e.sub):"",wp.element.createElement("span",null,e.text))}))):""),"slick"==window.vibebp.settings.customizer.theme?wp.element.createElement(pu,null,M?wp.element.createElement("div",{className:"menu_item",onClick:function(){J(!1),U.update("dark",!0),setHovered(!hovered)}},wp.element.createElement("span",{className:"icon",dangerouslySetInnerHTML:{__html:window.vibebp.icons.dark_mode}})):wp.element.createElement("div",{className:"menu_item",onClick:function(){J(!0),U.update("dark",!1)}},wp.element.createElement("span",{className:"icon",dangerouslySetInnerHTML:{__html:window.vibebp.icons.light_mode}}))):wp.element.createElement(pu,null,wp.element.createElement("div",{className:"user",onClick:function(){return E(!h)}},wp.element.createElement(zt,{type:"user",id:{user_id:vu("vibebp").getUser().id}}),h?wp.element.createElement("div",{className:"vibebp_profile_menu_wrapper"},wp.element.createElement("div",{className:"vibebp_profile_usermenu_content"},O.length?O.map((function(e){return wp.element.createElement("span",{className:e.classes.join(" "),onClick:function(){return function(e){e.classes.indexOf("bp-menu")>-1?(r(e.css_id),bu("vibebp").setComponent(e.css_id)):window.location.href=e.url}(e)},dangerouslySetInnerHTML:{__html:e.title}})})):"",wp.element.createElement("span",{onClick:function(){bu("vibebp").logout()}},wp.element.createElement("span",{className:"vicon vicon-power-off"}),window.vibebp.translations.logout))):""),wp.element.createElement(Ct,null),window.vibebp.settings.firebase_config?wp.element.createElement("span",{className:"login_extras",onClick:function(){o(!i);var e=new CustomEvent("loginExtras",{detail:{loginExtras:!0}});document.dispatchEvent(e)}},wp.element.createElement("span",{className:"vicon vicon-align-justify"})):""))),"dashboard"===n?wp.element.createElement(Jn,null):"activity"===n?wp.element.createElement(Xr,{type:"personal"}):"profile"===n?wp.element.createElement(Za,null):"notifications"===n?wp.element.createElement(yi,null):"messages"===n?wp.element.createElement(Po,null):"friends"===n?wp.element.createElement(Sl,null):"groups"===n?wp.element.createElement(Es,null):"settings"===n?wp.element.createElement(fm,null):"followers"===n?wp.element.createElement(sc,null):"shop"===n?wp.element.createElement(mp,null):"memberships"===n?wp.element.createElement(Vp,null):-1!==n.indexOf("post_type")?wp.element.createElement(iu,{page:n}):wp.element.createElement("div",{id:n+"_component"})):wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null))};function yu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yu(Object(n),!0).forEach((function(t){hu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ou=wp.element,ju=(Ou.createElement,Ou.useState),Nu=(Ou.useEffect,Ou.Fragment,Ou.render,wp.data),Su=(Nu.dispatch,Nu.select,function(e){var t=Eu(ju({dark:!1,widgets:[]}),2),n=t[0],r=t[1];return wp.element.createElement(Tt.Provider,{value:gu(gu({},n),{},{update:function(e,t){var a=gu({},n);"remove"===e?delete a[t]:a[e]=t,r(a)}})},wp.element.createElement("div",{className:n.dark?"vibebp_myprofile dark_theme "+window.vibebp.style:"vibebp_myprofile "+window.vibebp.style},wp.element.createElement(en,null),wp.element.createElement(wu,null),wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:"<style>span.vibebp-login{z-index:-1}</style>"}})))});n(0);function ku(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Au=wp.element,xu=(Au.createElement,Au.useState),Iu=Au.useEffect,Cu=Au.Fragment,Tu=Au.render,Du=wp.data,Lu=(Du.dispatch,Du.select);document.addEventListener("DOMContentLoaded",(function(){document.getElementById("vibebp_member")&&Tu(wp.element.createElement((function(e){var t=ku(xu({}),2),n=t[0],r=t[1];return Iu((function(){document.addEventListener("userLoaded",(function(){var e=Lu("vibebp").getUser();document.querySelector("body").classList.contains("page")&&!document.querySelector("body").classList.contains("profile")||document.querySelector("body").classList.contains("my-profile")&&parseInt(e.id)===parseInt(window.vibebp.user_id)?(r(e),document.querySelector("body").classList.add("vibebp_my_profile")):document.querySelector("body").classList.remove("vibebp_my_profile"),window.onpopstate=function(){var e=window.location.href.split("#");Array.isArray(e)&&e.length>1&&e.map((function(e,t){t>0&&e.indexOf("&")?e.split("&").map((function(e){e.indexOf("=")&&("component"==e.split("=")[0]&&setTimeout((function(){console.log("not same")}),200))})):e.indexOf("=")&&"component"==e.split("=")[0]&&setTimeout((function(){console.log("not same")}),200)}))}}))}),[]),wp.element.createElement(Cu,null,n&&Object.keys(n).length?wp.element.createElement(Su,{user:n}):wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:e.def}}))}),{def:document.getElementById("vibebp_member").innerHTML}),document.getElementById("vibebp_member"))}),!1)}]);