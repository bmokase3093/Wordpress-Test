!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);n(1);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=wp.element,s=(a.createElement,a.render),i=a.useState,c=a.useEffect,l=a.Fragment,u=a.useRef,d=wp.data,m=d.select,p=d.dispatch,f=function(e){var t=u(null),n=u(null),o=r(i(!0),2),a=o[0],s=o[1],d=r(i({}),2),f=d[0],_=d[1],w=r(i(null),2),g=w[0],b=w[1],v=r(i(0),2),y=v[0],h=v[1],E=r(i(0),2),O=(E[0],E[1]),S=r(i([]),2),k=S[0],j=S[1],N=r(i(0),2),C=(N[0],N[1],r(i(!1),2)),x=C[0],A=C[1];c((function(){A(!0),fetch("".concat(window.instructor_earnings.api,"/get_currencies"),{method:"post",body:JSON.stringify({token:m("vibebp").getToken()})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status&&e.hasOwnProperty("currencies")&&(j(e.currencies),b(e.currencies[0].value))})).catch((function(e){console.error("Uh oh, an error!",e),p("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}),[]);var M=function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=g),s(!0),fetch("".concat(window.instructor_earnings.api,"/instructor_earnings?currency=").concat(e),{method:"post",body:JSON.stringify({user_id:window.instructor_earnings.user_id,currency:e,token:m("vibebp").getToken()})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status&&e.data&&_(e.data),s(!1)})).catch((function(e){s(!1),console.error("Uh oh, an error!",e),p("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))};c((function(){g&&P()}),[g]),c((function(){if(t&&t.current&&x&&!a&&f.hasOwnProperty("commissions")&&Object.keys(f.commissions).length){var r=["January","February","March","April","May","June","July","August","Spetember","October","November","December"],o=[],s=[],i=[];Object.keys(f.commissions).map((function(e){s[parseInt(e-1)]=parseInt(f.commissions[e].sales),o[parseInt(e-1)]=parseInt(f.commissions[e].commission)}));for(var c=0;c<=11;c++)null!==s[c]&&void 0!==s[c]||(s[c]=0),null!==o[c]&&void 0!==o[c]||(o[c]=0);var l=M(),u=M();i.push({label:window.instructor_earnings.translations.earnings,data:s,borderColor:l,backgroundColor:l,showLines:!0,fill:!1}),i.push({label:window.instructor_earnings.translations.payouts,data:o,borderColor:u,backgroundColor:u,showLines:!0,fill:!1});var d=t.current.getContext("2d");y&&y.destroy();var m={};setTimeout((function(){m=new Chart(d,{type:"line",data:{labels:r,datasets:i,options:{scales:{yAxes:[{stacked:!0,ticks:{beginAtZero:!0}}]}}}}),h(m)}),200)}if(n&&!a&&f.hasOwnProperty("sales_pie")&&f.sales_pie.length){var p=[],_=[],w=[];f.sales_pie.map((function(e){p.push(e.label)})),f.sales_pie.map((function(e){_.push(e.value),w.push(M())})),g&&g.destroy();var g={};g=new Chart(n.current.getContext("2d"),{type:"doughnut",data:{datasets:[{data:_,backgroundColor:w}],labels:p}}),O(g),console.log(n,f.sales_pie,p)}setTimeout((function(){document.dispatchEvent(new CustomEvent("vibebp_widget_loaded",{detail:{props:e}}))}),500)}),[f,a,x]);return wp.element.createElement("div",{className:"wplms_dashboard_instructor_commission text-center"},wp.element.createElement("span",{className:"vicon vicon-reload",onClick:function(e){s(!0),fetch("".concat(window.instructor_earnings.api,"/instructor_earnings/generate?post"),{method:"post",body:JSON.stringify({token:m("vibebp").getToken()})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){localforage.removeItem("".concat(window.instructor_earnings.api,"/instructor_earnings?currency=").concat(g)).then((function(){alert(window.instructor_earnings.translations.calculated_commissions),s(!1),P()}))})).catch((function(e){s(!1),console.error("Uh oh, an error!",e),p("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}}),a?wp.element.createElement("div",{class:"widget_loader"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(l,null,f.hasOwnProperty("currencies")?wp.element.createElement("div",{className:"dash_tabs"},k.map((function(e){return wp.element.createElement("div",{className:"dash_tab "+(e.value==g?"active":""),onClick:function(){b(e.value)}},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.label}}))}))):"",wp.element.createElement("div",{className:"wplms_instructor_commission_data"},wp.element.createElement("div",{className:"wplms_instructor_commission_graph"},f.hasOwnProperty("commissions")?wp.element.createElement("canvas",{ref:t}):wp.element.createElement("div",{className:"vbp_message"},window.instructor_earnings.translations.no_data)),wp.element.createElement("div",{className:"wplms_instructor_commission_pie"},wp.element.createElement("canvas",{ref:n})))))};document.addEventListener("wplms_instructor_earning_stats",(function(e){document.querySelector(".wplms_instructor_earning_stats")&&s(wp.element.createElement(f,{type:document.querySelector(".wplms_instructor_earning_stats").getAttribute("data-type"),settings:e.detail.widget.options}),document.querySelector(".wplms_instructor_earning_stats"))}))},function(e,t,n){}]);