!function(e){var t={};function n(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(8);Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return s.AllSubstringsIndexStrategy}});var a=n(9);Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return a.ExactWordIndexStrategy}});var r=n(10);Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return r.PrefixIndexStrategy}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(11);Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return s.CaseSensitiveSanitizer}});var a=n(12);Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return a.LowerCaseSanitizer}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(13);Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return s.TfIdfSearchIndex}});var a=n(14);Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return a.UnorderedSearchIndex}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t=t||[];for(var n=e=e||{},s=0;s<t.length;s++)if(null==(n=n[t[s]]))return null;return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(15);Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return s.SimpleTokenizer}});var a=n(16);Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return a.StemmingTokenizer}});var r=n(17);Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return r.StopWordsTokenizer}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=t.StopWordsMap={a:!0,able:!0,about:!0,across:!0,after:!0,all:!0,almost:!0,also:!0,am:!0,among:!0,an:!0,and:!0,any:!0,are:!0,as:!0,at:!0,be:!0,because:!0,been:!0,but:!0,by:!0,can:!0,cannot:!0,could:!0,dear:!0,did:!0,do:!0,does:!0,either:!0,else:!0,ever:!0,every:!0,for:!0,from:!0,get:!0,got:!0,had:!0,has:!0,have:!0,he:!0,her:!0,hers:!0,him:!0,his:!0,how:!0,however:!0,i:!0,if:!0,in:!0,into:!0,is:!0,it:!0,its:!0,just:!0,least:!0,let:!0,like:!0,likely:!0,may:!0,me:!0,might:!0,most:!0,must:!0,my:!0,neither:!0,no:!0,nor:!0,not:!0,of:!0,off:!0,often:!0,on:!0,only:!0,or:!0,other:!0,our:!0,own:!0,rather:!0,said:!0,say:!0,says:!0,she:!0,should:!0,since:!0,so:!0,some:!0,than:!0,that:!0,the:!0,their:!0,them:!0,then:!0,there:!0,these:!0,they:!0,this:!0,tis:!0,to:!0,too:!0,twas:!0,us:!0,wants:!0,was:!0,we:!0,were:!0,what:!0,when:!0,where:!0,which:!0,while:!0,who:!0,whom:!0,why:!0,will:!0,with:!0,would:!0,yet:!0,you:!0,your:!0};s.constructor=!1,s.hasOwnProperty=!1,s.isPrototypeOf=!1,s.propertyIsEnumerable=!1,s.toLocaleString=!1,s.toString=!1,s.valueOf=!1},function(e,t,n){e.exports=function(){"use strict";(function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var s=(new Date).getTime(),a=Math.max(0,16-(s-e)),r=window.setTimeout((function(){t(s+a)}),a);return e=s+a,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})(),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),function(e){try{return new CustomEvent("test"),!1}catch(e){}function t(t,n){n=n||{bubbles:!1,cancelable:!1};var s=document.createEvent("MouseEvent");return s.initMouseEvent(t,n.bubbles,n.cancelable,e,0,0,0,0,0,!1,!1,!1,!1,0,null),s}t.prototype=Event.prototype,e.MouseEvent=t}(window);var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),n=function e(t,n,s){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,s)}if("value"in a)return a.value;var i=a.get;return void 0!==i?i.call(s):void 0},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],s=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(s=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);s=!0);}catch(e){a=!0,r=e}finally{try{!s&&o.return&&o.return()}finally{if(a)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function t(n,s,a,r){e(this,t);var i=this;function o(e){e.stopPropagation(),document.removeEventListener("mouseup",o),document.removeEventListener("mousemove",l),i.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{handle:i}}))}function l(e){e.stopPropagation(),i.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:e.clientX,mouseY:e.clientY}}))}this.position=n,this.constraints=s,this.cursor=a,this.eventBus=r,this.el=document.createElement("div"),this.el.className="croppr-handle",this.el.style.cursor=a,this.el.addEventListener("mousedown",(function(e){e.stopPropagation(),document.addEventListener("mouseup",o),document.addEventListener("mousemove",l),i.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:i}}))}))},i=function(){function n(t,s,a,r){e(this,n),this.x1=t,this.y1=s,this.x2=a,this.y2=r}return t(n,[{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.x1=null==e?this.x1:e,this.y1=null==t?this.y1:t,this.x2=null==n?this.x2:n,this.y2=null==s?this.y2:s,this}},{key:"width",value:function(){return Math.abs(this.x2-this.x1)}},{key:"height",value:function(){return Math.abs(this.y2-this.y1)}},{key:"resize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],s=this.x1+this.width()*n[0],a=this.y1+this.height()*n[1];return this.x1=s-e*n[0],this.y1=a-t*n[1],this.x2=this.x1+e,this.y2=this.y1+t,this}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=this.width()*e,s=this.height()*e;return this.resize(n,s,t),this}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.width(),s=this.height();return e=null===e?this.x1:e,t=null===t?this.y1:t,this.x1=e,this.y1=t,this.x2=e+n,this.y2=t+s,this}},{key:"getRelativePoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.width()*e[0],n=this.height()*e[1];return[t,n]}},{key:"getAbsolutePoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.x1+this.width()*e[0],n=this.y1+this.height()*e[1];return[t,n]}},{key:"constrainToRatio",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"height";if(null!==e){switch(this.width(),this.height(),n){case"height":this.resize(this.width(),this.width()*e,t);break;case"width":this.resize(1*this.height()/e,this.height(),t);break;default:this.resize(this.width(),this.width()*e,t)}return this}}},{key:"constrainToBoundary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],s=this.getAbsolutePoint(n),r=a(s,2),i=r[0],o=r[1],l=i,u=o,c=e-i,d=t-o,m=-2*n[0]+1,p=-2*n[1]+1,_=null,h=null;switch(m){case-1:_=l;break;case 0:_=2*Math.min(l,c);break;case 1:_=c}switch(p){case-1:h=u;break;case 0:h=2*Math.min(u,d);break;case 1:h=d}if(this.width()>_){var w=_/this.width();this.scale(w,n)}if(this.height()>h){var g=h/this.height();this.scale(g,n)}return this}},{key:"constrainToSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(r&&(r>1?(e=1*t/r,s*=r):r<1&&(t=e*r,n=1*s/r)),e&&this.width()>e){var i=e,o=null===r?this.height():t;this.resize(i,o,a)}if(t&&this.height()>t){var l=null===r?this.width():e,u=t;this.resize(l,u,a)}if(n&&this.width()<n){var c=n,d=null===r?this.height():s;this.resize(c,d,a)}if(s&&this.height()<s){var m=null===r?this.width():n,p=s;this.resize(m,p,a)}return this}}]),n}();function o(e){e.preventDefault();var t=e.changedTouches[0];t.target.dispatchEvent(new MouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[e.type],{bubbles:!0,cancelable:!0,view:window,clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY}))}var l=[{position:[0,0],constraints:[1,0,0,1],cursor:"nw-resize"},{position:[.5,0],constraints:[1,0,0,0],cursor:"n-resize"},{position:[1,0],constraints:[1,1,0,0],cursor:"ne-resize"},{position:[1,.5],constraints:[0,1,0,0],cursor:"e-resize"},{position:[1,1],constraints:[0,1,1,0],cursor:"se-resize"},{position:[.5,1],constraints:[0,0,1,0],cursor:"s-resize"},{position:[0,1],constraints:[0,0,1,1],cursor:"sw-resize"},{position:[0,.5],constraints:[0,0,0,1],cursor:"w-resize"}];function u(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}return function(a){function r(t,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(this,r),s(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,a))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,a),t(r,[{key:"getValue",value:function(e){return n(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"getValue",this).call(this,e)}},{key:"setImage",value:function(e){return n(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"setImage",this).call(this,e)}},{key:"destroy",value:function(){return n(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"destroy",this).call(this)}},{key:"moveTo",value:function(e,t){return this.box.move(e,t),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"resizeTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[.5,.5];return this.box.resize(e,t,n),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"scaleBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5];return this.box.scale(e,t),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"reset",value:function(){return this.box=this.initializeBox(this.options),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}}]),r}(function(){function n(t,s){var a=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e(this,n),this.options=n.parseOptions(s||{}),!t.nodeName&&null==(t=document.querySelector(t)))throw"Unable to find element.";if(!t.getAttribute("src"))throw"Image src not provided.";this._initialized=!1,this._restore={parent:t.parentNode,element:t},r||(0===t.width||0===t.height?t.onload=function(){a.initialize(t)}:this.initialize(t))}return t(n,[{key:"initialize",value:function(e){this.createDOM(e),this.options.convertToPixels(this.cropperEl),this.attachHandlerEvents(),this.attachRegionEvents(),this.attachOverlayEvents(),this.box=this.initializeBox(this.options),this.redraw(),this._initialized=!0,null!==this.options.onInitialize&&this.options.onInitialize(this)}},{key:"createDOM",value:function(e){var t;this.containerEl=document.createElement("div"),this.containerEl.className="croppr-container",this.eventBus=this.containerEl,(t=this.containerEl).addEventListener("touchstart",o),t.addEventListener("touchend",o),t.addEventListener("touchmove",o),this.cropperEl=document.createElement("div"),this.cropperEl.className="croppr",this.imageEl=document.createElement("img"),this.imageEl.setAttribute("src",e.getAttribute("src")),this.imageEl.setAttribute("alt",e.getAttribute("alt")),this.imageEl.className="croppr-image",this.imageClippedEl=this.imageEl.cloneNode(),this.imageClippedEl.className="croppr-imageClipped",this.regionEl=document.createElement("div"),this.regionEl.className="croppr-region",this.overlayEl=document.createElement("div"),this.overlayEl.className="croppr-overlay";var n=document.createElement("div");n.className="croppr-handleContainer",this.handles=[];for(var s=0;s<l.length;s++){var a=new r(l[s].position,l[s].constraints,l[s].cursor,this.eventBus);this.handles.push(a),n.appendChild(a.el)}this.cropperEl.appendChild(this.imageEl),this.cropperEl.appendChild(this.imageClippedEl),this.cropperEl.appendChild(this.regionEl),this.cropperEl.appendChild(this.overlayEl),this.cropperEl.appendChild(n),this.containerEl.appendChild(this.cropperEl),e.parentElement.replaceChild(this.containerEl,e)}},{key:"setImage",value:function(e){var t=this;return this.imageEl.onload=function(){t.box=t.initializeBox(t.options),t.redraw()},this.imageEl.src=e,this.imageClippedEl.src=e,this}},{key:"destroy",value:function(){this._restore.parent.replaceChild(this._restore.element,this.containerEl)}},{key:"initializeBox",value:function(e){var t=e.startSize.width,n=e.startSize.height,s=new i(0,0,t,n);s.constrainToRatio(e.aspectRatio,[.5,.5]);var a=e.minSize,r=e.maxSize;s.constrainToSize(r.width,r.height,a.width,a.height,[.5,.5],e.aspectRatio);var o=this.cropperEl.offsetWidth,l=this.cropperEl.offsetHeight;s.constrainToBoundary(o,l,[.5,.5]);var u=this.cropperEl.offsetWidth/2-s.width()/2,c=this.cropperEl.offsetHeight/2-s.height()/2;return s.move(u,c),s}},{key:"redraw",value:function(){var e=this,t=Math.round(this.box.width()),n=Math.round(this.box.height()),s=Math.round(this.box.x1),a=Math.round(this.box.y1),r=Math.round(this.box.x2),i=Math.round(this.box.y2);window.requestAnimationFrame((function(){e.regionEl.style.transform="translate("+s+"px, "+a+"px)",e.regionEl.style.width=t+"px",e.regionEl.style.height=n+"px",e.imageClippedEl.style.clip="rect("+a+"px, "+r+"px, "+i+"px, "+s+"px)";for(var o=e.box.getAbsolutePoint([.5,.5]),l=o[0]-e.cropperEl.offsetWidth/2>>31,u=o[1]-e.cropperEl.offsetHeight/2>>31,c=-2*((l^u)+u+u+4)+8,d=0;d<e.handles.length;d++){var m=e.handles[d],p=m.el.offsetWidth,_=m.el.offsetHeight,h=s+t*m.position[0]-p/2,w=a+n*m.position[1]-_/2;m.el.style.transform="translate("+Math.round(h)+"px, "+Math.round(w)+"px)",m.el.style.zIndex=c==d?5:4}}))}},{key:"attachHandlerEvents",value:function(){var e=this.eventBus;e.addEventListener("handlestart",this.onHandleMoveStart.bind(this)),e.addEventListener("handlemove",this.onHandleMoveMoving.bind(this)),e.addEventListener("handleend",this.onHandleMoveEnd.bind(this))}},{key:"attachRegionEvents",value:function(){var e=this.eventBus;function t(t){t.stopPropagation(),e.dispatchEvent(new CustomEvent("regionmove",{detail:{mouseX:t.clientX,mouseY:t.clientY}}))}function n(s){s.stopPropagation(),document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",t),e.dispatchEvent(new CustomEvent("regionend",{detail:{mouseX:s.clientX,mouseY:s.clientY}}))}this.regionEl.addEventListener("mousedown",(function(s){s.stopPropagation(),document.addEventListener("mouseup",n),document.addEventListener("mousemove",t),e.dispatchEvent(new CustomEvent("regionstart",{detail:{mouseX:s.clientX,mouseY:s.clientY}}))})),e.addEventListener("regionstart",this.onRegionMoveStart.bind(this)),e.addEventListener("regionmove",this.onRegionMoveMoving.bind(this)),e.addEventListener("regionend",this.onRegionMoveEnd.bind(this))}},{key:"attachOverlayEvents",value:function(){var e=this,t=null;function n(t){t.stopPropagation(),e.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:t.clientX,mouseY:t.clientY}}))}function s(a){a.stopPropagation(),document.removeEventListener("mouseup",s),document.removeEventListener("mousemove",n),1!==e.box.width()||1!==e.box.height()?e.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{mouseX:a.clientX,mouseY:a.clientY}})):e.box=t}this.overlayEl.addEventListener("mousedown",(function(a){a.stopPropagation(),document.addEventListener("mouseup",s),document.addEventListener("mousemove",n);var r=e.cropperEl.getBoundingClientRect(),o=a.clientX-r.left,l=a.clientY-r.top;t=e.box,e.box=new i(o,l,o+1,l+1),e.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:e.handles[4]}}))}))}},{key:"onHandleMoveStart",value:function(e){var t=e.detail.handle,n=[1-t.position[0],1-t.position[1]],s=this.box.getAbsolutePoint(n),r=a(s,2),i=r[0],o=r[1];this.activeHandle={handle:t,originPoint:n,originX:i,originY:o},null!==this.options.onCropStart&&this.options.onCropStart(this.getValue())}},{key:"onHandleMoveMoving",value:function(e){var t=e.detail,n=t.mouseX,s=t.mouseY,a=this.cropperEl.getBoundingClientRect();n-=a.left,s-=a.top,n<0?n=0:n>a.width&&(n=a.width),s<0?s=0:s>a.height&&(s=a.height);var r=this.activeHandle.originPoint.slice(),o=this.activeHandle.originX,l=this.activeHandle.originY,u=this.activeHandle.handle,c=1===u.constraints[0],d=1===u.constraints[1],m=1===u.constraints[2],p=1===u.constraints[3],_=(p||d)&&(c||m),h=p||d?o:this.box.x1,w=p||d?o:this.box.x2,g=c||m?l:this.box.y1,f=c||m?l:this.box.y2;h=p?n:h,w=d?n:w,g=c?s:g,f=m?s:f;var v=!1,y=!1;if((p||d)&&(v=p?n>o:n<o),(c||m)&&(y=c?s>l:s<l),v){var b=h;h=w,w=b,r[0]=1-r[0]}if(y){var k=g;g=f,f=k,r[1]=1-r[1]}var x=new i(h,g,w,f);if(this.options.aspectRatio){var q=this.options.aspectRatio,z=!1;_?z=s>x.y1+q*x.width()||s<x.y2-q*x.width():(c||m)&&(z=!0);var N=z?"width":"height";x.constrainToRatio(q,r,N)}var S=this.options.minSize,O=this.options.maxSize;x.constrainToSize(O.width,O.height,S.width,S.height,r,this.options.aspectRatio);var P=this.cropperEl.offsetWidth,E=this.cropperEl.offsetHeight;x.constrainToBoundary(P,E,r),this.box=x,this.redraw(),null!==this.options.onCropMove&&this.options.onCropMove(this.getValue())}},{key:"onHandleMoveEnd",value:function(e){null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue())}},{key:"onRegionMoveStart",value:function(e){var t=e.detail,n=t.mouseX,s=t.mouseY,a=this.cropperEl.getBoundingClientRect();n-=a.left,s-=a.top,this.currentMove={offsetX:n-this.box.x1,offsetY:s-this.box.y1},null!==this.options.onCropStart&&this.options.onCropStart(this.getValue())}},{key:"onRegionMoveMoving",value:function(e){var t=e.detail,n=t.mouseX,s=t.mouseY,a=this.currentMove,r=a.offsetX,i=a.offsetY,o=this.cropperEl.getBoundingClientRect();n-=o.left,s-=o.top,this.box.move(n-r,s-i),this.box.x1<0&&this.box.move(0,null),this.box.x2>o.width&&this.box.move(o.width-this.box.width(),null),this.box.y1<0&&this.box.move(null,0),this.box.y2>o.height&&this.box.move(null,o.height-this.box.height()),this.redraw(),null!==this.options.onCropMove&&this.options.onCropMove(this.getValue())}},{key:"onRegionMoveEnd",value:function(e){null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue())}},{key:"getValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e&&(e=this.options.returnMode),"real"==e){var t=this.imageEl.naturalWidth,n=this.imageEl.naturalHeight,s=this.imageEl.getBoundingClientRect(),a=s.width,r=s.height,i=t/a,o=n/r;return{x:Math.round(this.box.x1*i),y:Math.round(this.box.y1*o),width:Math.round(this.box.width()*i),height:Math.round(this.box.height()*o)}}if("ratio"==e){var l=this.imageEl.getBoundingClientRect(),c=l.width,d=l.height;return{x:u(this.box.x1/c,3),y:u(this.box.y1/d,3),width:u(this.box.width()/c,3),height:u(this.box.height()/d,3)}}if("raw"==e)return{x:Math.round(this.box.x1),y:Math.round(this.box.y1),width:Math.round(this.box.width()),height:Math.round(this.box.height())}}}],[{key:"parseOptions",value:function(e){var t=null,n={width:null,height:null},s={width:null,height:null},a={width:100,height:100,unit:"%"},r="real",i=null,o=null,l=null,u=null,c=null;void 0!==e.aspectRatio&&("number"==typeof e.aspectRatio?c=e.aspectRatio:e.aspectRatio instanceof Array&&(c=e.aspectRatio[1]/e.aspectRatio[0]));var d=null;void 0!==e.maxSize&&null!==e.maxSize&&(d={width:e.maxSize[0]||null,height:e.maxSize[1]||null,unit:e.maxSize[2]||"px"});var m=null;void 0!==e.minSize&&null!==e.minSize&&(m={width:e.minSize[0]||null,height:e.minSize[1]||null,unit:e.minSize[2]||"px"});var p=null;void 0!==e.startSize&&null!==e.startSize&&(p={width:e.startSize[0]||null,height:e.startSize[1]||null,unit:e.startSize[2]||"%"});var _=null;"function"==typeof e.onInitialize&&(_=e.onInitialize);var h=null;"function"==typeof e.onCropStart&&(h=e.onCropStart);var w=null;"function"==typeof e.onCropEnd&&(w=e.onCropEnd);var g=null;"function"==typeof e.onUpdate&&(console.warn("Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead."),g=e.onUpdate),"function"==typeof e.onCropMove&&(g=e.onCropMove);var f=null;if(void 0!==e.returnMode){var v=e.returnMode.toLowerCase();if(-1===["real","ratio","raw"].indexOf(v))throw"Invalid return mode.";f=v}var y=function(e,t){return null!==e?e:t};return{aspectRatio:y(c,t),maxSize:y(d,n),minSize:y(m,s),startSize:y(p,a),returnMode:y(f,r),onInitialize:y(_,i),onCropStart:y(h,o),onCropMove:y(g,l),onCropEnd:y(w,u),convertToPixels:function(e){for(var t=e.offsetWidth,n=e.offsetHeight,s=["maxSize","minSize","startSize"],a=0;a<s.length;a++){var r=s[a];null!==this[r]&&("%"==this[r].unit&&(null!==this[r].width&&(this[r].width=this[r].width/100*t),null!==this[r].height&&(this[r].height=this[r].height/100*n)),delete this[r].unit)}}}}}]),n}())}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(0);Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return s.AllSubstringsIndexStrategy}}),Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return s.ExactWordIndexStrategy}}),Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return s.PrefixIndexStrategy}});var a=n(1);Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return a.CaseSensitiveSanitizer}}),Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return a.LowerCaseSanitizer}});var r=n(2);Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return r.TfIdfSearchIndex}}),Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return r.UnorderedSearchIndex}});var i=n(4);Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return i.SimpleTokenizer}}),Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return i.StemmingTokenizer}}),Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return i.StopWordsTokenizer}});var o=n(18);Object.defineProperty(t,"Search",{enumerable:!0,get:function(){return o.Search}});var l=n(5);Object.defineProperty(t,"StopWordsMap",{enumerable:!0,get:function(){return l.StopWordsMap}});var u=n(19);Object.defineProperty(t,"TokenHighlighter",{enumerable:!0,get:function(){return u.TokenHighlighter}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();t.AllSubstringsIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"expandToken",value:function(e){for(var t,n=[],s=0,a=e.length;s<a;++s){t="";for(var r=s;r<a;++r)t+=e.charAt(r),n.push(t)}return n}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();t.ExactWordIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"expandToken",value:function(e){return e?[e]:[]}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();t.PrefixIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"expandToken",value:function(e){for(var t=[],n="",s=0,a=e.length;s<a;++s)n+=e.charAt(s),t.push(n);return t}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();t.CaseSensitiveSanitizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"sanitize",value:function(e){return e?e.trim():""}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();t.LowerCaseSanitizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"sanitize",value:function(e){return e?e.toLocaleLowerCase().trim():""}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TfIdfSearchIndex=void 0;var s,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),i=n(3),o=(s=i)&&s.__esModule?s:{default:s};t.TfIdfSearchIndex=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._uidFieldName=t,this._tokenToIdfCache={},this._tokenMap={}}return r(e,[{key:"indexDocument",value:function(e,t,n){this._tokenToIdfCache={};var s,r=this._tokenMap;"object"!==a(r[e])?r[e]=s={$numDocumentOccurrences:0,$totalNumOccurrences:1,$uidMap:{}}:(s=r[e]).$totalNumOccurrences++;var i=s.$uidMap;"object"!==a(i[t])?(s.$numDocumentOccurrences++,i[t]={$document:n,$numTokenOccurrences:1}):i[t].$numTokenOccurrences++}},{key:"search",value:function(e,t){for(var n={},s=0,r=e.length;s<r;s++){var i=e[s],o=this._tokenMap[i];if(!o)return[];if(0===s)for(var l=0,u=(c=Object.keys(o.$uidMap)).length;l<u;l++){n[d=c[l]]=o.$uidMap[d].$document}else{var c;for(l=0,u=(c=Object.keys(n)).length;l<u;l++){var d=c[l];"object"!==a(o.$uidMap[d])&&delete n[d]}}}var m=[];for(var d in n)m.push(n[d]);var p=this._createCalculateTfIdf();return m.sort((function(n,s){return p(e,s,t)-p(e,n,t)}))}},{key:"_createCalculateIdf",value:function(){var e=this._tokenMap,t=this._tokenToIdfCache;return function(n,s){if(!t[n]){var a=void 0!==e[n]?e[n].$numDocumentOccurrences:0;t[n]=1+Math.log(s.length/(1+a))}return t[n]}}},{key:"_createCalculateTfIdf",value:function(){var e=this._tokenMap,t=this._uidFieldName,n=this._createCalculateIdf();return function(s,a,r){for(var i=0,l=0,u=s.length;l<u;++l){var c,d=s[l],m=n(d,r);m===1/0&&(m=0),c=t instanceof Array?a&&(0,o.default)(a,t):a&&a[t],i+=(void 0!==e[d]&&void 0!==e[d].$uidMap[c]?e[d].$uidMap[c].$numTokenOccurrences:0)*m}return i}}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();t.UnorderedSearchIndex=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tokenToUidToDocumentMap={}}return a(e,[{key:"indexDocument",value:function(e,t,n){"object"!==s(this._tokenToUidToDocumentMap[e])&&(this._tokenToUidToDocumentMap[e]={}),this._tokenToUidToDocumentMap[e][t]=n}},{key:"search",value:function(e,t){for(var n={},a=this._tokenToUidToDocumentMap,r=0,i=e.length;r<i;r++){var o=a[e[r]];if(!o)return[];if(0===r)for(var l=0,u=(d=Object.keys(o)).length;l<u;l++){n[c=d[l]]=o[c]}else for(l=0,u=(d=Object.keys(n)).length;l<u;l++){var c=d[l];"object"!==s(o[c])&&delete n[c]}}var d,m=[];for(r=0,u=(d=Object.keys(n)).length;r<u;r++){c=d[r];m.push(n[c])}return m}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();var a=/[^a-zа-яё0-9\-']+/i;t.SimpleTokenizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"tokenize",value:function(e){return e.split(a).filter((function(e){return e}))}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();t.StemmingTokenizer=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._stemmingFunction=t,this._tokenizer=n}return s(e,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).map(this._stemmingFunction)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StopWordsTokenizer=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),a=n(5);t.StopWordsTokenizer=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tokenizer=t}return s(e,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).filter((function(e){return!a.StopWordsMap[e]}))}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var s,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),r=n(3),i=(s=r)&&s.__esModule?s:{default:s},o=n(0),l=n(1),u=n(2),c=n(4);t.Search=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw Error("js-search requires a uid field name constructor parameter");this._uidFieldName=t,this._indexStrategy=new o.PrefixIndexStrategy,this._searchIndex=new u.TfIdfSearchIndex(t),this._sanitizer=new l.LowerCaseSanitizer,this._tokenizer=new c.SimpleTokenizer,this._documents=[],this._searchableFields=[]}return a(e,[{key:"addDocument",value:function(e){this.addDocuments([e])}},{key:"addDocuments",value:function(e){this._documents=this._documents.concat(e),this.indexDocuments_(e,this._searchableFields)}},{key:"addIndex",value:function(e){this._searchableFields.push(e),this.indexDocuments_(this._documents,[e])}},{key:"search",value:function(e){var t=this._tokenizer.tokenize(this._sanitizer.sanitize(e));return this._searchIndex.search(t,this._documents)}},{key:"indexDocuments_",value:function(e,t){this._initialized=!0;for(var n=this._indexStrategy,s=this._sanitizer,a=this._searchIndex,r=this._tokenizer,o=this._uidFieldName,l=0,u=e.length;l<u;l++){var c,d=e[l];c=o instanceof Array?(0,i.default)(d,o):d[o];for(var m=0,p=t.length;m<p;m++){var _,h=t[m];if(null!=(_=h instanceof Array?(0,i.default)(d,h):d[h])&&"string"!=typeof _&&_.toString&&(_=_.toString()),"string"==typeof _)for(var w=r.tokenize(s.sanitize(_)),g=0,f=w.length;g<f;g++)for(var v=w[g],y=n.expandToken(v),b=0,k=y.length;b<k;b++){var x=y[b];a.indexDocument(x,c,d)}}}}},{key:"indexStrategy",set:function(e){if(this._initialized)throw Error("IIndexStrategy cannot be set after initialization");this._indexStrategy=e},get:function(){return this._indexStrategy}},{key:"sanitizer",set:function(e){if(this._initialized)throw Error("ISanitizer cannot be set after initialization");this._sanitizer=e},get:function(){return this._sanitizer}},{key:"searchIndex",set:function(e){if(this._initialized)throw Error("ISearchIndex cannot be set after initialization");this._searchIndex=e},get:function(){return this._searchIndex}},{key:"tokenizer",set:function(e){if(this._initialized)throw Error("ITokenizer cannot be set after initialization");this._tokenizer=e},get:function(){return this._tokenizer}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenHighlighter=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),a=n(0),r=n(1);t.TokenHighlighter=function(){function e(t,n,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._indexStrategy=t||new a.PrefixIndexStrategy,this._sanitizer=n||new r.LowerCaseSanitizer,this._wrapperTagName=s||"mark"}return s(e,[{key:"highlight",value:function(e,t){for(var n=this._wrapText("").length,s=Object.create(null),a=0,r=t.length;a<r;a++)for(var i=this._sanitizer.sanitize(t[a]),o=this._indexStrategy.expandToken(i),l=0,u=o.length;l<u;l++){var c=o[l];s[c]?s[c].push(i):s[c]=[i]}for(var d="",m="",p=0,_=(a=0,e.length);a<_;a++){var h=e.charAt(a);" "===h?(d="",m="",p=a+1):(d+=h,m+=this._sanitizer.sanitize(h)),s[m]&&s[m].indexOf(m)>=0&&(d=this._wrapText(d),e=e.substring(0,p)+d+e.substring(a+1),a+=n,_+=n)}return e}},{key:"_wrapText",value:function(e){var t=this._wrapperTagName;return"<"+t+">"+e+"</"+t+">"}}]),e}()},function(e,t,n){},function(e,t,n){"use strict";n.r(t);const{createElement:s,render:a,useState:r,useEffect:i,Fragment:o}=wp.element,{select:l,dispatch:u}=wp.data;var c=e=>{const[t,n]=r(!1),[a,u]=r(!1),c=l("vibebp").getToken();i(()=>{n(!0)},[e]);return s(o,null,t?s("div",{className:"popup_wrapper",onClick:e=>{e.preventDefault(),document.querySelector(".popup_wrapper")&&e.target===document.querySelector(".popup_wrapper")&&n(!1)}},s("div",{className:"popup_content"},s("span",{className:"vicon vicon-close",onClick:()=>{n(!1)}}),s("h3",null,window.wplms_course_data.translations.apply_to_course),s("div",{className:"popup-footer"},s("a",{className:"button is-primary",onClick:()=>{u(!0),fetch(window.wplms_course_data.api_url+"/student/courseButton/applycourse",{method:"post",body:JSON.stringify({id:e.id,token:c})}).then(e=>e.json()).then(t=>{if(t.status){n(!1),u(!1);var s=new CustomEvent("wplms_popup_applied",{detail:{course:e.id,text:t.message}});document.dispatchEvent(s)}})}},window.wplms_course_data.translations.yes),s("a",{className:"button is-primary",onClick:()=>{n(!1)}},window.wplms_course_data.translations.cancel)))):"")};const{createElement:d,render:m}=wp.element;var p=e=>d("div",{class:"lds-ellipsis"},d("div",null),d("div",null),d("div",null),d("div",null));const{createElement:_,useState:h,useEffect:w,Fragment:g,render:f}=wp.element;var v=({progress:e,size:t})=>{let n,s;switch(t){case"xs":n=10,s=1;break;case"s":n=12,s=1.2;break;case"sm":n=25,s=2.5;break;case"med":n=50,s=5;break;case"lg":n=75,s=7.5;break;case"xl":n=100,s=10;break;default:n=50,s=5}const a=n-2*s,r=2*a*Math.PI,i=r-e/100*r;return _("div",{className:"react-progress-circle"},_("svg",{height:2*n,width:2*n},_("circle",{className:"ReactProgressCircle_circleBackground",strokeWidth:s,style:{strokeDashoffset:i},r:a,cx:n,cy:n}),_("circle",{className:"ReactProgressCircle_circle",strokeWidth:s,strokeDasharray:r+" "+r,style:{strokeDashoffset:i},r:a,cx:n,cy:n})))};const{createContext:y}=wp.element;var b=y({courseStatus:{},current_unit_key:0,update:e=>{}});const{createElement:k,useState:x,useEffect:q,Fragment:z,render:N,useContext:S}=wp.element,{dispatch:O,select:P}=wp.data;var E=e=>{const t=S(b),[n,s]=x([]),[a,r]=x(0);q(()=>{if(Array.isArray(t.courseStatus.courseitems)&&t.courseStatus.courseitems.length){let e=[...t.courseStatus.courseitems];e=t.courseStatus&&t.courseStatus.filtered_items&&t.courseStatus.filtered_items.length?t.courseStatus.filtered_items:t.courseStatus.courseitems;let n=-1;e.map((e,s)=>{"section"==e.type?n=s:n>-1&&t.current_unit_key==s&&r(n)}),n<0&&r(n),s(e)}},[t.courseStatus.courseitems,t.current_unit_key,t.courseStatus.filtered_items]),q(()=>{if(Array.isArray(t.courseStatus.courseitems)&&t.courseStatus.courseitems.length){let e=-1,n=[...t.courseStatus.courseitems];n.map((s,a)=>{"section"==s.type?(e=a,n[e].lesson_count=0,n[e].duration=0):e>-1&&(n[e].duration=parseInt(n[e].duration)+parseInt(s.duration),n[e].lesson_count++,n[a].section=e,t.current_unit_key==a&&r(e))}),e<0&&r(e),s(n)}},[t.courseStatus.courseitems]);let i=-1;return k(z,null,n?k("ul",{className:n.length>10?"":"stickypos"},n.map((e,s)=>{let o=Math.round(e.duration/60);"section"==e.type&&(i=s);let l=e.type+" "+(e.status?"done":"")+" "+(t.current_unit_key==s?"active":"")+" ";return"section"!=e.type&&a>-1&&(l+=a===i?" open_lesson":" collapsed_lesson"),k("li",{className:l},k("p",{onClick:()=>{((e,n)=>{"section"==e.type?r(n):0!=e.id&&(document.querySelector(".course_status").scrollTo({top:0,left:0,behavior:"smooth"}),t.update({index:n},"loadunit"))})(e,e.key)}},e.icon&&e.icon.length>200?k("span",{dangerouslySetInnerHTML:{__html:e.icon}}):k("span",{className:e.icon}),k("span",{className:"lesson_title",dangerouslySetInnerHTML:{__html:e.title}}),"section"==e.type?k("span",null,k("span",{className:"lesson_count"},e.lesson_count+" "+window.wplms_course_data.translations.lesson_count),k("span",{className:"lesson_duration"},o<180?o+" "+window.wplms_course_data.time_labels.minute.symbol:o>999?k("span",{className:"vicon vicon-infinite"}):Math.round(o/60)+" "+window.wplms_course_data.time_labels.hour.symbol)):k("span",{className:"lesson_duration"},o>=9999?k("i",{className:"vicon vicon-infinite"}):o<180?o+" "+window.wplms_course_data.time_labels.minute.symbol:Math.round(o/60)+" "+window.wplms_course_data.time_labels.hour.symbol)),"section"==e.type?k("i",s===a?{className:"vicon vicon-minus",onClick:()=>r(!1)}:{className:"vicon vicon-plus",onClick:()=>r(s)}):"","section"!=e.type?"unit"===e.type?k("div",{className:"unit_progress_wrapper",onClick:()=>{((e,n)=>{0==e.id||t.courseStatus.lock||e.status||t.courseStatus.unit_media_lock&&(e.meta.hasOwnProperty("video")&&Array.isArray(e.meta.video)&&e.meta.video.length||"video"==e.unit_type)||t.update({index:n},"directmarkcomplete")})(e,s)}},t.courseStatus.hasOwnProperty("lock")&&t.courseStatus.lock&&!t.courseStatus.courseitems[s].status&&s!=t.current_unit_key?k("span",{className:"vicon vicon-lock"}):k(v,{progress:n[s]&&"unit"==n[s].type&&n[s].hasOwnProperty("progressbar")?n[s].progressbar:0,size:"xs"})):k("div",{className:"unit_progress_wrapper"},t.courseStatus.hasOwnProperty("lock")&&t.courseStatus.lock&&!t.courseStatus.courseitems[s].status&&s!=t.current_unit_key?k("span",{className:"vicon vicon-lock"}):k(v,{progress:100,size:"xs"})):"")})):k("div",{class:"message"},window.wplms_course_data.translations.no_content_found))};const{Component:I,createElement:C,render:M,useState:T,useEffect:L,Fragment:j}=wp.element;var A=e=>{const[t,n]=T(e.duration),[s,a]=T({d:0,h:0,m:0,s:0});L(()=>{if(e.start){setTimeout(()=>{let s=t-1;s<=-1?e.update(e.quiz_id,"expired"):s>=0&&(n(s),r())},1e3)}else n(e.duration),r()},[t,e.start,e.duration]);const r=()=>{let e={...s},n=t;n>86400?(e.d=Math.floor(n/86400),n-=86400*e.d):e.d=0,n>3600?(e.h=Math.floor(n/3600),n-=3600*e.h):e.h=0,n>60?(e.m=Math.floor(n/60),n-=60*e.m):e.m=0,e.s=n,a(e)};let i=0;return t>-1&&(i=Math.floor((e.duration-t)/e.duration*100),i<=0&&(i=1)),C("div",{className:"quiztimer"},C("div",{className:"circle_timer"},i?C(v,{size:window.innerWidth<480?"xs":"sm",progress:i}):"",C("span",null,C("span",{className:"timer_amount"},s.d?C(j,null,C("span",null,s.d),C("span",null,":")):"",s.h?C(j,null,C("span",null,s.h),C("span",null,":")):"",s.m?C(j,null,C("span",null,s.m),C("span",null,":")):"",C("span",null,s.s)),C("span",{className:"timer_unit"},s.d?C(j,null,C("span",null,window.wplms_course_data.translations.days),C("span",null)):"",s.h?C(j,null,C("span",null,window.wplms_course_data.translations.hours),C("span",null)):"",s.m?C(j,null,C("span",null,window.wplms_course_data.translations.minutes),C("span",null)):"",C("span",null,window.wplms_course_data.translations.seconds)))))};const{createElement:D,render:H,useState:F,useEffect:B,useContext:$,Fragment:R,RawHTML:U}=wp.element,{dispatch:J,select:W}=wp.data;var X=e=>{const[t,n]=F(e.timestamp),[s,a]=F(0);let r=Math.floor(Date.now()/1e3);B(()=>{if(n(parseInt(e.timestamp)),e.timestamp)if(e.hasOwnProperty("notimediff"))a(parseInt(e.timestamp));else{let t=e.timestamp;if(e.timestamp.toString().includes("-")){t=new Date(t).getTime()/1e3;let e=(new Date).getTimezoneOffset();e*=60,parseInt(e)>0?t-=Math.abs(e):t+=Math.abs(e)}parseInt(t)>r?a(parseInt(t)-r):a(r-parseInt(t))}},[e.timestamp]);return D("span",{className:"friendly_time"},(()=>{if(s<0)return window.wplms_course_data.translations.expired;let t,n,a,r=0,i=0,o=0,l=[{label:window.wplms_course_data.time_labels.year.single,multi:window.wplms_course_data.time_labels.year.multi,value:31536e3},{label:window.wplms_course_data.time_labels.month.single,multi:window.wplms_course_data.time_labels.month.multi,value:2592e3,max:12},{label:window.wplms_course_data.time_labels.week.single,multi:window.wplms_course_data.time_labels.week.multi,value:604800,max:7},{label:window.wplms_course_data.time_labels.day.single,multi:window.wplms_course_data.time_labels.day.multi,value:86400,max:31},{label:window.wplms_course_data.time_labels.hour.single,multi:window.wplms_course_data.time_labels.hour.multi,value:3600,max:24},{label:window.wplms_course_data.time_labels.minute.single,multi:window.wplms_course_data.time_labels.minute.multi,value:60,max:60},{label:window.wplms_course_data.time_labels.second.single,multi:window.wplms_course_data.time_labels.second.multi,value:1,max:60}];if(s>=776736e3)return window.wplms_course_data.translations.unlimited_time;if(s<=0)return e.hasOwnProperty("notimediff")?s+" "+window.wplms_course_data.time_labels.second.multi:window.wplms_course_data.translations.just_now;for(let e=0;e<l.length;e++)if(n=l[e],i=e,n.value<s){r=Math.floor(s/n.value),r>n.max&&(r=n.max);break}return t=r+" "+(r>1?n.multi:n.label),n.value>1&&(a=l[i+1],o=Math.floor(s%n.value/a.value),o&&(t+=", "+o+" "+(o>1?a.multi:a.label))),t})())};const{createElement:Y,render:V,useState:Q,useEffect:K,Fragment:G}=wp.element;var Z=e=>{const[t,n]=Q({});K(()=>{n(e.question)},[e.question]);let s="";t.hasOwnProperty("marked_answer")&&(s=t.marked_answer);let a="";return t.hasOwnProperty("usercorrect")&&t.show_correct_answer&&(a="question_incorrect",t.usercorrect>0&&(a="question_correct")),Y(G,null,Y("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),Y("input",{type:"text",className:a,value:s,onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,n(s),e.update(s,e.index,"changed")}}))};const{createElement:ee,render:te,useState:ne,useEffect:se,Fragment:ae}=wp.element;var re=e=>{const[t,n]=ne({}),[s,a]=ne([]);se(()=>{if(n(e.question),e.question.hasOwnProperty("options")&&e.question.options.length&&Array.isArray(e.question.options)){let t=[...e.question.options];window.wplms_course_data.question_option_rearrange&&r(t),a(t)}},[e.question.correct_indexes]);const r=e=>{for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[n],e[n]=s}};let i="";return t.hasOwnProperty("marked_answer")&&(i=t.marked_answer),ee(ae,null,ee("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?ee(ae,null,(t=>s.map((function(s,a){let r=t.options.findIndex(e=>e==s);return ee("div",{className:"question_option radio "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(r)?"question_correct":"question_incorrect":"")},ee("input",{type:"radio",name:e.quiz_id+"_"+t.id,value:r,id:e.quiz_id+"_"+t.id+r,checked:parseInt(t.marked_answer)===r,onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,n(s),e.update(s,e.index,"changed")}}),ee("label",{for:e.quiz_id+"_"+t.id+r,dangerouslySetInnerHTML:{__html:s}}))})))(t),t.attempted?"":ee("span",{className:"resetq_answer button",onClick:t=>{let s={...e.question};s.marked_answer=null,n(s),e.update(s,e.index,"changed")}},ee("i",{class:"vicon vicon-trash"}))):"")};const{createElement:ie,render:oe,useState:le,useEffect:ue,Fragment:ce}=wp.element;var de=e=>{const[t,n]=le({}),[s,a]=le(-1);ue(()=>{n(e.question)},[e.question]);const r=(t,s)=>{let r={...e.question};r.marked_answer&&r.marked_answer.length||(r.marked_answer=[]),r.marked_answer[s]=t,n(r),e.update(r,e.index,"changed"),a(-1)},i=(e,t)=>e.options.map((function(n,s){return e.hasOwnProperty("options_arr")&&e.options_arr&&e.options_arr.length&&e.options_arr[t]&&e.options_arr[t].length?e.options_arr[t].includes((s+1).toString())||e.options_arr[t].includes(s+1)?ie("option",{value:s,selected:e.marked_answer&&e.marked_answer.length&&e.marked_answer[t]&&parseInt(e.marked_answer[t])===s,dangerouslySetInnerHTML:{__html:n}}):void 0:ie("option",{value:s,selected:e.marked_answer&&e.marked_answer.length&&e.marked_answer[t]&&parseInt(e.marked_answer[t])===s,dangerouslySetInnerHTML:{__html:n}})}));return ie(ce,null,t&&t.extra_content&&Array.isArray(t.extra_content)?ie("div",{className:"question_content"},t.extra_content.map((function(n,o){return ie(ce,null,ie("span",{className:"select_question_content",dangerouslySetInnerHTML:{__html:n}}),t.options&&t.options.length&&o<t.extra_content.length-1?ie(ce,null,((t,n)=>ie(ce,null,ie("span",{className:t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(n)?"question_correct":"question_incorrect":""},s===n?ie("select",{name:e.quiz_id+"_"+t.id,id:e.quiz_id+"_"+t.id,onChange:e=>{r(e.target.value,n)}},ie("option",null,window.wplms_course_data.translations.select_option),i(t,n)):t.options.length&&t.hasOwnProperty("marked_answer")&&t.marked_answer.length&&t.marked_answer[n]?ie("span",{className:"selectimitate ",dangerouslySetInnerHTML:{__html:t.options[t.marked_answer[n]]},onClick:()=>{a(n)}}):ie("span",{className:"selectimitate no_value",onClick:()=>{a(n)}})),t.attempted?"":ie("span",{className:"resetq_answer button",onClick:e=>{r(null,n)}},ie("i",{class:"vicon vicon-trash"}))))(t,o)):"")}))):"")};const{createElement:me,render:pe,useState:_e,useEffect:he,Fragment:we}=wp.element;var ge=e=>{const[t,n]=_e({}),[s,a]=_e([]);"undefined"!=e.question.marked_answer&&null!=e.question.marked_answer||(e.question.marked_answer=[]),he(()=>{if(n(e.question),e.question.hasOwnProperty("options")&&e.question.options.length&&Array.isArray(e.question.options)){let t=[...e.question.options];window.wplms_course_data.question_option_rearrange&&r(t),a(t)}},[e.question.correct_indexes]);const r=e=>{for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[n],e[n]=s}};return me(we,null,me("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?me(we,null,(t=>{if(s&&s.length)return s.map((function(s,a){let r=t.options.findIndex(e=>e==s);return me("div",{className:"question_option checkbox "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(r)?"question_correct":"question_incorrect":"")},me("input",{type:"checkbox",name:e.quiz_id+"_"+t.id,value:r,id:e.quiz_id+"_"+t.id+r,checked:e.question.marked_answer&&e.question.marked_answer.length&&e.question.marked_answer.includes(r),onChange:t=>{let s={...e.question};if(s.marked_answer.includes(r)){let e=s.marked_answer.indexOf(r);e>-1&&s.marked_answer.splice(e,1)}else s.marked_answer.push(r);n(s),e.update(s,e.index,"changed")}}),me("label",{for:e.quiz_id+"_"+t.id+r,dangerouslySetInnerHTML:{__html:s}}))}))})(t),t.attempted?"":me("span",{className:"resetq_answer button",onClick:t=>{let s={...e.question};s.marked_answer=null,n(s),e.update(s,e.index,"changed")}},me("i",{class:"vicon vicon-trash"}))):"")};const{createElement:fe,render:ve,useState:ye,useEffect:be,Fragment:ke}=wp.element;var xe=e=>{const[t,n]=ye("120"),[s,a]=ye(()=>{let t="";return e.marked_answer&&e.marked_answer.length&&(t=e.marked_answer[e.index]),t});be(()=>{void 0!==s&&s&&s.length>15&&n(8*s.length)},[s]);let r="";s&&(r=s);return fe(ke,null,fe("div",{className:"fillblank_area"},fe("input",{type:"text",value:r,onChange:t=>{let n=s;n=t.target.value,a(n),e.update(n,e.index,"changed")},style:{width:t+"px"}})))};const{createElement:qe,render:ze,useState:Ne,useEffect:Se,Fragment:Oe}=wp.element;var Pe=e=>{const[t,n]=Ne({});Se(()=>{n(e.question)},[]);let s="";t.hasOwnProperty("marked_answer")&&(s=t.marked_answer);const a=(s,a,r)=>{if("changed"==r){let r={...t};r.marked_answer&&t.marked_answer.length||(r.marked_answer=[]),r.marked_answer[a]=s,n(r),e.update(r,e.index,"changed")}};return qe(Oe,null,t&&t.extra_content&&Array.isArray(t.extra_content)?qe("div",{className:"question_content"},t.extra_content.map((function(e,n){return qe(Oe,null,qe("span",{className:"select_question_content",dangerouslySetInnerHTML:{__html:e}}),n<t.extra_content.length-1?qe("div",{className:"fillblank_area "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(n)?"question_correct":"question_incorrect":"")},qe(xe,{update:a,index:n,marked_answer:t.marked_answer})):"")}))):"")};const{createElement:Ee,render:Ie,useState:Ce,useEffect:Me,Fragment:Te}=wp.element;var Le=e=>{const[t,n]=Ce([]),[s,a]=Ce(!1),[r,i]=Ce([]),[o,l]=Ce([]),[u,c]=Ce([]),[d,m]=Ce([]);Me(()=>{i(e.items)},[e.items]);let p="droppable";s&&(p+=" active");const _=e=>{let t="";return s===r[e]&&(t="dragging"),t};return Ee("div",{className:p},r.map((p,h)=>Ee("div",{key:h,onDragStart:e=>{r[h]&&a(r[h])},onDragEnd:()=>{a(!1)},onDragOver:t=>{t.preventDefault(),((t,n)=>{if(!s)return;let a=r[n];if(s===a)return;let o=[...r];o=o.filter(e=>e!=s),o.splice(n,0,s),i(o),e.update(o,"changed")})(0,h)},ref:e=>{((e,s)=>{if(e){let a=t;a[s]||(a[s]=e),n(a)}})(e,h)},draggable:"true",style:d[h],onTouchStart:e=>{let n=[...u];t.map((e,t)=>{let s=e.getBoundingClientRect();n[t]=s}),c(n),r[h]&&a(r[h])},onTouchMove:e=>{e.preventDefault();let t=[];if("touchmove"===e.type){let n=[...d];n[h]={transform:"translateY("+Math.floor(e.touches[0].clientY-u[h].top)+"px)"},m(n),t.push(r[h]);let s=[];if(e.touches[0].clientY&&u.map((n,a)=>{n.top+n.height/2>e.touches[0].clientY&&r[a]!==r[h]&&t.push(r[a]),n.bottom-n.height/2<e.touches[0].clientY&&r[a]!==r[h]&&s.push(r[a])}),s.length)for(let e=s.length-1;e>=0;e--)t.unshift(s[e]);l(t)}},onTouchEnd:t=>{i(o),e.update(o,"changed"),c([]),m([]),a(!1),l([])},className:_(h)+" "+(e.question.show_correct_answer&&e.question.correct_indexes?e.question.correct_indexes&&e.question.correct_indexes.length&&e.question.correct_indexes.includes(h)?"question_correct":"question_incorrect":"")},Ee("div",{dangerouslySetInnerHTML:{__html:p}}))))};const{createElement:je,render:Ae,useState:De,useEffect:He,Fragment:Fe}=wp.element;var Be=e=>{e.question.id,e.quiz_id;const[t,n]=De({}),[s,a]=De(!1);He(()=>{let t=e.question;if(!s&&t&&t.marked_answer&&t.marked_answer.length&&"undefined"!=t.marked_answer){let e=[];t.marked_answer.map((n,s)=>{e.push(t.original_options[parseInt(n)-1])}),t.options=e,n(t),a(!0)}n(t)},[t]);return je(Fe,null,je("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?je(Fe,null,je(Le,{items:t.options,original_items:t.original_options,update:(s,a)=>{if("changed"==a){let a=t;a.marked_answer=[],s.map((e,t)=>{let n=a.original_options.indexOf(e);a.marked_answer.push(n+1)}),n(a),e.update(a,e.index,"changed")}},question:t}),t.attempted?"":je("span",{className:"resetq_answer button",onClick:s=>{let a={...t};a.marked_answer=null,a.options=a.original_options,n(a),e.update(a,e.index,"changed")}},je("i",{class:"vicon vicon-trash"}))):"")};const{createElement:$e,render:Re,useState:Ue,useEffect:Je,Fragment:We}=wp.element;function Xe(e){if(null==e)return!0;if(void 0===e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var Ye=e=>{const[t,n]=Ue([]),[s,a]=Ue(!1),[r,i]=Ue([]),[o,l]=Ue(""),[u,c]=Ue([]),[d,m]=Ue(e.matches),[p,_]=Ue([]),[h,w]=Ue([]),[g,f]=Ue([]),[v,y]=Ue({}),[b,k]=Ue([]),[x,q]=Ue([]),[z,N]=Ue([]),[S,O]=Ue({x:0,y:0}),[P,E]=Ue([]);Je(()=>{let t=[...e.items];e.question&&e.question.marked_answer&&e.question.marked_answer.length&&e.question.marked_answer.map(n=>{n&&"NaN"!=typeof n&&(t=t.filter(t=>t!=e.question.original_options[n-1]))}),c(t);let n=[];e.question&&e.question.marked_answer&&e.question.marked_answer.length&&e.question.marked_answer.map(e=>{parseFloat(e)-1>=0?n.push(e-1):n.push(null)}),N(n),e.update(!1,"reset")},[e.items,e.reset]);let I="droppable";s&&(I+=" active");const C=e=>{let t="";return s===u[e]&&(t="dragging"),t};return $e("div",{className:"match_playground"},$e("div",{className:"match_options"},d&&d.length?d.map((n,l)=>$e("div",{key:l,className:"match_option "+(e.question.show_correct_answer&&e.question.correct_indexes?e.question.correct_indexes&&e.question.correct_indexes.length&&e.question.correct_indexes.includes(l)?"question_correct":"question_incorrect":""),onDrop:t=>{((t,n)=>{if(!s)return;if(P.index===n)return;let a=[...u],r=[...z];if(!r[n]&&0!==r[n]){a=a.filter(e=>e!=s);let t=e.original_items.indexOf(s);d&&d.length&&d.map((e,t)=>{Xe(r[t])&&(r[t]=null)}),Xe(n)||(r[n]=t),N(r),c(a),e.update(r,"changed")}})(0,l)},onDragOver:e=>{e.preventDefault()},ref:e=>{((e,t)=>{if(e){let n=r;n[t]||(n[t]=e),i(n)}})(e,l)}},$e("div",{dangerouslySetInnerHTML:{__html:n}}),$e("div",{className:"children"},e.original_items&&null!=z[l]&&e.original_items[z[l]]?$e("div",{key:"droppablediv"+l,draggable:"true",onDragStart:t=>{e.original_items[z[l]]&&(a(e.original_items[z[l]]),E({index:l,source:"droppablediv"}))},onDragEnd:()=>{a(!1),E({})},onDragOver:e=>{e.preventDefault()},className:C(l),style:x[z[l]],onTouchStart:n=>{let s=[...h];t.map((e,t)=>{let n=e.getBoundingClientRect();s[t]=n}),w(s);let i=[...g];r.map((e,t)=>{let n=e.getBoundingClientRect();i[t]=n}),f(i),y(o.getBoundingClientRect()),e.original_items[z[l]]&&(a(e.original_items[z[l]]),E({index:l,source:"droppablediv"})),E({})},onTouchMove:e=>{if(e&&(e.preventDefault(),"touchmove"===e.type)){let t=[...x];t[z[l]]={position:"fixed",top:Math.floor(e.touches[0].clientY)+"px",left:Math.floor(e.touches[0].clientX)+"px"},q(t),O({x:e.touches[0].clientX,y:e.touches[0].clientY})}},onTouchEnd:t=>{let n=[...u],r=[...z];v.top<S.y&&v.top+v.height>S.y&&v.left<S.x&&v.left+v.width>S.x&&(n.push(s),r.map((e,t)=>{e==z[l]&&(r[t]=null)})),f([]),y({}),a(!1),q([]),k([]),c(n),N(r),e.update(r,"changed"),O({x:0,y:0})}},$e("div",{dangerouslySetInnerHTML:{__html:e.original_items[z[l]]}})):""))):""),$e("div",{className:I,onDragOver:e=>{e.preventDefault()},onDrop:t=>{(t=>{if("droppablediv"!==P.source)return;if(!s)return;let n=[...u],a=[...z];n.includes(s)||n.push(s),c(n),Xe(P.index)||(a[P.index]=null),N(a),e.update(a,"changed")})()},ref:e=>{var t;(t=e)&&l(t)}},u&&u.length?u.map((s,i)=>$e("div",{key:"draggablediv"+i,onDragStart:e=>{u[i]&&a(u[i]),E({})},onDragEnd:()=>{a(!1),E({})},onDragOver:e=>{e.preventDefault()},ref:e=>{((e,s)=>{if(e){let a=t;a[s]||(a[s]=e),n(a)}})(e,i)},draggable:"true",style:b[i],onTouchStart:e=>{let n=[...h];t.map((e,t)=>{let s=e.getBoundingClientRect();n[t]=s}),w(n);let i=[...g];r.map((e,t)=>{let n=e.getBoundingClientRect();i[t]=n}),f(i),s&&a(s),E({})},onTouchMove:e=>{if(e.preventDefault(),"touchmove"===e.type){let t=[...b];t[i]={position:"fixed",top:Math.floor(e.touches[0].clientY)+"px",left:Math.floor(e.touches[0].clientX)+"px"},k(t),O({x:e.touches[0].clientX,y:e.touches[0].clientY})}},onTouchEnd:t=>{k([]);let n=[...u],r=[...z];g.map((t,a)=>{if(t.top<S.y&&t.top+t.height>S.y&&t.left<S.x&&t.left+t.width>S.x){let t=e.original_items.indexOf(s);t>=0&&!r[a]&&0!==r[a]&&(r[a]=t,n=n.filter(e=>e!=s))}}),f([]),a(!1),c(n),N(r),e.update(r,"changed"),O({x:0,y:0})},className:C(i)},$e("div",{dangerouslySetInnerHTML:{__html:s}}))):""))};const{createElement:Ve,render:Qe,useState:Ke,useEffect:Ge,Fragment:Ze}=wp.element;var et=e=>{e.question.id,e.quiz_id;const[t,n]=Ke({}),[s,a]=Ke(!1);Ge(()=>{n(e.question)},[t]);return Ve(Ze,null,Ve("div",{className:"question_content"},Ve("div",{className:"question_statement",dangerouslySetInnerHTML:{__html:t&&t.extra_content&&t.extra_content.statement?t.extra_content.statement:""}}),t.options&&t.options.length&&t.content.match&&t.content.match.length?Ve(Ye,{matches:t.extra_content.match,original_matches:t.extra_content.match,items:t.options,original_items:t.original_options,update:(s,r)=>{if("changed"==r){let a={...t};a.marked_answer=[],s.map(e=>{a.marked_answer.push(parseInt(e)+1)}),n(a),e.update(a,e.index,"changed")}"reset"==r&&a(!1)},reset:s,question:t}):"",Ve("div",{className:"question_end",dangerouslySetInnerHTML:{__html:t&&t.content&&t.content.end?t.content.end:""}})),t.attempted?"":Ve("span",{className:"resetq_answer button",onClick:s=>{a(!0);let r={...t};r.marked_answer=null,r.options=r.original_options,n(r),e.update(r,e.index,"changed")}},Ve("i",{class:"vicon vicon-trash"})))};const{createElement:tt,render:nt,useState:st,useEffect:at,Fragment:rt}=wp.element;var it=e=>{const[t,n]=st(e.question);let s="";return t.hasOwnProperty("marked_answer")&&(s=t.marked_answer),tt(rt,null,tt("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?tt(rt,null,(t=>t.options.map((function(s,a){return tt("div",{className:"question_option radio "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(a)?"question_correct":"question_incorrect":"")},tt("input",{type:"radio",name:e.quiz_id+"_"+t.id,value:a,id:e.quiz_id+"_"+t.id+a,checked:parseInt(t.marked_answer)===a,onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,n(s),e.update(s,e.index,"changed")}}),tt("label",{for:e.quiz_id+"_"+t.id+a,dangerouslySetInnerHTML:{__html:s}}))})))(t),t.attempted?"":tt("span",{className:"resetq_answer button",onClick:t=>{let s={...e.question};s.marked_answer=null,n(s)}},tt("i",{class:"vicon vicon-trash"}))):"")};const{createElement:ot,render:lt,useState:ut,useEffect:ct,Fragment:dt}=wp.element;var mt,pt,_t=e=>{const[t,n]=ut({});ct(()=>{n(e.question)},[e.question]);let s="";t.hasOwnProperty("marked_answer")&&(s=t.marked_answer);let a="";return t.hasOwnProperty("usercorrect")&&t.show_correct_answer&&(a="question_incorrect",t.usercorrect>0&&(a="question_correct")),ot(dt,null,ot("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),ot("textarea",{className:a,type:"text",onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,n(s),e.update(s,e.index,"changed")},value:s},s))},ht=ht||function(e,t){var n={},s=n.lib={},a=function(){},r=s.Base={extend:function(e){a.prototype=this;var t=new a;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},i=s.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,s=this.sigBytes;if(e=e.sigBytes,this.clamp(),s%4)for(var a=0;a<e;a++)t[s+a>>>2]|=(n[a>>>2]>>>24-a%4*8&255)<<24-(s+a)%4*8;else if(65535<n.length)for(a=0;a<e;a+=4)t[s+a>>>2]=n[a>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],s=0;s<t;s+=4)n.push(4294967296*e.random()|0);return new i.init(n,t)}}),o=n.enc={},l=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],s=0;s<e;s++){var a=t[s>>>2]>>>24-s%4*8&255;n.push((a>>>4).toString(16)),n.push((15&a).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],s=0;s<t;s+=2)n[s>>>3]|=parseInt(e.substr(s,2),16)<<24-s%8*4;return new i.init(n,t/2)}},u=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],s=0;s<e;s++)n.push(String.fromCharCode(t[s>>>2]>>>24-s%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],s=0;s<t;s++)n[s>>>2]|=(255&e.charCodeAt(s))<<24-s%4*8;return new i.init(n,t)}},c=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=s.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,s=n.words,a=n.sigBytes,r=this.blockSize,o=a/(4*r);if(t=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*r,a=e.min(4*t,a),t){for(var l=0;l<t;l+=r)this._doProcessBlock(s,l);l=s.splice(0,t),n.sigBytes-=a}return new i.init(l,a)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=d.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new m.HMAC.init(e,n).finalize(t)}}});var m=n.algo={};return n}(Math);pt=(mt=ht).lib.WordArray,mt.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,s=this._map;e.clamp(),e=[];for(var a=0;a<n;a+=3)for(var r=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,i=0;4>i&&a+.75*i<n;i++)e.push(s.charAt(r>>>6*(3-i)&63));if(t=s.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,n=this._map;(s=n.charAt(64))&&-1!=(s=e.indexOf(s))&&(t=s);for(var s=[],a=0,r=0;r<t;r++)if(r%4){var i=n.indexOf(e.charAt(r-1))<<r%4*2,o=n.indexOf(e.charAt(r))>>>6-r%4*2;s[a>>>2]|=(i|o)<<24-a%4*8,a++}return pt.create(s,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){function t(e,t,n,s,a,r,i){return((e=e+(t&n|~t&s)+a+i)<<r|e>>>32-r)+t}function n(e,t,n,s,a,r,i){return((e=e+(t&s|n&~s)+a+i)<<r|e>>>32-r)+t}function s(e,t,n,s,a,r,i){return((e=e+(t^n^s)+a+i)<<r|e>>>32-r)+t}function a(e,t,n,s,a,r,i){return((e=e+(n^(t|~s))+a+i)<<r|e>>>32-r)+t}for(var r=ht,i=(l=r.lib).WordArray,o=l.Hasher,l=r.algo,u=[],c=0;64>c;c++)u[c]=4294967296*e.abs(e.sin(c+1))|0;l=l.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,r){for(var i=0;16>i;i++){var o=e[l=r+i];e[l]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}i=this._hash.words;var l=e[r+0],c=(o=e[r+1],e[r+2]),d=e[r+3],m=e[r+4],p=e[r+5],_=e[r+6],h=e[r+7],w=e[r+8],g=e[r+9],f=e[r+10],v=e[r+11],y=e[r+12],b=e[r+13],k=e[r+14],x=e[r+15],q=t(q=i[0],S=i[1],N=i[2],z=i[3],l,7,u[0]),z=t(z,q,S,N,o,12,u[1]),N=t(N,z,q,S,c,17,u[2]),S=t(S,N,z,q,d,22,u[3]);q=t(q,S,N,z,m,7,u[4]),z=t(z,q,S,N,p,12,u[5]),N=t(N,z,q,S,_,17,u[6]),S=t(S,N,z,q,h,22,u[7]),q=t(q,S,N,z,w,7,u[8]),z=t(z,q,S,N,g,12,u[9]),N=t(N,z,q,S,f,17,u[10]),S=t(S,N,z,q,v,22,u[11]),q=t(q,S,N,z,y,7,u[12]),z=t(z,q,S,N,b,12,u[13]),N=t(N,z,q,S,k,17,u[14]),q=n(q,S=t(S,N,z,q,x,22,u[15]),N,z,o,5,u[16]),z=n(z,q,S,N,_,9,u[17]),N=n(N,z,q,S,v,14,u[18]),S=n(S,N,z,q,l,20,u[19]),q=n(q,S,N,z,p,5,u[20]),z=n(z,q,S,N,f,9,u[21]),N=n(N,z,q,S,x,14,u[22]),S=n(S,N,z,q,m,20,u[23]),q=n(q,S,N,z,g,5,u[24]),z=n(z,q,S,N,k,9,u[25]),N=n(N,z,q,S,d,14,u[26]),S=n(S,N,z,q,w,20,u[27]),q=n(q,S,N,z,b,5,u[28]),z=n(z,q,S,N,c,9,u[29]),N=n(N,z,q,S,h,14,u[30]),q=s(q,S=n(S,N,z,q,y,20,u[31]),N,z,p,4,u[32]),z=s(z,q,S,N,w,11,u[33]),N=s(N,z,q,S,v,16,u[34]),S=s(S,N,z,q,k,23,u[35]),q=s(q,S,N,z,o,4,u[36]),z=s(z,q,S,N,m,11,u[37]),N=s(N,z,q,S,h,16,u[38]),S=s(S,N,z,q,f,23,u[39]),q=s(q,S,N,z,b,4,u[40]),z=s(z,q,S,N,l,11,u[41]),N=s(N,z,q,S,d,16,u[42]),S=s(S,N,z,q,_,23,u[43]),q=s(q,S,N,z,g,4,u[44]),z=s(z,q,S,N,y,11,u[45]),N=s(N,z,q,S,x,16,u[46]),q=a(q,S=s(S,N,z,q,c,23,u[47]),N,z,l,6,u[48]),z=a(z,q,S,N,h,10,u[49]),N=a(N,z,q,S,k,15,u[50]),S=a(S,N,z,q,p,21,u[51]),q=a(q,S,N,z,y,6,u[52]),z=a(z,q,S,N,d,10,u[53]),N=a(N,z,q,S,f,15,u[54]),S=a(S,N,z,q,o,21,u[55]),q=a(q,S,N,z,w,6,u[56]),z=a(z,q,S,N,x,10,u[57]),N=a(N,z,q,S,_,15,u[58]),S=a(S,N,z,q,b,21,u[59]),q=a(q,S,N,z,m,6,u[60]),z=a(z,q,S,N,v,10,u[61]),N=a(N,z,q,S,c,15,u[62]),S=a(S,N,z,q,g,21,u[63]);i[0]=i[0]+q|0,i[1]=i[1]+S|0,i[2]=i[2]+N|0,i[3]=i[3]+z|0},_doFinalize:function(){var t=this._data,n=t.words,s=8*this._nDataBytes,a=8*t.sigBytes;n[a>>>5]|=128<<24-a%32;var r=e.floor(s/4294967296);for(n[15+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),n[14+(a+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,s=0;4>s;s++)a=n[s],n[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);return t},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),r.MD5=o._createHelper(l),r.HmacMD5=o._createHmacHelper(l)}(Math),function(){var e,t=ht,n=(e=t.lib).Base,s=e.WordArray,a=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(o=this.cfg).hasher.create(),a=s.create(),r=a.words,i=o.keySize,o=o.iterations;r.length<i;){l&&n.update(l);var l=n.update(e).finalize(t);n.reset();for(var u=1;u<o;u++)l=n.finalize(l),n.reset();a.concat(l)}return a.sigBytes=4*i,a}});t.EvpKDF=function(e,t,n){return a.create(n).compute(e,t)}}(),ht.lib.Cipher||function(e){var t=(p=ht).lib,n=t.Base,s=t.WordArray,a=t.BufferedBlockAlgorithm,r=p.enc.Base64,i=p.algo.EvpKDF,o=t.Cipher=a.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,s){return("string"==typeof n?_:m).encrypt(e,t,n,s)},decrypt:function(t,n,s){return("string"==typeof n?_:m).decrypt(e,t,n,s)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=p.mode={},u=function(e,t,n){var s=this._iv;s?this._iv=void 0:s=this._prevBlock;for(var a=0;a<n;a++)e[t+a]^=s[a]},c=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();c.Encryptor=c.extend({processBlock:function(e,t){var n=this._cipher,s=n.blockSize;u.call(this,e,t,s),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+s)}}),c.Decryptor=c.extend({processBlock:function(e,t){var n=this._cipher,s=n.blockSize,a=e.slice(t,t+s);n.decryptBlock(e,t),u.call(this,e,t,s),this._prevBlock=a}}),l=l.CBC=c,c=(p.pad={}).Pkcs7={pad:function(e,t){for(var n,a=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,r=[],i=0;i<n;i+=4)r.push(a);n=s.create(r,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:l,padding:c}),reset:function(){o.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var d=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),m=(l=(p.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?s.create([1398893684,1701076831]).concat(e).concat(t):t).toString(r)},parse:function(e){var t=(e=r.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=s.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return d.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:l}),encrypt:function(e,t,n,s){s=this.cfg.extend(s);var a=e.createEncryptor(n,s);return t=a.finalize(t),a=a.cfg,d.create({ciphertext:t,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:s.format})},decrypt:function(e,t,n,s){return s=this.cfg.extend(s),t=this._parse(t,s.format),e.createDecryptor(n,s).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),p=(p.kdf={}).OpenSSL={execute:function(e,t,n,a){return a||(a=s.random(8)),e=i.create({keySize:t+n}).compute(e,a),n=s.create(e.words.slice(t),4*n),e.sigBytes=4*t,d.create({key:e,iv:n,salt:a})}},_=t.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:p}),encrypt:function(e,t,n,s){return n=(s=this.cfg.extend(s)).kdf.execute(n,e.keySize,e.ivSize),s.iv=n.iv,(e=m.encrypt.call(this,e,t,n.key,s)).mixIn(n),e},decrypt:function(e,t,n,s){return s=this.cfg.extend(s),t=this._parse(t,s.format),n=s.kdf.execute(n,e.keySize,e.ivSize,t.salt),s.iv=n.iv,m.decrypt.call(this,e,t,n.key,s)}})}(),function(){for(var e=ht,t=e.lib.BlockCipher,n=e.algo,s=[],a=[],r=[],i=[],o=[],l=[],u=[],c=[],d=[],m=[],p=[],_=0;256>_;_++)p[_]=128>_?_<<1:_<<1^283;var h=0,w=0;for(_=0;256>_;_++){var g=(g=w^w<<1^w<<2^w<<3^w<<4)>>>8^255&g^99;s[h]=g,a[g]=h;var f=p[h],v=p[f],y=p[v],b=257*p[g]^16843008*g;r[h]=b<<24|b>>>8,i[h]=b<<16|b>>>16,o[h]=b<<8|b>>>24,l[h]=b,b=16843009*y^65537*v^257*f^16843008*h,u[g]=b<<24|b>>>8,c[g]=b<<16|b>>>16,d[g]=b<<8|b>>>24,m[g]=b,h?(h=f^p[p[p[y^f]]],w^=p[p[w]]):h=w=1}var k=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),a=this._keySchedule=[],r=0;r<n;r++)if(r<t)a[r]=e[r];else{var i=a[r-1];r%t?6<t&&4==r%t&&(i=s[i>>>24]<<24|s[i>>>16&255]<<16|s[i>>>8&255]<<8|s[255&i]):(i=s[(i=i<<8|i>>>24)>>>24]<<24|s[i>>>16&255]<<16|s[i>>>8&255]<<8|s[255&i],i^=k[r/t|0]<<24),a[r]=a[r-t]^i}for(e=this._invKeySchedule=[],t=0;t<n;t++)r=n-t,i=t%4?a[r]:a[r-4],e[t]=4>t||4>=r?i:u[s[i>>>24]]^c[s[i>>>16&255]]^d[s[i>>>8&255]]^m[s[255&i]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,r,i,o,l,s)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,c,d,m,a),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,s,a,r,i,o){for(var l=this._nRounds,u=e[t]^n[0],c=e[t+1]^n[1],d=e[t+2]^n[2],m=e[t+3]^n[3],p=4,_=1;_<l;_++){var h=s[u>>>24]^a[c>>>16&255]^r[d>>>8&255]^i[255&m]^n[p++],w=s[c>>>24]^a[d>>>16&255]^r[m>>>8&255]^i[255&u]^n[p++],g=s[d>>>24]^a[m>>>16&255]^r[u>>>8&255]^i[255&c]^n[p++];m=s[m>>>24]^a[u>>>16&255]^r[c>>>8&255]^i[255&d]^n[p++],u=h,c=w,d=g}h=(o[u>>>24]<<24|o[c>>>16&255]<<16|o[d>>>8&255]<<8|o[255&m])^n[p++],w=(o[c>>>24]<<24|o[d>>>16&255]<<16|o[m>>>8&255]<<8|o[255&u])^n[p++],g=(o[d>>>24]<<24|o[m>>>16&255]<<16|o[u>>>8&255]<<8|o[255&c])^n[p++],m=(o[m>>>24]<<24|o[u>>>16&255]<<16|o[c>>>8&255]<<8|o[255&d])^n[p++],e[t]=h,e[t+1]=w,e[t+2]=g,e[t+3]=m},keySize:8});e.AES=t._createHelper(n)}();var wt=ht,gt={stringify:function(e){var t={ct:e.ciphertext.toString(wt.enc.Base64)};return e.iv&&(t.iv=e.iv.toString()),e.salt&&(t.s=e.salt.toString()),JSON.stringify(t).replace(/\s/g,"")},parse:function(e){var t=JSON.parse(e),n=wt.lib.CipherParams.create({ciphertext:wt.enc.Base64.parse(t.ct)});return t.iv&&(n.iv=wt.enc.Hex.parse(t.iv)),t.s&&(n.salt=wt.enc.Hex.parse(t.s)),n}};var ft=e=>{let t="";if(!e.type)return t;if(!e.marked||"undefined"==e.marked)return t;switch(e.type){case"truefalse":case"single":case"survey":t=e.options[parseInt(e.marked)];break;case"multiple":if(t="",(n=e.marked.split(",")).length)for(let s=0;s<n.length;s++)t+=e.options[parseInt(n[s])]+(s+1<n.length?" , ":"");break;case"sort":case"match":if((n=e.marked.split(",")).length)for(let s=0;s<n.length;s++)"undefined"!==e.original_options[parseInt(n[s])-1]&&null!=e.original_options[parseInt(n[s])-1]&&""!=e.original_options[parseInt(n[s])-1]||(e.original_options[parseInt(n[s])-1]="____"),t+=e.original_options[parseInt(n[s])-1]+(s+1<n.length?" , ":"");break;case"select":if(t="",(n=e.marked.split("|")).length)for(let s=0;s<n.length;s++)t+=e.options[parseInt(n[s])]+(s+1<n.length?" , ":"");break;case"fillblank":case"text":var n;if(t="",(n=e.marked.split("|")).length)for(let e=0;e<n.length;e++)t+=n[e]+(e+1<n.length?" , ":"");break;case"largetext":case"smalltext":t=e.marked}return t};var vt=e=>{let t="";if(!e.type)return"";switch(e.type){case"truefalse":t=e.correct?window.wplms_course_data.translations.true:window.wplms_course_data.translations.false;break;case"single":case"survey":t=e.options[parseInt(e.correct)-1];break;case"multiple":if(t="",(n=e.correct.split(",")).length)for(let s=0;s<n.length;s++)t+=e.options[parseInt(n[s])-1]+(s+1<n.length?" , ":"");break;case"sort":case"match":if(t="",(n=e.correct.split(",")).length)for(let s=0;s<n.length;s++)t+=e.original_options[parseInt(n[s])-1]+(s+1<n.length?" , ":"");break;case"select":if(t="",(n=e.correct.split("|")).length)for(let s=0;s<n.length;s++)t+=e.options[parseInt(n[s])-1]+(s+1<n.length?" , ":"");break;case"fillblank":case"text":case"largetext":case"smalltext":var n;if(t="",(n=e.correct.split("|")).length)for(let e=0;e<n.length;e++)t+=n[e]+(e+1<n.length?" , ":"")}return t};function yt(e){if(null==e)return!0;if(void 0===e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var bt=(e,t=null,n=null,s=null,a=!0)=>{s&&(s=parseFloat(s)),n||(s=null);let r=0,i=[],o=0;e.user_marks=0;let l=0,u=null;yt(e.correct)||(u=JSON.parse(wt.AES.decrypt(e.correct,e.key,{format:gt}).toString(wt.enc.Utf8))),e.correct=u;let c=null;switch(e.hasOwnProperty("marked_answer")&&(c=e.marked_answer),e.type){case"truefalse":e.marked=c,e.correct=parseInt(u),c==u?(e.user_marks=e.marks,r=1):e.user_marks=0,i.push(u);break;case"single":e.marked=c,c==u-1?(e.user_marks=e.marks,r=1):e.user_marks=0,i.push(u-1);break;case"multiple":yt(c)&&(c=[]);var d=c;e.marked=c.join(",").slice();var m=u.split(",");if(i=m,t){if(d.length)for(let e=0;e<d.length;e++){let t=d[e]+1;t=t.toString(),-1!==m.indexOf(t)?o++:l++}r=o/m.length,e.user_marks=Math.round(e.marks*r*100)/100}else if(d.length==m.length)for(let t=0;t<d.length;t++){e.user_marks=e.marks,r=1;let n=d[t]+1;if(n=n.toString(),-1==m.indexOf(n)){e.user_marks=0,r=0;break}}break;case"match":case"sort":yt(c)&&(c=[]),e.marked=c.join(",").slice();let n=c,s=u.split(","),a=0;if(n&&n.length){for(let t=0;t<n.length;t++){e.user_marks=e.marks,r=1;let u="";yt(n[t])||(u=n[t].toString()),s[t]!=u?(r&&(e.user_marks=0,r=0,a=1),l++):(o++,i.push(t))}t?(r=o/s.length,e.user_marks=Math.round(e.marks*r*100)/100):a&&(e.user_marks=0,r=0)}break;case"fillblank":yt(c)&&(c=[]),c.map((e,t)=>{c[t]=e.toLowerCase()}),e.marked=c.join("|").slice(),u=u.toLowerCase();let p=u.split("|");if(e.user_marks=0,c.length){e.user_marks=e.marks,r=1;for(let t=0;t<c.length;t++){let n="";yt(c[t])||(n=c[t].toString());let s=[];yt(p[t])||Array.isArray(p[t])||(s=p[t].split(",")),-1==s.indexOf(n)?(r&&(e.user_marks=0,r=0),l++):(o++,i.push(t))}t?(r=o/p.length,e.user_marks=Math.round(e.marks*r*100)/100):c.length!==p.length&&(e.user_marks=0,r=0)}break;case"select":yt(c)&&(c=[]),e.marked=c.join("|").slice();let _=u.split("|");if(e.user_marks=0,c&&c.length){e.user_marks=e.marks,r=1;for(let t=0;t<c.length;t++){let n="";n=(parseInt(c[t])+1).toString(),n!=_[t]?(r&&(e.user_marks=0,r=0),l++):(o++,i.push(t))}t?(r=o/_.length,e.user_marks=Math.round(e.marks*r*100)/100):c.length!==_.length&&(e.user_marks=0,r=0)}break;case"smalltext":case"largetext":e.marked=c,c&&u&&c.toLowerCase()==u.toLowerCase()?(e.user_marks=e.marks,r=1):e.user_marks=0}if(!yt(c)&&s&&(t&&l>0?e.user_marks=e.user_marks-l*s:r||(e.user_marks=e.user_marks-s)),e.auto||a||(e.user_marks=0,e.show_correct_answer=0),i&&i.length)for(var p=i.length-1;p>=0;p--)"multiple"==e.type?i[p]=parseInt(i[p]-1):i[p]=parseInt(i[p]);return e.correct_indexes=i,e.auto&&(e.usercorrect=r,e.attempted=!0),e.marked=ft(e),e.correct=vt(e),e};const{createElement:kt,render:xt,useState:qt,useEffect:zt,Fragment:Nt,RawHTML:St}=wp.element;var Ot=e=>{const[t,n]=qt({}),[s,a]=qt(!1);zt(()=>{n(e.question),setTimeout(()=>{a(!0)},200)},[]);let r="incorrect",i="checked_answer incorrect";return t.hasOwnProperty("user_marks")&&t.user_marks&&parseFloat(t.user_marks)>0&&(r="correct",i="checked_answer correct"),kt(Nt,null,t.show_correct_answer&&void 0!==t.correct&&t.correct.length?kt("div",{className:i},kt("strong",null,window.wplms_course_data.translations.correct_answer,kt(St,null,t.correct))):"",kt("div",{className:s?"question_wrapper loaded":"question_wrapper"},kt("div",{className:"result"},kt("div",{className:r},kt("span",null),kt("strong",null,t.user_marks)))))};const{createElement:Pt,render:Et,useState:It,useEffect:Ct,Fragment:Mt}=wp.element;var Tt=e=>{let t="",n="";return Ct(()=>{},[e.question]),e.question.hasOwnProperty("show_hint")&&e.question.show_hint?(n="question_hint_content message show",t="question_hint show"):(e.question.show_hint=0,n="question_hint_content message",t="question_hint"),Pt(Mt,null,e.question.hint?Pt("span",{className:t,onClick:t=>{e.question.show_hint=!e.question.show_hint,e.update({...e.question},e.index,"changed")}}):"",e.question.hint?Pt("span",{className:n,dangerouslySetInnerHTML:{__html:e.question.hint}}):"")};const{createElement:Lt,render:jt,useState:At,useEffect:Dt,Fragment:Ht}=wp.element;var Ft=e=>{const[t,n]=At({}),[s,a]=At([]);Dt(()=>{n(e.quiz),a(e.currentQuestions)},[e.quiz,e.currentQuestions]);let r=[];if(t.hasOwnProperty("meta")&&t.meta.hasOwnProperty("questions")&&t.meta.questions&&t.meta.questions.length&&(r=t.meta.questions),r.length)if(null!==e.filter)switch(e.filter){case"wrong":r=r.filter(e=>!e.hasOwnProperty("user_marks")||!e.user_marks||parseFloat(e.user_marks)<=0);break;case"correct":r=r.filter(e=>e.hasOwnProperty("user_marks")&&e.user_marks&&parseFloat(e.user_marks)>0);break;case"bookmarked":r=r.filter(t=>e.bookMarked.indexOf(t.id)>-1)}else r=t.meta.questions;return Lt("div",{className:""},Lt("div",{class:t&&t.meta&&t.meta.questions&&t.meta.questions.length>=10?"timeline_wrapper question_numbers":"timeline_wrapper"},Lt("ul",null,t&&t.meta&&t.meta.questions&&t.meta.questions.length?r.map((n,r)=>{let i="";return e.bookMarked.indexOf(n.id)>-1&&(i+=" bookmarked"),("undefined"!=n.marked_answer&&null!=n.marked_answer||Array.isArray(n.marked_answer)&&n.marked_answer.length)&&(i+=" done",n.hasOwnProperty("attempted")&&n.attempted&&(n.hasOwnProperty("user_marks")&&n.user_marks&&parseFloat(n.user_marks)>0?i+=" correct":i+=" incorrect")),-1!==s.indexOf(r)&&(i+=" active"),Lt("li",{className:i,"data-number":window.wplms_course_data.translations.question_prefix+(r+1)},Lt("span",{onClick:n=>{((n,r,i)=>{n.preventDefault();let o=[...s],l=[];if(t.question_number&&"undefined"!=t.question_number&&t.question_number>0){if(-1!==o.indexOf(i))return;let e=Math.ceil((i+1)/t.question_number),n=e*t.question_number-t.question_number,s=e*t.question_number;for(let e=n;e<s;e++)l.push(e);a(l)}e.update(l,"show")})(n,0,r)}},n.marks))}):"",t&&t.meta&&t.meta.questions&&t.meta.questions.length?Lt("span",{className:"hide_questions",onClick:e.hideQuestions},Lt("span",{class:"vicon vicon-angle-double-left"}),Lt("span",null,window.wplms_course_data.translations.hide_questions)):"")))};const{createElement:Bt,render:$t,useState:Rt,useEffect:Ut,Fragment:Jt}=wp.element;const{createElement:Wt,render:Xt,useState:Yt,useEffect:Vt,Fragment:Qt}=wp.element;var Kt=e=>{const[t,n]=Yt({}),[s,a]=Yt([]),[r,i]=Yt(1);Vt(()=>{if(n(e.quiz),a(e.currentQuestions),e.currentQuestions.length){let t=Math.ceil((e.currentQuestions[0]+1)/e.quiz.question_number);i(t)}const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js",t.async=!0,t.onload=()=>{document.dispatchEvent(new Event("VibeBP_Editor_Content"))},document.body.appendChild(t)},[e.quiz,e.currentQuestions]),Vt(()=>{n(e.quiz),o(null,1)},[e.filter]),Vt(()=>{"bookmarked"==e.filter&&e.questions.length&&s.length&&e.questions.length<=s[s.length-1]&&o(null,e.questions.length)},[e.bookMarked]);const o=(n,s)=>{if(n&&n.preventDefault(),r===s)return;let o=[],l=s*t.question_number-t.question_number,u=s*t.question_number;for(let e=l;e<u;e++)o.push(e);a(o),e.update(o,"show"),i(s)},l=(n=null,i)=>{n&&n.preventDefault();let o=[...s],l=[];if(t.question_number&&"undefined"!=t.question_number&&t.question_number>0)if(i>0){let n;n=t.question_number+o[o.length]>e.questions.length?e.questions.length:o[o.length-1]+t.question_number+1;for(let e=o[o.length-1]+1;e<n;e++)l.push(e);let s=r;s++,a(l)}else{for(let e=o[0]-1;e>=o[0]-t.question_number;e--)l.unshift(e);let e=r;e--,a(l)}e.update(l,"show")};return t&&t.meta&&e.questions&&e.questions.length?Wt("div",{class:"quiz_pagination_wrapper buttons has-addons"},e.questions[s[0]-1]&&"undefined"!=e.questions[s[0]-1]?Wt("span",{href:"#",className:"button ques_link left prevq",onClick:e=>{l(e,-1)}},Wt("i",{className:"vicon vicon-angle-left","aria-hidden":"true"})):Wt("span",{href:"#",className:"button ques_link left prevq faded"},Wt("i",{className:"vicon vicon-angle-left","aria-hidden":"true"})),(()=>{let n=Math.ceil(e.questions.length/t.question_number),s=n,a=[],i=0;if(n>1)for(;n;)if(n){let e=n;r==e?a.unshift(Wt("span",{className:"button active",onClick:t=>{o(t,e)}},n)):(r-1>=1||r+1<=s)&&(r-1==e||r+1==e||1==e||e==s?a.unshift(Wt("span",{className:"button",onClick:t=>{o(t,e)}},n)):i<2&&(a.unshift(Wt("span",{className:"button"},"...")),i++)),n--}return a})(),e.questions[s[s.length-1]+1]&&"undefined"!=e.questions[s[s.length-1]+1]?Wt("span",{href:"#",className:"button ques_link right nextq",onClick:e=>{l(e,1)}},Wt("i",{className:"vicon vicon-angle-right","aria-hidden":"true"})):Wt("span",{href:"#",className:"button ques_link right nextq faded"},Wt("i",{className:"vicon vicon-angle-right","aria-hidden":"true"}))):""};const{createElement:Gt,render:Zt,useState:en,useEffect:tn,Fragment:nn,RawHTML:sn}=wp.element;var an=e=>Gt(nn,null,e.active?Gt("div",{className:"confirmpopup_wrapper"},Gt("div",{className:"confirmpopup_content"},Gt("div",{dangerouslySetInnerHTML:{__html:e.content}}),Gt("div",{className:"buttons_wrapper"},Gt("span",{className:"button",onClick:t=>{e.yesfunction,e.update(e.type,"trigger")}},e.yes),Gt("span",{className:"button",onClick:t=>{e.update(e.type,"nottrigger")}},e.no)))):"");const{createElement:rn,render:on,useState:ln,useEffect:un,Fragment:cn}=wp.element;function dn(e){if(null==e)return!0;if(void 0===e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var mn=e=>{const[t,n]=ln(e.quiz),[s,a]=ln(!1),[r,i]=ln(""),[o,l]=ln({}),[u,c]=ln({});return un(()=>{let t=0,n=0,s=0,a=0;if(e.quiz&&e.quiz.meta&&e.quiz.meta.questions&&(e.quiz.meta.questions.map((e,r)=>{e.hasOwnProperty("usercorrect")&&e.hasOwnProperty("marked_answer")&&!dn(e.marked_answer)?parseInt(e.usercorrect)>0?t++:n++:s++,a++}),c({correct:t,incorrect:n,ommitted:s}),""!=r)){let e={datasets:[{data:[t,n,s],backgroundColor:["#82c362","#dc6a6a","#5381ab"]}],labels:[window.wplms_course_data.translations.correct+" ("+t+") ("+Math.round(t/a*100)+"%)",window.wplms_course_data.translations.incorrect+" ("+n+") ("+Math.round(n/a*100)+"%)",window.wplms_course_data.translations.unattempted+" ("+s+") ("+Math.round(s/a*100)+"%)"]},i=new Chart(r,{type:"pie",data:e});l(i)}},[r]),rn("div",{className:"quiz_stats_chart"},t&&t.meta&&t.meta.questions&&t.meta.questions.length&&t.submitted?rn(cn,null,o&&u?rn("div",{className:"quiz_stats_chart_pie"},rn("canvas",{ref:e=>{e&&""==r&&i(e)}})):"",rn("div",{className:"question_stats_content_wrapper"},rn("span",{className:"question_stats_content_heading"},window.wplms_course_data.translations.historical),rn("div",{className:"question_stats_content"},t.meta.questions.map((e,t)=>{if(e.hasOwnProperty("correct_data"))return rn("div",{className:e.hasOwnProperty("user_marks")&&e.user_marks&&parseFloat(e.user_marks)>0?"checked_answer correct":"checked_answer incorrect"},rn("span",null,window.wplms_course_data.translations.q,t+1),rn("span",null,e.correct_data,"%"))})),t.hasOwnProperty("tags_data")&&!dn(t.tags_data)?rn(cn,null,rn("span",{className:"question_stats_content_heading"},window.wplms_course_data.translations.correct_by_tag),rn("div",{className:"question_stats_content"},t.tags_data.map(e=>rn("div",{className:"checked_answer correct"},rn("span",{dangerouslySetInnerHTML:{__html:e.label}}),rn("span",null,e.value,"%"))))):"")):"")};const{createElement:pn,render:_n,useState:hn,useEffect:wn,Fragment:gn}=wp.element,{dispatch:fn,select:vn}=wp.data;var yn=e=>{const[t,n]=hn([]),[s,a]=hn(null),[r,i]=hn(!0),[o,l]=hn(null),[u,c]=hn(!1);wn(()=>{let e=vn("vibebp").getToken();!function(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)?(d(e),a(e)):localforage.getItem("bp_login_token").then(t=>{e=t,d(e),a(e)})},[e.quizid]);const d=t=>{fetch(window.wplms_course_data.api_url+"/user/quiz/previousresults/"+e.quizid,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:t})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{e&&e.length&&n(e),i(!1)}).catch(e=>{i(!1),console.error("Uh oh, an error!",e),fn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})};return!r&&t.length?pn("div",{className:"previous_results_wrapper"},pn("h3",{className:"subtitle",onClick:()=>{c(!u)}},pn("span",null,window.wplms_course_data.translations.previous_results)," ",pn("span",{className:u?"vicon vicon-minus":"vicon vicon-plus"})),u?o&&o.hasOwnProperty("id")?pn("div",{className:"single_quiz_result quiz_results"},pn("span",{className:"vicon vicon-arrow-left",onClick:()=>{l(null)}}),pn(ts,{quizid:e.quizid,activity:o.id})):pn("div",null,t.length?pn("ul",{className:"quiz_results"},t.map(e=>pn("li",{className:"result",onClick:()=>{l(e)}},pn("span",{dangerouslySetInnerHTML:{__html:e.content}})))):pn("div",{className:"vbp_message message"},window.wplms_course_data.translations.results_not_available)):""):""};const{createElement:bn,render:kn,useState:xn,useEffect:qn,Fragment:zn}=wp.element;var Nn=e=>e.quiz&&e.quiz.meta&&e.quiz.meta.questions&&e.quiz.meta.questions.length&&e.quiz.question_number<e.quiz.meta.questions.length?bn("div",{className:"course_status"},bn("div",{className:"incourse"},bn("div",{className:"quiz_content",dangerouslySetInnerHTML:{__html:e.quiz&&e.quiz.content?e.quiz.content:""}}),bn("div",{className:"quiz_questions_content"},bn("h1",null,bn("span",{className:"student_score"},e.quiz.marks+"/"+e.quiz.max_marks),e.quiz.quiz_passing_score?bn("span",null,e.quiz.marks>e.quiz.quiz_passing_score?window.wplms_course_data.translations.passed:window.wplms_course_data.translations.failed):""),e.quiz.meta.questions.map((t,n)=>{let s="",a="";return t.hasOwnProperty("show_hint")&&t.show_hint?(a="question_hint_content message show",s="question_hint show"):(a="question_hint_content message",s="question_hint"),bn("div",{className:"question"},bn("div",{className:"question_actions"},bn("span",null,window.wplms_course_data.translations.question_full_prefix," ",n+1),bn("div",null,bn("span",{className:"marks"},bn("i",{className:"vicon vicon-medall"}),t.marks))),e.renderSwitch(t,n),t.attempted&&t.show_correct_answer&&t.explanation.length?bn(zn,null,bn("div",{className:"answers"},t.hasOwnProperty("correct")?bn("div",{className:"correct_answer"},bn("label",null,window.wplms_course_data.translations.correct_answer),bn("div",{dangerouslySetInnerHTML:{__html:t.correct}})):"",t.hasOwnProperty("marked")&&t.marked?bn("div",{className:"marked_answer"},bn("label",null,window.wplms_course_data.translations.marked_answer),bn("div",{dangerouslySetInnerHTML:{__html:t.marked}})):""),bn("div",{className:"explanation"},bn("strong",null,window.wplms_course_data.translations.question_explanation),bn("div",{dangerouslySetInnerHTML:{__html:t.explanation}}))):"")}),bn("style",null,'\n\t:root { --body: #fafafa; --highlight: #fff; --text: #475F7B; --bold: #394C62; --primary: #5A8DEE; --secondary: #475F7B; --success: #39DA8A; --primarycolor: #fff; --sidebar: #f4f4ff; --border: rgba(0,0,0,0.08); --darkborder: rgba(0,0,0,0.3); --blue: #5A8DEE; --indigo: #6610F2; --purple: #6F42C1; --pink: #E83E8C; --red: #FF5B5C; --orange: #FD7E14; --yellow: #FDAC41; --green: #39DA8A; --cyan: #00CFDD; --white: #FFFFFF; --gray: #475F7B; --gray-dark: #394C62; --info: #00CFDD; --warning: #FDAC41; --danger: #FF5B5C; --light: #A3AFBD; --dark: #394C62; --error: #ffe27e; --errortext: #725906; --shadow: rgba(0,0,0,0.2); } \n\t.correct_answer { margin-bottom: 1rem;border-bottom:1px solid rgba(0,0,0,0.1); } \n\t.course_status .incourse > * { margin: 0.5rem; } .course_status .incourse .quiz_pagination_wrapper { margin: 1.5rem 0; } .course_status .incourse .quiz_pagination_wrapper .buttons { align-items: center; display: flex; flex-wrap: wrap; justify-content: flex-start; } .course_status .incourse .quiz_pagination_wrapper .question .button { width: auto !important; display: inline-block !important; height: auto !important; } .course_status .incourse .quiz_pagination_wrapper > .button { background: var(--highlight) !important; color: var(--bold) !important; border: 1px solid var(--border) !important; min-width: auto !important; margin: 0; text-align: center; border-radius: 0; padding: 12px 0; width: 48px !important; } .course_status .incourse .quiz_pagination_wrapper > .button.right { float: none; } .course_status .incourse .quiz_pagination_wrapper > .button.active { background: var(--primary) !important; color: var(--primarycolor) !important; } .course_status .incourse .quiz_pagination_wrapper > .button.ques_link { min-with: auto !important; } .course_status .incourse .quiz_stats_chart { display: flex; flex-direction: row; flex-wrap: wrap; } .course_status .incourse .quiz_stats_chart .quiz_stats_chart_pie { width: 340px; } .course_status .incourse .quiz_stats_chart .question_stats_content_wrapper { width: calc(100% - 340px); margin-bottom: 1rem; } .course_status .incourse .quiz_stats_chart span.question_stats_content_heading { margin-bottom: 1rem; display: inline-block; } .course_status .incourse .quiz_stats_chart span.question_stats_content_heading:not(:nth-child(1)) { margin-top: 1.5rem; } .course_status .incourse .quiz_stats_chart .question_stats_content { display: flex; flex-wrap: wrap; margin: 0 -5px; } .course_status .incourse .quiz_stats_chart .question_stats_content > * { margin: 5px; } .course_status .incourse .question_wrapper { min-height: 100px; position: absolute; overflow: hidden; left: 0; top: 0; width: 100%; height: 100%; z-index: 99; text-align: center; transition: all 200ms ease-in; } .course_status .incourse .question_wrapper.loaded .result { transform: translateX(40%); } .course_status .incourse .question_wrapper.loaded .result .correct > span, .course_status .incourse .question_wrapper.loaded .result .incorrect > span { transform: scale(1); } .course_status .incourse .question_wrapper .fillblank_area { clear: none; display: inline-block; } .course_status .incourse .question_wrapper .result { transition: all 200ms ease-in; } .course_status .incourse .question_wrapper .incorrect, .course_status .incourse .question_wrapper .correct { display: inline-block; margin-top: 15px; padding: 10px; } .course_status .incourse .question_wrapper .incorrect strong { color: #ef614d; font-size: 48px; line-height: 64px; margin: 0 10px; font-weight: 600; } .course_status .incourse .question_wrapper .incorrect > span { background: #ef614d; } .course_status .incourse .question_wrapper .incorrect > span:before { content: "e646"; font-family: vicon; color: #fff; font-weight: 900; position: absolute; font-size: 3rem; top: 50%; left: 50%; transform: translate(-50%, -50%); } .course_status .incourse .question_wrapper .correct strong { font-size: 48px; line-height: 64px; margin: 0 10px; font-weight: 600; color: #75b733; } .course_status .incourse .question_wrapper .correct > span:before { content: "e64c"; font-family: vicon; color: #fff; font-weight: 900; position: absolute; font-size: 3rem; top: 50%; left: 50%; transform: translate(-50%, -50%); } .course_status .incourse .question_wrapper span { position: relative; width: 64px; height: 64px; float: left; border-radius: 50%; background: #75b733; display: block; padding: 30px; transform: scale(15); transition: all 200ms ease-in-out; } .course_status .incourse .question_wrapper span .correct > span:before { font-family: fonticon; top: 18px; left: 18px; content: "e038"; color: #FFF; font-size: 30px; line-height: 1; position: absolute; } .course_status .incourse .checked_answer { margin: 2.5rem 0 0; padding: 1rem; font-size: 1.2rem; color: var(--bold); border: 1px solid var(--border); background-color: var(--sidebar); border-radius: 2px; } .course_status .incourse .checked_answer.incorrect { background: #d8eec2; } .course_status .incourse .checked_answer.correct { background: #d8eec2; } .course_status .incourse .checked_answer span { white-space: nowrap; } .course_status .incourse .quiztimer { display: grid; justify-items: center; align-items: center; } .course_status .incourse .quiztimer .circle_timer { display: flex; flex-direction: row; } .course_status .incourse .quiztimer .circle_timer > span { display: flex; justify-content: center; flex-direction: column; } .course_status .incourse .quiztimer .circle_timer .react-progress-circle { display: flex; } .course_status .incourse .quiztimer .timer_amount, .course_status .incourse .quiztimer .timer_unit { color: var(--bold); line-height: 1em; display: grid; grid-template-columns: 1fr 5px 1fr; justify-items: center; } .course_status .incourse .quiztimer .timer_amount span:nth-child(n+4), .course_status .incourse .quiztimer .timer_amount span:nth-child(n+4), .course_status .incourse .quiztimer .timer_unit span:nth-child(n+4), .course_status .incourse .quiztimer .timer_unit span:nth-child(n+4) { display: none; } .course_status .incourse .quiztimer .timer_amount { font-size: 2rem; } .course_status .incourse .quiztimer .timer_amount span { margin: 0 5px; } .course_status .incourse .quiztimer .timer_unit { font-size: 11px; } .course_status .incourse .fillblank_area { clear: none; display: inline-block; } .course_status .incourse span.select_question_content { display: inline-block; } .course_status .incourse .question_content select { margin: 0 5px; } .course_status .incourse .droppable > div { border: 1px solid var(--border); padding: 1rem; cursor: move; } .course_status .incourse .droppable:hover > div { border-color: var(--primary); } .course_status .incourse .droppable.active { overflow-y: scroll; } .course_status .incourse .question .droppable, .course_status .incourse .match_options { touch-action: none; } .course_status .incourse .droppable > div + div { border-top: none; } .course_status .incourse .droppable .dragging { border: 1px solid #f5d01a; box-shadow: 0 0 6px #efc600; } .course_status .incourse .quiz_questions_content .question_actions { margin-top: 1rem; display: flex; flex-direction: row; flex-wrap: wrap; justify-content: space-between; align-items: center; font-size: 1.5rem; } .course_status .incourse .quiz_questions_content .question_actions span.button { cursor: pointer; padding: 0.2rem; font-size: 1.2rem; margin: 0; } .course_status .incourse .quiz_questions_content .question_actions > div { display: flex; flex-direction: row; } .course_status .incourse .quiz_questions_content .question_actions > div span { margin: 0 0.2rem; z-index: 11; } .course_status .incourse .quiz_questions_content .question_actions > div span:not(.marks) { cursor: pointer; } .course_status .incourse .quiz_questions_content .question .marks i.icon-check-5:before { content: "e63a"; font-family: vicon; font-weight: 400 !important; font-variant: normal !important; text-transform: none !important; speak: none; line-height: 1; margin: 5px; } .course_status .incourse .question .question_option p { display: inline-block; } .course_status .incourse .question_option { display: block; margin-bottom: 1rem; } .course_status .incourse .question_option label { margin-bottom: 0; } .course_status .incourse .question_option.radio + .radio { margin-left: 0; } .course_status .incourse .match_playground { display: grid; grid-template-columns: 1fr 1fr; justify-content: center; align-items: stretch; grid-gap: 1rem; margin: 1rem 0; } .course_status .incourse .match_playground .droppable { border: 1px solid rgba(0, 0, 0, 0.2); } .course_status .incourse .match_playground .match_options .match_option { border: 1px solid rgba(0, 0, 0, 0.08); padding: 2rem; } .course_status .incourse .match_playground .droppable { display: grid; grid-template-columns: 1fr; grid-gap: 10px; padding: 30px; justify-content: center; align-items: center; } .course_status .incourse .match_playground .droppable > div { border-top: 1px solid var(--border); } .course_status .incourse .match_playground .match_option { background: var(--border); } .course_status .incourse .match_playground .match_option .children > div { border: 1px solid var(--border); padding: 1rem; background: var(--highlight); } .course_status .incourse .quiz_questions_content { flex: 3 0 480px; max-width: 100%; } .course_status .incourse .quiz_questions_content .question_content { padding: 1rem 0; border-top: none; } .course_status .incourse .quiz_questions_content .question { position: relative; border-bottom: 1px solid rgba(0,0,0,0.1); } .course_status .incourse .quiz_questions_content .question .question_hint { cursor: pointer; margin-right: 5px; } .course_status .incourse .quiz_questions_content .question .question_hint:before { content: "e718"; font-family: vicon; font-size: 22px; } .course_status .incourse .quiz_questions_content .question .question_hint.show:before { content: "e646"; } .course_status .incourse .quiz_questions_content .question .question_hint span.question_hint_content { transform: scale(0); padding: 1rem; background: var(--sidebar); border-radius: 5px; margin: 1rem 0; opacity: 0; transition: 0.2s all; } .course_status .incourse .quiz_questions_content .question .question_hint span.question_hint_content.show { transform: scale(1); opacity: 1; } .course_status .incourse .quiz_questions_content .question .explanation { /* padding: 1rem; */ /* font-size: 1.2rem; */ border: 1px solid var(--border); background: var(--highlight); z-index: 99; position: relative; margin: 1rem 0; } .course_status .incourse .quiz_questions_content .question_wrapper.loaded .result { transform: translate(0, -24px) scale(0.75); } .course_status .incourse div.sort_options { touch-action: none; } .course_status .incourse .single-quiz .question .question_content:first-child { border-top: none; } .course_status .incourse .quiz_questions li > strong { display: block; margin: 5px 0; } .course_status .incourse .incoursequiz_details { display: flex; flex: 1 0 240px !important; max-width: 100%; flex-direction: column; justify-content: space-between; align-items: baseline; align-items: center; margin-bottom: 1.5rem; flex: 1; z-index: 999; padding: 0.5rem; position: sticky; top: 3rem; background: var(--highlight); bordeR: 1px solid var(--border); border-radius: 5px; align-items: center; transition: 0.5s all; margin: 1rem 0; } .course_status .incourse .incoursequiz_details > div { display: flex; flex-wrap: wrap; justify-content: space-between; margin: 0 -0.5rem; align-items: center; width: 100%; } .course_status .incourse .incoursequiz_details > div > * { margin: 0.5rem; } .course_status .incourse .incoursequiz_details > div strong { flex: 1; } .course_status .incourse .incoursequiz_details > div strong .student_score { font-size: 1.8rem; } .course_status .incourse .incoursequiz_details > div strong .student_quiz_status { opacity: 0.7; font-size: 75%; margin: 0 0.75rem; } .course_status .incourse .incoursequiz_details > div .show_questions { display: flex; align-items: center; } .course_status .incourse .incoursequiz_details > div .show_questions > span:not(.vicon) { font-size: 11px; opacity: 0.5; text-transform: uppercase; } .course_status .incourse .incoursequiz_details .incourse_quiz_button > a { flex: 1; margin: 0 1rem; } .course_status .incourse .incoursequiz_details .quiz_timeline { min-width: 160px; margin: 0; padding: 0; max-height: none; overflow: hidden; } .course_status .incourse .incoursequiz_details .quiz_timeline li.done > span { display: flex; align-items: center; flex-direction: row-reverse; } .course_status .incourse .incoursequiz_details .quiz_timeline li.done > span:before { position: relative; color: var(--primary); } .course_status .incourse .incoursequiz_details .quiz_timeline li.done.active > span:before { color: var(--primarycolor); } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper { border: none; justify-content: center; align-items: center; display: flex; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul { display: flex; flex-wrap: wrap; margin: -0.25rem; font-size: 0.8rem; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li { margin: 0.25rem; padding: 5px; border-radius: 2px; border: none; display: flex; width: 32px; height: 24px; align-items: center; border: 1px solid var(--border); cursor: pointer; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li.bookmarked { box-shadow: 0 2px 2px var(--shadow); } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li.done { background: var(--border); } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li.done > span:before { content: "e64c"; font-family: vicon; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li.done.correct { color: #fff; background: rgba(0, 128, 0, 0.5); } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li.done.incorrect { color: #fff; background: rgba(255, 0, 0, 0.5); } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li.done.incorrect > span:before { content: "e646"; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li.active { background: var(--primary); color: var(--primarycolor); } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul li > span { position: relative; width: 100%; text-align: center; margin: 0; height: auto; background: none; border-radius: 0; bordeR: none; top: auto; left: auto; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul > span { display: flex; align-items: center; margin: 0 0.5rem; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper > ul > span > span:not(.vicon) { font-size: 11px; opacity: 0.5; text-transform: uppercase; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper.question_numbers ul > li { width: auto !important; white-space: nowrap; } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper.question_numbers ul > li:before { content: attr(data-number); } .course_status .incourse .incoursequiz_details .quiz_timeline .timeline_wrapper.question_numbers ul > li > span { padding: 0 5px; background: var(--border); margin: -2px -2px -2px 5px; border-radius: 2px; } .course_status .incourse span.question_hint_content { transform: scale(0); padding: 1rem; background: var(--sidebar); border-radius: 5px; margin: 1rem 0; opacity: 0; transition: 0.2s all; } .course_status .incourse span.question_hint_content.show { transform: scale(1); opacity: 1; } .course_status .incourse .question_option .radio > input[type=radio] + label, .course_status .incourse .question_option .checkbox > input[type=radio] + label { display: flex; align-items: center; } .course_status .incourse div#unit.quiz_title h1 { width: 50%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; } .course_status .incourse div#unit.quiz_title h5 { font-size: 14px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; } .course_status .incourse .loading_quiz.disabled { display: none; } .course_status .incourse .loading_quiz { position: fixed !important; width: 0%; height: 0%; left: 50%; top: 50%; z-index: 9999; } .course_status .incourse .question_correct { border: 2px solid rgba(0, 128, 0, 0.5) !important; padding: 5px; border-radius: 5px; } .course_status .incourse .question_incorrect { border: 2px solid rgba(255, 0, 0, 0.5) !important; padding: 5px; border-radius: 5px; } .course_status .incourse .quiz_questions_content { flex: 3 0 640px; max-width: 100%; } .course_status .incourse .quiz_questions_content .question_option.radio label > div, .course_status .incourse .quiz_questions_content .question_option.checkbox label > div { display: inline-block; } .course_status .incourse .quiz_questions_content .question_option.radio label > div > p, .course_status .incourse .quiz_questions_content .question_option.checkbox label > div > p { margin: 0; } .course_status .incourse .incourse_quiz_button { display: flex; flex-direction: column; justify-content: space-around; align-items: center; } .course_status .incourse .incourse_quiz_button a { text-align: center; width: 100%; margin: 0.25rem !important; } .course_status .incourse .quiz_retake { display: flex; align-items: center; flex-wrap: wrap; margin: 0 -0.25rem; } .course_status .incourse .quiz_retake > * { flex: 1 0 180px; margin: 0.25rem; } .course_status .incourse .confirmpopup_wrapper { position: fixed; top: 0; left: 0; height: 100vh; width: 100vw; background: rgba(0, 0, 0, 0.5); z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; } .course_status .incourse .confirmpopup_wrapper .confirmpopup_content { padding: 1rem; background: var(--highlight); border-radius: 5px; min-width: 50%; } .course_status .incourse span.question_stats_content_heading { margin-bottom: 1rem; display: inline-block; } .course_status .incourse span.question_stats_content_heading:not(:nth-child(1)) { margin-top: 1.5rem; } .course_status .incourse .question_stats_content .checked_answer span { text-transform: capitalize; } .course_status .incourse .question_stats_content { display: flex; flex-wrap: wrap; margin: 0 -5px; align-items: start; } .course_status .incourse .question_stats_content > * { margin: 5px; } .course_status .incourse .question_stats_content span { margin: 5px; } .course_status .incourse .question_stats_content .checked_answer { text-align: center; } .course_status .incourse .quiz_stats_chart { display: flex; flex-direction: row; flex-wrap: wrap; } .course_status .incourse .quiz_stats_chart .quiz_stats_chart_pie { flex: 1 0 240px; } .course_status .incourse .quiz_stats_chart .question_stats_content_wrapper { flex: 2 0 480px; } .course_content_content { display: inline-block; width: 100%; padding: 0.75rem 1rem 0; } .course_content_content h2 { font-size: 2.5rem; font-weight: 800; margin: 0 0 1.5rem !important; } .course_content_content .video_wrapper { z-index: 11; } .course_content_content .unit_attachments { background: var(--border); padding: 1rem; margin: 1rem 0; border-radius: 5px; display: flex; flex-direction: column; } .course_content_content .unit_attachments h3 { font-weight: 600; margin-bottom: 0.5rem; } .course_content_content .unit_attachments .attachment { width: 100%; display: flex; flex-direction: row; justify-content: space-between; align-items: center; margin: 0.5rem 0; } .course_content_content .unit_attachments .attachment > span { display: flex; align-items: center; margin: 0 -5px; } .course_content_content .unit_attachments .attachment > span span.attachment_icon > svg { width: 32px; fill: var(--text); color: var(--text); } .course_content_content .unit_attachments .attachment > span > * { margin: 0 5px; } .course_content_content .unit_assignments { background: var(--border); padding: 1rem; margin: 1rem 0; border-radius: 5px; display: flex; flex-direction: column; } .course_content_content .unit_assignments h3 { font-weight: 600; margin-bottom: 0.5rem; } .course_content_content .unit_assignments .assignment .assignment_heading { display: flex; justify-content: space-between; padding: 5px 0; } .course_content_content .pratice_questions { margin: 1rem 0; } .course_content_content .pratice_questions .incourse { margin: 1rem 0; background: var(--sidebar); padding: 1rem 1.5rem; border-radius: 8px; } .course_content_content .pratice_questions .incourse .quiz_questions_content { margin: 0; } .finish-course-content { display: flex; flex-direction: column; justify-content: center; text-align: center; padding-top: 60px; } .finish-course-content h1 { font-size: 3rem; } .finish-course-content h2 { font-size: 2.5rem; } .finish-course-content h3 { font-size: 1.8rem; } .finish-course-content .post_completion_message { flex: 1; max-height: calc(100vh - 550px); overflow-y: auto; min-height: 100px; } .finish-course-content .vibe_editor_rich_text { text-align: start; } .finish-course-content .completion_message { font-size: 1.2rem; margin: 1rem 0; } .finish-course-content .awards { display: flex; align-items: baseline; justify-content: center; margin: 1.5rem 0; } .finish-course-content .awards .certificate svg, .finish-course-content .awards .badge img { fill: var(--light); width: 64px; height: 64px; border-radius: 5px; } .finish-course-content .awards > * { margin: 1rem 0.5rem; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #fafafa; padding: 1rem; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); border-radius: 5px; width: 128px; transition: all 0.2s; font-size: 1rem; font-weight: 600; } .finish-course-content .awards > *:hover { box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); transform: translateY(-2px); } .finish-course-content .finished_percentage { display: flex; align-items: center; justify-content: center; margin: 0; position: absolute; top: -90px; right: calc(50% - 90px); } .finish-course-content .finished_percentage > span { width: 180px; height: 180px; font-weight: 800; display: flex; flex-direction: column; line-height: 0; align-items: center; justify-content: center; border-radius: 50%; font-size: 1.6rem; font-weight: 600; color: var(--primarycolor); background: var(--primary); box-shadow: 0 -1px 1rem var(--highlight); } .finish-course-content .finished_percentage > span:before { position: absolute; content: \'\'; width: 100%; height: 100%; border: 10px solid #fff; box-shadow: inset 0 1px 10px rgba(0, 0, 0, 0.4); border-radius: 50%; z-index: 0; } .finish-course-content .finished_percentage > span > span { line-height: 1; font-size: 11px; display: flex; flex-wrap: wrap; letter-spacing: 1px; position: relative; font-weight: 800; font-size: 11px; letter-spacing: 2px; } .finish-course-content .finished_percentage > span > span + span { width: 80%; } .finish-course-content .finished_percentage > span > span strong { font-size: 4rem; color: var(--primarycolor); margin-left: -0.5rem; } .finish-course-content .finished_percentage > span > span strong + span { font-size: 1rem; position: absolute; margin-top: 1rem; right: -1rem; top: 0; } .quiz_bar { background: var(--highlight); padding: 0.5rem; margin: 1rem 0; align-items: center; display: inline-block; width: 100%; } .quiz_pagination_wrapper .faded { opacity: 0.45; } .quiztimer { display: flex; justify-content: center; } .quiztimer .c100.big { font-size: 10rem; } .quiztimer .c100.big > span { font-size: 1.5rem; display: flex; flex-direction: column; line-height: 1.5; } .quiztimer .c100.big > span span.timer_amount, .quiztimer .c100.big > span span.timer_unit { display: flex; align-items: center; justify-content: center; } .quiztimer .c100.big > span span.timer_amount > span + span, .quiztimer .c100.big > span span.timer_unit > span + span { margin-left: 2px; } .quiztimer .c100.big > span > span.timer_unit { font-size: 0.7rem; opacity: 0.5; } .quiztimer .c100.big:after { border: 1px dashed rgba(0, 0, 0, 0.05); } .answers { margin: 0.5rem 0; }\n\t')))):"";const{Component:Sn,createElement:On,render:Pn,useState:En,useEffect:In,Fragment:Cn}=wp.element;var Mn=e=>{const[t,n]=En(e.duration),[s,a]=En({d:0,h:0,m:0,s:0});In(()=>{if(e.start){setTimeout(()=>{let s=t-1;s<=-1?e.update(e.quiz_id,"expired"):s>=0&&(n(s),r())},1e3)}else n(e.duration),r()},[t,e.start,e.duration]);const r=()=>{let e={...s},n=t;n>86400?(e.d=Math.floor(n/86400),n-=86400*e.d):e.d=0,n>3600?(e.h=Math.floor(n/3600),n-=3600*e.h):e.h=0,n>60?(e.m=Math.floor(n/60),n-=60*e.m):e.m=0,e.s=n,a(e)};return On("div",{className:"driptimer_wrapper"},On("div",{className:"driptimer"},On("span",{className:"timer_amount"},s.d?On(Cn,null,On("span",null,s.d),On("span",null,":")):"",s.h?On(Cn,null,On("span",null,s.h),On("span",null,":")):"",s.m?On(Cn,null,On("span",null,s.m),On("span",null,":")):"",On("span",null,s.s)),On("span",{className:"timer_unit"},s.d?On(Cn,null,On("span",null,window.wplms_course_data.translations.days),On("span",null)):"",s.h?On(Cn,null,On("span",null,window.wplms_course_data.translations.hours),On("span",null)):"",s.m?On(Cn,null,On("span",null,window.wplms_course_data.translations.minutes),On("span",null)):"",On("span",null,window.wplms_course_data.translations.seconds))))};const{createElement:Tn,useState:Ln,useEffect:jn,Fragment:An,render:Dn,useRef:Hn}=wp.element,{dispatch:Fn,select:Bn}=wp.data;const{createElement:$n,render:Rn,useState:Un,useEffect:Jn,useCallback:Wn,useRef:Xn,Fragment:Yn,useLayoutEffect:Vn}=wp.element,{dispatch:Qn,select:Kn}=wp.data;function Gn(e){if(null==e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Zn(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function es(e){try{JSON.parse(e)}catch(e){return!1}return!0}var ts=e=>{const[t,n]=Un({}),[s,a]=Un("quiz"),[r,i]=Un([]),o=Xn(null),[l,u]=Un({}),[c,d]=Un("up"),[m,_]=Un(!1),[h,w]=Un(!1),[g,f]=Un(!1),[v,y]=Un(!0),[b,k]=Un(null),[x,q]=Un(null),[z,N]=Un([]),[S,O]=Un([]),[P,E]=Un(!1),[I,C]=Un("");Jn(()=>{let t=Kn("vibebp").getToken();Zn(t)?localforage.getItem("bp_login_token").then(e=>{t=e,M(t),k(t)}):(M(t),k(t)),document.addEventListener("wplms_answer_question_type",({detail:e})=>{T(e.question,e.index,"changed")}),localforage.getItem("bookmarked_questions_"+e.quizid).then(e=>{e&&e.length&&N(JSON.parse(e))})},[e.quizid]),Jn(()=>{e&&e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz&&!b&&t.hasOwnProperty("id")&&(localStorage.setItem("vibequiz_"+t.id,JSON.stringify(t)),document.querySelector(".start_quiz_button")&&document.querySelector(".start_quiz_button").remove()),document.dispatchEvent(new Event("VibeBP_Editor_Content"))},[t]);const M=(t=null,s=null)=>{t||(t=b),a("quiz");let r={token:t};if(e.hasOwnProperty("activity")&&e.activity&&(r.activity=e.activity),e.hasOwnProperty("course")&&e.course&&(r.course=e.course),e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz&&!t){let s=localStorage.getItem("vibequiz_"+e.quizid),r="";if(void 0!==s&&s){if(r=JSON.parse(s),r){if(q(null),r.hasOwnProperty("drip_message"))n(r);else if(r.meta&&r.meta.questions){let s=0,a=0;if("object"==typeof r.meta.questions&&!Array.isArray(r.meta.questions)){let e=[];Object.keys(r.meta.questions).map(t=>{"object"==typeof r.meta.questions[t]&&(r.meta.questions[t].id=t,e.push(r.meta.questions[t]),e.id=t)}),r.meta.questions=e}r.meta.questions.map((e,t)=>{if(e.raw)r.meta.questions[t]=e.raw;else{r.meta.questions[t].show=!1;let n=localStorage.getItem(e.id);!Gn(n)&&Zn(e.marked_answer)&&(es(n)?r.meta.questions[t].marked_answer=JSON.parse(n):r.meta.questions[t].marked_answer=n)}s+=parseFloat(e.user_marks),a+=parseInt(e.marks)}),Number.isInteger(s)||(s=s.toFixed(2)),r.marks=s,r.max_marks=a,r.question_number=parseInt(r.question_number);let o=[];if(r.question_number&&r.question_number>0)for(let e=0;e<r.question_number;e++)o.push(e);if(i(o),e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz&&!t){let t=localStorage.getItem("quiz_expiry_"+e.quizid);if(void 0!==t&&t){let e=Math.floor((new Date).getTime()/1e3);e>=parseInt(t)?D(r):r.remaining=parseInt(t)-e}let n=localStorage.getItem("quiz_retakes_"+e.quizid);if(n&&(n=parseInt(n),r.hasOwnProperty("meta")||(r.meta={}),r.meta.hasOwnProperty("retakes"))){let e=parseInt(r.meta.retakes)-n;e<-1&&(e=0),r.meta.retakes=e}}n(r)}var o=document.createEvent("Event");o.initEvent("unit_traverse",!1,!0),document.querySelector(".unit_content")&&document.querySelector(".unit_content")&&document.querySelector(".unit_content").dispatchEvent(o)}else console.log(r);return void a(!1)}}let l=window.wplms_course_data.api_url+"/user/quiz/"+e.quizid;e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz&&!t&&(l=window.wplms_course_data.api_url+"/quiz/nonloggedin/"+e.quizid+"?client_id="+window.wplms_course_data.client_id),e.hasOwnProperty("force")&&e.force&&(l.includes("?client_id")?l+="&force":l+="?force"),s&&!l.includes("force")&&(l.includes("?")?l+="&force":l+="?force"),r.hasOwnProperty("activity")&&r.activity&&(/\?/.test(l)?l+="&activity="+r.activity:l+="?activity="+r.activity),fetch(l,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(r)}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(s=>{if(s){if(q(null),s.hasOwnProperty("drip_message"))n(s);else if(s.meta&&s.meta.questions){let t=0,a=0;if("object"==typeof s.meta.questions&&!Array.isArray(s.meta.questions)){let e=[];Object.keys(s.meta.questions).map(t=>{"object"==typeof s.meta.questions[t]&&(s.meta.questions[t].id=t,e.push(s.meta.questions[t]),e.id=t)}),s.meta.questions=e}s.meta.questions.map((e,n)=>{if(e.raw)s.meta.questions[n]=e.raw;else{s.meta.questions[n].show=!1;let t=localStorage.getItem(e.id);!Gn(t)&&Zn(e.marked_answer)&&(es(t)?s.meta.questions[n].marked_answer=JSON.parse(t):s.meta.questions[n].marked_answer=t);try{JSON.parse(e.correct),e.attempted&&(s.meta.questions[n].correct=JSON.parse(wt.AES.decrypt(e.correct,e.key,{format:gt}).toString(wt.enc.Utf8)),s.meta.questions[n].correct=vt(e))}catch(e){console.log(e)}}t+=parseFloat(e.marks),a+=parseInt(e.max_marks)}),Number.isInteger(t)||(t=t.toFixed(2)),isNaN(a)||(s.marks=t,s.max_marks=a),s.question_number=parseInt(s.question_number);let r=[];if(s.question_number&&s.question_number>0)for(let e=0;e<s.question_number;e++)r.push(e);i(r);let o=Math.floor((new Date).getTime()/1e3);s.hasOwnProperty("expiry")&&s.expiry>0&&(s.expiry>o?s.remaining=parseInt(s.expiry)-o:s.remaining=0);let l=localStorage.getItem("quiz_retakes_"+e.quizid);if(l&&(l=parseInt(l),s.hasOwnProperty("meta")||(s.meta={}),s.meta.hasOwnProperty("retakes"))){let e=parseInt(s.meta.retakes)-l;e<-1&&(e=0),s.meta.retakes=e}n(s)}s.remaining&&s.remaining<=0&&D(s,t);var r=document.createEvent("Event");r.initEvent("unit_traverse",!1,!0),document.querySelector(".unit_content")&&document.querySelector(".unit_content")&&document.querySelector(".unit_content").dispatchEvent(r)}else console.log(s);a(!1)}).catch(e=>{a(!1),console.error("Uh oh, an error!",e),Qn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},T=(e,s,a)=>{if("changed"==a){let a={...t};a.meta.questions[s]=e,n(a),Zn(e.marked_answer)?null==e.marked_answer&&localStorage.removeItem(e.id):"object"==typeof e.marked_answer||Array.isArray(e.marked_answer)?localStorage.setItem(e.id,JSON.stringify(e.marked_answer)):localStorage.setItem(e.id,e.marked_answer)}},L=(e,t)=>{"show"==t&&i(e)},j=()=>{a("start");let s={...t};if(s.start=!0,s.remaining&&s.remaining>0)a(!1),n(s);else{let t={quiz_id:s.id,token:b};if(e.hasOwnProperty("course")&&(t.course=e.course),s.hasOwnProperty("non_logged_in_quiz")&&s.non_logged_in_quiz&&(!b||e.hasOwnProperty("exported")&&e.exported))return a(!1),localStorage.setItem("quiz_expiry_"+s.id,Math.floor((new Date).getTime()/1e3)+s.meta.duration),n(s),void U(s);fetch(window.wplms_course_data.api_url+"/user/quiz/start?post",{method:"POST",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(t)}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{a(!1),n(s),U(s);let t=window.wplms_course_data.api_url+"/student/quiz";$(t),e.hasOwnProperty("message")&&Qn("vibebp").addNotification({text:e.message})}).catch(e=>{a(!1),console.error("Uh oh, an error!",e),Qn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}},D=(s=null,r=null)=>{N([]),localforage.removeItem("bookmarked_questions_"+e.quizid),s||(s=t),r||Zn(b)||(r=b),localStorage.removeItem("quiz_expiry_"+s.id),a("submit");let i={...s},o=0,l=0;if(i.meta&&i.meta.questions&&i.meta.questions.length)for(let e=0;e<i.meta.questions.length;e++)i.meta.questions[e].attempted||(i.meta.questions[e]=bt(i.meta.questions[e],t.partial_marking,t.negative_marking,parseFloat(t.negative_marks),!1)),i.meta.questions[e].content=i.meta.questions[e].original_content,i.meta.questions[e].auto||(i.meta.questions[e].user_marks=0),o+=parseFloat(i.meta.questions[e].user_marks),l+=parseInt(i.meta.questions[e].marks),localStorage.removeItem(i.meta.questions[e].id);if(i.marks=o.toFixed(2),i.max_marks=l,(isNaN(i.max_marks)||i.max_marks<1)&&(i.max_marks=1),(isNaN(i.marks)||i.marks<1)&&(i.marks=0),e.hasOwnProperty("update")&&e.update("update_quiz_marks",{user_marks:i.marks,total_marks:i.max_marks}),i.hasOwnProperty("remaining")&&delete i.remaining,e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz)return i.submitted=!0,i.start=!1,n(i),void(e.hasOwnProperty("update")&&e.update("quizsubmitted"));fetch(window.wplms_course_data.api_url+"/user/submitresult?post",{method:"POST",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({quiz_id:i.id,course_id:i.hasOwnProperty("course_id")?i.course_id:e.hasOwnProperty("course")?e.course:"",results:i.meta.questions,quiz:i,token:r})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{if(t){if(a(!1),i.submitted=!0,i.start=!1,t.check_results_url&&(i.check_results_url=t.check_results_url),t.hasOwnProperty("retakes")&&void 0!==t.retakes&&(i.hasOwnProperty("meta")&&void 0!==i.meta||(i.meta={}),i.meta.retakes=t.retakes),t.completion_message&&(i.meta.completion_message=t.completion_message),t.retake_html&&(i.retake_html=t.retake_html),i.meta&&i.meta.questions&&i.meta.questions.length&&!Zn(t.correct_data))for(let e=0;e<i.meta.questions.length;e++)t.correct_data.hasOwnProperty(i.meta.questions[e].id)&&(i.meta.questions[e].correct_data=t.correct_data[i.meta.questions[e].id]);t.hasOwnProperty("tags_data")&&(i.tags_data=t.tags_data),n(i);var s=document.createEvent("Event");if(s.initEvent("unit_traverse",!1,!0),i.hasOwnProperty("quiz_passing_score")&&i.quiz_passing_score?t.hasOwnProperty("continue")&&t.continue&&e.hasOwnProperty("update")&&e.update("quizsubmitted"):e.hasOwnProperty("update")&&e.update("quizsubmitted"),document.querySelector(".unit_content")&&document.querySelector(".unit_content")){document.querySelector(".unit_content").dispatchEvent(s);var r=new CustomEvent("react_quiz_submitted",{detail:{next_unit:t.next_unit}});document.dispatchEvent(r)}R(i);let o=window.wplms_course_data.api_url+"/user/quiz/previousresults/"+e.quizid;$(o,!0);let l=window.wplms_course_data.api_url+"/student/quiz";$(l);let u=`${window.wplms_course_data.api_url}/instructor/stats/${e.quizid}`;$(u);let c=`${window.wplms_course_data.api_url}/instructor/leaderboard/${e.quizid}`;$(c),t.hasOwnProperty("message")&&Qn("vibebp").addNotification({text:t.message})}}).catch(e=>{a(!1),console.error("Uh oh, an error!",e),Qn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},H=(e,n)=>{switch(e.type){case"smalltext":return $n(Z,{question:e,index:n,update:T});case"single":return $n(re,{question:e,index:n,update:T,quiz_id:t.id});case"select":return $n(de,{question:e,index:n,update:T,quiz_id:t.id});case"multiple":return $n(ge,{question:e,index:n,update:T,quiz_id:t.id});case"fillblank":return $n(Pe,{question:e,index:n,update:T,quiz_id:t.id});case"sort":return $n(Be,{question:e,index:n,update:T,quiz_id:t.id});case"match":return $n(et,{question:e,index:n,update:T,quiz_id:t.id});case"truefalse":return $n(it,{question:e,index:n,update:T,quiz_id:t.id});case"largetext":return $n(_t,{question:e,index:n,update:T,quiz_id:t.id});default:let s=1e3*Math.random();return document.dispatchEvent(new CustomEvent("wplms_load_question_type",{detail:{question:e,update:T,quiz_id:t.id,index:n,keyref:s}})),$n("div",{"data-q":e.id,className:e.type,"data-keyref":s})}},F=(e,n)=>{if("trigger"==n)switch(e){case"submit":D(t),w(!1),f(!1);break;case"start":j(),_(!1)}if("nottrigger"==n)switch(e){case"submit":w(!1),f(!1);break;case"start":_(!1)}},B=async()=>{if(!t.meta.questions.length)return!1;void 0===e.quizid&&(e.quizid=e.quiz.id),document.getElementById("quiz_results_"+e.quizid)&&document.getElementById("quiz_results_"+e.quizid).remove();const n=document.createElement("div");if(n.src=n.src,n.setAttribute("id","quiz_results_"+e.quizid),n.classList.add("quiz_results"),t.hasOwnProperty("title")){let e=document.createElement("meta"),n=document.createElement("meta");e.setAttribute("property","og:title");let s="";t.meta.auto&&(s=t.marks+"/"+t.max_marks),t.quiz_passing_score&&(t.marks>t.quiz_passing_score?s+=" "+window.wplms_course_data.translations.passed:s+=" "+window.wplms_course_data.translations.failed),e.setAttribute("content",s+t.title),e.setAttribute("name","twitter:title"),e.setAttribute("content",s+t.title),document.body.appendChild(e),document.body.appendChild(n)}var s;document.body.appendChild(n),Rn($n(Nn,{quiz:t,renderSwitch:H}),document.getElementById("quiz_results_"+e.quizid)),await(s=1e3,new Promise(e=>setTimeout(e,s)));let a=document.getElementById("quiz_results_"+e.quizid).outerHTML;document.getElementById("quiz_results_"+e.quizid)&&document.getElementById("quiz_results_"+e.quizid).remove();var r=window.open("","","height=800, width=1000");r.document.write(a),r.print()},$=(e,t=null,n=null)=>n&&!navigator.onLine?new Promise((e,t)=>{t(0)}):"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&navigator.onLine?t?localforage.removeItem(e):localforage.iterate((function(t,n,s){e.length&&n.length&&n.includes(e)&&localforage.removeItem(n)})):new Promise(e=>{e(1)}),R=t=>{let n=window.wplms_course_data.api_url+"/user/quiz/"+e.quizid;e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz&&!b&&(n=window.wplms_course_data.api_url+"/quiz/nonloggedin/"+e.quizid+"?client_id="+window.wplms_course_data.client_id),"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(n).then(e=>{e&&e.length&&(e=JSON.parse(e)).hasOwnProperty("meta")&&(e=t,localforage.setItem(n,JSON.stringify(e)))})},U=n=>{let s=window.wplms_course_data.api_url+"/user/quiz/"+e.quizid;e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz&&!b&&(s=window.wplms_course_data.api_url+"/quiz/nonloggedin/"+e.quizid+"?client_id="+window.wplms_course_data.client_id),"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(s).then(e=>{e&&e.length&&(e=JSON.parse(e)).hasOwnProperty("meta")&&(n.expiry=Math.round((new Date).getTime()/1e3)+parseInt(t.meta.duration),e=n,localforage.setItem(s,JSON.stringify(e)))})};let J=0;t.meta&&t.meta.duration&&(J=t.meta.duration),t&&t.remaining&&t.remaining>0&&(J=t.remaining),t.hasOwnProperty("end_time")&&parseInt(t.end_time)&&parseInt(t.end_time)>(new Date).getTime()&&(parseInt(t.end_time)-(new Date).getTime())/1e3<J&&(J=Math.floor((parseInt(t.end_time)-(new Date).getTime())/1e3));let W="",X="loading_quiz";s||(W="disabled",X+=" disabled");let Y=window.wplms_course_data.translations.submit_quiz_confirm;if(t.meta&&t.meta.questions){let e=1;t.meta.questions.map((function(t){t.marked_answer||(e=0)})),e||(Y=window.wplms_course_data.translations.unanswered_confirm+Y)}let V=[];if(t.hasOwnProperty("meta")&&t.meta.hasOwnProperty("questions")&&t.meta.questions&&t.meta.questions.length&&(V=t.meta.questions),V.length&&null!==x)switch(x){case"wrong":V=V.filter(e=>!e.hasOwnProperty("user_marks")||!e.user_marks||parseFloat(e.user_marks)<=0);break;case"correct":V=V.filter(e=>e.hasOwnProperty("user_marks")&&e.user_marks&&parseFloat(e.user_marks)>0);break;case"bookmarked":V=V.filter(e=>z.indexOf(e.id)>-1)}return console.log(t.hasOwnProperty("end_time")&&parseInt(t.end_time)&&parseInt(t.end_time)<=(new Date).getTime()),"quiz"!==s?t&&t.hasOwnProperty("drip_message")?$n(Yn,null,t&&t.hasOwnProperty("drip_time")?$n(Mn,{start:!0,duration:t.drip_time,update:(e,t)=>{"expired"==t&&M(null,!0)},quiz_id:t.id}):"",$n("div",{className:"quiz_content",dangerouslySetInnerHTML:{__html:t&&t.hasOwnProperty("drip_message")?t.drip_message:""}})):$n(Yn,null,$n(an,{active:h,update:F,type:"submit",content:Y,yes:window.wplms_course_data.translations.yes,no:window.wplms_course_data.translations.no,yesfunction:"submitQuiz"}),ReactDOM.createPortal($n(an,{active:g,update:F,type:"submit",content:window.wplms_course_data.translations.bookmark_confirm,yes:window.wplms_course_data.translations.yes,no:window.wplms_course_data.translations.no,yesfunction:"submitQuiz"}),document.querySelector("#quiz_popup")),P?ReactDOM.createPortal($n("div",{className:"confirmpopup_wrapper"},$n("div",{className:"confirmpopup_content"},$n("textarea",{value:P.flagged_feedback,onChange:e=>{let s={...t},a=s.meta.questions.findIndex(e=>parseInt(P.id)===parseInt(e.id));if(a>-1){s.meta.questions[a].flagged_feedback=e.target.value,n(s);let t={...P};t.flagged_feedback=s.meta.questions[a].flagged_feedback,E(t)}}}),$n("div",{className:"buttons_wrapper"},$n("span",{className:S.indexOf(P.id)>-1?"button is-loading":P.flagged?"button flagged":"button flag",onClick:e=>{(()=>{let e=P,s=t.meta.questions.findIndex(e=>parseInt(P.id)===parseInt(e.id));if(s>-1){if(Zn(e.flagged_feedback))return Qn("vibebp").addNotification({text:window.wplms_course_data.translations.add_feedback_to_flag}),!1;let a=[...S];a.indexOf(e.id)<=-1&&a.push(e.id),O(a),fetch(window.wplms_course_data.api_url+"/user/question/flag/"+e.id+"?post",{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:b,flagged:!0,feedback:e.flagged_feedback})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(r=>{if(r){if(r.status){let r=a.indexOf(e.id);r>-1&&(a.splice(r,1),O(a));let i={...t};i.meta.questions[s].flagged=!0,n(i),C(""),E(!1)}r.message&&Qn("vibebp").addNotification({icon:"",text:r.message})}}).catch(e=>{console.error("Uh oh, an error!",e),Qn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}})()}},window.wplms_course_data.translations.submit_feedback),$n("span",{className:"button",onClick:e=>{E(!1)}},window.wplms_course_data.translations.cancel)))),document.querySelector("#quiz_popup")):"",$n(an,{active:m,update:F,type:"start",content:window.wplms_course_data.translations.start_quiz_confirm,yes:window.wplms_course_data.translations.yes,no:window.wplms_course_data.translations.no,yesfunction:"startQuiz"}),$n("div",{className:"incourse"},$n("div",{className:X},$n("div",{id:"ajaxloader",className:W})),e.hasOwnProperty("activity")?t.submitted?$n("h3",null,$n("span",{className:"student_score"},t.meta.auto?t.marks+"/"+t.max_marks:""),t.quiz_passing_score?$n("span",null,t.marks>t.quiz_passing_score?window.wplms_course_data.translations.passed:window.wplms_course_data.translations.failed):""):"":$n("div",{className:"up"==c?"incoursequiz_details show_controls":"incoursequiz_details hide_controls",ref:o},$n("div",{className:"quiz_first_block"},t.submitted?$n("strong",null,$n("span",{className:"student_score"},t.meta.auto?t.marks+"/"+t.max_marks:""),t.quiz_passing_score?$n("span",null,t.marks>t.quiz_passing_score?window.wplms_course_data.translations.passed:window.wplms_course_data.translations.failed):"",$n("span",{className:"student_quiz_status"},window.wplms_course_data.translations.quiz_submitted)):$n("div",{className:"quiztimer_wrapper"},t.hasOwnProperty("end_time")&&parseInt(t.end_time)?$n("div",{className:"end_timer"},$n("span",null,window.wplms_course_data.translations.ends_in),$n(A,{duration:Math.floor((t.end_time-(new Date).getTime())/1e3),update:()=>{},quiz_id:t.id,start:!0})):"",t&&t.meta&&t.meta.duration&&parseInt(t.meta.duration)<863913600?$n(A,{duration:J,update:(e,n)=>{"expired"==n&&"submit"!==!s&&D(t)},quiz_id:t.id,start:t.start}):$n("strong",null,window.wplms_course_data.translations.no_time_limit)),t&&t.meta&&t.meta.questions&&t.meta.questions.length&&t.submitted?$n("div",{className:"buttons has-addons small"},$n("a",{className:"correct"==x?"button tip end is-focused":"button tip",title:window.wplms_course_data.translations.show_correct_attempts,onClick:()=>{q("correct"!=x?"correct":null)}},$n("span",{className:"vicon vicon-check"})),$n("a",{className:"wrong"==x?"button tip end is-focused":"button tip",title:window.wplms_course_data.translations.show_wrong_attempts,onClick:()=>{q("wrong"!=x?"wrong":null)}},$n("span",{className:"vicon vicon-close"})),t.hasOwnProperty("show_print_results")&&t.show_print_results?$n("a",{className:"button tip",title:window.wplms_course_data.translations.print_results,onClick:()=>{B()}},$n("span",{className:"vicon vicon-printer"})):""):"",t&&t.meta&&t.meta.questions&&t.meta.questions.length&&z.length?$n("div",{className:"buttons has-addons"},$n("a",{className:"bookmarked"==x?"button tip end is-focused":"button tip",title:window.wplms_course_data.translations.show_bookmarked,onClick:()=>{q("bookmarked"!=x?"bookmarked":null)}},$n("span",{className:"vicon vicon-bookmark-alt"}))):"",$n("span","up"==c?{className:"quiz_detail_toggle vicon button is-primary vicon-arrow-up",onClick:()=>{d("up"==c?"down":"up")}}:{className:"quiz_detail_toggle vicon button is-primary vicon-arrow-down",onClick:()=>{d("up"==c?"down":"up")}})),$n("div",{className:"quiz_timeline"},!t.submitted||t.meta&&t.meta.retakes>0?$n("div",{className:"incourse_quiz_button"},t.start||t.submitted?"":t.remaining&&t.remaining>0?$n("a",{className:"continue_quiz button is-primary",onClick:j},window.wplms_course_data.translations.continue):t&&t.meta&&t.meta.hasOwnProperty("check_access")&&"object"!=typeof t.meta.check_access&&t.meta.check_access.hasOwnProperty("status")&&!t.meta.check_access.status?$n("div",{className:"check_quiz",dangerouslySetInnerHTML:{__html:t.meta.check_access.html}}):t.hasOwnProperty("end_time")&&parseInt(t.end_time)&&parseInt(t.end_time)<=(new Date).getTime()?"":t.hasOwnProperty("start_time")&&t.start_time&&parseInt(t.start_time)>(new Date).getTime()?$n("div",{className:"start_timer"},$n("div",null,window.wplms_course_data.translations.starts_in),$n(A,{duration:Math.floor((parseInt(t.start_time)-(new Date).getTime())/1e3),update:()=>{n({...t,start_time:t.start_time})},quiz_id:t.id,start:!0})):$n("a",{className:"start"===s?"start_quiz button full is-primary is-loading":"start_quiz  full button is-primary",onClick:()=>{window.wplms_course_data.start_popup?_(!0):j()}},window.wplms_course_data.translations.start),t.start&&!t.submitted&&(!e.hasOwnProperty("non_logged_in_quiz")||e.hasOwnProperty("non_logged_in_quiz")&&!e.non_logged_in_quiz)?$n("a",{className:"save"===s?"save_quiz button is-primary is-loading":"save_quiz button is-primary",onClick:()=>{if(t.meta.questions&&t.meta.questions.length){a("save");let e=[];t.meta.questions.map((t,n)=>{let s={...t};null==s.marked_answer||"undefined"==s.marked_answer||Zn(s.marked_answer)||t.attempted||(s.correct=vt(s),e.push(s))}),fetch(window.wplms_course_data.api_url+"/user/savequiz?post",{method:"POST",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({quiz_id:t.id,questions:e,token:b})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{a(!1),e.hasOwnProperty("message")&&Qn("vibebp").addNotification({text:e.message})}).catch(e=>{a(!1),console.error("Uh oh, an error!",e),Qn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}}},window.wplms_course_data.translations.save_quiz):"",t.hasOwnProperty("end_time")&&parseInt(t.end_time)&&parseInt(t.end_time)<=(new Date).getTime()?"":t.start&&!t.submitted&&(()=>{if(t&&t.hasOwnProperty("hide_submit_button")&&t.hide_submit_button){if(r&&r.length&&t.hasOwnProperty("meta")&&t.meta&&t.meta.hasOwnProperty("questions")&&t.meta.questions&&t.meta.questions.length){return r.indexOf(t.meta.questions.length-1)>-1}return!0}return!0})()?$n("a",{className:"submit"===s?"submit_quiz button is-primary is-loading":"submit_quiz button is-primary",onClick:()=>{window.wplms_course_data.submit_popup?w(!0):z.length?f(!0):D()}},window.wplms_course_data.translations.submit):"",!t.start&&t.submitted&&t.meta&&t.meta.retakes>0?$n("div",{className:"quiz_retake"},$n("a",{className:"retake"===s?"retake_quiz button is-primary is-loading":"retake_quiz button is-primary",onClick:()=>(()=>{t.hasOwnProperty("non_logged_in_quiz")&&t.non_logged_in_quiz&&!b&&localStorage.removeItem("vibequiz_"+t.id),a("retake");let n={token:b};if(e.hasOwnProperty("course")&&(n.course=e.course),e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz){localStorage.removeItem("vibequiz_"+e.quizid);let n=localStorage.getItem("quiz_retakes_"+e.quizid);return n||(n=0),localStorage.setItem("quiz_retakes_"+t.id,parseInt(n)+1),void M()}let s=window.wplms_course_data.api_url+"/user/quiz/"+e.quizid;e.hasOwnProperty("non_logged_in_quiz")&&e.non_logged_in_quiz&&!b&&(s=window.wplms_course_data.api_url+"/quiz/nonloggedin/"+e.quizid+"?client_id="+window.wplms_course_data.client_id),$(s,!0,!0).then(t=>{fetch(window.wplms_course_data.api_url+"/user/coursestatus/retake_single_quiz/"+e.quizid+"?post",{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(n)}).then(e=>e.json()).then(t=>{t&&(t.status?(M(),e.hasOwnProperty("update")&&e.update("retake_quiz")):t.message&&(Qn("vibebp").addNotification({icon:"",text:t.message}),a(!1)))})}).catch(e=>{console.log(e),navigator&&!navigator.onLine&&(Qn("vibebp").addNotification({text:window.wplms_course_data.translations.could_not_retake_offline}),a(!1))})})()},window.wplms_course_data.translations.retake),$n("strong",null,window.wplms_course_data.translations.retakes_left," : ",t.meta.retakes)):""):"",v?$n(Ft,{hideQuestions:()=>y(!1),quiz:t,currentQuestions:r,update:L,filter:x,bookMarked:z}):"",t&&t.meta&&t.meta.questions&&t.meta.questions.length&&!v?$n("span",{className:"show_questions",onClick:()=>y(!0)},$n("span",null,window.wplms_course_data.translations.show_questions),$n("span",{className:"vicon vicon-angle-double-right"})):"")),$n("div",{className:"quiz_questions_content"},$n("div",{className:""},t.start||t.submitted?"":$n("div",{className:"quiz_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),!t.start&&t.submitted?$n("div",{className:""},$n("div",{className:"quiz_content",dangerouslySetInnerHTML:{__html:t.meta.completion_message}}),!t.start&&t.submitted&&t.retake_html?$n("div",{dangerouslySetInnerHTML:{__html:t.retake_html}}):""):"",t.start||!t.submitted||e.hasOwnProperty("activity")?"":!e.hasOwnProperty("non_logged_in_quiz")||e.hasOwnProperty("non_logged_in_quiz")&&!e.non_logged_in_quiz?$n(yn,{quizid:e.quizid}):"",t&&t.meta&&t.meta.questions&&t.submitted&&t.meta.auto&&t.show_advance_stats&&!e.hasOwnProperty("activity")?$n(mn,{quiz:t}):"",t&&t.meta&&V&&(t.start||t.submitted)?V.map((i,o)=>{if(-1===r.indexOf(o))return;let l="",u="";return i.hasOwnProperty("show_hint")&&i.show_hint?(u="question_hint_content message show",l="question_hint show"):(u="question_hint_content message",l="question_hint"),$n("div",{className:"question"},$n("div",{className:"question_actions"},$n("span",null,window.wplms_course_data.translations.question_full_prefix," ",o+1),$n("div",null,$n("span",{className:"marks"},$n("i",{className:"vicon vicon-medall"}),i.marks),!e.hasOwnProperty("non_logged_in_quiz")||e.hasOwnProperty("non_logged_in_quiz")&&!e.non_logged_in_quiz?$n("span",{className:S.indexOf(i.id)>-1?"is-loading":i.flagged?"flagged":"flag",onClick:()=>{E(i)}},$n("i",{className:i.flagged?"vicon vicon-flag-alt":"vicon vicon-flag"})):"",i.hint?$n("span",{className:l,onClick:e=>{let s={...t};s.meta.questions[o].hasOwnProperty("show_hint")&&s.meta.questions[o].show_hint?s.meta.questions[o].show_hint=!1:s.meta.questions[o].show_hint=!0,n(s)}}):"")),H(i,o),!t.submitted&&t.start?$n("span",{className:"bookmark button",onClick:()=>{(t=>{let n=[...z],s=n.indexOf(t.id);s<=-1?n.push(t.id):n.splice(s,1),localforage.setItem("bookmarked_questions_"+e.quizid,JSON.stringify(n)),N(n),n.length||"bookmarked"!=x||q(null)})(i)}},$n("i",{className:z.indexOf(i.id)>-1?"vicon vicon-bookmark-alt":"vicon vicon-bookmark"})):"",i.attempted||!t.check_answer||t.submitted?"":!e.hasOwnProperty("non_logged_in_quiz")||e.hasOwnProperty("non_logged_in_quiz")&&!e.non_logged_in_quiz?$n("div",{className:"checkanswer"===s?"check_answer button is-primary is-loading":"check_answer button is-primary",onClick:e=>{((e,s)=>{a("checkanswer");let r=bt(e,t.partial_marking,t.negative_marking,parseFloat(t.negative_marks),!0),i={...t};r.attempted=!0,i.meta.questions[s]=r,fetch(window.wplms_course_data.api_url+"/user/saveuserquestion?post",{method:"POST",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({quiz_id:i.id,question:r,token:b})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{a(!1),n(i),R(i),e.hasOwnProperty("message")&&Qn("vibebp").addNotification({text:e.message})}).catch(e=>{a(!1),console.error("Uh oh, an error!",e),Qn("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})})(i,o)}},window.wplms_course_data.translations.check_answer):"",i.hint?$n("span",{className:u,dangerouslySetInnerHTML:{__html:i.hint}}):"",i.attempted?$n(Ot,{question:i}):"",i.attempted&&i.show_correct_answer&&i.explanation.length?$n("div",{className:"explanation"},$n("strong",null,window.wplms_course_data.translations.question_explanation),$n("div",{dangerouslySetInnerHTML:{__html:i.explanation}})):"")}):"",t&&t.meta&&t.meta.questions&&(t.start||t.submitted)?$n(Kt,{quiz:t,questions:[...V],currentQuestions:r,filter:x,update:L,bookMarked:z}):"")))):$n(p,null)},ns=n(6),ss=n.n(ns);const{createElement:as,useState:rs,useEffect:is,useRef:os,Fragment:ls,render:us}=wp.element,{dispatch:cs,select:ds}=wp.data,ms=Math.round(100*Math.random());var ps=e=>{const t=os(null),[n,s]=rs(!1),[a,r]=rs(!1),[i,o]=rs(""),[l,u]=rs(""),[c,d]=rs(""),[m,p]=rs(""),[_,h]=rs({x:0,y:0,width:0,height:0,type:"image"}),[w,g]=rs(""),[f,v]=rs(window.wplms_course_data.translations.select_image);is(()=>{e.hasOwnProperty("crop")&&e.crop&&s(!0)},[]),is(()=>{if(a&&w&&n)new ss.a(w,{returnMode:"ratio",onCropEnd:function(t){let n={..._};n.x=100*t.x,n.y=100*t.y,n.height=100*t.height,n.width=100*t.width,h(n);let s={x:w.naturalWidth*t.x,y:w.naturalHeight*t.y,width:w.naturalWidth*t.width,height:w.naturalHeight*t.height};e.update(m,s)}})},[a,w]);_.x,_.y,_.width,_.height;return as("div",{className:"uploader"},as("label",{for:"fileupload_"+ms,className:"upload_file"},f,"image"==e.type?as("input",{id:"fileupload_"+ms,"data-type":e.type,ref:t,type:"file",accept:"image/*",onChange:n=>{t.current.files[0].size<window.wplms_course_data.settings.upload_limit?(o(window.URL.createObjectURL(t.current.files[0])),p(t.current.files[0]),e.update(t.current.files[0],{..._,key:"image"})):(v(window.wplms_course_data.translations.image_size_error),setTimeout(()=>{v(window.wplms_course_data.translations.select_image)},3500))}}):"video"==e.type?as("input",{id:"fileupload_"+ms,"data-type":e.type,ref:t,type:"file",accept:"video/*",onChange:n=>{t.current.files[0].size<window.wplms_course_data.settings.upload_limit?(u(window.URL.createObjectURL(t.current.files[0])),p(t.current.files[0]),e.update(t.current.files[0],{..._,key:"video"})):(v(window.wplms_course_data.translations.image_size_error),setTimeout(()=>{v(window.wplms_course_data.translations.select_image)},3500))}}):as("input",{id:"fileupload_"+ms,"data-type":e.type,ref:t,type:"file",onChange:n=>{t.current.files&&t.current.files[0]&&(t.current.files[0].size<e.args.allowed_file_size?-1!==e.args.allowed_mime_types.indexOf(t.current.files[0].type)?(d(window.URL.createObjectURL(t.current.files[0])),p(t.current.files),e.update(t.current.files,{..._,key:"attachment"})):(v(window.wplms_course_data.translations.image_type_error),setTimeout(()=>{v(window.wplms_course_data.translations.select_image)},3500)):(v(window.wplms_course_data.translations.image_size_error),setTimeout(()=>{v(window.wplms_course_data.translations.select_image)},3500)))}})))};const{Component:_s,createElement:hs,render:ws,useState:gs,useEffect:fs,Fragment:vs}=wp.element;var ys=e=>{const[t,n]=gs(e.duration),[s,a]=gs({d:0,h:0,m:0,s:0});fs(()=>{if(e.start){setTimeout(()=>{let s=t-1;s<=-1?e.update(e.quiz_id,"expired"):s>=0&&(n(s),r())},1e3)}else n(e.duration),r()},[t,e.start,e.duration]);const r=()=>{let e={...s},n=t;n>86400?(e.d=Math.floor(n/86400),n-=86400*e.d):e.d=0,n>3600?(e.h=Math.floor(n/3600),n-=3600*e.h):e.h=0,n>60?(e.m=Math.floor(n/60),n-=60*e.m):e.m=0,e.s=n,a(e)};let i="c100 p0 big";if(t>-1){let n=Math.floor((e.duration-t)/e.duration*100);n<=0&&(n=1),i="c100 p"+n+" big"}return hs("div",{className:"quiztimer"},t>=776736e3?window.wplms_course_data.translations.unlimited_time:hs(vs,null,hs("div",{className:"circle_timer"},hs("div",{className:i},hs("span",null,hs("span",{className:"timer_amount"},s.d?hs(vs,null,hs("span",null,s.d),hs("span",null,":")):"",s.h?hs(vs,null,hs("span",null,s.h),hs("span",null,":")):"",s.m?hs(vs,null,hs("span",null,s.m),hs("span",null,":")):"",hs("span",null,s.s)),hs("span",{className:"timer_unit"},s.d?hs(vs,null,hs("span",null,window.wplms_course_data.translations.days),hs("span",null)):"",s.h?hs(vs,null,hs("span",null,window.wplms_course_data.translations.hours),hs("span",null)):"",s.m?hs(vs,null,hs("span",null,window.wplms_course_data.translations.minutes),hs("span",null)):"",hs("span",null,window.wplms_course_data.translations.seconds))),hs("div",{className:"slice"},hs("div",{className:"bar"}),hs("div",{className:"fill"}))))))};const{createContext:bs}=wp.element;var ks=bs({course:{},activeTab:"create_course",update:e=>{}});const{createElement:xs,render:qs,useState:zs,useEffect:Ns,useContext:Ss,Fragment:Os,RawHTML:Ps}=wp.element;var Es=e=>{const[t,n]=zs(e.field),[s,a]=(Ss(ks),zs({post_content:"",raw:{}})),[r,i]=zs(Math.round(1e5*Math.random()));Ns(()=>{if(e.field&&e.field.id){var t=new CustomEvent("load_vibe_editor",{detail:{selector:".vibe_"+e.field.id+r+"_editor",content:e.field.hasOwnProperty("value")?e.field.value:"",raw:e.field.hasOwnProperty("raw")?e.field.raw:"",components:e.field.components?e.field.components:"",updater:e.field.id+r}});document.dispatchEvent(t)}},[e.field]),Ns(()=>(e.field&&e.field.id&&document.addEventListener("vibe_editor_content_update_"+e.field.id+r,o,!1),()=>{e.field&&e.field.id&&document.removeEventListener("vibe_editor_content_update_"+e.field.id+r,o)}));const o=t=>{a({post_content:t.detail.raw_html,raw:t.detail.editor_content});let s={...e.field};s.value=t.detail.raw_html,s.raw=t.detail.editor_content,JSON.stringify(s.raw)!==JSON.stringify(e.field.raw)&&(n(s),e.update(s,e.fieldIndex,"fieldvaluechanged"))};return xs("div",{className:"vibev_editor"},xs("div",{className:"vibe_"+t.id+r+"_editor"},xs("textarea",{value:t.value})))};var Is=function(e){if(void 0===e)return!0;if("undefined"===e)return!0;if(null==e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};const{createElement:Cs,useState:Ms,useEffect:Ts,Fragment:Ls,render:js,useContext:As}=wp.element,{dispatch:Ds,select:Hs}=wp.data;var Fs=e=>{const[t,n]=Ms(!0),[s,a]=Ms({}),[r,i]=Ms([]),[o,l]=Ms(""),[u,c]=Ms(!1);let d=Hs("vibebp").getUser();d.token=Hs("vibebp").getToken(),Ts(()=>{n(!0);let t=`${window.wplms_course_data.api_url}/user/content/assignmentId/${e.assignment.id}`;e.hasOwnProperty("force")&&e.force&&(t+="?force"),fetch(t,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:d.token})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e){if(e.hasOwnProperty("remaining"))e.duration=e.remaining;else if(e.hasOwnProperty("start")&&!0!==e.start&&e.start){let t=parseInt(e.duration)+parseInt(e.start),n=Math.round((new Date).getTime()/1e3);e.duration=t>n?t-n:0}e.hasOwnProperty("comment_content")&&l(e.comment_content),a(e),n(!1),document.dispatchEvent(new Event("VibeBP_Editor_Content"))}}).catch(e=>{n(!1),console.error("Uh oh, an error!",e),Ds("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}),document.addEventListener("wplms_assignment_custom_upload",({detail:e})=>{if(e.hasOwnProperty("data")&&e.data.hasOwnProperty("Key")&&e.data.Key.length){let t=[...r],n=e.data.Key.split("/");t.push({...e.data,name:n[n.length-1]}),i(t)}})},[e.assignment]);const m=(t=null)=>{let n=o;if(!t&&s&&s.type&&"upload"==s.type){if(!r||r.length<=0)return Ds("vibebp").addNotification({text:window.wplms_course_data.translations.upload_a_file}),!1;Is(n)&&(n=s.title+" - "+(d.displayname?d.displayname:d.name?d.name:""))}else if(t&&Is(n)&&(n=s.title+" - "+(d.displayname?d.displayname:d.name?d.name:"")),!n||n.length<=3)return Ds("vibebp").addNotification({text:window.wplms_course_data.translations.error}),!1;c(!0);var i=new FormData;i.append("body",JSON.stringify({comment:n,attachments:r,token:Hs("vibebp").getToken()})),r.length&&r.map((e,t)=>{e instanceof File?i.append("files_"+t,e):i.append("files_"+t,JSON.stringify(e))}),fetch(`${window.wplms_course_data.api_url}/user/upload/assignmentId/${e.assignment.id}?upload`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:i}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{if(c(!1),t){let n={...s};if(t.attachment_urls&&t.attachment_urls.length&&(n.attachment_urls=t.attachment_urls),t.comment_id){n.flag=1,n.already_submitted=!0,e.hasOwnProperty("unitIndex")?e.update({unitIndex:e.unitIndex,assignmentIndex:e.assignmentIndex},"complete"):e.update({},"submitassignment");let t=`${window.wplms_course_data.api_url}/user/content/assignmentId/${e.assignment.id}`;"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(t).then(e=>{e&&e.length&&(e=JSON.parse(e),e=n,localforage.setItem(t,JSON.stringify(e)))});let s=window.wplms_course_data.api_url+"/student/assignments";_(s)}if(a(n),t.hasOwnProperty("message")&&Ds("vibebp").addNotification({text:t.message}),t.status){let t=e.course,n=e.assignment.id;document.dispatchEvent(new CustomEvent("course_item_completed",{detail:{course_id:t,item_id:n}}))}}}).catch(e=>{c(!1),console.error("Uh oh, an error!",e),Ds("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},_=(e,t)=>"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&navigator.onLine?t?localforage.removeItem(e):localforage.iterate((function(t,n,s){e.length&&n.length&&n.includes(e)&&localforage.removeItem(n)})):new Promise(e=>{e(1)});let h={allowed_mime_types:s.permit_mime,allowed_file_size:parseInt(s.permit_size)},w=s.duration;return s.hasOwnProperty("end_time")&&parseInt(s.end_time)&&parseInt(s.end_time)>(new Date).getTime()&&(parseInt(s.end_time)-(new Date).getTime())/1e3<w&&(w=Math.floor((parseInt(s.end_time)-(new Date).getTime())/1e3)),t?Cs(p,null):Cs("div",{className:"course_assignment_wrapper"},Cs("div",{className:"course_assignment"},Cs("div",{className:"assignment_details"},s.hasOwnProperty("end_time")&&parseInt(s.end_time)?Cs("div",{className:"end_timer"},Cs("span",null,window.wplms_course_data.translations.ends_in),Cs(ys,{duration:Math.floor((s.end_time-(new Date).getTime())/1e3),update:()=>{},quiz_id:s.id,start:!0})):"",Cs("div",{className:"assignment_marks"},Cs("span",null,s.total_marks),Cs("span",null,window.wplms_course_data.translations.total_marks)),Cs(ys,{duration:w,update:(e,t)=>{"expired"==t&&(s.already_submitted||m(!0))},quiz_id:s.id,start:s.start})),Cs("div",{className:"assignment_content_wrapper"},Cs("div",{className:"assignment_content",dangerouslySetInnerHTML:{__html:s.content}}),s.type&&"upload"==s.type&&s&&s.permit_extension&&s.permit_extension.length&&s.flag<=2?Cs("div",{className:"allowed_file_extenstions"},Cs("label",null,window.wplms_course_data.translations.allowed_file_extenstions),s.permit_extension.map(e=>Cs("span",null,e))):"",s.hasOwnProperty("end_time")&&parseInt(s.end_time)&&parseInt(s.end_time)<=(new Date).getTime()?"":s.hasOwnProperty("start_time")&&parseInt(s.start_time)&&parseInt(s.start_time)>(new Date).getTime()?Cs("div",{className:"start_timer"},Cs("div",null,window.wplms_course_data.translations.starts_in),Cs(ys,{duration:Math.floor((parseInt(s.start_time)-(new Date).getTime())/1e3),update:()=>{a({...s,start_time:s.start_time})},quiz_id:s.id,start:!0})):s.start?"":Cs("a",{className:"assignment_start_button button is-primary",onClick:()=>{fetch(`${window.wplms_course_data.api_url}/user/start/assignmentId/${e.assignment.id}?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:Hs("vibebp").getToken()})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{if(t){let n={...s};n.start=Math.round((new Date).getTime()/1e3),a(n);let r=`${window.wplms_course_data.api_url}/user/content/assignmentId/${e.assignment.id}`,i=window.wplms_course_data.api_url+"/student/assignments";_(i,!0),"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(r).then(e=>{e&&e.length&&(e=JSON.parse(e)).hasOwnProperty("duration")&&(e.start=n.start,localforage.setItem(r,JSON.stringify(e)))}),t.hasOwnProperty("message")&&Ds("vibebp").addNotification({text:t.message})}}).catch(e=>{console.error("Uh oh, an error!",e),Ds("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}},window.wplms_course_data.translations.start_assignment),s.start&&s.flag<=2?Cs(Ls,null,s.already_submitted?Cs(Ls,null,s.attachment_urls&&s.attachment_urls.length?Cs(Ls,null,window.wplms_course_data.translations.uploaded_files,Cs("div",{className:"assignment_attachments"},s.attachment_urls.map((e,t)=>e.hasOwnProperty("url")?Cs("div",null,Cs("a",null,e.name)):Cs("div",null,Cs("a",{href:e.url,target:"_blank",download:!0},e.name))))):"",s.hasOwnProperty("end_time")&&parseInt(s.end_time)&&parseInt(s.end_time)<=(new Date).getTime()?"":s.hasOwnProperty("flag")&&1==s.flag&&s.duration>0?Cs("div",{className:"resubmit ",onClick:()=>{(()=>{let t={...s};t.already_submitted=!1,t.flag=0,e.hasOwnProperty("unitIndex")?e.update({unitIndex:e.unitIndex,assignmentIndex:e.assignmentIndex},"retake"):e.update({},"retookassignment"),a(t)})()}},Cs("a",{className:"button is-primary"},window.wplms_course_data.translations.resubmit,Cs("span",{className:"vicon vicon-close"}))):""):"",s.type&&"upload"==s.type&&!s.already_submitted?Cs("div",{className:"upload_assignment"},s.hasOwnProperty("custom_upload")&&s.custom_upload?Cs("div",null,(g=new CustomEvent("custom_assignment_upload",{detail:{data:s}}),document.dispatchEvent(g),Cs("div",{className:"custom_assignment_upload",id:s.custom_upload}))):Cs(ps,{type:1,update:(e,t)=>{let n=[...r];n.push(new File([e[0]],e[0].name)),i(n)},args:h}),r?Cs("div",{className:"assignment_attachments"},r.map((e,t)=>Cs("div",null,Cs("span",null,e.name),Cs("span",{className:"vicon vicon-close",onClick:()=>{(e=>{let t=[...r];t.splice(e,1),i(t)})(t)}})))):"",Cs(Es,o?{field:{id:"assignment_text",value:o,components:["editor"]},update:(e,t,n)=>{l(e.value)}}:{field:{id:"assignment_text",components:["editor"]},update:(e,t,n)=>{l(e.value)}})):"",!s.hasOwnProperty("type")||s.type&&"textarea"==s.type?Cs(Es,{field:o?{id:"assignment_text",value:o,components:["editor"]}:{id:"assignment_text",components:["editor"]},update:(e,t,n)=>{l(e.value)}}):""):"",s.flag&&s.hasOwnProperty("marks")&&s.flag>1?Cs("div",{className:"assigment_evaluated"},s.message?Cs("span",null,s.message):"",s.marks?Cs("span",null,window.wplms_course_data.translations.marks_obtained," : ",s.marks):"",s.hasOwnProperty("instructor_remarks")?Cs("div",{className:"remarks"},Cs("h3",null,window.wplms_course_data.translations.instructor_remarks," "),Cs("div",{dangerouslySetInnerHTML:{__html:s.instructor_remarks}})):""):"")),s.start&&!s.already_submitted?Cs("a",{className:u?"button is-primary is-loading":"button is-primary",onClick:()=>{m()}},window.wplms_course_data.translations.submit_assignment):"");var g};const{createContext:Bs}=wp.element;var $s=Bs({comments:{},update:e=>{}});const{createElement:Rs,useState:Us,useEffect:Js,Fragment:Ws,render:Xs,useContext:Ys}=wp.element,{dispatch:Vs,select:Qs}=wp.data,Ks=e=>{const[t,n]=Us({}),s=Ys($s);Js(()=>{n(e.comment)},[e.comment]);const a=e=>{s.update({comment:t},e)},r=Qs("vibebp").getUser();return t&&Object.keys(t).length?Rs("li",{className:"unit_comment_wrapper "+(e.disable==t.comment_ID?"disabled":"")},Rs("div",{className:"unit_comment"},t.user?Rs("div",{className:"comment_user"},t.user.avatar?Rs("img",{src:t.user.avatar}):"",t.user.name?Rs("span",{className:"username"},t.user.name):t.user.displayname?Rs("span",{className:"username"},t.user.displayname):Rs("span",{className:"username"},window.wplms_course_data.translations.anonymous)):"",Rs("div",{className:"unit_comment_content"},Rs("div",{className:"unit_comment_header"},Rs("span",null,Rs(X,{timestamp:parseInt(t.comment_date)})),t.hasOwnProperty("comment_karma")&&e.disable!=t.comment_ID?Rs("div",{className:"comment_actions"},r.id==t.user_id||t.hasOwnProperty("user")&&t.user.id==r.id||Object.keys(r.caps).indexOf("manage_options")>-1?Rs("span",{className:"vicon vicon-pencil",onClick:()=>{a("edit")}}):"","note"==t.type||t.hasOwnProperty("comment_type")&&"note"==t.comment_type?"":Rs("span",{className:"vicon vicon-share",onClick:()=>{a("reply")}}),r.id==t.user_id||t.hasOwnProperty("user")&&t.user.id==r.id?Rs(Ws,null,parseInt(t.comment_parent)||"note"==t.type?"":t.question?Rs("span",{className:"vicon vicon-user active tip",title:window.wplms_course_data.translations.instructor_question}):Rs("span",{className:"vicon vicon-user tip",title:window.wplms_course_data.translations.ask_instructor,onClick:()=>{fetch(window.wplms_course_data.api_url+"/student/askQuestion/?post",{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({comment:t,unit_id:s.unit_id,course_id:s.course_id,token:Qs("vibebp").getToken()})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{n({...t,question:!0}),e?e.hasOwnProperty("message")&&Vs("vibebp").addNotification({icon:"vicon vicon-user",text:e.message}):e.hasOwnProperty("message")&&Vs("vibebp").addNotification({text:e.message})}).catch(e=>{console.error("Uh oh, an error!",e),Vs("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}}),r.id==t.user_id||t.hasOwnProperty("user")&&t.user.id==r.id?Rs("span",{className:"vicon vicon-trash",onClick:()=>{a("delete")}}):""):""):""),Rs("div",{dangerouslySetInnerHTML:{__html:t.comment_content}}))),t.child&&t.child.length?Rs("ul",null,t.child.map((t,n)=>Rs(Ks,{comment:t,disable:e.disable}))):""):""};var Gs=Ks;const{createElement:Zs,useState:ea,useEffect:ta,Fragment:na,render:sa}=wp.element,{dispatch:aa,select:ra}=wp.data;let ia=!1;var oa=e=>{const[t,n]=ea([]),[s,a]=ea(!1),[r,i]=ea(0),[o,l]=ea(!1),[u,c]=ea(!1),[d,m]=ea({}),[_,h]=ea(!0),[w,g]=ea("public");const f=ra("vibebp").getUser(),v=ra("vibebp").getToken(),y={type:w,unit_id:e.unit_id,course_id:e.course_id};ta(()=>{m(y)},[e.unit_id]),ta(()=>{let t={type:w,unit_id:e.unit_id,course_id:e.course_id};m(t),h(!0),i(0),n([]),b(w,!0)},[w]);const b=(s=null,o=null)=>{s||(s="public"),ia&&ia.abort();let l={},u=new AbortController;ia&&(l={signal:u.signal}),ia=u;let c=r;o&&(c=0),c||a(!0),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}?page=${c}&per_page=20&force`,{method:"post",...l,headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:v,type:s})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e){let s=[...t];o&&(s=[]),e.length?(e.map((t,n)=>{s.findIndex(e=>e.comment_ID===t.comment_ID)<0&&s.push(z(t,e))}),n(s),h(!1),a(!1),i(c+1)):(h(!0),a(!1))}}).catch(e=>{"AbortError"===e.name||(a(!1),console.error("Uh oh, an error!",e),aa("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data}))})},k=(e,t,n)=>{for(let s=0;s<e.length;s++)e[s].comment_ID==t&&(e[s].child&&e[s].child.length?e[s].child.unshift(n):(e[s].child=[],e[s].child.push(n))),e[s].child&&e[s].child.length&&k(e[s].child,t,n);return e},x=(e,t,n)=>{for(let s=0;s<e.length;s++)e[s].comment_ID==t&&(e[s]=n),e[s].child&&e[s].child.length&&x(e[s].child,t,n);return e},q=(e,t,n)=>{for(let s=0;s<e.length;s++)e[s].comment_ID==t&&(e[s].comment_content=n.comment_content),e[s].child&&e[s].child.length&&x(e[s].child,t,n);return e},z=(e,t)=>(t.map((n,s)=>{parseInt(e.comment_ID)===parseInt(n.comment_parent)&&(e.hasOwnProperty("child")||(e.child=[]),t.splice(s,1),e.child.push(z(n,t)))}),e),N=()=>Math.floor(1e9*Math.random()+1),S=s=>{s.user.id&&fetch(`${window.wplms_course_data.api_url}/user/unitcomments/delete/${s.comment_ID}?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({comment:s,token:ra("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e){let a=O(s,[...t]);if(n(a),e.status){let e=window.wplms_course_data.api_url+"/student/comments/0";E(e)}e.hasOwnProperty("message")&&e.message.length&&aa("vibebp").addNotification({text:e.message}),I(a)}}).catch(e=>{console.error("Uh oh, an error!",e),aa("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},O=(e,t)=>{if(e.comment_ID&&t.length)for(var n=t.length-1;n>=0;n--){if(t[n].comment_ID==e.comment_ID){t.splice(n,1);break}t[n].hasOwnProperty("child")&&t[n].child.length&&(t[n].child=O(e,t[n].child))}return t},P=()=>{switch(d.ctype){case"new":return"public"==w?window.wplms_course_data.translations.add_comment:window.wplms_course_data.translations.add_note;case"new_question":return window.wplms_course_data.translations.ask_question;case"reply":return window.wplms_course_data.translations.reply;case"edit":return"public"==w?window.wplms_course_data.translations.edit_comment:window.wplms_course_data.translations.edit_note;default:return"public"==w?window.wplms_course_data.translations.add_comment:window.wplms_course_data.translations.add_note}},E=(e,t)=>"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&navigator.onLine?t?localforage.removeItem(e):localforage.iterate((function(t,n,s){e.length&&n.length&&n.includes(e)&&localforage.removeItem(n)})):new Promise(e=>{e(1)}),I=t=>{let n=`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}?page=${r-1}&per_page=20`;"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(n).then(e=>{e&&e.length&&(e=t,localforage.setItem(n,JSON.stringify(e)))})};let C="";if(t.length&&u){let e=t.findIndex(e=>e.comment_ID===u);C=e>-1?t[e].ctype:""}return Zs($s.Provider,{value:{comments:t,unit_id:e.unit_id,course_id:e.course_id,update:(e,t)=>{switch(t){case"edit":l(!0),e.comment.ctype=t,e.comment.user_id||(e.comment.user_id=f.id),e.comment.user||(e.comment.user=f),m(e.comment);break;case"reply":l(!0),m({user_id:f.id,user:f,comment_ID:N(),comment_parent:e.comment.comment_ID,ctype:t});break;case"delete":S(e.comment)}}}},Zs("div",{className:"unit_comments_enclosure"},Zs("div",{className:o?"unit_comments_wrapper active":"unit_comments_wrapper"},Zs("span",null,Zs("span",{onClick:e.back},Zs("span",{className:"vicon vicon-arrow-left"})),Zs("strong",null,window.wplms_course_data.translations[w]),Zs("span",{onClick:e.expand},Zs("span",{className:"vicon vicon-align-right"}))),Zs("div",{className:"vibe_tabs"},Zs("span",{className:"vibe_tab "+("public"==w?"active":""),onClick:()=>{g("public")}},window.wplms_course_data.translations.comments),Zs("span",{className:"vibe_tab "+("note"==w?"active":""),onClick:()=>{g("note")}},window.wplms_course_data.translations.notes)),s?Zs(p,null):Zs(na,null,Zs("div",{className:"unit_comments"},t&&t.length?Zs("ul",null,t.map((e,t)=>Zs(Gs,{comment:e,disable:u}))):Zs("div",{className:"vbp_message"},window.wplms_course_data.translations.no_comments),Zs("div",{className:"loadmore_wrapper"},_?"":Zs("a",{className:"link",onClick:()=>{b(w)}},window.wplms_course_data.translations.load_more))),Zs("div",{className:"unit_comments_action"},o?Zs("div",{className:"addcomment"},Zs("textarea",{value:d.comment_content,onChange:e=>{let t={...d};t.comment_content=e.target.value,m(t)}},d.comment_content),Zs("div",{className:"addcomment_buttons"},Zs("a",{className:u?"button is-primary is-loading":"button is-primary",onClick:()=>{if(!d.ctype)return aa("vibebp").addNotification({text:window.wplms_course_data.translations.insufficientdata}),!1;if(!(d.comment_content&&d.comment_content.length>3))return aa("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content}),!1;{d.comment_ID||(d.comment_ID=N()),c(d.comment_ID),d.comment_post_ID||(d.comment_post_ID=e.unit_id);let s=d.comment_ID,a=[...t];switch(d.ctype){case"new":case"new_question":a.unshift(d),n(a),I(a),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}/new/0?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({...d,token:ra("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e)if(e.comment_data){let t=a.findIndex(e=>parseInt(e.comment_ID)==d.comment_ID);t>=0&&(e.comment_data.user=f,a.splice(t,1,e.comment_data),n(a));let s=window.wplms_course_data.api_url+"/student/comments/0";E(s)}else aa("vibebp").addNotification({text:e.message});c(!1)}).catch(e=>{console.error("Uh oh, an error!",e),aa("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})});break;case"edit":if(!d.comment_content||d.comment_content.length<4)return void aa("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content});let t=q(a,s,d);n(t),I(a);d.comment_content;fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}/edit/${s}?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({...d,token:ra("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e)if(e.comment_data){e.comment_data.hasOwnProperty("user")||(e.comment_data.user=f),t=q(a,s,e.comment_data),n(t);let r=window.wplms_course_data.api_url+"/student/comments/0";E(r)}else aa("vibebp").addNotification({text:window.wplms_course_data.translations.error});c(!1)}).catch(e=>{console.error("Uh oh, an error!",e),aa("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})});break;case"reply":if(!d.comment_content||d.comment_content.length<4)return void aa("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content});let r=k(a,d.comment_parent,d);n(r),I(a),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}/reply/${d.comment_parent}?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({...d,token:ra("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e)if(e.comment_data){e.comment_data.hasOwnProperty("user")||(e.comment_data.user=f),r=x(a,s,e.comment_data),n(r);let t=window.wplms_course_data.api_url+"/student/comments/0";E(t)}else aa("vibebp").addNotification({text:window.wplms_course_data.translations.error});c(!1)}).catch(e=>{console.error("Uh oh, an error!",e),aa("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}m(y),l(!1)}}},P()),Zs("a",{className:"link",onClick:()=>{m(y),l(!1)}},window.wplms_course_data.translations.cancel))):Zs(na,null,Zs("a",{className:"new"==C&&u?"button is-primary is-loading":"button is-primary",onClick:()=>{let e={...d};e.ctype="new",o&&(e={}),e.user_id=f.id,e.user=f,m(e),l(!o)}},Zs("span",{className:"public"==w?"vicon vicon-comments":"vicon vicon-note"}),Zs("span",null,P())),"public"==w?Zs("a",{className:"new_question"==C&&u?"button is-primary is-loading":"button is-primary",onClick:()=>{let e={...d};e.ctype="new_question",o&&(e={}),e.user_id=f.id,e.user=f,m(e),l(!o)}},Zs("span",{className:"vicon vicon-help"}),Zs("span",null,window.wplms_course_data.translations.ask_question)):""))))))};const{createElement:la,useState:ua,useEffect:ca,Fragment:da,render:ma,useContext:pa}=wp.element,{dispatch:_a,select:ha}=wp.data;var wa=e=>{const[t,n]=ua(0),[s,a]=ua(0),r=pa(b),i=()=>{const e=document.querySelector(".course_content_content");if(!e)return;let t=e.clientHeight-(e.offsetTop-240)-window.innerHeight,n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;if(document.querySelector("body").classList&&document.querySelector("body").classList.contains("course_status_fullscreen")&&document.querySelector(".course_status")&&(n=document.querySelector(".course_status").scrollTop,t=e.clientHeight-e.offsetTop-window.innerHeight),0!==n)return n>t?(r.update({progress:100},"updateprogress"),void r.update({},"progresscompleted")):void r.update({progress:n/t*100},"updateprogress");r.update({progress:0},"updateprogress")},o=e=>{a(Math.random())};return ca(()=>(document.addEventListener("course_status_fullscreen_toggle",o),()=>{document.removeEventListener("course_status_fullscreen_toggle",o)}),[]),ca(()=>(document.querySelector(".course_status")&&(document.querySelector("body").classList&&document.querySelector("body").classList.contains("course_status_fullscreen")?document.querySelector(".course_status").addEventListener("scroll",i):window.addEventListener("scroll",i)),()=>{document.querySelector(".course_status")&&(document.querySelector("body").classList&&document.querySelector("body").classList.contains("course_status_fullscreen")?document.querySelector(".course_status").removeEventListener("scroll",i):window.removeEventListener("scroll",i))})),""};const{createElement:ga,render:fa,useState:va,useEffect:ya,useContext:ba,Fragment:ka,RawHTML:xa}=wp.element;var qa=e=>{const[t,n]=va([]),[s,a]=va(()=>{let t=e.maxstars?e.maxstars-1:4,n=[];for(;t>=0;)n.unshift(t),t--;return n});ya(()=>{let t=e.rating?e.rating-1:-1,s=[];for(;t>=0;)s.unshift(t),t--;n(s)},[e.rating]);return t&&t.length>=0?ga("div",{className:"wplms-course-star-rating"},s.map((s,a)=>{let r=0;return t.includes(a)&&(r=1),ga("span",{className:"vicon vicon-star "+(r?"golden":""),onClick:t=>{(t=>{let s=[];for(;t>=0;)s.unshift(t),t--;n(s),e.update(s,"ratingchanged")})(a)}})})):""};const{createElement:za,render:Na,useState:Sa,useEffect:Oa,Fragment:Pa,useContext:Ea,useRef:Ia}=wp.element,{dispatch:Ca,select:Ma}=wp.data;var Ta=e=>{const t=Ia(null),[n,s]=Sa(Math.round(1e4*Math.random())),[a,r]=Sa(!1),[i,o]=Sa(!1),l=(e,t)=>{void 0===t&&(t=window.location.href);var n=t.match("[?&]"+e+"=([^&]+)");return n?n[1]:null};Oa(()=>(c().then(()=>{if(document.querySelector("#item_"+e.index)){let t={};"youtube"==e.provider&&(t.youtube={modestbranding:1}),"vimeo"==e.provider&&(t.vimeo={controls:!0,playsinline:!1}),window.wplms_course_data.course.status.seek_lock&&(t.listeners={seek:e=>{var t=a.currentTime;if(_getTargetTime(a,e)>t)return e.preventDefault(),!1}});let n=null;if(e.hasOwnProperty("video")&&e.video.hasOwnProperty("videotype")&&"360"==e.video.videotype)n=new Plyr(document.querySelector("#item_"+e.index),t),n.mediainfo=n.mediainfo||{},n.mediainfo.projection="360",n.vr({projection:"AUTO",debug:!0,forceCardboard:!1});else{if(e.hasOwnProperty("src")&&"mpd"==e.url.split(".").pop())dashjs.MediaPlayer().create().initialize(document.querySelector("#item_"+e.index),e.url,!0);if(n=new Plyr(document.querySelector("#item_"+e.index),t),e.hasOwnProperty("src")&&"m3u8"==e.url.split(".").pop())if(Hls.isSupported()){const t=new Hls;t.loadSource(e.url),t.attachMedia(document.querySelector("#item_"+e.index))}else document.querySelector("#item_"+e.index).src=e.url}n&&(o(n),n.once("loadeddata",()=>{let t=localStorage.getItem(e.url);t&&(n.currentTime=parseInt(t)),r({plyr:n,url:e.url})}),n.on("timeupdate",()=>{localStorage.setItem(e.url,Math.floor(n.currentTime))}),"youtube"==e.provider&&n.pause(),n.on("ready",()=>{if("youtube"==e.provider){let t=l("t",e.url);if(void 0!==t&&t)n.muted=!0,n.forward(parseInt(t)),n.play();else{let s=localStorage.getItem(e.url);void 0!==t&&s&&(n.muted=!0,n.forward(parseInt(s)),n.play())}}}),n.on("playing",()=>{if("youtube"==e.provider){let t=l("t",e.url);if(void 0!==t&&t)n.seekDone||(n.pause(),n.muted=!1,n.seekDone=!0);else{localStorage.getItem(e.url)&&(n.seekDone||(n.pause(),n.muted=!1,n.seekDone=!0))}}}),n.once("ended",u))}}),()=>{document.querySelector(".video_wrapper")&&document.querySelector(".video_wrapper > div")&&document.querySelector(".video_wrapper > div").remove()}),[e.url]);const u=t=>{e.update("ended",{index:e.index,src:e.url,event:t})},c=()=>{if(document.querySelector(".video_wrapper")&&document.querySelector(".video_wrapper > div")&&document.querySelector(".video_wrapper > div").remove(),"youtube"==e.provider)return localforage.getItem(e.url).then(t=>{if(t){var n=document.createElement("div"),s=document.createElement("video");s.setAttribute("id","item_"+e.index);var a=document.createElement("source");a.setAttribute("src",URL.createObjectURL(t)),a.setAttribute("type",t.type),s.appendChild(a),n.appendChild(s),document.querySelector(".video_wrapper").appendChild(n)}else{(n=document.createElement("div")).setAttribute("id","item_"+e.index),n.setAttribute("data-plyr-provider","youtube"),n.setAttribute("data-plyr-embed-id",e.embed_id),document.querySelector(".video_wrapper").appendChild(n)}});if("vimeo"==e.provider)return new Promise(t=>{var n=document.createElement("div");n.setAttribute("id","item_"+e.index),n.setAttribute("data-plyr-provider","vimeo"),n.setAttribute("data-plyr-embed-id",e.embed_id),document.querySelector(".video_wrapper").appendChild(n),t()});var t=document.createElement("div"),n=document.createElement("video");n.setAttribute("id","item_"+e.index);var s=document.createElement("source");return localforage.getItem(e.url).then(t=>{t?(s.setAttribute("src",URL.createObjectURL(t)),s.setAttribute("type",t.type)):(s.setAttribute("src",e.url),s.setAttribute("type",e.mime_type))}).then(()=>{n.appendChild(s),t.appendChild(n),document.querySelector(".video_wrapper").appendChild(t)})};return za("div",{className:"video_wrapper item_player_"+n},"youtube"==e.provider?za("div",{ref:t,id:"item_"+e.index,"data-plyr-provider":"youtube","data-plyr-embed-id":e.embed_id}):"vimeo"==e.provider?za("div",{ref:t,id:"item_"+e.index,"data-plyr-provider":"vimeo","data-plyr-embed-id":e.embed_id}):"local"==e.provider?za("div",null,za("video",{className:"activity_meta video",ref:t,id:"item_"+e.index},za("source",{src:e.url,type:e.mime_type}))):"")};const{createElement:La,render:ja,useState:Aa,useEffect:Da,Fragment:Ha}=wp.element,{dispatch:Fa,select:Ba}=wp.data;var $a=e=>{const[t,n]=Aa({}),[s,a]=Aa(!1),[r,i]=Aa(null);Da(()=>{n(e.question),a(!0)},[e.question]);const o=(e,s=0,a)=>{let r={...t};"changed"==a&&(r=e,n(r),!function(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.marked_answer)?"object"==typeof e.marked_answer||Array.isArray(e.marked_answer)?localStorage.setItem(e.id,JSON.stringify(e.marked_answer)):localStorage.setItem(e.id,e.marked_answer):null==e.marked_answer&&localStorage.removeItem(e.id))};return s?t?La(Ha,null,La("div",{className:"incourse"},La("div",{className:"quiz_questions_content"},La("div",{className:"question_cwrapper"},La("div",{className:"question","data-i":e.i},La(Tt,{question:t,update:o}),(e=>{switch(e.type){case"smalltext":return La(Z,{question:e,update:o});case"single":return La(re,{question:e,update:o,quiz_id:e.id});case"select":return La(de,{question:e,update:o,quiz_id:e.id});case"multiple":return La(ge,{question:e,update:o,quiz_id:e.id});case"fillblank":return La(Pe,{question:e,update:o,quiz_id:e.id});case"sort":return La(Be,{question:e,update:o,quiz_id:e.id});case"match":return La(et,{question:e,update:o,quiz_id:e.id});case"truefalse":return La(it,{question:e,update:o,quiz_id:e.id});case"largetext":return La(_t,{question:e,update:o,quiz_id:e.id})}})({...t}),t.attempted?"":La("div",{className:"quiz_check_answer button",onClick:e=>{(e=>{let t={...e};a(!1),t=bt(t,null,null,null,!0),t.attempted=!0,a(!0),n(t)})(t)}},window.wplms_course_data.translations.check_answer),t.attempted?La(Ot,{question:t}):"",t.attempted&&t.explanation.length?La("div",{className:"explanation"},La("strong",null,window.wplms_course_data.translations.question_explanation),La("div",{dangerouslySetInnerHTML:{__html:t.explanation}})):"")),t.attempted&&window.wplms_course_data.question_retries?La("div",{className:"quiz_check_answer button",onClick:e=>{(()=>{let e={...t};if(e.hasOwnProperty("original")){let t=e;e=t.original,e.original=t.original,n(e)}})()}},La("span",{className:"vicon vicon-reload"}),window.wplms_course_data.translations.retry):""))):"":La(p,null)};const{createElement:Ra,render:Ua,useState:Ja,useEffect:Wa,Fragment:Xa}=wp.element,{dispatch:Ya,select:Va}=wp.data;function Qa(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var Ka=e=>{const[t,n]=Ja([]),[s,a]=Ja(!1),[r,i]=Ja(0);Wa(()=>{o()},[e.questions,r]);const o=()=>{a(!1);let t=`${window.wplms_course_data.api_url}/course/questions/?client_id=${window.wplms_course_data.client_id}`;e.hasOwnProperty("force")&&e.force&&(t+="&force"),fetch(t,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({questions:e.questions,page:r+1,per_page:window.wplms_course_data.practice_questions})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e.status){if(e.questions){let t=[];e.questions.map(e=>{let n=localStorage.getItem(e.id);!Qa(n)&&Qa(e.marked_answer)&&(!function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(n)?e.marked_answer=n:e.marked_answer=JSON.parse(n)),t.push(e)}),n(t)}a(!0)}else console.log(e)}).catch(e=>{a(!0),console.error("Uh oh, an error!",e),Ya("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})};return Ra("div",{className:"practice_questions"},s?t.filter((e,t)=>t<(r+1)*window.wplms_course_data.practice_questions).map(e=>Ra($a,{question:e,i:r*window.wplms_course_data.practice_questions+t.indexOf(e)+1})):Ra(p,null),e.questions.length>window.wplms_course_data.practice_questions?Ra("div",{className:"buttons has-addons"},r>0?Ra("span",{className:"button vicon vicon-angle-left",onClick:()=>{s&&i(r-1)}}):"",r<Math.floor(e.questions.length/window.wplms_course_data.practice_questions)?Ra("span",{className:"button vicon vicon-angle-right",onClick:()=>{s&&i(r+1)}}):""):"")};const{createElement:Ga,render:Za,useState:er,useEffect:tr,Fragment:nr,useContext:sr}=wp.element,{dispatch:ar,select:rr}=wp.data;var ir=e=>{const[t,n]=er(null),[s,a]=er(e.curriculumItem),[r,i]=er(!1),[o,l]=er(!1),[u,c]=er(!1),[d,m]=er(!1);sr(b);tr(()=>{if(a({...e.curriculumItem}),e.curriculumItem.hasOwnProperty("meta")&&e.curriculumItem.meta.hasOwnProperty("scorm_type")&&e.curriculumItem.meta.scorm_type){window.scorm_page_type="unit",window.hasOwnProperty("scorm_wplms_data")||(window.scorm_wplms_data={});let e=rr("vibebp").getUser();window.scorm_wplms_data.module_id=s.id,window.scorm_wplms_data.type="unit",window.scorm_wplms_data.user_email=e.email,window.scorm_wplms_data.user_name=e.username,window.scorm_wplms_data.token=rr("vibebp").getToken()}},[e.curriculumItem]),tr(()=>{var e;if(document.querySelector(".wp-playlist.wp-video-playlist")&&(void 0!==(e=JSON.parse(document.querySelector(".wp-playlist-script").innerHTML))&&e&&e.hasOwnProperty("tracks")&&e.tracks.length)){document.querySelector(".wp-playlist video")&&document.querySelector(".wp-playlist video").remove(),(n=document.createElement("div")).classList.add("wplms-playlist");var t=document.createElement("video");n.appendChild(t),document.querySelector(".wp-playlist.wp-video-playlist").parentNode.appendChild(n),setTimeout(()=>{new Plyr(".wplms-playlist video").source={type:"video",sources:e.tracks};var t=document.createElement("div");t.classList.add("wplms_playlist");let n=document.createElement("div");n.classList.add("prevnextbuttonsdiv");let s=document.createElement("span");s.classList.add("wp-playlist-prev-button");let a=document.createElement("span");a.classList.add("wp-playlist-next-button"),n.appendChild(s),n.appendChild(a),document.querySelector(".wp-playlist.wp-video-playlist").parentNode.prepend(n),a.onclick=e=>{p(e,"forward","video")},s.onclick=e=>{p(e,"backward","video")},e.tracks.map((e,n)=>{var s=document.createElement("span");s.classList.add("track"),s.setAttribute("data-url",e.src),s.innerHTML=e.title,n<1&&s.classList.add("active"),s.onclick=t=>{t.preventDefault(),document.querySelector(".wplms_playlist .track")&&document.querySelectorAll(".wplms_playlist .track").forEach((e,t)=>{e.classList.remove("active")}),t.target.classList.add("active"),document.querySelector(".wplms-playlist video")&&document.querySelector(".wplms-playlist video").remove();var n=document.createElement("div");n.classList.add("wplms-playlist");var s=document.createElement("video");n.appendChild(s),document.querySelector(".wp-playlist.wp-video-playlist").parentNode.appendChild(n),setTimeout(()=>{new Plyr(".wplms-playlist video").source={type:"video",sources:[e]}},200)},t.appendChild(s)}),document.querySelector(".wp-playlist.wp-video-playlist").appendChild(t)},200)}if(document.querySelector(".wp-playlist.wp-audio-playlist")&&(void 0!==(e=JSON.parse(document.querySelector(".wp-playlist-script").innerHTML))&&e&&e.hasOwnProperty("tracks")&&e.tracks.length)){var n;document.querySelector(".wp-playlist audio")&&document.querySelector(".wp-playlist audio").remove(),document.querySelector(".wp-playlist-current-item")&&document.querySelector(".wp-playlist-current-item").remove(),(n=document.createElement("div")).classList.add("wplms-playlist");t=document.createElement("audio");n.appendChild(t),document.querySelector(".wp-playlist.wp-audio-playlist").parentNode.appendChild(n),setTimeout(()=>{new Plyr(".wplms-playlist audio").source={type:"audio",sources:e.tracks};var t=document.createElement("div");t.classList.add("wplms_playlist");let n=document.createElement("div");n.classList.add("prevnextbuttonsdiv");let s=document.createElement("span");s.classList.add("wp-playlist-prev-button");let a=document.createElement("span");a.classList.add("wp-playlist-next-button"),n.appendChild(s),n.appendChild(a),document.querySelector(".wp-playlist.wp-audio-playlist").parentNode.prepend(n),a.onclick=e=>{p(e,"forward","audio")},s.onclick=e=>{p(e,"backward","audio")},e.tracks.map((e,n)=>{var s=document.createElement("span");s.classList.add("track"),s.setAttribute("data-url",e.src),s.innerHTML=e.title,n<1&&s.classList.add("active"),s.onclick=t=>{t.preventDefault(),document.querySelector(".wplms_playlist .track")&&document.querySelectorAll(".wplms_playlist .track").forEach((e,t)=>{e.classList.remove("active")}),t.target.classList.add("active"),document.querySelector(".wplms-playlist")&&document.querySelector(".wplms-playlist").remove();var n=document.createElement("div");n.classList.add("wplms-playlist");var s=document.createElement("audio");n.appendChild(s),document.querySelector(".wp-playlist.wp-audio-playlist").parentNode.appendChild(n),setTimeout(()=>{let t=new Plyr(".wplms-playlist audio");t.source={type:"audio",sources:[e]},t.play()},200)},t.appendChild(s)}),document.querySelector(".wp-playlist.wp-audio-playlist").appendChild(t)},200)}},[s]);const p=(e,t,n)=>{if("forward"==t){for(let e=0;e<document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track").length;e++)if(document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track")[e].classList.contains("active")&&e<document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track").length-1){document.querySelector(".wplms_playlist .track")&&document.querySelectorAll(".wplms_playlist .track").forEach((e,t)=>{e.classList.remove("active")}),document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track")[e+1].classList.add("active"),document.querySelector(".wplms-playlist")&&document.querySelector(".wplms-playlist").remove();let t=document.createElement("div");t.classList.add("wplms-playlist");let s=document.createElement(n);t.appendChild(s),document.querySelector(".wp-playlist.wp-"+n+"-playlist").parentNode.appendChild(t),setTimeout(()=>{let t=new Plyr(".wplms-playlist "+n);t.source={type:n,sources:[{src:document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track")[e+1].getAttribute("data-url")}]},t.play()},200);break}}else for(let e=document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track").length-1;e>=0;e--)if(document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track")[e].classList.contains("active")&&0!=e){document.querySelector(".wplms_playlist .track")&&document.querySelectorAll(".wplms_playlist .track").forEach((e,t)=>{e.classList.remove("active")}),document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track")[e-1].classList.add("active"),document.querySelector(".wplms-playlist")&&document.querySelector(".wplms-playlist").remove();var s=document.createElement("div");s.classList.add("wplms-playlist");var a=document.createElement(n);s.appendChild(a),document.querySelector(".wp-playlist.wp-"+n+"-playlist").parentNode.appendChild(s),setTimeout(()=>{let t=new Plyr(".wplms-playlist "+n);t.source={type:n,sources:[{src:document.querySelectorAll(".wp-"+n+"-playlist .wplms_playlist .track")[e-1].getAttribute("data-url")}]},t.play()},200);break}};let _="";if(s.meta.hasOwnProperty("video")&&"object"==typeof s.meta.video&&"video"==s.meta.video.type){let e=s.meta.video.url.split(".");switch(e[e.length-1]){case"mov":_="video/mp4";break;default:_="video/"+e[e.length-1]}}if(s.meta.hasOwnProperty("audio")&&"object"==typeof s.meta.audio&&"audio"==s.meta.audio.type){let e=s.meta.audio.url.split(".");switch(e[e.length-1]){case"m4a":_="audio/mp4";break;case"oga":_="audio/ogg";break;default:_="audio/"+e[e.length-1]}}const h=async(t,n,a=null)=>{if(t){let o={};window.wplms_course_data.course.status.seek_lock&&(o.listeners={seek:e=>{var t=r.currentTime;if(((e,t)=>"object"!=typeof t||"input"!==t.type&&"change"!==t.type?Number(t):t.target.value/t.target.max*e.media.duration)(r,e)>t)return e.preventDefault(),!1}});const l=await localforage.getItem(n);l&&document.querySelector(".media_video_meta"+a+" source")&&document.querySelector(".media_video_meta"+a+" source").setAttribute("src",URL.createObjectURL(l));let u=new Plyr(t,o);u.once("loadeddata",()=>{let e=localStorage.getItem(n);e&&e<=u.duration&&(u.currentTime=e),i({plyr:u,url:n})}),null===a||s.status||u.once("ended",t=>{e.update({index:a,src:n,event:t},"videosended")})}};((e,t,n=[])=>{const s=Hn(Date.now());jn(()=>{const n=setTimeout((function(){Date.now()-s.current>=t&&(e(),s.current=Date.now())}),t-(Date.now()-s.current));return()=>{clearTimeout(n)}},[t,...n])})(()=>{void 0!==r.player&&r.player.on("playing",()=>{localStorage.setItem(r.url,r.player.currentTime)})},500,[r,o]);const w=(e,t)=>{let n={...s};n.meta.hasOwnProperty("assignments")&&n.meta.assignments.length&&n.meta.assignments[t]&&(n.meta.assignments[t].show=e),a(n)},g=(t,n)=>{"complete"==n&&e.update({assignmentIndex:t.assignmentIndex},"completeUnitAssigmnent"),"retake"==n&&e.update({assignmentIndex:t.assignmentIndex},"retakeUnitAssigmnent")},f=e=>{e&&!t&&n(e)},v=(t,n)=>{e.update(n,"mediaended")};let y=[],k=[];if(s.meta.hasOwnProperty("video")&&"object"==typeof s.meta.video){if("youtube"==s.meta.video.type){let e=s.meta.video.url.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/);e&&e.length&&(y=e[1])}"vimeo"==s.meta.video.type&&(k=s.meta.video.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/))}return Ga("div",{className:"course_content_content"},e.hasOwnProperty("noLabels")&&e.noLabels?"":Ga(nr,null,Ga("span",{className:"lesson_info"},Ga("span",null,window.wplms_course_data.reports.module.unit+" ",e.item_number+"/"+e.total_item_count),Ga("span",null," "),Ga(X,{timestamp:s.duration,notimediff:1})),Ga("h2",{dangerouslySetInnerHTML:{__html:s.title}})),Ga("div",null,s.meta.hasOwnProperty("access")&&s.meta.access||!s.meta.hasOwnProperty("drip_time")?s.meta.hasOwnProperty("video")&&"object"==typeof s.meta.video&&!Array.isArray(s.meta.video)?"youtube"==s.meta.video.type?Ga("div",null,y&&y.length?Ga(Ta,{provider:"youtube",index:e.index,embed_id:y,url:s.meta.video.url,update:v}):""):"vimeo"==s.meta.video.type&&void 0!==k&&k&&void 0!==k[4]&&k[4]?Ga("div",null,Ga(Ta,{provider:"vimeo",index:e.index,embed_id:k[4],url:s.meta.video.url,update:v})):Ga("div",null,Ga(Ta,{provider:"local",index:e.index,src:s.meta.video.url,mime_type:_,url:s.meta.video.url,video:s.meta.video,update:v})):s.meta.hasOwnProperty("audio")&&"object"==typeof s.meta.audio&&!Array.isArray(s.meta.audio)&&s.meta.audio.url.length?Ga("div",null,Ga("div",null,Ga("audio",{className:"activity_meta audio",ref:e=>{h(e,s.meta.audio.url)}},Ga("source",{src:s.meta.audio.url,type:_})))):s.meta.hasOwnProperty("package")?Ga("div",{className:"unit_iframe_wrapper"},Ga("iframe",{src:s.meta.package.src,width:"100%",height:"100%",frameborder:"0",allowfullscreen:"allowfullscreen"})):Ga("div",{className:s.type+""+s.id}):Ga(Mn,{start:!0,duration:s.meta.drip_time,update:(t,n)=>{"expired"==n&&e.update({index:e.index},"loadunit")},quiz_id:e.index})),s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.hasOwnProperty("video")&&s.meta.video.length?Ga("div",{className:"unit_videos"},s.meta.video.map((e,t)=>Ga("div",{className:"video_wrapper"},Ga("video",{className:"activity_meta video media_video_meta"+t,ref:n=>h(n,e,t)},Ga("source",{src:e,type:"video/mp4"}))))):"",s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.hasOwnProperty("audio")&&s.meta.audio.length?Ga("div",{className:"unit_videos"},s.meta.audio.map((e,t)=>Ga("div",{className:"video_wrapper"},Ga("audio",{className:"activity_meta video media_video_meta"+t,ref:n=>h(n,e,t)},Ga("source",{src:e,type:"audio/mpeg"}))))):"",s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.hasOwnProperty("iframes")&&s.meta.iframes.length?Ga("div",{className:"unit_iframes"},s.meta.iframes.map((e,t)=>"object"==typeof e&&e.hasOwnProperty("value")?Ga("div",{className:"unit_iframe_wrapper "+e.shortcode},Ga("iframe",{src:e.value,width:"560",height:"315",frameborder:"0",allowfullscreen:"allowfullscreen"})):Ga("div",{className:"unit_iframe_wrapper"},Ga("iframe",{src:e,width:"560",height:"315",frameborder:"0",allowfullscreen:"allowfullscreen"})))):"",s.hasOwnProperty("unit_type")&&"elementor"===s.unit_type?(()=>{if(s.meta.hasOwnProperty("access")&&s.meta.access&&s.hasOwnProperty("meta")&&s.meta.hasOwnProperty("link")&&s.meta.link.length){let e=s.meta.link;return e.includes("?")?e+="&token="+rr("vibebp").getToken():e+="?token="+rr("vibebp").getToken(),Ga("div",{className:"wplms_iframe_wrapper"},Ga("iframe",{src:e,width:"100%"}))}return Ga("div",{dangerouslySetInnerHTML:{__html:s.content},ref:f})})():Ga("div",{dangerouslySetInnerHTML:{__html:s.content},ref:f}),s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.attachments&&s.meta.attachments.length?Ga("div",{className:"unit_attachments"},Ga("h3",null,window.wplms_course_data.translations.attachments),s.meta.attachments.map((e,t)=>{return Ga("div",{className:"attachment"},Ga("span",null,"application/pdf"==(n=e.type)?Ga("span",{className:"attachment_icon",dangerouslySetInnerHTML:{__html:window.wplms_course_data.course.attachment_types["application/pdf"]}}):"image/jpeg"==n?Ga("span",{className:"attachment_icon",dangerouslySetInnerHTML:{__html:window.wplms_course_data.course.attachment_types["image/jpeg"]}}):"video/mp4"==n?Ga("span",{className:"attachment_icon",dangerouslySetInnerHTML:{__html:window.wplms_course_data.course.attachment_types["video/mp4"]}}):"application/pdf"==n||"application/pdf"==n?"":Ga("span",{className:"attachment_icon",dangerouslySetInnerHTML:{__html:window.wplms_course_data.course.attachment_types.default}}),Ga("strong",{dangerouslySetInnerHTML:{__html:e.name}})),Ga("a",{href:e.link,target:"_blank",className:"vicon vicon-download"}));var n})):"",s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.attachments&&s.meta.assignments.length?Ga("div",{className:"unit_assignments"},Ga("h3",null,window.wplms_course_data.translations.assignments),s.meta.assignments.map((t,n)=>Ga("div",{className:"assignment"},Ga("div",{className:"assignment_heading"},Ga("span",null,t.title),Ga("div",{className:"assignment_meta"},t&&t.hasOwnProperty("show")&&t.show?Ga("a",{className:"vicon vicon-minus",onClick:()=>{w(!1,n)}}):Ga("a",{className:"vicon vicon-plus",onClick:()=>{w(!0,n)}}))),t.show?Ga("div",{className:"assignment_content_wrapper"},Ga(Fs,{assignment:t,assignmentIndex:n,index:n,unitIndex:e.index,update:g})):""))):"",s.meta.hasOwnProperty("pratice_questions")&&s.meta.pratice_questions.length?Ga("div",{className:"pratice_questions"},Ga(Ka,{questions:s.meta.pratice_questions})):"")},or=n(7);function lr(e,t,n,s){const a=e*(Math.PI/180),r=t*(Math.PI/180);return{x:0,y:0,wobble:10*s(),wobbleSpeed:.1+.1*s(),velocity:.5*n+s()*n,angle2D:-a+(.5*r-s()*r),angle3D:-Math.PI/4+s()*(Math.PI/2),tiltAngle:s()*Math.PI,tiltAngleSpeed:.1+.3*s()}}function ur(e,t,n,s,a,r){let i;return new Promise(o=>{requestAnimationFrame((function l(u){i||(i=u);const c=u-i,d=i===u?0:(u-i)/a;t.slice(0,Math.ceil(c/r)).forEach(e=>{!function(e,t,n,s){e.physics.x+=Math.cos(e.physics.angle2D)*e.physics.velocity,e.physics.y+=Math.sin(e.physics.angle2D)*e.physics.velocity,e.physics.z+=Math.sin(e.physics.angle3D)*e.physics.velocity,e.physics.wobble+=e.physics.wobbleSpeed,s?e.physics.velocity*=s:e.physics.velocity-=e.physics.velocity*n,e.physics.y+=3,e.physics.tiltAngle+=e.physics.tiltAngleSpeed;const{x:a,y:r,tiltAngle:i,wobble:o}=e.physics,l=`translate3d(${a+10*Math.cos(o)}px, ${r+10*Math.sin(o)}px, 0) rotate3d(1, 1, 1, ${i}rad)`;e.element.style.visibility="visible",e.element.style.transform=l,e.element.style.opacity=1-t}(e,d,n,s)}),u-i<a?requestAnimationFrame(l):(t.forEach(t=>{if(e&&t.element.parentNode===e)return e.removeChild(t.element)}),o())}))})}const cr={angle:90,spread:45,startVelocity:45,elementCount:50,width:"10px",height:"10px",colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"],duration:3e3,stagger:0,dragFriction:.1,random:Math.random};function dr(e,t={}){const{elementCount:n,colors:s,width:a,height:r,angle:i,spread:o,startVelocity:l,decay:u,dragFriction:c,duration:d,stagger:m,random:p}=Object.assign({},cr,function(e){return!e.stagger&&e.delay&&(e.stagger=e.delay),e}(t)),_=function(e,t,n,s,a){return Array.from({length:t}).map((t,r)=>{const i=document.createElement("div"),o=n[r%n.length];return i.style["background-color"]=o,i.style.width=s,i.style.height=a,i.style.position="absolute",i.style.willChange="transform, opacity",i.style.visibility="hidden",e&&e.appendChild(i),i})}(e,n,s,a,r);return ur(e,_.map(e=>({element:e,physics:lr(i,o,l,p)})),c,u,d,m)}const{createElement:mr,render:pr,useState:_r,useEffect:hr,Fragment:wr,useRef:gr}=wp.element,{dispatch:fr,select:vr}=wp.data;var yr=e=>{const[t,n]=_r(!1),[s,a]=_r(!1),[r,i]=_r(!1),o=gr(null),l=gr(null),[u,c]=_r(!1),[d,m]=_r(!1),[_,h]=_r(""),[w,g]=_r(!1),[f,v]=_r(e.course),[y,k]=_r({}),[x,q]=_r({prev:0,next:0}),[z,N]=_r(!1),[S,O]=_r(!1),[P,I]=_r({}),[C,M]=_r(!1),[T,L]=_r(!0),[j,A]=_r(!0),[D,H]=_r([]),[F,B]=_r(null),[$,R]=_r(!1),[U,J]=_r(null),[W,Y]=_r(null),[V,Q]=_r([]),[K,G]=_r([]),[Z,ee]=_r([]),[te,ne]=_r(!1);let se=vr("vibebp").getUser();se.token=vr("vibebp").getToken(),hr(()=>{e.hasOwnProperty("download")&&e.download&&localforage.getItem("coursestatus_"+e.course_id).then(t=>{if(t&&t.length)try{t=JSON.parse(t),G(t)}catch(e){console.log(e)}-1==V.indexOf(e.course_id)&&Q([...V,e.course_id])}),v(e.course)},[e.course]),hr(()=>{f&&(e.hasOwnProperty("download")&&e.download||re())},[f]),hr(()=>{u&&(async()=>{if(!navigator.onLine)return fr("vibebp").addNotification({text:window.wplms_course_data.translations.could_not_refresh}),await ge(1e3),void c(!1);y.hasOwnProperty("courseitems")&&y.courseitems&&y.courseitems.length?localforage.removeItem(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`).then(()=>{y.courseitems.map((e,t)=>{let n=fe(e);localforage.removeItem(n).then(async()=>{e.hasOwnProperty("id")&&0!=e.id&&await Ee(`${window.wplms_course_data.api_url}/user/unitcomments/${e.id}`),t==y.courseitems.length-1&&re(!0)})})}):localforage.removeItem(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`).then(()=>{re(!0)})})()},[u]),hr(()=>{(async()=>{if(await ge(500),document.querySelector(".course_package_wrapper")&&!u){let e=new Draggabilly(document.querySelector(".course_package_wrapper"),{axis:"y",handle:".course_package_header"});e.on("dragStart",()=>{}),e.on("dragMove",(e,t,n)=>{n.y>=90&&c(!0)}),e.on("dragEnd",()=>{e.setPosition(0,0)})}else if(document.querySelector(".course_content")&&!u){let e=new Draggabilly(document.querySelector(".course_content"),{axis:"y",handle:".course_content_header"});e.on("dragStart",()=>{}),e.on("dragMove",(e,t,n)=>{n.y>=90&&c(!0)}),e.on("dragEnd",()=>{e.setPosition(0,0)})}})()},[u,y]),hr(()=>{V.length&&localforage.removeItem(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`).then(()=>{re()})},[V]),hr(()=>{if(K.length&&Object.keys(y).length&&y.hasOwnProperty("courseitems")&&y.courseitems&&y.courseitems.length){let t="coursestatus_"+e.course_id;localforage.setItem(t,JSON.stringify(K));let n=W;for(let e=W+1;e<y.courseitems.length;e++)void 0!==y.courseitems[e]&&y.courseitems[e]&&0!=y.courseitems[e].id&&n<=W&&(n=e);_e(n,{...y}),y.courseitems[W].downloaded=1;let s=0,a=0,r=0;y.courseitems.map((e,t)=>{e.downloaded&&s++,e.id&&r++}),a=s/r,a=Math.round(100*a),e.update({progress:a,index:e.index},"progresschanged")}},[K]),hr(()=>{localforage.setItem("coursestatus_curriculum_item_video_urls_"+e.course_id,JSON.stringify(Z))},[Z]);const ae=e=>{if(e.detail.hasOwnProperty("action")&&(console.log(e.detail),"unitfinished"==e.detail.action)){let t=e.detail.coursestatus.courseitems.findIndex(t=>t.id==e.detail.id);t>-1&&qe(t)}};hr(()=>(document.addEventListener("custom_unit_action",ae),()=>{document.removeEventListener("custom_unit_action",ae)})),hr(()=>(window.innerWidth<480&&O(!0),document.addEventListener("wplms_change_coursestatus",e=>{let t=e.detail.coursestatus;a(!0),k(t),a(!1)}),document.addEventListener("custom_quiz_action",t=>{if(t.detail.hasOwnProperty("action")){console.log(t.detail);let n=t.detail.coursestatus;if("quizsubmitted"==t.detail.action){let s=n.courseitems.findIndex(e=>e.id==t.detail.id);if(s>-1){if(n.courseitems[s].hasOwnProperty("status")&&parseInt(n.courseitems[s].status))return n.courseitems[s].progressbar=100,!1;n.courseitems[s].status=1,n.courseitems[s].progressbar=100;let t=0,a=0,r=0;n.courseitems.map((e,n)=>{e.status&&t++,e.id&&r++}),a=t/r,a=Math.round(100*a),e.update({progress:a,index:e.index},"progresschanged"),k(n),n.courseitems[s]&&"unit"==n.courseitems[s].type?fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${n.courseitems[s].id}/markcomplete?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token,progress:a})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{t&&(t.status?(fr("vibebp").addNotification({icon:t.icon,text:t.message}),a&&a>=100&&de(),document.dispatchEvent(new CustomEvent("course_item_completed",{detail:{course_id:e.course_id,item_id:n.courseitems[s].id}}))):t.hasOwnProperty("message")&&fr("vibebp").addNotification({text:t.message}),le(n,W))}).catch(e=>{console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}):(n.courseitems[s].status=1,k(n),a&&a>=100&&de()),le(n,s)}}if("retake_quiz"==t.detail.action){let t=n.current_unit_key;if(n.courseitems[t]&&n.courseitems[t].status){n.courseitems[t].status=0;let s=0,a=0,r=0;n.courseitems.map((e,t)=>{e.status&&s++,e.id&&r++}),a=s/r,a=Math.round(100*a),e.update({progress:a,index:e.index},"progresschanged"),k(n),le(n,t);new CustomEvent("item_retake",{detail:{coursestatus:{...y},item_id:y.courseitems[t].id,course_id:e.course_id}})}}}}),e.hasOwnProperty("download")&&e.download||(document.querySelector("body").classList.add("course_status_fullscreen"),document.querySelector("body").classList.add("wplms_course_status")),window.wplms_course_data.disable_contextmenu&&document.addEventListener("contextmenu",ue,!1),()=>{if(document.querySelector("body").classList.remove("wplms_course_status"),document.querySelector("body").classList.remove("course_status_fullscreen"),document.querySelector("body").classList.remove("course_status_loaded"),V.indexOf(e.course_id)>-1){let t=[...V];t.splice(V.indexOf(e.course_id),1),Q(t)}window.wplms_course_data.disable_contextmenu&&document.removeEventListener("contextmenu",ue);var t=new CustomEvent("course_status_left",{detail:{coursestatus:y,course_id:e.course_id}});document.dispatchEvent(t)}),[]),hr(()=>{let e={...y};if(_&&_.length>3){if(e&&e.courseitems){var t=new or.Search("key");t.addIndex("title"),t.addIndex("content"),t.addDocuments(e.courseitems);var n=t.search(_);e.filtered_items=n,e.keyword=_,k(e),n&&n.length&&_e(n[0].key,e)}}else e.filtered_items=[],e.keyword="",k(e)},[_]);const re=t=>{t||n(!0),m(!1),ce(e.course_id),fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(async s=>{if(s){s.hasOwnProperty("error_code")&&(fr("vibebp").addNotification({icon:s.icon,text:s.hasOwnProperty("error_message")&&s.error_message.length?s.error_message:window.wplms_course_data.translations.error}),e.back(!0));let i=null,o=[],l=null;if(s.courseitems&&s.courseitems.length)if(s.courseitems.map((t,n)=>{t.status&&(t.progressbar=100,A(!1)),t.hasOwnProperty("id")&&0!=s.courseitems[n].id&&(null===i&&(i=n,l=n),o.push(fe(s.courseitems[n])),e.hasOwnProperty("startUnit")&&e.startUnit&&parseInt(s.courseitems[n].id)===parseInt(e.startUnit)&&(i=n))}),document.querySelector("body").classList.contains("course_status_loaded")||document.querySelector("body").classList.add("course_status_loaded"),e.hasOwnProperty("download")&&e.download&&V.indexOf(e.course_id)>-1){if(localforage.setItem("coursestatus_curriculum_item_urls_"+e.course_id,JSON.stringify(o)),e.hasOwnProperty("startUnit")&&e.startUnit&&l!==i)for(var a=0;a<i;a++)void 0!==s.courseitems[a]&&s.courseitems[a]&&0!=s.courseitems[a].id&&(s.courseitems[a].downloaded=1);s.current_unit_key=i,k(s),Y(i),_e(i,s),ye(s.current_unit_key,s)}else k(s),Y(s.current_unit_key),_e(s.current_unit_key,s),ye(s.current_unit_key,s);if(s.hasOwnProperty("package")&&s.package.length)if(m(!0),s.hasOwnProperty("package_details")&&s.package_details&&s.package_details.hasOwnProperty("package_type")&&"xapi"==s.package_details.package_type){let t=s.package_details.path;t+="?endpoint="+encodeURIComponent(window.wplms_course_data.xapi_endpoint+"/"+e.course_id),t+="&auth="+encodeURIComponent("Basic "+se.token),t+="&actor="+encodeURIComponent(JSON.stringify({objectType:"Agent",mbox:se.email,name:se.displayname})),k({package:'<div class="iframecontent"><iframe src="'+t+'" width="100%" allowFullScreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe></div>'})}else window.scorm_page_type="course",window.scorm_wplms_data={},window.scorm_wplms_data.user_email=se.email,window.scorm_wplms_data.user_name=se.username,window.scorm_wplms_data.token=se.token,window.scorm_wplms_data.course_id=e.course_id,window.is_take_course=!0,window.scorm_wplms_data.type="course",k({package:s.package}),s.hasOwnProperty("package_type")&&s.package_type&&"1.1"==s.package_type&&setTimeout(()=>{var e=new CustomEvent("unit_content_loaded",{detail:{coursestatus:{package:s.package}}});document.dispatchEvent(e)},200);var r=new CustomEvent("course_status_loaded",{detail:{coursestatus:s,course_id:e.course_id}});document.dispatchEvent(r),t||n(!1)}t&&(await ge(500),c(!1))}).catch(e=>{c(!1),console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})};hr(()=>{if(y)return document.addEventListener("course_item_completed",ie),()=>{document.removeEventListener("course_item_completed",ie)}},[y]);const ie=e=>{e.detail&&e.detail.course_id&&e.detail.item_id&&oe(e.detail.course_id,e.detail.item_id)},oe=(e,t)=>{y.hasOwnProperty("gamification")&&y.gamification.type&&"curriculum"==y.gamification.type&&y.gamification.value&&y.gamification.value.hasOwnProperty(t)&&fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e}/item/${t}/assignbadges?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{e.status&&(e.hasOwnProperty("message")&&fr("vibebp").addNotification({iconUrl:window.wplms_course_data.coin_image,backgroundColor:"var(--success)",textColor:"var(--gray-dark)",text:e.message}),e.hasOwnProperty("badges")&&Array.isArray(e.badges)&&e.badges.length&&(ne(!0),setTimeout(()=>{ne(!1)},5e3),iziToast?e.badges.map(e=>{iziToast.show({message:`${window.wplms_course_data.translations.you_have_got_badge} ${e.name}`,image:e.image,position:"topCenter"})}):e.badges.map(e=>{fr("vibebp").addNotification({text:`${window.wplms_course_data.translations.you_have_got_badge} ${e.name}`})})))}).catch(e=>{console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},le=(t,n)=>{"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`).then(s=>{s&&s.length&&(s=JSON.parse(s)).hasOwnProperty("courseitems")&&(s.courseitems=t.courseitems,s.current_unit_key=n,localforage.setItem(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`,JSON.stringify(s)))})},ue=e=>(console.log("You've tried to open context menu"),e.preventDefault(),!1),ce=e=>{window.wplms_course_data.gamification&&window.wplms_course_data.gamification&&fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e}/gamification`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{e.status&&e.active&&e.gamification&&(k(t=>({...t,gamification:e.gamification})),fr("vibebp").addNotification({text:e.message}))}).catch(e=>{console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},de=()=>{e.hasOwnProperty("download")&&e.download||y.hasOwnProperty("auto_finish")&&y.auto_finish&&f.user_progress>=100&&fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/checkcomplete`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token,course:y,course_id:e.course})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{e&&e.status&&Ne(!0)}).catch(e=>{console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},me=e=>{let t={...y};t&&t.courseitems&&t.courseitems[W]&&"unit"==t.courseitems[W].type&&(t.courseitems[W].hasOwnProperty("progressbar")||(t.courseitems[W].progressbar=0),e>100&&(e=100),t.courseitems[W].progressbar=e,k(t))},pe=(e,t)=>{let n=document.scrollingElement||document.documentElement;document.querySelector("body").classList&&document.querySelector("body").classList.length&&document.querySelector("body").classList.contains("course_status_fullscreen")&&o.current&&(e=0,n=o.current);const s=n.scrollTop,a=e-s,r=+new Date,i=function(){const o=+new Date-r;var l,u,c;n.scrollTop=parseInt((l=o,u=s,c=a,(l/=t/2)<1?c/2*l*l+u:-c/2*(--l*(l-2)-1)+u)),o<t?requestAnimationFrame(i):n.scrollTop=e};i()},_e=async(t,n=null,s=null)=>{if(null==n&&(n={...y}),n.hasOwnProperty("lock")&&n.lock&&(!e.hasOwnProperty("download")||!e.download)&&n.courseitems&&n.courseitems.length)for(let e=0;e<t;e++)if("section"!=n.courseitems[e].type&&!n.courseitems[e].status)return!1;if(n.courseitems[t].id&&"unit"==n.courseitems[t].type)if(s||!n.courseitems[t].content||n.courseitems[t].content.length<3||!n.courseitems[t].meta.hasOwnProperty("access")||!n.courseitems[t].meta.access||n.courseitems[t].meta.hasOwnProperty("no_cache")&&n.courseitems[t].meta.no_cache){a(!0),U&&U.abort();let r={},i=new AbortController;U&&(r={signal:i.signal}),J(i),n.current_unit_key=t,Y(t),k(n),ye(t,n);let l=`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${n.courseitems[t].id}`;(s||n.courseitems[t].meta.hasOwnProperty("no_cache")&&n.courseitems[t].meta.no_cache)&&(l+="?force"),fetch(l,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},...r,body:JSON.stringify({token:se.token})}).then(e=>e.json()).then(async s=>{if(J(null),s){n.courseitems[t].content=s.content,n.courseitems[t].meta=s.meta;let i=1;Array.isArray(s.scripts)&&s.scripts.map(e=>{if(!document.getElementById(e.key)){let t=document.createElement("script");t.src=e.src,t.id=e.key,document.body.appendChild(t),t.onload=()=>{i++,console.log("loaded"),i==s.scripts.length&&document.body.dispatchEvent(new Event("post-load"))}}}),k(n),le(n,t),a(!1),document.querySelector(".course_status")&&document.querySelector(".course_status").scroll({top:o.current.getBoundingClientRect().top,left:0,behavior:"smooth"}),s.meta.hasOwnProperty("scorm_type")&&s.meta.scorm_type&&setTimeout(()=>{var e=new CustomEvent("unit_content_loaded",{detail:{coursestatus:n}});document.dispatchEvent(e)},200);var r=new CustomEvent("unit_loaded",{detail:{coursestatus:n,course:e.course_id,user:vr("vibebp").getUser()}});if(document.dispatchEvent(r),document.dispatchEvent(new Event("VibeBP_Editor_Content")),e.hasOwnProperty("download")&&e.download&&V.indexOf(e.course_id)>-1){await ge(4e3),await he(n.courseitems[t]);let e=fe(n.courseitems[t]);G([...K,e])}}}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):(J(null),a(!1),console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data}))})}else{Y(t),n.current_unit_key=t,k(n),le(n,t),ye(t,n),n.hasOwnProperty("courseitems")&&n.courseitems[t]&&n.courseitems[t].hasOwnProperty("meta")&&n.courseitems[t].meta.hasOwnProperty("scorm_type")&&n.courseitems[t].meta.scorm_type&&setTimeout(()=>{var e=new CustomEvent("unit_content_loaded",{detail:{coursestatus:n}});document.dispatchEvent(e)},200),document.querySelector(".course_status")&&document.querySelector(".course_status").scroll({top:o.current.getBoundingClientRect().top,left:0,behavior:"smooth"});var r=new CustomEvent("unit_loaded",{detail:{coursestatus:n,course:e.course_id}});document.dispatchEvent(r),document.dispatchEvent(new Event("VibeBP_Editor_Content")),e.hasOwnProperty("download")&&e.download||o.current&&window.hasOwnProperty("innerWidth")&&window.innerWidth>768&&pe(o.current.scrollTop,800)}else{if(a(!0),Y(t),n.current_unit_key=t,k(n),ye(t,n),a(!1),le(n,t),e.hasOwnProperty("download")&&e.download||o.current&&window.hasOwnProperty("innerWidth")&&window.innerWidth>768&&pe(o.current.scrollTop,800),e.hasOwnProperty("download")&&e.download&&V.indexOf(e.course_id)>-1){await ge(4e3),await he(n.courseitems[t]);let e=fe(n.courseitems[t]);G([...K,e])}document.querySelector(".course_status")&&document.querySelector(".course_status").scroll({top:o.current.getBoundingClientRect().top,left:0,behavior:"smooth"})}i(!1)},he=async e=>new Promise(async(t,n)=>{if(e.meta.hasOwnProperty("video"))if("object"==typeof e.meta.video&&"video"==e.meta.video.type)await we(e.meta.video.url),t();else if(Array.isArray(e.meta.video)&&e.meta.video.length)for(let n=0;n<e.meta.video.length;n++)console.log(e.meta.video[n]),await we(e.meta.video[n]),e.meta.video.length-1===n&&t();else t();else if(e.meta.hasOwnProperty("audio"))if("object"==typeof e.meta.audio&&"audio"==e.meta.audio.type)await we(e.meta.audio.url),t();else if(Array.isArray(e.meta.audio)&&e.meta.audio.length)for(let n=0;n<e.meta.audio.length;n++)await we(e.meta.audio[n]),e.meta.audio.length-1===n&&t();else t();else t()}),we=async(t,n=null)=>new Promise(async(s,a)=>{fetch(t).then(e=>e.blob()).then(e=>{n&&(t=n),localforage.setItem(t,e),Z.indexOf(t)<0&&ee([...Z,t]),s(t)}).catch(t=>{console.log(t),fr("vibebp").addNotification({text:window.wplms_course_data.translations.some_error_downloading_video}),e.update("","pause")})}),ge=e=>new Promise(t=>setTimeout(t,e)),fe=t=>{let n="";return n="unit"==t.type?`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${t.id}`:"quiz"==t.type?`${window.wplms_course_data.api_url}/user/quiz/${t.id}`:"wplms-assignment"==t.type?`${window.wplms_course_data.api_url}/user/content/assignmentId/${t.id}`:`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${t.id}`,n},ve=t=>{let n=W;if("prev"==t){for(let e=n-1;e>=0;e--)if(y.courseitems[e]&&0!=y.courseitems[e].id){n=y.courseitems[e].key;break}}else for(let t=n+1;t<y.courseitems.length;t++)if(y.courseitems[t]&&0!=y.courseitems[t].id){n=y.courseitems[t].key,1==e.course.user_status&&e.update({index:e.index,user_status:2},"statuschanged");break}_e(n)},ye=(e,t=null)=>{null===t&&(t=y);let n={prev:0,next:0};for(let s=e-1;s>=0;s--)if(t.courseitems[s]&&0!=t.courseitems[s].id){n.prev=1;break}for(let s=e+1;s<t.courseitems.length;s++)if(t.courseitems[s]&&0!=t.courseitems[s].id){n.next=1;break}q(n)},be=(t=null,n=null)=>{if("quizsubmitted"==t&&qe(),"retake_quiz"==t){let t={...y};if(t.courseitems[W]&&t.courseitems[W].status){t.courseitems[W].status=0,t.courseitems[W].user_marks=0,t.courseitems[W].total_marks=0;let n=0,a=0,r=0;t.courseitems.map((e,t)=>{e.status&&n++,e.id&&r++}),a=n/r,a=Math.round(100*a),e.update({progress:a,index:e.index},"progresschanged"),k(t),le(t,W);var s=new CustomEvent("item_retake",{detail:{coursestatus:{...y},item_id:y.courseitems[W].id,course_id:e.course_id}});document.dispatchEvent(s)}}if("update_quiz_marks"==t){let e={...y},t={...e.courseitems[W]};t.hasOwnProperty("user_marks")||(t.user_marks=0),t.hasOwnProperty("total_marks")||(t.total_marks=0),t.user_marks+=parseInt(n.user_marks),t.total_marks+=parseInt(n.total_marks),e.courseitems[W]=t,k(e)}},ke=(t,n)=>{let s={...y};"submitassignment"==n&&(t.hasOwnProperty("unitIndex")||(s.courseitems[W].status=1,k(s),le(s,W),document.dispatchEvent(new CustomEvent("course_item_completed",{detail:{course_id:e.course_id,item_id:y.courseitems[W].id,courseStatus:{...y}}})))),"retookassignment"==n&&(t.hasOwnProperty("unitIndex")||(s.courseitems[W].status=0,k(s),le(s,W),document.dispatchEvent(new CustomEvent("item_retake",{detail:{course_id:e.course_id,item_id:y.courseitems[W].id,courseStatus:{...y}}}))))},xe=e=>dr(e,{colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"],angle:90,spread:90,startVelocity:45,elementCount:100,dragFriction:.1,duration:5e3,stagger:2,width:"12px",height:"12px"}),qe=(t=null,n=null)=>new Promise(s=>{e.hasOwnProperty("download")&&e.download&&s();let a={...y};if(null==t&&(t=W),a.courseitems[t].hasOwnProperty("status")&&parseInt(a.courseitems[t].status))return a.courseitems[t].progressbar=100,s(),!1;a.courseitems[t].status=1,a.courseitems[t].progressbar=100;let r=0,i=0,o=0;a.courseitems.map((e,t)=>{e.status&&r++,e.id&&o++}),i=r/o,i=Math.round(100*i),e.update({progress:i,index:e.index},"progresschanged"),a.courseitems[t]&&"unit"==a.courseitems[t].type?fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${a.courseitems[t].id}/markcomplete?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token,progress:i})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(r=>{r&&(r.status&&(i&&i>=100&&null==n&&de(),document.dispatchEvent(new CustomEvent("course_item_completed",{detail:{course_id:e.course_id,item_id:a.courseitems[t].id,courseStatus:a}}))),fr("vibebp").addNotification({icon:r.icon,text:r.message}),k(a),le(a,W),s())}).catch(e=>{console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}):(a.courseitems[t].status=1,k(a),i&&i>=100&&null==n&&de(),document.dispatchEvent(new CustomEvent("course_item_completed",{detail:{course_id:e.course_id,item_id:a.courseitems[t].id,courseStatus:a}})),k(a),le(a,t),s())}),ze=()=>{if(y.hasOwnProperty("package")&&y.package||qe(),M(!0),R(!0),!y.hasOwnProperty("comments_open")||!y.comments_open)return Ne(!0),!1;P.hasOwnProperty("comment_ID")||fetch(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token,course_id:e.course_id})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{e&&e.comment_ID&&I(e),L(!1)}).catch(e=>{L(!1),console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},Ne=(t=null)=>{if(!t){if(!(P&&P.hasOwnProperty("title")&&P.hasOwnProperty("review")&&P.hasOwnProperty("rating")&&P.title.length>3&&P.review.length>3&&P.rating>=1))return alert(window.wplms_course_data.translations.please_check_review_form),L(!1),!1;L(!0),P.comment_post_ID=e.course_id,P.course_id=e.course_id,P.token=se.token,fetch(window.wplms_course_data.api_url+"/updatecourse/addreview?post",{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(P)}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{if(!t)return alert(window.wplms_course_data.translations.error_review_form),L(!1),!1;if(t.status)L(!1),t.hasOwnProperty("comment_id")&&t.comment_id&&"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`).then(n=>{n&&n.length&&"object"==typeof(n=JSON.parse(n))&&(n.comment_ID=t.comment_id,n.rating=P.rating,n.review=P.review,n.title=P.title,localforage.setItem(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`,JSON.stringify(n)))});else if(t.message)return alert(t.message),L(!1),!1}).catch(e=>{L(!1),console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}L(!0),fetch(window.wplms_course_data.api_url+"/user/finishcourse?post",{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({course_id:e.course_id,token:se.token})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{if(t){if(t.status&&(M(!1),L(!1),t.finished)){if(B(t.finished),t.finished.hasOwnProperty("course_status")){e.update({index:e.index,user_status:t.finished.course_status},"statuschanged");let n={...y};n.course_status=t.finished.course_status,k(n)}t.finished.status&&Se().then(()=>{e.update({progress:100,index:e.index},"progresschanged"),"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`).then(t=>{t&&t.length&&(t=y,localforage.setItem(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`,JSON.stringify(t)))})})}}else fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_finishing_course}),L(!1)}).catch(e=>{L(!1),console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})},Se=()=>{let e=[],t={...y};return t.hasOwnProperty("courseitems")&&t.courseitems&&t.courseitems.length&&t.courseitems.map((n,s)=>{let a=new Promise((function(e){n&&n.hasOwnProperty("status")&&parseInt(n.status)?e():n&&n.hasOwnProperty("id")&&parseInt(n.id)?(t.courseitems[s].status=1,t.courseitems[s].progressbar=100,e()):e()}));e.push(a)}),k(t),Promise.all(e)},Oe=(e,t)=>{if("loadunit"==t&&e.hasOwnProperty("index")&&_e(e.index,null,!0),y.hasOwnProperty("assignment_locking")&&y.assignment_locking&&"completeUnitAssigmnent"==t||"retakeUnitAssigmnent"==t){let n={...y},s=n.courseitems[W];if(parseInt(n.assignment_locking)>1){if("completeUnitAssigmnent"==t&&s.meta.hasOwnProperty("assignments")&&s.meta.assignments.length&&(s.meta.assignments[e.assignmentIndex].status=1),"retakeUnitAssigmnent"==t){let t=y.courseitems[W];t.meta.hasOwnProperty("assignments")&&t.meta.assignments.length&&(t.meta.assignments[e.assignmentIndex].status=0)}let a=0;s.meta.assignments.map((e,t)=>{e.status&&a++});let r=a/s.meta.assignments.length*100;r>=100?qe():1==s.status&&(n.courseitems[W].status=0),r=Math.round(r),me(r),k(n)}}if("mediaended"==t&&qe(),"videosended"==t){let t={...y};if(t.courseitems[W]&&t.courseitems[W].hasOwnProperty("meta")&&t.courseitems[W].meta.hasOwnProperty("video")&&t.courseitems[W].meta.video.length){t.courseitems[W].meta.hasOwnProperty("completion")||(t.courseitems[W].meta.completion=[]),t.courseitems[W].meta.completion[e.index]||(t.courseitems[W].meta.completion[e.index]={url:t.courseitems[W].meta.completion[e.index],status:0}),t.courseitems[W].meta.completion[e.index].status=1;let n=0;t.courseitems[W].meta.completion.map((e,t)=>{e&&e.status&&n++});let s=Math.round(n/t.courseitems[W].meta.video.length*100);t.courseitems[W].hasOwnProperty("progressbar")||(t.courseitems[W].progressbar=0),s>=100?(s=100,qe()):(t.courseitems[W].progressbar=s,k(t))}}},Pe=()=>{if(window.wplms_course_data.hide_complete_course&&y&&y.hasOwnProperty("courseitems")&&y.courseitems&&y.courseitems.length)for(var e=0;e<y.courseitems.length;e++)if(y.courseitems[e].hasOwnProperty("type")&&"section"!=y.courseitems[e].type&&(!y.courseitems[e].hasOwnProperty("status")||!y.courseitems[e].status))return!1;return!0},Ee=(e,t=null)=>"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&navigator.onLine?t?localforage.removeItem(e):localforage.iterate((function(t,n,s){e.length&&n.length&&n.includes(e)&&localforage.removeItem(n)})):new Promise(e=>{e(1)});return mr(wr,null,t?mr(p,null):y?mr(b.Provider,{value:{courseStatus:y,current_unit_key:W,update:(e,t)=>{switch(t){case"loadunit":e.hasOwnProperty("index")&&_e(e.index);break;case"updateprogress":e.hasOwnProperty("progress")&&me(e.progress);break;case"progresscompleted":qe();break;case"directmarkcomplete":e.hasOwnProperty("index")&&(y.hasOwnProperty("assignment_locking")&&y.assignment_locking&&y.courseitems[W].meta.hasOwnProperty("assignments")&&y.courseitems[W].meta.assignments.length?fr("vibebp").addNotification({icon:"vicon-bookmark-alt",text:window.wplms_course_data.translations.complete_unit_assignments}):qe(e.index))}}}},mr("div",{className:"course_status course_id_"+e.course_id+" "+(S?"moveonside":"")},j&&y.hasOwnProperty("instructions")&&y.instructions.length?mr("div",{className:"course_instructions_wrapper",onClick:e=>{document.querySelector(".course_instructions_wrapper")&&e.target===document.querySelector(".course_instructions_wrapper")&&(e.preventDefault(),A(!1))}},mr("div",{className:"course_instructions"},mr("div",{className:"close",onClick:()=>{A(!1)}},mr("span",{className:"vicon vicon-close"})),mr("h1",null,window.wplms_course_data.translations.course_instructions),mr("div",{dangerouslySetInnerHTML:{__html:y.instructions}}))):"",F?mr("div",{className:"reviewpopup_wrapper"},mr("div",{className:"reviewpopup_content"},mr("div",{className:"finish-course-content"},F.hasOwnProperty("percentage")?mr("span",{className:"finished_percentage",ref:xe},mr("span",null,mr("span",null,mr("strong",null,F.percentage),mr("span",null,"%")),mr("span",null,F.title))):"",F.awards?mr("div",{className:"awards"},Object.keys(F.awards).map(e=>"badge"==e?mr("div",{className:"badge"},mr("img",{src:F.awards[e].url}),mr("span",null,F.awards[e].title)):"certificate"==e?mr("div",{className:"certificate"},mr("a",{href:F.awards[e].url,target:"_blank"},mr("svg",{xmlns:"http://www.w3.org/2000/svg",width:"160",height:"160",viewBox:"0 0 24 24"},mr("path",{d:"M14.969 9.547l.031.191c0 .193-.096.379-.264.496-.538.372-.467.278-.67.885-.084.253-.33.424-.605.424h-.002c-.664-.002-.549-.038-1.083.338-.112.08-.244.119-.376.119s-.264-.039-.376-.118c-.534-.376-.419-.34-1.083-.338h-.002c-.275 0-.521-.171-.605-.424-.203-.607-.133-.513-.669-.885-.169-.118-.265-.304-.265-.497l.031-.19c.207-.604.208-.488 0-1.094l-.031-.191c0-.193.096-.379.265-.497.536-.372.465-.277.669-.885.084-.253.33-.424.605-.424h.002c.662.002.544.041 1.083-.338.112-.08.244-.119.376-.119s.264.039.376.118c.534.376.419.34 1.083.338h.002c.275 0 .521.171.605.424.203.607.132.513.67.885.168.118.264.304.264.497l-.031.191c-.207.604-.208.488 0 1.094zm-1.469-1.198l-.465-.464-1.41 1.446-.66-.627-.465.464 1.125 1.091 1.875-1.91zm4.5 4.651h-12v1h12v-1zm-1 2h-10v1h10v-1zm1 2h-12v1h12v-1zm1-15h-19v20h24v-20h-5zm3 15.422c-1.151.504-2.074 1.427-2.578 2.578h-14.844c-.504-1.151-1.427-2.074-2.578-2.578v-10.844c1.151-.504 2.074-1.427 2.578-2.578h14.844c.504 1.151 1.427 2.074 2.578 2.578v10.844z"})),mr("span",null,window.wplms_course_data.translations.achievement_certificate))):"points"==e?mr("div",{className:"points"},mr("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},mr("path",{d:"M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 3c-4.971 0-9 4.029-9 9s4.029 9 9 9 9-4.029 9-9-4.029-9-9-9zm1 13.947v1.053h-1v-.998c-1.035-.018-2.106-.265-3-.727l.455-1.644c.956.371 2.229.765 3.225.54 1.149-.26 1.385-1.442.114-2.011-.931-.434-3.778-.805-3.778-3.243 0-1.363 1.039-2.583 2.984-2.85v-1.067h1v1.018c.725.019 1.535.145 2.442.42l-.362 1.648c-.768-.27-1.616-.515-2.442-.465-1.489.087-1.62 1.376-.581 1.916 1.711.804 3.943 1.401 3.943 3.546.002 1.718-1.344 2.632-3 2.864z"})),mr("span",null,F.awards[e].amount)):void 0)):"",mr("div",{className:"post_completion_message"},mr("div",{className:"completion_message",dangerouslySetInnerHTML:{__html:F.message}}),mr("div",{dangerouslySetInnerHTML:{__html:F.post_message}})),mr("div",{className:"popup-footer"},mr("a",{className:"link",onClick:()=>B(!1)},window.wplms_course_data.translations.cancel),mr("a",{className:"button is-primary",onClick:e.back},window.wplms_course_data.translations.back_to_my_courses,mr("span",{className:"vicon vicon-arrow-right"})))))):"",C?mr("div",{className:"reviewpopup_wrapper",onClick:e=>{e.preventDefault(),document.querySelector(".reviewpopup_wrapper")&&e.target===document.querySelector(".reviewpopup_wrapper")&&M(!1)}},mr("div",{className:"reviewpopup_content"},mr("div",{className:"close",onClick:()=>{M(!1)}},mr("span",{className:"vicon vicon-close"})),T?mr(p,null):y.hasOwnProperty("comments_open")&&y.comments_open?mr(wr,null,mr("div",{className:"reviewform"},mr("label",null,window.wplms_course_data.translations.rating),mr(qa,{update:(e,t)=>{if("ratingchanged"==t){let t=0;e&&(t=e.length);let n={...P};n.rating=t,I(n)}},rating:P.rating}),mr("input",{type:"text",onChange:e=>{let t={...P};t.title=e.target.value,I(t)},value:P.title,placeholder:window.wplms_course_data.translations.review_title}),mr("textarea",{onChange:e=>{let t={...P};t.review=e.target.value,I(t)},value:P.review,placeholder:window.wplms_course_data.translations.your_review})),mr("div",{className:"popup-footer"},$?mr(wr,null,mr("a",{href:"#",onClick:()=>{Ne(!0)}},mr("span",{className:"vicon vicon-angle-left"})," ",window.wplms_course_data.translations.skip_review_and_finish_course),mr("a",{href:"#",className:T?"button is-primary is-loading":"button is-primary",onClick:()=>{Ne()}},window.wplms_course_data.translations.submit_review_and_finish_course," ",mr("span",{className:"vicon vicon-arrow-right"}))):mr(wr,null,mr("a",{className:"link",onClick:()=>M(!1)},window.wplms_course_data.translations.cancel),mr("a",{className:"button is-primary",onClick:()=>{P&&P.hasOwnProperty("title")&&P.hasOwnProperty("review")&&P.hasOwnProperty("rating")&&P.title.length>3&&P.review.length>3&&P.rating>=1?(L(!0),P.comment_post_ID=e.course_id,P.course_id=e.course_id,P.token=se.token,fetch(window.wplms_course_data.api_url+"/updatecourse/addreview?post",{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(P)}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{t?t.status?(L(!1),t.hasOwnProperty("comment_id")&&t.comment_id&&"undefined"!=typeof localforage&&window.vibebp.api.sw_enabled&&localforage.getItem(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`).then(n=>{n&&n.length&&"object"==typeof(n=JSON.parse(n))&&(n.comment_ID=t.comment_id,n.rating=P.rating,n.review=P.review,n.title=P.title,localforage.setItem(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`,JSON.stringify(n)))})):t.message&&(alert(t.message),L(!1)):(alert(window.wplms_course_data.translations.error_review_form),L(!1)),M(!1)}).catch(e=>{L(!1),console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})):(alert(window.wplms_course_data.translations.please_check_review_form),L(!1))}},window.wplms_course_data.translations.submit_review," ",mr("span",{className:"vicon vicon-arrow-right"}))))):"")):"",(()=>{let e=0;if(y&&y.courseitems&&y.courseitems.length&&y.courseitems[W]&&"unit"==y.courseitems[W].type&&!y.courseitems[W].status&&y.courseitems[W].hasOwnProperty("meta")&&y.courseitems[W].meta.hasOwnProperty("access")&&y.courseitems[W].meta.access&&(e=1,y.hasOwnProperty("assignment_locking")&&y.assignment_locking&&y.courseitems[W].meta.hasOwnProperty("assignments")&&y.courseitems[W].meta.assignments.length&&(e=0),y.courseitems[W].meta.hasOwnProperty("video")&&(y.courseitems[W].meta.video.hasOwnProperty("url")||Array.isArray(y.courseitems[W].meta.video)&&y.courseitems[W].meta.video.length)&&(e=0),y.courseitems[W].meta.hasOwnProperty("disableprogress")&&y.courseitems[W].meta.disableprogress&&(e=0)),y&&y.hasOwnProperty("disablescrollprogress")&&y.disablescrollprogress&&(e=0),e)return mr(wa,null)})(),y.package?u?mr(p,null):mr("div",{className:"course_package_wrapper"},mr("div",{className:"course_package_header"},mr("div",{className:"vicon vicon-arrow-left",onClick:()=>{e.back(d)}}),d||t?"":mr("div",{className:"finish_course button is-primary small",onClick:()=>{ze()}},window.wplms_course_data.translations.complete)),mr("div",{className:"course_package"},mr("div",{dangerouslySetInnerHTML:{__html:y.package}}))):mr(wr,null,mr("div",{className:z?"course_timeline expand "+(r?"comments_shown":""):"course_timeline "+(r?"comments_shown":"")},mr("div",{className:"course_action_points"},mr("div",{className:"action_points"},mr("a",{className:"vicon vicon-arrow-left",onClick:e.back,title:window.wplms_course_data.translations.back}),!s&&!Is(y)&&y.hasOwnProperty("courseitems")&&y.courseitems.length?mr(wr,null,mr("a",{className:"vicon vicon-search",onClick:()=>{g(!0)},title:window.wplms_course_data.translations.search_unit}),y.courseitems[W].hasOwnProperty("meta")&&y.courseitems[W].meta.hasOwnProperty("access")&&y.courseitems[W].meta.access?mr(wr,null,mr("a",{className:"vicon vicon-comments",onClick:()=>{i(!r)},title:window.wplms_course_data.translations.comments})):""):"",document.querySelector("body").classList.contains("single-course")?"":mr("a",{title:document.querySelector("body").classList.contains("course_status_fullscreen")?window.wplms_course_data.translations.minimise_screen:window.wplms_course_data.translations.maximise_screen,className:"vicon vicon-fullscreen",onClick:()=>{document.querySelector("body").classList.contains("course_status_fullscreen")?document.querySelector("body").classList.remove("course_status_fullscreen"):document.querySelector("body").classList.add("course_status_fullscreen");var t=new CustomEvent("course_status_fullscreen_toggle",{detail:{coursestatus:y,course_id:e.course_id}});document.dispatchEvent(t)}})),w?mr("div",{className:"search-course "+(w?"active":"")},mr("input",{type:"text",placeholder:window.wplms_course_data.translations.search_course_elements,onChange:e=>{h(e.target.value)},value:_}),mr("span",null,y.filtered_items&&_.length>3?y.filtered_items.length+" "+window.wplms_course_data.translations.results_found:""),mr("span",{onClick:()=>{g(!1),h("")},className:"vicon vicon-close"})):""),y&&y.courseitems&&y.courseitems[W]&&"unit"==y.courseitems[W].type&&r?mr(oa,{unit_id:y.courseitems[W].id,course_id:e.course_id,back:()=>{i(!1)},expand:()=>N(!z)}):"",e.hasOwnProperty("course")?mr("div",{className:"course_heading",ref:l},mr("h2",{dangerouslySetInnerHTML:{__html:f.name}}),mr("div",{class:"course_progress_wrapper"},mr("div",{className:"course_progress"},mr("span",{style:{width:f.user_progress+"%"}})),mr("span",null,f.user_progress,"%"))):"",u?mr(p,null):mr(E,{courseHeadingRef:l})),mr("div",{className:"course_content",ref:o},mr("div",{className:"course_content_header"},mr("span",{className:"toggle_timeline_wrapper",onClick:()=>{O(!S)}},mr("span",{className:S?window.innerWidth<480?"vicon vicon-angle-double-down":"vicon vicon-angle-double-right":window.innerWidth<480?"vicon vicon-angle-double-up":"vicon vicon-angle-double-left"}),mr("span",null,S?window.wplms_course_data.translations.show_panel:window.wplms_course_data.translations.hide_panel),mr("span",{dangerouslySetInnerHTML:{__html:window.wplms_course_data.translations.drag_to_refresh}})),mr("div",{className:"right_block"},y.hasOwnProperty("comments_open")?mr("span",{className:"review_block",onClick:()=>(M(!0),void(P.hasOwnProperty("comment_ID")||fetch(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({token:se.token,course_id:e.course_id})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{e&&e.comment_ID&&I(e),L(!1)}).catch(e=>{L(!1),console.error("Uh oh, an error!",e),fr("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})))},mr("span",{className:"vicon vicon-star"}),mr("span",null,window.wplms_course_data.translations.leave_rating)):"",y&&y.courseitems&&y.courseitems.length?mr("div",{className:"unit_prevnext"},mr("div",{className:"unit_prev navigate_unit",onClick:()=>{ve("prev")}},x.prev?mr(wr,null,mr("span",{className:"vicon vicon-arrow-left"}),mr("span",null,window.wplms_course_data.translations.previous_unit)):""),mr("div",{className:"unit_next navigate_unit",onClick:()=>{ve("next")}},x.next?mr(wr,null,mr("span",null,window.wplms_course_data.translations.next_unit),mr("span",{className:"vicon vicon-arrow-right"})):"")):"")),s||u?mr(p,null):y&&y.courseitems&&y.courseitems.length?(()=>{let t=0,n=0;y.courseitems.map((e,s)=>{e.id&&t++,s<=W&&e.id&&n++});let s="next_curriculum_item unlocked";switch(y.hasOwnProperty("lock")&&y.lock&&!y.courseitems[W].status&&(s="next_curriculum_item locked"),y.courseitems[W].type){case"quiz":return mr("div",{className:"course_content_content_wrapper"},mr("div",{className:"course_content_content"},mr("span",{className:"lesson_info"},mr("span",null,window.wplms_course_data.reports.module.quiz," ",n+"/"+t),mr(X,{timestamp:y.courseitems[W].duration,notimediff:1})),mr("h2",{dangerouslySetInnerHTML:{__html:y.courseitems[W].title}}),y.courseitems[W].hasOwnProperty("quiz_type")?mr("div",null,(()=>{var t={coursestatus:y,type:y.courseitems[W].quiz_type,id:y.courseitems[W].id,course_id:e.course_id};y.courseitems[W].hasOwnProperty("content_id")&&(t.content_id=y.courseitems[W].content_id);var n=new CustomEvent("custom_quiz_type",{detail:t});return document.dispatchEvent(n),mr("div",{id:y.courseitems[W].quiz_type,quizid:y.courseitems[W].id})})()):mr(ts,{quizid:y.courseitems[W].id,update:be,course:e.course_id})),W+1<y.courseitems.length?mr("div",{className:s,onClick:()=>{ve("next")}},y.courseitems[W+1].icon?y.courseitems[W+1].icon.length>200?mr("span",null,mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].icon}}),mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].title}})):mr("span",null,mr("span",{className:y.courseitems[W+1].icon}),mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].title}})):mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].title}})):y.hasOwnProperty("course_status")&&parseInt(y.course_status)<3&&Pe()?mr("div",{className:"finish_course"},mr("a",{className:"button is-primary is-fullwidth",onClick:()=>{ze()}},mr("span",{className:"vicon vicon-check-box",style:{margin:"0 1rem"}}),window.wplms_course_data.translations.complete_course)):"");case"wplms-assignment":return mr("div",{className:"course_content_content_wrapper"},mr("div",{className:"course_content_content"},mr("span",{className:"lesson_info"},mr("span",null,window.wplms_course_data.reports.module.assignment," ",n+"/"+t),mr(X,{timestamp:y.courseitems[W].duration,notimediff:1})),mr("h2",{dangerouslySetInnerHTML:{__html:y.courseitems[W].title}}),mr(Fs,{assignment:y.courseitems[W].meta,update:ke,course:e.course_id})),W+1<y.courseitems.length?mr("div",{className:s,onClick:()=>{ve("next")}},mr("span",null,mr("span",{className:y.courseitems[W+1].icon?y.courseitems[W+1].icon:""}),mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].title}}))):y.hasOwnProperty("course_status")&&parseInt(y.course_status)<3&&Pe()?mr("div",{className:"finish_course"},mr("a",{className:"button is-primary is-fullwidth",onClick:()=>{ze()}},mr("span",{className:"vicon vicon-check-box",style:{margin:"0 1rem"}}),window.wplms_course_data.translations.complete_course)):"");case"unit":default:return mr("div",{className:"course_content_content_wrapper"},y.courseitems[W].hasOwnProperty("custom_unit_type")?mr("div",null,(()=>{var t={coursestatus:y,type:y.courseitems[W].custom_unit_type,id:y.courseitems[W].id,course_id:e.course_id};y.courseitems[W].hasOwnProperty("content_id")&&(t.content_id=y.courseitems[W].content_id);var n=new CustomEvent("custom_unit_type",{detail:t});return document.dispatchEvent(n),mr("div",{id:y.courseitems[W].unit_type,quizid:y.courseitems[W].id})})()):mr(ir,{curriculumItem:y.courseitems[W],update:Oe,index:W,item_number:n,total_item_count:t}),W+1<y.courseitems.length?mr("div",{className:s,onClick:()=>{ve("next");let e=0;y&&y.courseitems&&y.courseitems.length&&y.courseitems[W]&&"unit"==y.courseitems[W].type&&!y.courseitems[W].status&&y.courseitems[W].hasOwnProperty("meta")&&y.courseitems[W].meta.hasOwnProperty("access")&&y.courseitems[W].meta.access&&(e=1,y.hasOwnProperty("assignment_locking")&&y.assignment_locking&&y.courseitems[W].meta.hasOwnProperty("assignments")&&y.courseitems[W].meta.assignments.length&&(e=0),y.unit_media_lock&&(y.courseitems[W].meta.hasOwnProperty("video")&&Array.isArray(y.courseitems[W].meta.video)&&y.courseitems[W].meta.video.length||"video"==y.courseitems[W].unit_type)&&(e=0),"unit"!==y.courseitems[W].type&&(e=0),y.courseitems[W]&&y.courseitems[W].hasOwnProperty("meta")&&y.courseitems[W].meta.hasOwnProperty("disableprogress")&&y.courseitems[W].meta.disableprogress&&(e=0)),e&&qe(W)}},y.courseitems[W+1].icon?y.courseitems[W+1].icon.length>200?mr("span",null,mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].icon}}),mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].title}})):mr("span",null,mr("span",{className:y.courseitems[W+1].icon}),mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].title}})):mr("span",{dangerouslySetInnerHTML:{__html:y.courseitems[W+1].title}})):y.hasOwnProperty("course_status")&&parseInt(y.course_status)<3&&Pe()?mr("div",{className:"finish_course"},mr("a",{className:"button is-primary is-fullwidth",onClick:()=>{ze()}},mr("span",{className:"vicon vicon-check-box",style:{margin:"0 1rem"}}),window.wplms_course_data.translations.complete_course)):"")}})():"",te?mr("span",{className:"vibebp_content_show_fireworks finished_percentage",ref:xe}):"")))):"")};n(20);const{createElement:br,render:kr,useState:xr,useEffect:qr,Fragment:zr}=wp.element,{select:Nr,dispatch:Sr}=wp.data,Or=e=>{Nr("vibebp").getUser();const t=Nr("vibebp").getToken(),[n,s]=xr(!0),[a,r]=xr(window.wplms_course_data.translations.take_this_course),[i,o]=xr(""),[l,u]=xr({}),[c,d]=xr(-1),[m,p]=xr(""),[_,h]=xr([]),[w,g]=xr(!1),[f,v]=xr(!1),[y,b]=xr({}),[k,x]=xr(!1),[q,z]=xr(!1),[N,S]=xr(!1),[O,P]=xr(!1);qr(()=>{document.addEventListener("wplms_popup_applied",t=>{t.detail.course==e.id&&t.detail.hasOwnProperty("text")&&(v(!1),o("#"),r(t.detail.text))},!1),document.addEventListener("reload_course_button",t=>{t.detail.course==e.id&&E()},!1)}),qr(()=>{E()},[e]),qr(()=>{if(N){var t=new CustomEvent("wplms_popup_clicked",{detail:{course:e.id}});document.dispatchEvent(t),S(!1)}},[N]);const E=()=>{s(!0),x(!1),fetch(`${window.wplms_course_data.api_url}/student/courseButton/?course=${e.id}&force`,{method:"post",body:JSON.stringify({id:e.id,token:t,price:window.wplms_course_data.show_price})}).then(e=>e.json()).then(e=>{e.status&&(e.text.length&&("#apply"==e.link&&v(!0),r(e.text),e.hasOwnProperty("error")?b(e.error):(o(e.link),u(e.course),d(e.course_status),e.hasOwnProperty("form")&&p(e.form)),h(e.extras)),e.hasOwnProperty("hide_button")&&e.hide_button&&x(!0),e.hasOwnProperty("is_free")&&e.is_free&&P(!0)),s(!1)})},I=(t,n)=>{var s=new CustomEvent("coursebuttonpricingclicked",{detail:{original_event:t,course:e.id,price:n}});document.dispatchEvent(s)};return k?"":w?br(zr,null,br("div",{class:"lds-ellipsis"},br("div",null),br("div",null),br("div",null),br("div",null)),ReactDOM.createPortal(br(yr,{course_id:l.id,course:l,back:()=>{g(!1)},index:1,update:()=>{}}),document.querySelector("#wplms_the_course_button"))):n?br("span",{className:"course_button button full is-loading"},"..."):br(zr,null,f?br("span",{className:"the_course_button"},br("a",{href:i,className:"course_button button full",onClick:e=>{e.preventDefault(),S(!0)}},br("span",{dangerouslySetInnerHTML:{__html:a}}),_.length?br("div",{className:"extra_details"},_.map(e=>br("span",null,e))):"")):m.length?br("div",{className:" the_course_button"},br("form",{action:m,className:"",method:"post"},br("input",{type:"hidden",name:"token",value:t}),br("input",{type:"hidden",name:"course_id",value:e.id}),br("button",{type:"submit",className:"button full course_button"},br("span",{dangerouslySetInnerHTML:{__html:a}}),_.length?_.map(e=>br("span",null,e)):""))):br(zr,null,br("span",{className:"the_course_button"},i&&i.length?c>-1?br("span",null,br("a",{onClick:()=>{g(!0)},className:"course_button button full"},a)):Array.isArray(i)?br("strong",{className:"course_button button full"},br("a",{href:i[0].link,onClick:e=>{I(e,i[0])}},br("strong",null,a&&a.length?a:window.wplms_course_data.translations.take_this_course),br("span",{dangerouslySetInnerHTML:{__html:i[0].price}})),i.length>1?br(zr,null,br("input",{id:"course_price",type:"checkbox"}),br("label",{for:"course_price",class:"vicon vicon-angle-down"}),br("div",{className:"wplms_price_dropdown"},i.map(e=>br("a",{href:e.link,dangerouslySetInnerHTML:{__html:e.price},onClick:t=>{I(t,e)}})))):"",_.length?br("div",{className:"extra_details"},_.map(e=>br("span",{dangerouslySetInnerHTML:{__html:e}}))):""):br("a",{href:i,className:"course_button button full",onClick:e=>{I(e,i)}},a&&a.length?a:window.wplms_course_data.translations.take_this_course,_.length?br("div",{className:"extra_details"},_.map(e=>br("span",{dangerouslySetInnerHTML:{__html:e}}))):""):br("a",c<0&&O?{href:i,className:"course_button button full",onClick:n=>{n.preventDefault(),s(!0),fetch(window.wplms_course_data.api_url+"/user/subscribe?post",{method:"post",body:JSON.stringify({course_id:e.id,token:t})}).then(e=>e.json()).then(e=>{e.status&&E(),s(!1)})}}:{href:i,className:"course_button button full",onClick:e=>{I(e,i)}},br("strong",null,a&&a.length?a:window.wplms_course_data.translations.take_this_course),_.length?br("div",{className:"extra_details"},_.map(e=>br("span",null,e))):"")),y&&y.hasOwnProperty("error_message")?br("div",{className:"vbp_message error"},br("span",{className:"vicon "+y.icon,style:{margin:"0 0.2rem"}}),br("span",{dangerouslySetInnerHTML:{__html:y.error_message}})):""))},Pr=()=>{document.querySelectorAll(".the_course_button").forEach(e=>{kr(br(Or,{id:e.getAttribute("data-id"),def:e.innerHTML}),e)}),document.removeEventListener("userLoaded",Pr,!1)};document.addEventListener("userLoaded",Pr,!1),document.addEventListener("wplms_popup_clicked",e=>{null!==document.getElementById("wplms_popup")&&document.getElementById("wplms_popup").remove();let t=document.createElement("div");t.setAttribute("id","wplms_popup"),document.body.appendChild(t),kr(br(c,{id:e.detail.course}),document.getElementById("wplms_popup"))},!1)}]);