!function(e){var t={};function s(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t){const{createElement:s,render:n,useState:a,useEffect:o,Fragment:r}=wp.element,{select:i,dispatch:l}=wp.data,d=e=>{const t=window.contact_users,[n,r]=a(!0),[d,u]=a({friends_active:!1,user_can_edit_post:!1,disable_instructor_display:!0}),[c,_]=a([]),[p,m]=a([]),[g,f]=a([]),[h,b]=a({subject:"",message:""});o(()=>{fetch(`${t.api}/check?user_id=${e.settings.user_id}&force`,{method:"post",body:JSON.stringify({user_id:e.settings.user_id,token:i("vibebp").getToken()})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(t=>{t.status&&u(t.data),r(!1),document.dispatchEvent(new CustomEvent("vibebp_widget_loaded",{detail:{props:e}}))}).catch(t=>{r(!1),document.dispatchEvent(new CustomEvent("vibebp_widget_loaded",{detail:{props:e}})),l("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}),e.settings.hasOwnProperty("show_instructors_only")&&e.settings.show_instructors_only&&v("get_instructors")},[]);const v=s=>{let n="";n="object"==typeof s?s.target.value:s,_([]),m([]),n&&fetch(t.api+"/users?force",{method:"post",body:JSON.stringify({type:n,user_id:e.settings.user_id,token:i("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&_(e.data)})};return s("div",{className:"contact_user"},n?s("div",null,s("div",{className:"widget_loader"},s("div",null),s("div",null),s("div",null),s("div",null))):s("div",{className:"dash-content-form"},s("h3",{class:"widget_title"},e.settings.title),e.settings.hasOwnProperty("show_instructors_only")&&e.settings.show_instructors_only?s("h4",{style:{margin:"1rem 0"}},window.contact_users.translations.select_instructor):s("select",{className:"usergroup-dropdown chosen","data-placeholder":t.translations.select_user_groups,onChange:v},";",s("option",{value:""},t.translations.select_a_user_groups),d.friends_active?s("option",{value:"get_friends"},t.translations.friends):"",d.disable_instructor_display?"":s("option",{value:"get_instructors"},t.translations.instructor),s("option",{value:"get_admins"},t.translations.administrator),d.user_can_edit_post?s("option",{value:"get_course_students"},t.translations.course_students):""),g&&g.length?s("div",{className:"contact_users"},g.map((e,t)=>s("span",{onClick:()=>{(e=>{let t=g.findIndex(t=>t.id==e.id);if(t>-1){let e=[...g];e.splice(t,1),f(e)}})(e)}},s("span",null,e.name),s("span",null,"❌")))):"",s("input",{type:"text",name:"to",className:"input-text to usergroup-filter",placeholder:t.translations.type_name_to_autocomplete,onChange:e=>{let t=e.target.value;if(t&&t.length>2){let e=[...c].filter(e=>e.name.toLowerCase().split(t.toLowerCase()).length>1);m(e)}else m([])}}),s("input",{type:"text",name:"subject",className:"input-text subject",placeholder:t.translations.enter_subject,onChange:e=>b({...h,subject:e.target.value})}),s("textarea",{name:"message",className:"form_message",placeholder:t.translations.enter_message,onChange:e=>b({...h,message:e.target.value})}),g.length?s("a",{id:"dash_contact_form_submit",className:"button",onClick:s=>{let n=g.map(e=>e.id);fetch(t.api+"/send_message?post",{method:"post",body:JSON.stringify({member_ids:n,user_id:e.settings.user_id,subject:h.subject,message:h.message,token:i("vibebp").getToken()})}).then(e=>e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}).then(e=>{if(e.message){let s=document.querySelector("#dash_contact_form_submit");s.textContent=e.message,setTimeout((function(){s.textContent=t.translations.send_message}),2e3)}}).catch(e=>{console.error("Uh oh, an error!",e),l("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})})}},t.translations.send_message):"",p&&p.length?s("div",{className:"contact_users"},p.map((e,t)=>s("div",{className:"logo",onClick:()=>(e=>{-1==g.findIndex(t=>t.id==e.id)&&f([...g,e])})(e)},s("h3",{dangerouslySetInnerHTML:{__html:e.pic}}),s("span",null,e.name)))):""))};document.addEventListener("wplms_dash_contact_users",e=>{document.querySelector(".wplms_dash_contact_users")&&n(s(d,{settings:e.detail.widget.options}),document.querySelector(".wplms_dash_contact_users"))})}]);