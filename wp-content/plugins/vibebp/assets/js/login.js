!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=wp.data,a=r.dispatch,i=r.select,o=function(e){return new Promise((function(t){if(window.vibebp.settings.hasOwnProperty("firebase_config")&&window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&firebase.database&&window.vibebp.settings.session_lock){var n=firebase.database().ref("users");n||t(),n.orderByChild("firebaseUid").equalTo(e).once("value",(function(r){if(r.exists()){var o=r.val();for(var l in o)o[l].hasOwnProperty("status")&&("loggedin_logout_all"==window.vibebp.settings.session_lock?function(){var r=i("vibebp").getData("loggedInNumber");r||(r=o[l].hasOwnProperty("loggedInNumber")?o[l].loggedInNumber+1:1,a("vibebp").setData("loggedInNumber",r),localforage.setItem("loggedInNumber",r)),firebase.database().ref("users/".concat(l,"/loggedInNumber")).set(r),firebase.database().ref("users/".concat(l,"/status")).onDisconnect().set(0),n.orderByChild("firebaseUid").equalTo(e).on("value",(function(e){if(e.exists()){var t=e.val();for(var n in t)t[n].hasOwnProperty("loggedInNumber")&&t[n].loggedInNumber&&t[n].loggedInNumber!==r&&document.dispatchEvent(new Event("vibebp_logout"))}})),t()}():o[l].hasOwnProperty("status")&&o[l].status&&t(window.vibebp.translations.online_from_other_account));t()}else t()})).catch((function(){t()}))}else t()}))};function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=wp.element,p=(u.createElement,u.useState),d=u.useEffect,m=u.Fragment,f=(u.render,wp.data),b=f.dispatch,v=(f.select,function(e){var t=s(p({}),2),n=t[0],r=t[1],a=s(p(null),2),i=a[0],c=a[1],u=s(p(!1),2),f=u[0],v=u[1],w=s(p(!1),2),g=w[0],y=w[1];d((function(){window.vibebp.settings.firebase_config&&"object"==("undefined"==typeof firebase?"undefined":l(firebase))&&0===firebase.apps.length&&firebase.initializeApp(JSON.parse(window.vibebp.settings.firebase_config))}),[]),d((function(){e.childProviderId!==g&&y(e.childProviderId)}),[e.childProviderId]),d((function(){if(window.vibebp.settings.firebase_config){var e={};Object.keys(window.vibebp.settings.auth).map((function(t){window.vibebp.settings.auth[t]&&("google"===t&&(e.google=new firebase.auth.GoogleAuthProvider,e.google.addScope("profile"),e.google.addScope("email")),"twitter"===t&&(e.twitter=new firebase.auth.TwitterAuthProvider),"github"===t&&(e.github=new firebase.auth.GithubAuthProvider),"apple"===t&&(e.apple=new firebase.auth.OAuthProvider("apple.com"),e.apple.addScope("email"),e.apple.addScope("name")),"facebook"===t&&(e.facebook=new firebase.auth.FacebookAuthProvider),"microsoft"===t&&(e.microsoft=new firebase.auth.OAuthProvider("microsoft.com")))})),r(e)}}),[]);var h=function(t,n){return fetch("".concat(window.vibebp.api.url,"/sociallogin?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:JSON.stringify({social:t.credential.signInMethod,client_id:window.vibebp.settings.client_id,user:{email:t.user.email,uid:t.user.uid,name:t.user.displayName,avatar:t.user.photoURL,phoneNumber:t.user.phoneNumber,last_login:t.user.metadata.lastSignInTime,create_time:t.user.metadata.creationTime},idToken:n})}).then((function(e){return e.json()})).then((function(n){if(n.status)return localforage.setItem("bp_login_token",n.token),fetch("".concat(window.vibebp.api.validate_token,"?force&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:n.token}).then((function(e){return e.json()})).then((function(r){if(r.hasOwnProperty("data")){if("undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&window.vibebp.settings.firebase_config&&firebase.database().ref("users/".concat(r.data.data.user.id,"/firebaseUid")).set(t.user.uid),localforage.setItem("bp_user",JSON.stringify(r.data.data.user)),sessionStorage.setItem("bp_user",JSON.stringify(r.data.data.user)),e.setUser(r.data.data.user),b("vibebp").setToken(n.token),console.log("#1"),b("vibebp").setUser(r.data.data.user),document.querySelector("body").classList.add("vibebp-logged-in"),window.vibebp.settings.login_redirect&&r.hasOwnProperty("redirect_component")&&r.redirect_component){var a="";a=r.redirect_component.split("http").length>1?r.redirect_component:r.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+r.data.data.user.slug+r.redirect_component:window.vibebp.settings.login_redirect+r.data.data.user.slug+"#"+r.redirect_component,window.location.href=a}var i=sessionStorage.getItem("loggedinmenu");return i?b("vibebp").setData("loggedinMenu",JSON.parse(i)):fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:n.token})}).then((function(e){return e.json()})).then((function(e){e.status&&(sessionStorage.setItem("loggedinmenu",JSON.stringify(e.menu)),b("vibebp").setData("loggedinMenu",e.menu))})),r.data.data.user}document.dispatchEvent(new Event("vibebp_logout"))}))}))};if(!f&&n&&Object.keys(n).length&&g){var _=!1;Object.keys(n).map((function(e,t){g===n[e].providerId&&(_=e)})),_&&v(_)}return wp.element.createElement(m,null,window.vibebp.settings.email_login?"":wp.element.createElement(m,null,wp.element.createElement("h2",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_heading}}),wp.element.createElement("p",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_message}})),i?wp.element.createElement("div",{className:"vbp_message error",dangerouslySetInnerHTML:{__html:i}}):"",window.vibebp.settings.firebase_config?Object.keys(window.vibebp.settings.auth).map((function(e){if(window.vibebp.settings.auth[e])return wp.element.createElement("a",{className:f==e?"button is-primary is-loading":"button is-primary",onClick:function(){return function(e){console.log("##0"),window.vibebp.settings.firebase_config&&n&&n[e]?(v(e),c(null),window.innerWidth<1024?firebase.auth().signInWithRedirect(n[e]).then((function(e){var t=e.user;o(t.user.uid).then((function(n){n&&n.length?c(n):(b("vibebp").setData("firebaseUser",t),t.getIdToken().then((function(t){h(e,t).then((function(e){b("vibebp").setUser(e)}))})))}))})).catch((function(e){console.log(e),"auth/account-exists-with-different-credential"===e.code&&(console.log("account exists in different login credentials"),firebase.auth().fetchSignInMethodsForEmail(e.email).then((function(t){if(v(!1),Array.isArray(t)){if(t.indexOf("google.com")>-1)(n=new firebase.auth.GoogleAuthProvider).addScope("profile"),n.addScope("email");else if(t.indexOf("facebook.com")>-1)var n=new firebase.auth.FacebookAuthProvider;else if(t.indexOf("twitter.com")>-1)n=new firebase.auth.TwitterAuthProvider;else if(t.indexOf("github.com")>-1)n=new firebase.auth.GithubAuthProvider;else if(t.indexOf("microsoft")>-1)n=new firebase.auth.OAuthProvider("microsoft.com");n.setCustomParameters({login_hint:e.email}),firebase.auth().signInWithRedirect(n).then((function(e){var t=e.user;o(t.uid).then((function(n){n&&n.length?c(n):t.getIdToken().then((function(t){h(e,t).then((function(e){b("vibebp").setUser(e)}))}))}))})).catch((function(e){console.log(e)}))}})))})):firebase.auth().signInWithPopup(n[e]).then((function(e){var t=e.user;o(t.uid).then((function(n){n&&n.length?c(n):(b("vibebp").setData("firebaseUser",t),t.getIdToken().then((function(t){h(e,t).then((function(e){b("vibebp").setUser(e)}))})))}))})).catch((function(e){console.log(e),"auth/account-exists-with-different-credential"===e.code&&(console.log("account exists in different login credentials"),firebase.auth().fetchSignInMethodsForEmail(e.email).then((function(t){if(v(!1),Array.isArray(t)){if(t.indexOf("google.com")>-1)(n=new firebase.auth.GoogleAuthProvider).addScope("profile"),n.addScope("email");else if(t.indexOf("facebook.com")>-1)var n=new firebase.auth.FacebookAuthProvider;else if(t.indexOf("twitter.com")>-1)n=new firebase.auth.TwitterAuthProvider;else if(t.indexOf("github.com")>-1)n=new firebase.auth.GithubAuthProvider;n.setCustomParameters({login_hint:e.email}),firebase.auth().signInWithPopup(n).then((function(e){var t=e.user;o(t.uid).then((function(n){n&&n.length?c(n):t.getIdToken().then((function(t){h(e,t).then((function(e){b("vibebp").setUser(e)}))}))}))})).catch((function(e){console.log(e)}))}})))}))):document.dispatchEvent(new CustomEvent("login_with_"+e,{detail:{key:e}}))}(e)}},window.vibebp.settings.icons&&window.vibebp.settings.icons[e]?wp.element.createElement("span",{className:"vicon",dangerouslySetInnerHTML:{__html:window.vibebp.settings.icons[e]}}):wp.element.createElement("span",{className:"icon vicon vicon-"+e}),wp.element.createElement("span",null,window.vibebp.translations[e]))})):"",window.vibebp.settings.email_login?"":wp.element.createElement("a",{className:"button is-primary",onClick:function(){return e.setemailSignIn(!0)}},wp.element.createElement("span",{className:"icon vicon vicon-email"}),wp.element.createElement("span",null,window.vibebp.translations.email_login)),wp.element.createElement("div",{className:"extra_details"},window.vibebp.settings.enable_registrations?isNaN(window.vibebp.settings.enable_registrations)?wp.element.createElement("p",null,window.vibebp.translations.no_account,wp.element.createElement("a",{className:"vibebp_forward_link",href:window.vibebp.settings.enable_registrations},window.vibebp.translations.create_one," ",wp.element.createElement("span",{className:"vicon vicon-arrow-right"}))):wp.element.createElement("p",null,window.vibebp.translations.no_account,wp.element.createElement("a",{className:"vibebp_forward_link",onClick:function(){return e.setRegistration(!0)}},window.vibebp.translations.create_one," ",wp.element.createElement("span",{className:"vicon vicon-arrow-right"}))):"",wp.element.createElement("p",null,window.vibebp.translations.login_terms)))});function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=wp.data,_=(h.dispatch,h.select),E={setUser:function(e){return document.dispatchEvent(new CustomEvent("userLoaded",{detail:{userLoaded:e}})),{type:"SET_USER",user:e}},addNotification:function(e){return{type:"ADD_NOTIFICATION",notification:g(g({},e),{},{id:(new Date).getTime()})}},removeNotification:function(e){return{type:"REMOVE_NOTIFICATION",notification:e}},updateNotification:function(e){return{type:"UPDATE_NOTIFICATION",notification:e}},getUser:function(){return{type:"GET_USER"}},verifyUser:function(e,t){return{type:"VERIFY_USER_API",path:e,token:t}},setToken:function(e){return{type:"SET_TOKEN",token:e}},logout:function(){fetch("".concat(window.vibebp.api.remove_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify({token:_("vibebp").getToken()})});var e=new CustomEvent("userLoaded",{detail:{userLoaded:!0,loggedOut:!0}});return document.dispatchEvent(e),localforage.removeItem("loggedInNumber"),sessionStorage.removeItem("bp_user"),window.vibebp.settings.firebase_config&&firebase.auth().signOut(),localforage.removeItem("bp_login_token").then((function(){document.querySelector("body").classList.add("vibebp_logout"),window.location.href=window.vibebp.settings.logout_redirect+"?vibebp_logout=1"})),{type:"LOGOUT"}},setMenu:function(e){return{type:"SET_MENU",menu:e}},setOnlineMembers:function(e){return{type:"SET_ONLINE_MEMBERS",onlineMembers:e}},setData:function(e,t){return{type:"SET_DATA",data_type:e,data:t}},setComponent:function(e){var t=window.location.href.split("#")[0]+"#",n=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,t,r){n[t]=r})),""),a="",i="";return Object.keys(n).map((function(e){"component"!==e&&(r+="&"+e+"="+n[e]),"action"==e&&(a=n[e]),"id"==e&&(i=n[e])})),t+="component="+e,r.length&&(t+=r),window.location.href=t,localforage.removeItem("last_request"),document.querySelector("body").classList.forEach((function(e,t){e.indexOf("vibebp-component")>-1&&document.querySelector("body").classList.remove(e)})),document.querySelector("body").classList.add("vibebp-component-"+e),{type:"SET_COMPONENT",component:e,action:a,id:i}},setAction:function(e){var t=window.location.href.split("#")[0]+"#",n=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,t,r){n[t]=r})),""),a="",i="";return Object.keys(n).map((function(e){"component"!==e&&"action"!==e&&(r+="&"+e+"="+n[e]),"component"==e&&(i=n[e]),"id"==e&&(a=n[e])})),i&&(t+="component="+i,e&&(t+="&action="+e,a&&(t+="&id="+a))),r.length&&(t+=r),window.location.href=t,{type:"SET_ACTION",action:e}},setId:function(e){var t=window.location.href.split("#")[0]+"#",n=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,t,r){n[t]=r})),""),a="",i="";return Object.keys(n).map((function(e){"component"!==e&&"action"!==e&&"id"!=e&&(r+="&"+e+"="+n[e]),"action"==e&&(i=n[e]),"component"==e&&(a=n[e])})),a&&(t+="component="+a,i&&(t+="&action="+i,e&&(t+="&id="+e))),r.length&&(t+=r),window.location.href=t,{type:"SET_ID",id:e}},sendRealTimeNotification:function(e,t){return{type:"SEND_REALTIME_NOTIFICATION",user_id:e,message:t}},removeRealTimeNotification:function(e,t){return{type:"REMOVE_REALTIME_NOTIFICATION",user_id:e,message:t}},AddStaleRequest:function(e){var t=localforage.createInstance({name:"vibebp_stale_requests"}),n=Math.round((new Date).getTime()/1e3);return t.keys().then((function(r){var a=r.findIndex((function(t){return t.indexOf(e)>-1}));a>-1?t.setItem(r[a],n):t.setItem(e,n)})),{}}};function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=wp.data,x=I.registerStore,A=(I.combineReducers,I.useStore,{user:{},menu:[],notifications:[],component:"",action:""}),T=x("vibebp",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return sessionStorage.setItem("bp_user",JSON.stringify(t.user)),P(P({},e),{},{user:t.user});case"ADD_NOTIFICATION":var n=S(e.notifications),r=[];return n.map((function(e,t){e.id>=(new Date).getTime()-3e3&&r.push(e)})),r.unshift(P({},t.notification)),P(P({},e),{},{notifications:r});case"REMOVE_NOTIFICATION":var a=S(e.notifications);return a.splice(a.findIndex((function(e){return t.notification.id===e.id})),1),P(P({},e),{},{notifications:a});case"UPDATE_NOTIFICATION":var i=S(e.notifications),o=i.findIndex((function(e){return t.notification.id===e.id}));return o>-1&&(i[o]=t.notification),P(P({},e),{},{notifications:i});case"GET_NOTIFICATIONS":return e.notifications;case"GET_USER":return e.user;case"SET_MENU":return P(P({},e),{},{menu:t.menu});case"GET_MENU":return e.menu;case"SET_TOKEN":return P(P({},e),{},{token:t.token});case"SET_COMPONENT":var l=new CustomEvent("component_loaded",{detail:{component:t.component,action:t.action,id:t.id,user:e.user,token:e.token}});return document.dispatchEvent(l),P(P({},e),{},{component:t.component,action:t.action,id:t.id});case"SET_ACTION":return P(P({},e),{},{action:t.action});case"SET_ID":return P(P({},e),{},{id:t.id});case"SET_ONLINE_MEMBERS":return P(P({},e),{},{onlineMembers:t.onlineMembers});case"SET_DATA":var s=P({},e.data);return s[t.data_type]=t.data,P(P({},e),{},{data:s});case"SEND_REALTIME_NOTIFICATION":P({},e.user);return!e.hasOwnProperty("realTimeNotification")||e.realTimeNotification.message!=t.message&&e.realTimeNotification.user_id!=t.user_id?(window.vibebp.settings.firebase_config&&window.vibebp.settings.realtimenotifications,P(P({},e),{},{realTimeNotification:{user_id:t.user_id,message:t.message}})):e}return e},actions:E,selectors:{getUser:function(e){return e.user},verifyUser:function(e,t,n){return e.user},setUser:function(e,t){return e.user=t,t},getNotifications:function(e){return e.notifications},removeNotification:function(e,t){var n=e.notifications;return n.splice(n.findIndex((function(e){return e.id===t})),1),e.notifications=n,n},updateNotification:function(e,t){var n=e.notifications;if("object"===O(t)){var r=n.findIndex((function(e){return e.id===t.id}));r>-1&&(n[r]=t),e.notifications=n}return n},logout:function(e){return e.user},setMenu:function(e,t){return e.menu},getMenu:function(e){return e.menu},getComponent:function(e){return e.component},getAction:function(e){return e.action},getId:function(e){return e.id},getToken:function(e){return e.token},setToken:function(e,t){return e.token=t,t},getOnlineMembers:function(e){return e.onlineMembers},getData:function(e,t){return!(!e.hasOwnProperty("data")||!e.data.hasOwnProperty(t))&&e.data[t]}},controls:{VERIFY_USER_API:function(e){var t=e.path,n=e.token;return fetch(t,{method:"post",body:n}).then((function(e){return e.json()})).then((function(e){return e.hasOwnProperty("data")&&e.status?("undefined"!=typeof firebase&&firebase.hasOwnProperty("auth")&&firebase.auth().onAuthStateChanged((function(e){e&&Object.keys(e).length&&firebase.auth().currentUser&&o(e.uid).then((function(e){e&&e.length&&document.dispatchEvent(new Event("vibebp_logout"))}))})),localforage.setItem("bp_user",JSON.stringify(e.data.data.user)),e.data.data.user.exp=e.data.exp,e.data.data.user):(localforage.removeItem("bp_user"),localforage.removeItem("bp_login_token"),{})}))},LOGOUT:function(e){localforage.removeItem("bp_login_token"),localforage.removeItem("bp_user")}},resolvers:{verifyUser:regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.verifyUser(t,n);case 2:return r=e.sent,e.abrupt("return",E.setUser(r));case 4:case"end":return e.stop()}}),e)})),setToken:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.setToken(t));case 1:case"end":return e.stop()}}),e)})),setUser:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.setUser(t));case 1:case"end":return e.stop()}}),e)})),addNotification:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.addNotification(t));case 1:case"end":return e.stop()}}),e)})),removeNotification:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.removeNotification(t));case 1:case"end":return e.stop()}}),e)})),updateNotification:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.updateNotification(t));case 1:case"end":return e.stop()}}),e)})),logout:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.logout();case 2:return e.sent,e.abrupt("return",E.setUser({}));case 4:case"end":return e.stop()}}),e)})),setMenu:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.setMenu(t));case 1:case"end":return e.stop()}}),e)}))}});function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U=wp.element,M=(U.createElement,U.useState),L=U.useEffect,R=U.Fragment,J=(U.render,wp.data),q=J.select,z=J.dispatch,F=function(e){var t=C(M(""),2),n=t[0],r=t[1],a=C(M(!1),2),i=a[0],l=a[1],s=C(M("input"),2),c=s[0],u=s[1],p=C(M("input"),2),d=(p[0],p[1]),m=C(M(""),2),f=m[0],b=m[1],v=C(M(!1),2),w=v[0],g=v[1],y=C(M(""),2),h=y[0],_=y[1],E=C(M(""),2),O=E[0],S=E[1],N=C(M(""),2),k=(N[0],N[1],C(M(!1),2)),P=k[0],j=k[1],I=C(M(!0),2),x=I[0],A=I[1],T=C(M(!1),2),D=T[0],U=T[1];L((function(){window.vibebp.translations.login_checkbox.length&&A(!1)}),[]);var J=function(){var t=0;n.indexOf("@")>-1&&!n.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i)&&(u("input is-danger"),_(window.vibebp.translations.invalid_email),t++),f.length<4&&(d("input is-danger"),_(window.vibebp.translations.password_too_short),t++),!t&&x&&(l(!0),window.vibebp.settings.hasOwnProperty("firebase_config")&&window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&firebase.database&&window.vibebp.settings.session_lock?fetch("".concat(window.vibebp.api.generate_token,"?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({email:n,password:f})}).then((function(e){return e.json()})).then((function(t){t.status?fetch("".concat(window.vibebp.api.validate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:t.token}).then((function(e){return e.json()})).then((function(n){l(!1),n.hasOwnProperty("data")?firebase.auth().signInWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(r){r.hasOwnProperty("user")||(r.user=r),firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(r.user.uid).then((function(){o(r.user.uid).then((function(a){if(a&&a.length)_(a);else{if(l(!1),localforage.setItem("bp_login_token",t.token),q("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),z("vibebp").setData("firebaseUser",r),n.data.data.user.firebaseUid=r.user.uid,z("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var i="";i=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=i}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&z("vibebp").setData("loggedinMenu",e.menu),z("vibebp").setUser(n.data.data.user)}))}}))})).catch((function(a){console.log(a),o(r.user.uid).then((function(a){if(a&&a.length)_(a);else{if(l(!1),localforage.setItem("bp_login_token",t.token),q("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),z("vibebp").setData("firebaseUser",r),n.data.data.user.firebaseUid=r.user.uid,z("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var i="";i=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=i}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&z("vibebp").setData("loggedinMenu",e.menu),z("vibebp").setUser(n.data.data.user)}))}}))}))})).catch((function(r){if(console.log(r),400==r.status||"auth/user-not-found"==r.code)console.log("create user in firebase"),firebase.auth().createUserWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(r){if(l(!1),localforage.setItem("bp_login_token",t.token),q("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),z("vibebp").setData("firebaseUser",r),r.hasOwnProperty("user")?n.data.data.user.firebaseUid=r.user.uid:r.hasOwnProperty("uid")&&(n.data.data.user.firebaseUid=r.uid),fetch("".concat(window.vibebp.api.url,"/storeFirebaseUID?post&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({user:n.data.data.user,token:t.token})}),z("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var a="";a=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=a}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&z("vibebp").setData("loggedinMenu",e.menu)}))})).catch((function(e){console.log("register",e)}));else{if(l(!1),localforage.setItem("bp_login_token",t.token),q("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),z("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var a="";a=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=a}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&z("vibebp").setData("loggedinMenu",e.menu),z("vibebp").setUser(n.data.data.user)}))}})):document.dispatchEvent(new Event("vibebp_logout"))})):(l(!1),_(t.message))})):fetch("".concat(window.vibebp.api.generate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:JSON.stringify({email:n,password:f})}).then((function(e){return e.json()})).then((function(t){l(!1),t.status?(localforage.setItem("bp_login_token",t.token),q("vibebp").setToken(t.token),fetch("".concat(window.vibebp.api.validate_token,"?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:t.token}).then((function(e){return e.json()})).then((function(n){if(n.hasOwnProperty("data")){if(localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),window.vibebp.settings.firebase_config&&"function"==typeof firebase.database&&!firebase.auth().currentUser?firebase.auth().signInWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(e){z("vibebp").setData("firebaseUser",e);var t=0;e.hasOwnProperty("user")?t=e.user.uid:e.hasOwnProperty("uid")&&(t=e.uid),z("vibebp").setUser(n.data.data.user),firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(t)})).catch((function(e){console.log(e),400==e.code||"auth/user-not-found"==e.code?firebase.auth().createUserWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(e){var r=0;e.hasOwnProperty("user")?(n.data.data.user.firebaseUid=e.user.uid,r=e.user.uid):e.hasOwnProperty("uid")&&(n.data.data.user.firebaseUid=e.uid,r=e.uid),z("vibebp").setData("firebaseUser",e),firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(r),fetch("".concat(window.vibebp.api.url,"/storeFirebaseUID?post&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({user:n.data.data.user,token:t.token})}),z("vibebp").setUser(n.data.data.user)})).catch((function(e){console.log("register",e)})):(400==e.code&&e.code,z("vibebp").setUser(n.data.data.user))})):z("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var r="";r=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=r}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&z("vibebp").setData("loggedinMenu",e.menu),z("vibebp").setUser(n.data.data.user)}))}else document.dispatchEvent(new Event("vibebp_logout"))}))):_(t.message)})))};return L((function(){w&&document.dispatchEvent(new Event("Vibebp_forgot_password"))}),[w]),wp.element.createElement(R,null,wp.element.createElement("h2",null,w?window.vibebp.translations.forgotpassword:window.vibebp.translations.signin_email_heading),w?wp.element.createElement("p",null,window.vibebp.translations.forgot_password):wp.element.createElement("p",null,window.vibebp.translations.signin_email_description),wp.element.createElement("div",{className:"loginform"},O.length?wp.element.createElement("div",{className:"message"},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:O}})):wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,window.vibebp.translations.email)),wp.element.createElement("input",{className:c,type:"text",onChange:function(e){r(e.target.value)}}))),w?O.length?"":wp.element.createElement(R,null,wp.element.createElement("a",{className:P?"button is-primary is-loading":"button is-primary",onClick:function(){j(!0),fetch("".concat(window.vibebp.api.url,"/forgotPassword?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({email:n})}).then((function(e){return e.json()})).then((function(e){j(!1),e.hasOwnProperty("message")&&(z("vibebp").addNotification({text:e.message}),S(e.message),setTimeout((function(){S("")}),5e3))}))}},window.vibebp.translations.password_recovery_email)):wp.element.createElement(R,null,wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,window.vibebp.translations.password),wp.element.createElement("span",{className:"forgot_password",onClick:function(){window.vibebp.settings.hasOwnProperty("forgotpassword_link")&&window.vibebp.settings.forgotpassword_link.length?window.location.href=window.vibebp.settings.forgotpassword_link:g(!0)}},window.vibebp.translations.forgotpassword)),wp.element.createElement("span",{className:D?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return U(!D)}}),wp.element.createElement("input",{className:"input",type:D?"text":"password",onChange:function(e){b(e.target.value),_("")},onKeyPress:function(e){"Enter"===e.key&&J()}}))),window.vibebp.translations.login_checkbox.length?wp.element.createElement("div",{className:x?"checkbox":"checkbox error"},wp.element.createElement("input",{id:"login_checkbox",type:"checkbox",onClick:function(){return A(!x)}}),wp.element.createElement("label",{for:"login_checkbox",dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_checkbox}})):"",wp.element.createElement("a",{className:i?"button is-primary is-loading":"button is-primary",onClick:J},i&&q("vibebp").getToken()?"...":window.vibebp.translations.signin),h.length?wp.element.createElement("div",{className:"error"},h):"")),window.vibebp.settings.email_login?w?wp.element.createElement("div",{class:"extra_details"},wp.element.createElement("a",{className:"vibebp_back_link",onClick:function(){g(!1)}},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),window.vibebp.translations.back_to_signin)):"":wp.element.createElement("div",{class:"extra_details"},wp.element.createElement("a",{className:"vibebp_back_link",onClick:function(){e.setemailSignIn(!1),g(!0)}},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),window.vibebp.translations.all_signin_options)))};function $(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var G=wp.element,W=(G.createElement,G.useRef),B=G.useEffect,K=(G.Fragment,G.render,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=W(Date.now());B((function(){var n=setTimeout((function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())}),t-(Date.now()-r.current));return function(){clearTimeout(n)}}),[t].concat($(n)))});var V=function(e){try{JSON.parse(e)}catch(e){return!1}return!0};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||te(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||te(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=wp.element,ae=(re.createElement,re.useState),ie=re.useEffect,oe=(re.Fragment,re.render,wp.data),le=oe.dispatch,se=oe.select,ce=function(e){var t=ee(ae(!0),2),n=(t[0],t[1],ee(ae(e.field),2)),r=n[0],a=(n[1],ee(ae(!1),2)),i=a[0],o=a[1],l=ee(ae({icon:"",url:""}),2),s=l[0],c=l[1],u=ee(ae([]),2),p=u[0],d=u[1];ie((function(){"string"==typeof e.field.value&&e.field.value.length&&d(JSON.parse(e.field.value))}),[]);var m,f=function(t){e.hasOwnProperty("registration")&&e.registration?e.update(r):fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(Z({field_id:r.id,value:JSON.stringify(t),token:se("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){le("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"vibebp_profile_field social"},p.length?wp.element.createElement("div",{className:"social_icons_list"},p.map((function(e,t){return wp.element.createElement("div",{className:"social_icon_wrapper"},wp.element.createElement("div",{className:"social_icon"},wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.url)),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=X(p);e.splice(t,1),d(e),f(e)}}))}))):"",wp.element.createElement("a",{className:i?"vicon vicon-close":"vicon vicon-plus",onClick:function(){o(!i)}}),i?wp.element.createElement("div",{className:"add_social_icon"},wp.element.createElement("div",{className:"social_icons"},window.vibebp.social_icons.map((function(e){return wp.element.createElement("div",{className:s.icon===e.icon?"social_icon selected":"social_icon",onClick:function(){c(Z(Z({},s),{},{icon:e.icon}))}},wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.label))}))),wp.element.createElement("div",{className:!s.url.length||(m=s.url,/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(m))?"social_icon_url":"social_icon_url error"},wp.element.createElement("input",{type:"text",onChange:function(e){c(Z(Z({},s),{},{url:e.target.value}))},value:s.url})),wp.element.createElement("a",{className:"button is-primary",onClick:function(){if(s.url.length){var e=X(p);e.push(s),d(e),o(!1),c({icon:"",url:""}),f(e)}}},window.vibebp.translations.set_icon)):"")};function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){de(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function me(e){return function(e){if(Array.isArray(e))return ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){if(e){if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ve(e,t):void 0}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var we=wp.element,ge=(we.createElement,we.useState),ye=we.useEffect,he=(we.Fragment,we.render,wp.data),_e=he.dispatch,Ee=he.select,Oe=function(e){var t=fe(ge(!0),2),n=(t[0],t[1],fe(ge(e.field),2)),r=n[0],a=(n[1],fe(ge(!1),2)),i=a[0],o=a[1],l=fe(ge({icon:"",title:"",description:""}),2),s=l[0],c=l[1],u=fe(ge([]),2),p=u[0],d=u[1];ye((function(){"string"==typeof e.field.value&&e.field.value.length&&V(e.field.value)&&d(JSON.parse(e.field.value))}),[]);var m=function(t){e.hasOwnProperty("registration")&&e.registration?e.update(r):fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:r.id,value:JSON.stringify(t),token:Ee("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){_e("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"vibebp_profile_field repeatable"},p.length?wp.element.createElement("div",{className:"repeatable_icons_list"},p.map((function(e,t){return wp.element.createElement("div",{className:"repeatable_icon_wrapper"},wp.element.createElement("div",{className:"desc"!=r.rtype?"titled"!=r.rtype?"repeatable_title":"repeatable_icon":"repeatable_desc"},("stacked"==r.rtype||"spaced"==r.rtype)&&e.hasOwnProperty("icon")&&e.icon.length>100?wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:e.icon}}):wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,"desc"!=r.rtype&&e.hasOwnProperty("title")?wp.element.createElement("h4",null,e.title):"",wp.element.createElement("p",null,e.description))),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=me(p);e.splice(t,1),d(e),m(e)}}))}))):"",wp.element.createElement("a",{className:i?"vicon vicon-close":"vicon vicon-plus",onClick:function(){o(!i)}}),i?wp.element.createElement("div",{className:"add_repeatable_icon"},"stacked"==r.rtype||"spaced"==r.rtype?wp.element.createElement("div",{className:"repeatable_icons"},window.vibebp.repeatable_icons.map((function(e){if(!(e.length>100))return wp.element.createElement("div",{className:s.icon===e?"repeatable_icon selected":"repeatable_icon",onClick:function(){c(pe(pe({},s),{},{icon:e}))}},wp.element.createElement("span",{className:e}));wp.element.createElement("div",{className:s.icon===e?"repeatable_icon selected":"repeatable_icon",onClick:function(){c(pe(pe({},s),{},{icon:e}))}},wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:e}}))}))):"",wp.element.createElement("div",{className:"desc"!=r.rtype?"repeatable_title":"repeatable_desc"},"stacked"!=r.rtype&&"spaced"!=r.rtype||!s.icon?"":s.icon.length>100?wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:s.icon}}):wp.element.createElement("span",{className:s.icon}),wp.element.createElement("span",null,"desc"!=r.rtype?wp.element.createElement("input",{type:"text",onChange:function(e){c(pe(pe({},s),{},{title:e.target.value}))},value:s.title,placeholder:window.vibebp.translations.title}):"",wp.element.createElement("input",{type:"text",onChange:function(e){c(pe(pe({},s),{},{description:e.target.value}))},value:s.description,placeholder:window.vibebp.translations.description}))),wp.element.createElement("a",{className:"button is-primary",onClick:function(){var e=me(p);m(e),e.push(s),d(e),o(!1),c({icon:"",title:"",description:""})}},window.vibebp.translations.set_icon)):"")};function Se(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){Pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Ie(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){if(e){if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ae=wp.element,Te=(Ae.createElement,Ae.useState),Ce=Ae.useEffect,De=(Ae.Fragment,Ae.render,wp.data),Ue=De.dispatch,Me=De.select,Le=function(e){var t=je(Te(!0),2),n=t[0],r=t[1],a=je(Te(e.field),2),i=a[0],o=a[1],l=je(Te(),2),s=l[0],c=l[1],u=je(Te(),2),p=u[0],d=u[1],m=je(Te(),2),f=m[0],b=m[1],v=je(Te(),2),w=v[0],g=v[1],y=je(Te(""),2),h=y[0],_=y[1],E=je(Te([]),2),O=E[0],S=E[1];K((function(){if(!n&&e.field.value!==i.value){if(e.hasOwnProperty("registration")&&e.registration)return void e.update(i);fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(ke({field_id:i.id,type:"location",value:i.value,token:Me("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Ue("vibebp").addNotification({text:e.message})}))}}),500,[i.value]),K((function(){if(!n){var e=new google.maps.places.AutocompleteService;h.length&&e.getQueryPredictions({input:h},(function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){var n=Se(O);e.forEach((function(e){n.push(e.description)})),S(n)}}))}}),500,[h]),Ce((function(){if(s)if(window.hasOwnProperty("google")&&window.google.hasOwnProperty("maps")){var e={lat:-34.397,lng:150.644},t={zoom:16,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,imageDefaultUI:!0},n=new google.maps.Map(s,t);d(n);var a=new google.maps.Marker({map:n,position:e,animation:google.maps.Animation.DROP});b(a),r(!1),g(new google.maps.Geocoder)}else{var i=window.document.createElement("script");i.src="https://maps.googleapis.com/maps/api/js?key=".concat(window.vibebp.settings.google_maps_api_key,"&libraries=places"),i.async=!0,window.document.body.appendChild(i),i.addEventListener("load",(function(){var e={lat:-34.397,lng:150.644},t={zoom:16,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,imageDefaultUI:!0},n=new google.maps.Map(s,t);d(n);var a={url:window.vibebp.settings.map_marker,size:new google.maps.Size(51,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(21,30)},i=new google.maps.Marker({map:n,position:e,animation:google.maps.Animation.DROP,draggable:!0,icon:a});b(i),r(!1),g(new google.maps.Geocoder)}))}}),[s]),Ce((function(){if(!n){if(i.value){var e=i.value;if(Array.isArray(e)||e.split(","),e.length){var t=ke({},i);6===e.length&&(t.value={lat:e[0],lng:e[1],address:e[2],zipcode:e[3],city:e[4],country:e[5]});var r=new google.maps.LatLng(e[0],e[1]);o(t),p.setCenter(r),f.setPosition(r)}}else k();window.google.maps.event.addListener(f,"dragend",(function(e){(new google.maps.Geocoder).geocode({location:e.latLng},(function(e,t){"OK"==t&&(console.log(e),p.setCenter(e[0].geometry.location),o(ke(ke({},i),{},{value:{lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),address:e[0].formatted_address,zipcode:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("postal_code")}))].long_name,city:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("locality")}))].long_name,country:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("country")}))].long_name}})))}))}))}}),[n]);var N=function(){w&&(new google.maps.Geocoder).geocode({address:h},(function(e,t){"OK"==t&&(p.setCenter(e[0].geometry.location),f.setPosition(e[0].geometry.location)),S([])}))},k=function(){console.log("...locating"),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(e){var t=ke({},i);console.log(e),t.value=[e.coords.latitude,e.coords.longitude],o(t);var n=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);console.log(n),p.setCenter(n),f.setPosition(n)}))};return wp.element.createElement("div",{className:"vibebp_profile_field location"},wp.element.createElement("div",{className:"search_me"},wp.element.createElement("span",{className:"vicon vicon-target",onClick:k}),wp.element.createElement("input",{type:"text",value:h,onChange:function(e){_(e.target.value)}}),h.length?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){_(""),S([])}}):"",wp.element.createElement("span",{className:h.length?"vicon vicon-search is_active":"vicon vicon-search",onClick:N})),O.length?wp.element.createElement("div",{className:"vibebp_autocomplete_results"},O.map((function(e){return wp.element.createElement("div",{className:"vibebp_autocomplete_result",onClick:function(){_(e),S([]),N()}},e)}))):"",wp.element.createElement("div",{className:"google_map_locator"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",wp.element.createElement("div",{ref:function(e){e&&!s&&c(e)},style:{height:"400px",width:"100%"}})),wp.element.createElement("div",{className:"google_map_details"},wp.element.createElement("textarea",{placeholder:window.vibebp.translations.address,onChange:function(e){o(ke(ke({},i),{},{value:ke(ke({},i.value),{},{address:e.target.value})}))},value:i.value.hasOwnProperty("address")?i.value.address:""}),wp.element.createElement("div",{className:"gmap_fields"},wp.element.createElement("input",{type:"text",onChange:function(e){o(ke(ke({},i),{},{value:ke(ke({},i.value),{},{zipcode:e.target.value})}))},placeholder:window.vibebp.translations.zipcode,value:i.value.hasOwnProperty("zipcode")?i.value.zipcode:""}),wp.element.createElement("input",{type:"text",onChange:function(e){o(ke(ke({},i),{},{value:ke(ke({},i.value),{},{city:e.target.value})}))},placeholder:window.vibebp.translations.city,value:i.value.hasOwnProperty("city")?i.value.city:""}),wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.country,value:i.value.hasOwnProperty("country")?i.value.country:""}))))};function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){qe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ze(e){return function(e){if(Array.isArray(e))return He(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||$e(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||$e(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(e,t){if(e){if("string"==typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?He(e,t):void 0}}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ge=wp.element,We=(Ge.createElement,Ge.render,Ge.useState),Be=Ge.useEffect;Ge.useContext,Ge.Fragment,Ge.RawHTML;function Ke(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))if(n){for(var r=0;r<t.length;r++)if(t[r][n]===e[n])return r}else for(var a=0;a<t.length;a++)if(t[a].name===e.name)return a;return-1}var Ve=function(e){var t=Fe(We({}),2),n=t[0],r=t[1],a=Fe(We(""),2),i=(a[0],a[1]),o=Fe(We([]),2),l=o[0],s=o[1],c=Fe(We([]),2),u=c[0],p=c[1],d=Fe(We(!1),2),m=d[0],f=d[1],b=Fe(We(!1),2),v=b[0],w=b[1],g=Fe(We(!1),2),y=(g[0],g[1]);Be((function(){if(e.field&&e.field.hasOwnProperty("value")&&e.field.value.length&&e.field.options&&e.field.options.length){var t=[];e.field.value.map((function(n){e.field.options.map((function(e){e.value!=n&&e.name!=n||t.push(e)}))})),p(t)}e.field.options&&e.field.options.length&&Array.isArray(e.field.options)&&(f(!0),s(ze(e.field.options)),f(!1)),r(e.field),y(!0)}),[e.field]);var h="search_results";return v&&(h="search_results active"),wp.element.createElement("div",{className:"selectcptfield multiselect"},wp.element.createElement("div",{className:"selectcptfield_list"},u.length?wp.element.createElement("div",{className:"selectcptfield_items"},u.map((function(t){var a=n.cpt?n.multiselect:"";return wp.element.createElement("span",{type:a,onClick:function(){var a=ze(u),i=ze(l);a.splice(Ke(t,u,"name"),1),i.push(t),s(i),p(a);var o=Je({},n);if(a&&a.length){var c=[];a.map((function(e){e.hasOwnProperty("name")&&c.push(e.name)})),o.value=c,o.show_value=a,r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}else o.value=[],o.show_value=[],r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}},t.name)}))):""),wp.element.createElement("div",{className:"selectimitate",onClick:function(){w(!v)}},v?wp.element.createElement("i",{class:"vicon vicon-angle-up","aria-hidden":"true"}):wp.element.createElement("i",{class:"vicon vicon-angle-down","aria-hidden":"true"}),l.length?wp.element.createElement("div",{className:h},l.map((function(t,a){if(-1===Ke(t,u,"name"))return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){i("");var o=ze(u);if(-1===Ke(t,o,"name")){o.push(t),l.splice(a,1),p(o);var s=Je({},n);if(o&&o.length){var c=[];o.map((function(e){e.hasOwnProperty("name")&&c.push(e.name)})),s.value=c,s.show_value=o,r(s),e.update(s,e.fieldIndex,"fieldvaluechanged")}}}},wp.element.createElement("span",null,t.name))}))):m?"......":""))};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){Qe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var tt=wp.element,nt=(tt.createElement,tt.render,tt.useState),rt=tt.useEffect,at=tt.Fragment,it=(tt.useContext,wp.data),ot=it.dispatch,lt=it.select,st=function(e){var t=Xe(nt(!1),2),n=(t[0],t[1],Xe(nt({}),2)),r=n[0],a=n[1],i=Xe(nt(!1),2),o=(i[0],i[1],Xe(nt(0),2)),l=o[0],s=(o[1],Xe(nt(""),2)),c=s[0],u=s[1];rt((function(){c.length&&setTimeout((function(){u("")}),5e3)}),[c]),rt((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.hasOwnProperty("url")&&a(e.field.value)}),[e.field]);var p=function(t){void 0===t&&(t=r),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(Ze({field_id:e.field.id,type:e.field.type,value:t,token:lt("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){ot("vibebp").addNotification({text:e.message})}))},d=function(){a({}),fetch("".concat(window.vibebp.api.url,"/user/delete_media?post"),{method:"post",body:JSON.stringify({token:lt("vibebp").getToken(),media:r})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&ot("vibebp").addNotification({text:e.message})}))};return wp.element.createElement(at,null,r&&r.hasOwnProperty("url")?wp.element.createElement("div",{className:"single_media"},function(e){if(e.hasOwnProperty("url"))return wp.element.createElement("div",{className:"media_snapashot"},wp.element.createElement("a",{href:e.url,target:"_blank"},e.name),wp.element.createElement("span",{className:"vicon vicon-close",onClick:d}))}(r)):wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media",style:{border:"1px dotted var(--darkborder)",padding:"1rem"}},l?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:l+"%"}})),wp.element.createElement("span",null,l,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(t){return function(t){if(t.target.files[0]){var n=t.target.files[0],r=n.size/1024/1024,i=[];if(e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(t){e.field.all_upload_types.hasOwnProperty(t)&&e.field.all_upload_types[t].length&&e.field.all_upload_types[t].map((function(e){i.push(e)}))})),-1===i.indexOf(n.type))return u(window.vibebp.translations.file_type_not_allowed),!1;if(parseInt(e.field.upload_size)<r)return u(window.vibebp.translations.file_size_error+" "+e.field.upload_size+"MB"),!1;var o=new FormData;o.append("file",t.target.files[0]),o.append("body",JSON.stringify({token:lt("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media?upload"),{method:"post",body:o}).then((function(e){return e.json()})).then((function(e){e.status?(a(e.data),p(e.data)):e.hasOwnPropoerty("message")&&ot("vibebp").addNotification({text:e.message})}))}}(t)},style:{display:"none"}}),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(at,null,wp.element.createElement("span",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(at,null,wp.element.createElement("span",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),c&&c.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},c):""))};function ct(e){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e){return function(e){if(Array.isArray(e))return vt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||bt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||bt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(e,t){if(e){if("string"==typeof e)return vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(e,t):void 0}}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wt=wp.element,gt=(wt.createElement,wt.render,wt.useState),yt=wt.useEffect,ht=wt.Fragment,_t=(wt.useContext,wp.data),Et=_t.dispatch,Ot=_t.select,St=function(e){var t=ft(gt(!1),2),n=t[0],r=t[1],a=ft(gt([]),2),i=a[0],o=a[1],l=ft(gt([]),2),s=l[0],c=(l[1],ft(gt(!1),2)),u=c[0],p=c[1],d=ft(gt(!1),2),m=d[0],f=d[1],b=ft(gt(0),2),v=b[0],w=b[1],g=ft(gt("media"),2),y=g[0],h=g[1],_=ft(gt((function(){var t={posts_per_page:20,paged:1,search_terms:"",orderby:""};return e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&(t.post_mime_type=e.post_mime_type),t})),2),E=_[0],O=_[1],S=ft(gt(""),2),N=S[0],k=S[1],P=ft(gt([]),2),j=(P[0],P[1],ft(gt({name:"",url:"",type:"file"}),2)),I=j[0],x=j[1];yt((function(){return document.querySelector(".vibebp_myprofile")&&document.querySelector(".vibebp_myprofile").classList.add("popup_active"),function(){document.querySelector(".vibebp_myprofile.popup_active")&&document.querySelector(".vibebp_myprofile").classList.remove("popup_active")}}),[]),K((function(){fetch("".concat(window.vibebp.api.url,"/user/fetch_media?").concat(E.search_terms.length?"nocache":encodeURIComponent(JSON.stringify(dt(dt({},E),{},{search_terms:""})))),{method:"post",body:JSON.stringify(dt(dt({},E),{},{token:Ot("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(r(!1),e.status)if(m){var t=ut(i);e.data.map((function(e){t.push(e)})),o(t),f(!1),t.length<parseInt(data.total)?p(!0):p(!1)}else o(e.data),e.data.length<parseInt(e.total)?p(!0):p(!1)}))}),500,[E]);var A=function(){O(dt({},E))};yt((function(){return document.addEventListener("vibebp_component_reload",A),function(){document.removeEventListener("vibebp_component_reload",A)}})),yt((function(){N.length&&setTimeout((function(){k("")}),5e3)}),[N]);var T=function(t){e.share(t)},C=function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("video",{class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"}));case"audio":return wp.element.createElement("audio",{class:"audio_plyr"},wp.element.createElement("source",{src:e.url,type:"audio/mp3"}));case"document":return wp.element.createElement("span",{class:"modal_document"},e.name)}};return wp.element.createElement("div",{className:"vibe_editor_modal"},wp.element.createElement("span",{onClick:function(t){e.close(!1)}}),wp.element.createElement("div",{className:"ve_modal-content"},wp.element.createElement("div",{className:"ve_modal-header"},wp.element.createElement("div",null,window.vibebp.settings.media_tabs?Object.keys(window.vibebp.settings.media_tabs).map((function(t){if("upload"!=t||!window.vibebp.settings.hasOwnProperty("upload_capability")||!window.vibebp.settings.upload_capability)return wp.element.createElement("a",{className:y==t?"active":"",onClick:function(){h(t)}},window.vibebp.settings.media_tabs[t]);var n=Ot("vibebp").getUser();if(void 0!==n&&n.hasOwnProperty("caps")&&void 0!==n.caps){var r=0;if(Array.isArray(n.caps)?n.caps.findIndex((function(e,t){return e==window.vibebp.settings.upload_capability}))>-1&&(r=1):"object"===ct(n.caps)&&Object.keys(n.caps).map((function(e,t){e===window.vibebp.settings.upload_capability&&n.caps[e]&&(r=1)})),e.hasOwnProperty("allow_upload")&&e.allow_upload&&(r=1),r)return wp.element.createElement("a",{className:y==t?"active":"",onClick:function(){h(t)}},window.vibebp.settings.media_tabs[t])}})):""),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(t){e.close(!1)}})),wp.element.createElement("div",{className:"ve_modal-body"},"media"==y?wp.element.createElement(ht,null,wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,onChange:function(e){return O(dt(dt({},E),{},{search_terms:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("select",{onChange:function(e){O(dt(dt({},E),{},{order:e.target.value}))}},Object.keys(window.vibeEditor.media_order).map((function(e){return wp.element.createElement("option",{value:e},window.vibeEditor.media_order[e])}))))),n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):i&&i.length?wp.element.createElement("div",{className:"allMedia"},i.map((function(t,n){return wp.element.createElement("div",{className:"single_media"},wp.element.createElement("span",{onClick:function(n){T(t),e.hasOwnProperty("autoclose")||e.close(!1)}},C(t)),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return function(e){var t=ut(i);t.splice(t.findIndex((function(t){return t.id==e.id})),1),o(t),fetch("".concat(window.vibebp.api.url,"/user/delete_media"),{method:"post",body:JSON.stringify({token:Ot("vibebp").getToken(),media:e})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Et("vibebp").addNotification({text:e.message})}))}(t)}}))}))):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_media),u?wp.element.createElement("a",{className:"link",onClick:function(){O(dt(dt({},E),{},{paged:E.paged+1})),f(!0)}},window.vibebp.translations.more):""):"upload"===y?wp.element.createElement(ht,null,wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media"},window.vibebp.translations.upload_media,v?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:v+"%"}})),wp.element.createElement("span",null,v,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(t){return function(t){var n=e.post_mime_type,r=e.allowed_file_size;if(void 0===r&&(r=window.vibebp.settings.upload_limit),void 0===n||!Array.isArray(n)){var a=n;(n=[]).push(a)}if(t.target.files[0]){var l=t.target.files[0].size/1024/1024;if(n.indexOf(t.target.files[0].type)<=-1)return k(window.vibebp.translations.allowed_file_types+" "+n.join(",")),!1;if(r<l)return k(window.vibebp.translations.file_size_error+" "+r+"Mb"),!1;if(tus.isSupported&&tus.canStoreURLs&&l>4){var s="".concat(window.vibebp.api.url,"/user/upload_media_stream?upload"),c=new tus.Upload(t.target.files[0],{endpoint:s,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:Ot("vibebp").getToken(),filename:t.target.files[0].name,filetype:t.target.files[0].type},onError:function(e){e.hasOwnProperty("message")&&Et("vibebp").addNotification({text:e.message})},onProgress:function(t,n){var r=(t/n*100).toFixed(2);w(r),100==r&&setTimeout((function(){var t={posts_per_page:20,paged:1,search_terms:"",orderby:""};e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&(t.post_mime_type=e.post_mime_type),O(t),w(0),h("media")}),500)},onSuccess:function(){localStorage.removeItem(c._urlStorageKey),c.url=c.url.replace("?upload",""),fetch("".concat(c.url,"/complete_stream?nocache"),{method:"post",body:JSON.stringify({token:Ot("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&e.post_mime_type,w(0),h("media")}t.hasOwnProperty("message")&&Et("vibebp").addNotification({text:t.message})}))}});c.findPreviousUploads().then((function(e){e.length>0&&c.resumeFromPreviousUpload(e[0]),c.start()})),tus.Upload.terminate(s).then((function(){})).catch((function(e){}))}else{var u=new FormData;u.append("file",t.target.files[0]),u.append("body",JSON.stringify({token:Ot("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media"),{method:"post",body:u}).then((function(e){return e.json()})).then((function(e){if(e.status){var t=ut(i);t.unshift(e.data),o(t),h("media")}else e.hasOwnPropoerty("message")&&Et("vibebp").addNotification({text:e.message})}))}}}(t)}}),s&&s.length?wp.element.createElement("div",{className:"uploaded"},wp.element.createElement("strong",null,window.vibebp.translations.uploaded_media),wp.element.createElement("div",{className:"uploaded_files"},s.map((function(e,t){return wp.element.createElement("div",{className:"single_media",onClick:function(t){T(e)}},C(e))})))):""),N&&N.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},N):""):"embed"===y?wp.element.createElement(ht,null,wp.element.createElement("div",{className:"embed_media"},wp.element.createElement("label",{for:"vibe_editor_embed_name"}," ",window.vibebp.translations.enter_emabed_name," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_name",onChange:function(e){return x(dt(dt({},I),{},{name:e.target.value}))}}),wp.element.createElement("label",{for:"vibe_editor_embed_url"}," ",window.vibebp.translations.enter_embed_url," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_url",onChange:function(e){return x(dt(dt({},I),{},{url:e.target.value}))}}),wp.element.createElement("select",{onChange:function(e){return x(dt(dt({},I),{},{type:e.target.value}))},value:I.type},e.hasOwnProperty("embed_options")?e.embed_options.map((function(e){return wp.element.createElement("option",{value:e},e.charAt(0).toUpperCase()+e.slice(1))})):Object.keys(window.vibeEditor.embed_types).map((function(t){if(e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type)if(Array.isArray(e.post_mime_type)){if(e.post_mime_type.indexOf(t)<0)return}else if(e.post_mime_type.split(",").indexOf(t)<0)return;return wp.element.createElement("option",{value:t},window.vibeEditor.embed_types[t])}))),Object.values(I).findIndex((function(e){return""==e||null==e}))>-1?"":wp.element.createElement("button",{className:"button is-primary",onClick:function(){T(I),e.close(!1)}},window.vibebp.translations.embed))):wp.element.createElement("div",{className:y}))))};function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){Pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return It(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return It(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xt=wp.element,At=(xt.createElement,xt.render,xt.useState),Tt=xt.useEffect,Ct=xt.Fragment,Dt=(xt.useContext,xt.useRef),Ut=wp.data,Mt=Ut.dispatch,Lt=Ut.select,Rt=function(e){var t=Dt(null),n=jt(At(!1),2),r=(n[0],n[1],jt(At({}),2)),a=r[0],i=r[1],o=jt(At(!1),2),l=(o[0],o[1],jt(At(0),2)),s=(l[0],l[1],jt(At(""),2)),c=s[0],u=s[1],p=jt(At(!1),2),d=p[0],m=p[1],f=jt(At([]),2),b=f[0],v=f[1],w=jt(At(null),2),g=w[0],y=w[1];Tt((function(){c.length&&setTimeout((function(){u("")}),5e3)}),[c]),Tt((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.hasOwnProperty("url")&&i(e.field.value);var t=[];e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(n){e.field.all_upload_types.hasOwnProperty(n)&&e.field.all_upload_types[n].length&&e.field.all_upload_types[n].map((function(e){t.push(e)}))})),t.push("video"),v(t)}),[e.field]),Tt((function(){if(a&&a.hasOwnProperty("type")&&t.current){if("video"==a.type){var e=new Plyr(t.current);y(e)}if("youtube"==a.type){var n=new Plyr(t.current);y(n)}if("vimeo"==a.type){var r=new Plyr(t.current);y(r)}}}),[a]);var h=function(t){void 0===t&&(t=a),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save"),{method:"post",body:JSON.stringify(kt({field_id:e.field.id,type:e.field.type,value:t,token:Lt("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){Mt("vibebp").addNotification({text:e.message})}))},_=function(e){var t=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/);return!(!t||!t.length)&&t[1]};return wp.element.createElement("div",{className:"video_field"},a&&a.hasOwnProperty("url")?wp.element.createElement("div",null,wp.element.createElement("div",{className:"single_media"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"remove vicon vicon-close",onClick:function(){g&&(g.destroy(),y(null)),h(null),i({})}}),wp.element.createElement("div",null,"  ",wp.element.createElement("div",null," ",function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:t,class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"})));case"youtube":var n=_(a.url);return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("div",{ref:t,"data-plyr-provider":"youtube","data-plyr-embed-id":n}));case"vimeo":var r=e.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/);return wp.element.createElement("div",{className:"video_wrapper"}," ",wp.element.createElement("div",{ref:t,"data-plyr-provider":"vimeo","data-plyr-embed-id":r[4]}));case"audio":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("audio",{class:"audio_plyr",controls:!0},wp.element.createElement("source",{src:e.url,type:"audio/mp3"})));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}}(a)))," "))):wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media",style:{border:"1px dotted var(--darkborder)",padding:"1rem"},onClick:function(){m(!0)}},wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(Ct,null,wp.element.createElement("span",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(Ct,null,wp.element.createElement("span",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),c&&c.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},c):"",d?wp.element.createElement(St,{post_mime_type:b,allowed_file_size:e.field.upload_size,close:function(){m(!1)},share:function(e){if(e.hasOwnProperty("type")&&["youtube","vimeo"].includes(e.type))if("youtube"==e.type){if(!_(e.url))return u(window.vibebp.translations.invalid_url),!1}else if("vimeo"==e.type){if(!e.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/))return u(window.vibebp.translations.invalid_url),!1}i(e),h(e)},embed_options:["video","youtube","vimeo"]}):""))};function Jt(e){return function(e){if(Array.isArray(e))return Gt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ht(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(n),!0).forEach((function(t){Ft(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Ht(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){if(e){if("string"==typeof e)return Gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(e,t):void 0}}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wt=wp.element,Bt=(Wt.createElement,Wt.render,Wt.useState),Kt=Wt.useEffect,Vt=Wt.Fragment,Yt=(Wt.useContext,Wt.useRef),Zt=wp.data,Qt=Zt.dispatch,Xt=Zt.select,en=function(e){var t=Yt(null),n=$t(Bt(!1),2),r=(n[0],n[1],$t(Bt([]),2)),a=r[0],i=r[1],o=$t(Bt(!1),2),l=(o[0],o[1],$t(Bt(0),2)),s=(l[0],l[1],$t(Bt(""),2)),c=s[0],u=s[1],p=$t(Bt(!1),2),d=p[0],m=p[1],f=$t(Bt([]),2),b=f[0],v=f[1];Kt((function(){c.length&&setTimeout((function(){u("")}),5e3)}),[c]),Kt((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.length&&(V(e.field.value)?i(JSON.parse(e.field.value)):i(e.field.value));var t=[];e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(n){e.field.all_upload_types.hasOwnProperty(n)&&e.field.all_upload_types[n].length&&e.field.all_upload_types[n].map((function(e){t.push(e)}))})),t.push("image"),v(t)}),[e.field]);var w=function(t){void 0===t&&(t=a),e.hasOwnProperty("registration")&&e.registration?e.update(field):fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(zt({field_id:e.field.id,type:e.field.type,value:t,token:Xt("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){Qt("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"gallery_field"},wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media",style:{border:"1px dotted var(--darkborder)",padding:"1rem"},onClick:function(){m(!0)}},wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(Vt,null,wp.element.createElement("strong",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(Vt,null,wp.element.createElement("strong",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),c&&c.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},c):"",d?wp.element.createElement(St,{post_mime_type:b,autoclose:"1",allowed_file_size:e.field.upload_size,close:function(){m(!1)},share:function(e){if(e.hasOwnProperty("type")&&e.hasOwnProperty("url")){var t=Jt(a);t.push(e),i(t),w(t)}},embed_options:["video","youtube","vimeo"]}):""),a&&a.length?wp.element.createElement("div",{className:"media_gallery"},a.map((function(e,n){return wp.element.createElement("div",null,wp.element.createElement("div",{className:"single_media"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"remove vicon vicon-close",onClick:function(){var e=Jt(a);e.splice(n,1),w(e),i(e)}}),wp.element.createElement("div",null,"  ",wp.element.createElement("div",null," ",function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:t,class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"})));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}}(e)))," ")))}))):"")};function tn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rn=wp.element,an=(rn.createElement,rn.useState),on=rn.useEffect,ln=(rn.Fragment,rn.render,rn.useRef,wp.data),sn=(ln.dispatch,ln.select,function(e){var t=tn(an(e.value),2),n=t[0],r=t[1],a=tn(an({}),2),i=a[0],o=a[1];return on((function(){var t=100,r=0;e.hasOwnProperty("max")&&(t=e.max),e.hasOwnProperty("min")&&(r=e.min);var a=Math.round(100*n/(t-r));o({background:"linear-gradient(to right, var(--primary), var(--primary) "+a+"%, var(--light) "+a+"%, var(--light) 100%)"})}),[]),wp.element.createElement("div",{class:"range"},wp.element.createElement("div",{class:"form-group range__slider"},wp.element.createElement("input",{type:"range",style:i,step:e.hasOwnProperty("step")?e.step:"",min:e.hasOwnProperty("min")?e.min:0,max:e.hasOwnProperty("max")?e.max:100,value:n,onChange:function(t){r(t.target.value);var n=100,a=0;e.hasOwnProperty("max")&&(n=e.max),e.hasOwnProperty("min")&&(a=e.min);var i=Math.round(100*t.target.value/(n-a));console.log(i),o({background:"linear-gradient(to right, var(--primary), var(--primary) "+i+"%, var(--light) "+i+"%, var(--light) 100%)"}),e.change(t.target.value)}})),wp.element.createElement("div",{class:"form-group range__value"},e.hasOwnProperty("valueLabel")?wp.element.createElement("label",null,e.valueLabel):"",wp.element.createElement("span",null,n)))});function cn(e){return function(e){if(Array.isArray(e))return bn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||fn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||fn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fn(e,t){if(e){if("string"==typeof e)return bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bn(e,t):void 0}}function bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vn=wp.element,wn=(vn.createElement,vn.render,vn.Fragment,vn.useState),gn=vn.useEffect,yn=wp.data,hn=yn.dispatch,_n=yn.select;function En(e){var t=mn(wn(e.field),2),n=t[0],r=t[1],a=mn(wn(),2),i=a[0],o=a[1],l=mn(wn(!1),2),s=l[0],c=l[1],u=mn(wn(null),2),p=u[0],d=u[1];gn((function(){c(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/options?field_id=").concat(n.id).concat(e.registration?"&client_id="+window.vibebp.settings.client_id:""),{method:"post",body:JSON.stringify(pn({field_id:n.id,type:n.type,token:_n("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){c(!1),e.status&&o(e.values)})).catch((function(e){c(!1),console.log({error:e})}))}),[]);K((function(){n.value&&i&&function(){if(e.hasOwnProperty("registration")&&e.registration)e.update(n);else{p&&p.abort();var t=new AbortController,r=p?{signal:t.signal}:{};d(t),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),pn(pn({method:"post"},r),{},{body:JSON.stringify(pn({field_id:n.id,type:n.type,value:n.value,token:_n("vibebp").getToken()},e))})).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&hn("vibebp").addNotification({text:e.message})})).catch((function(e){console.log({error:e})}))}}()}),500,[n.value]);return wp.element.createElement("div",{className:"frontend_profile_field"},s?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",wp.element.createElement("div",{className:"_profile_field_body"},i?wp.element.createElement("div",{className:"vibebpProfile_table_wrapper"},wp.element.createElement("table",{className:"vibebpProfile_table"},i.hasOwnProperty("columns")&&i.columns&&i.columns.length&&i.hasOwnProperty("rows")&&i.rows&&i.rows.length?function(){for(var e=[],t=function(t){e.push(wp.element.createElement("tr",null,function(){for(var e=[],a=0;a<=i.columns.length;a++)if(0===a)if(0===t)e.push(wp.element.createElement("th",null));else{var o=i.rows[t-1];e.push(wp.element.createElement("th",{className:"removable_item"},wp.element.createElement("span",null,o.name)))}else if(0===t){var l=i.columns[a-1];e.push(wp.element.createElement("th",{className:"removable_item"},wp.element.createElement("span",null,l.name)))}else!function(){var o={row:i.rows[t-1].id,column:i.columns[a-1].id},l=pn(pn({},o),{},{type:"text",value:""});if(i.values){var s=i.values.findIndex((function(e){return e.row===o.row&&e.column===o.column}));s>-1&&i.values[s].row&&i.values[s].column&&(l=i.values[s])}var c=[];if(n.value&&Array.isArray(n.value)&&n.value.length){var u=n.value.find((function(e){return e.row===o.row&&e.column===o.column}));u&&(c=u.value)}e.push(wp.element.createElement("td",null,wp.element.createElement("div",null,wp.element.createElement(On,{field:pn(pn({},l),{},{value:c}),change:function(e){r((function(t){var n=pn({},t);n.hasOwnProperty("value")&&Array.isArray(n.value)?n.value=cn(t.value):n.value=[];var r=pn(pn({},o),{},{value:e}),a=n.value.findIndex((function(e){return e.row===o.row&&e.column===o.column}));return a>-1?n.value.splice(a,1,pn({},r)):n.value.push(pn({},r)),n}))}}))))}();return e}()))},a=0;a<=i.rows.length;a++)t(a);return e}():"")):""))}function On(e){var t=mn(wn({}),2),n=t[0],r=t[1],a=mn(wn(!0),2),i=a[0],o=(a[1],function(t){return e.change(t)});return gn((function(){r(e.field&&e.field.row&&e.field.column?pn({},e.field):pn(pn({},e.ids),{},{type:"text",value:""}))}),[e.field]),wp.element.createElement("div",{className:"profile_field_fields_element"},i?wp.element.createElement("div",{className:"field_settings"},"text"===n.type||"number"===n.type?wp.element.createElement("input",{type:"string"==typeof n.value||"number"==typeof n.value?n.value:"",value:n.value,onChange:function(e){return o(e.target.value)}}):"option"===n.type?wp.element.createElement("div",null,n.options&&n.options.length?wp.element.createElement("select",{onChange:function(e){return o(e.target.value)},value:n.value},n.options.map((function(e){return wp.element.createElement("option",{field:e.field},e.lable)}))):""):"range"===n.type||"points"===n.type?wp.element.createElement(sn,{value:n.value,min:"0",max:"100",change:function(e){return o(e)}}):"checkbox"===n.type?wp.element.createElement("div",null,n.options&&n.options.length?n.options.map((function(e,t){var a=pn({},n);return a.value&&Array.isArray(a.value)||(a.value=[]),wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:"custom-checkbox-".concat(t),value:t,checked:a.value.indexOf(t)>-1,onChange:function(){var e=pn({},n);e.value&&Array.isArray(e.value)||(e.value=[]);var a=cn(e.value);a.indexOf(t)>-1?a.splice(a.indexOf(t),1):a.push(t),r(pn(pn({},e),{},{value:a})),o(a)}}),wp.element.createElement("label",{htmlFor:"custom-checkbox-".concat(t)},e.lable))})):""):""):"")}function Sn(){return(Sn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Nn(e){return function(e){if(Array.isArray(e))return An(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||xn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kn(Object(n),!0).forEach((function(t){jn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function In(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||xn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xn(e,t){if(e){if("string"==typeof e)return An(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?An(e,t):void 0}}function An(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tn=wp.element,Cn=(Tn.createElement,Tn.useState),Dn=Tn.useEffect,Un=Tn.Fragment,Mn=(Tn.render,Tn.useRef),Ln=wp.data,Rn=Ln.dispatch,Jn=Ln.select,qn=!1,zn=function(e){var t=In(Cn(!1),2),n=t[0],r=t[1],a=In(Cn(!1),2),i=a[0],o=a[1],l=In(Cn({}),2),s=l[0],c=l[1],u=In(Cn(null),2),p=u[0],d=u[1],m=Mn(null);Dn((function(){}),[]),Dn((function(){"checkbox"!=e.field.type&&"selectbox"!=e.field.type&&"radio"!=e.field.type&&"multiselect"!=e.field.type&&"location"!=e.field.type&&"multiselectbox"!=e.field.type||e.field.hasOwnProperty("options")&&e.field.options.length||fetch("".concat(window.vibebp.api.url,"/xprofile/field/options?field_id=").concat(e.field.id,"&client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify(Pn({field_id:e.field.id,type:e.field.type,token:Jn("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(t){t.status?(c(Pn(Pn({},e.field),{},{options:t.values})),e.update&&e.update(Pn(Pn({},e.field),{},{options:t.values}))):c(Pn(Pn({},e.field),{},{options:[]}))}));var t=new CustomEvent("field_loaded",{detail:{field:e.field}});document.dispatchEvent(t),c(e.field)}),[e.field]),Dn((function(){return function(){m&&m.hasOwnProperty("current")&&m.current&&"undefined"!=typeof flatpickr&&m.current.flatpickr().destroy()}}),[e.field.id]);Dn((function(){if(m&&m.hasOwnProperty("current")&&m.current&&"undefined"!=typeof flatpickr){var e={altInput:!0,dateFormat:"Y-m-d",defaultDate:s.hasOwnProperty("value")&&s.value.length?s.value:[],onChange:f};flatpickr(m.current,e)}}),[s]),Dn((function(){if(e.hasOwnProperty("registration")&&e.registration)e.update(s);else if(n&&"checkbox"==s.type){qn&&qn.abort();var t={},a=new AbortController;qn&&(t={signal:a.signal}),qn=a,o(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),Pn(Pn({method:"post"},t),{},{body:JSON.stringify(Pn({field_id:s.id,type:s.type,value:s.value,token:Jn("vibebp").getToken()},e))})).then((function(e){return e.json()})).then((function(t){o(!1),r(!1),document.dispatchEvent(new CustomEvent("xprofile_field_saved",{detail:{field_id:s.id}})),e.hasOwnProperty("update")&&e.update(s),t.hasOwnProperty("message")&&Rn("vibebp").addNotification({icon:t.status?"vicon vicon-check-box":"vicon vicon-alert",text:t.message})}))}}),[s.value,n]),K((function(){if(e.hasOwnProperty("registration")&&e.registration)e.update(s);else if(n&&"checkbox"!=s.type){qn&&qn.abort();var t={},a=new AbortController;qn&&(t={signal:a.signal}),qn=a,o(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),Pn(Pn({method:"post"},t),{},{body:JSON.stringify(Pn({field_id:s.id,type:s.type,value:s.value,token:Jn("vibebp").getToken()},e))})).then((function(e){return e.json()})).then((function(t){o(!1),r(!1),document.dispatchEvent(new CustomEvent("xprofile_field_saved",{detail:{field_id:s.id}})),e.hasOwnProperty("update")&&e.update(s),t.hasOwnProperty("message")&&Rn("vibebp").addNotification({icon:t.status?"vicon vicon-check-box":"vicon vicon-alert",text:t.message})}))}}),1,[s.value,n]);var f=function(e){var t=Pn({},s);if(e&&e.length){var n=e[0].getDate();(n=n.toString()).length<2&&(n="0"+n);var a=e[0].getMonth()+1;(a=a.toString()).length<2&&(a="0"+a);var i=e[0].getFullYear()+"-"+a+"-"+n;t.value=i}else t.value="";c(t),r(!0)};return wp.element.createElement("div",{className:i?"vibebp_form_field control is-loading":"vibebp_form_field control"},"checkbox_acceptance"!==s.type?wp.element.createElement("label",null,wp.element.createElement("span",null,wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:s.name}}),s.description&&s.description.length?wp.element.createElement(Un,null,wp.element.createElement("span",{className:"vicon vicon-help-alt"}),wp.element.createElement("div",{className:"field_description",dangerouslySetInnerHTML:{__html:s.description}})):""),window.vibebp.components.hasOwnProperty("xprofile")&&window.vibebp.components.xprofile.hasOwnProperty("visibility")?wp.element.createElement("span",null,window.vibebp.components.xprofile.visibility[s.visibility]):""):"",s.hasOwnProperty("type")?"textbox"===s.type?wp.element.createElement("input",{type:"text",value:s.value,onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}}):"number"===s.type||"telephone"===s.type?wp.element.createElement("input",{type:"number",value:s.value,onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}}):"url"===s.type?wp.element.createElement("input",{type:"text",value:s.value,onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}}):"range"===s.type?wp.element.createElement("input",{type:"range",value:s.value,min:"0",max:"100",onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}}):"points"===s.type?wp.element.createElement("input",{type:"range",value:s.value,min:"0",max:"5",onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}}):"textarea"===s.type?wp.element.createElement("textarea",{onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}},s.value):"selectbox"===s.type?wp.element.createElement("select",{onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)},value:s.value},s.hasOwnProperty("options")?s.options.map((function(e,t){return wp.element.createElement("option",{value:e.name},e.name)})):""):"radio"===s.type?wp.element.createElement("div",{className:"vibebp_field_group"},s.hasOwnProperty("options")?s.options.map((function(e,t){return wp.element.createElement("div",{className:"radio"},wp.element.createElement("input",{id:e.id,type:"radio",value:e.name,checked:s.value===e.name,onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}}),wp.element.createElement("label",{for:e.id},e.name))})):""):"checkbox"===s.type?wp.element.createElement("div",{className:"vibebp_field_group"},s.hasOwnProperty("options")?s.options.map((function(e,t){return wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:e.id,value:e.name,checked:s.value&&s.value.indexOf(e.name)>-1,onChange:function(t){if(Array.isArray(s.value)||(s.value=[]),s.value&&-1===s.value.indexOf(e.name)){var n=Nn(s.value);n.push(e.name),c(Pn(Pn({},s),{},{value:n}))}else{var a=Nn(s.value);a.splice(s.value.indexOf(e.name),1),c(Pn(Pn({},s),{},{value:a}))}r(!0)}}),wp.element.createElement("label",{for:e.id},e.name))})):""):"multiselectbox"===s.type?wp.element.createElement(Ve,Sn({update:function(e,t,n){c(Pn(Pn({},s),{},{value:e.value})),r(!0)},field:s},e)):"datebox"===s.type?wp.element.createElement("input",{type:"date",ref:m}):"country"===s.type?wp.element.createElement("select",{onChange:function(e){c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)},value:s.value},window.vibebp.components.hasOwnProperty("xprofile")&&Object.keys(window.vibebp.components.xprofile.countries).length?Object.keys(window.vibebp.components.xprofile.countries).map((function(e,t){return wp.element.createElement("option",{value:e},window.vibebp.components.xprofile.countries[e])})):""):"color"===s.type?wp.element.createElement(Un,null,"undefined"==typeof Picker?wp.element.createElement("input",{type:"color",value:s.value,onChange:function(t){e.update(Pn(Pn({},s),{},{value:t.target.value})),r(!0)}}):wp.element.createElement("span",{className:"vibebp_color_field",style:{background:s.value},ref:function(t){if(!p){var n=new Picker(t);n.onChange=function(n){t.style.background=n.rgbaString,console.log("change detected"),e.hasOwnProperty("update")&&e.update(Pn(Pn({},s),{},{value:n.rgbaString})),c(Pn(Pn({},s),{},{value:n.rgbaString})),r(!0)},d(n)}}})):"location"===s.type?wp.element.createElement(Le,Sn({field:s},e)):"social"===s.type?wp.element.createElement(ce,Sn({field:s},e)):"repeatable"===s.type?wp.element.createElement(Oe,Sn({field:s},e)):"upload"===s.type?wp.element.createElement(st,Sn({field:s},e)):"video"===s.type?wp.element.createElement(Rt,Sn({field:s},e)):"gallery"===s.type?wp.element.createElement(en,Sn({field:s},e)):"table"===s.type?wp.element.createElement(En,Sn({field:s},e)):"checkbox_acceptance"===s.type?wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:s.id,value:s.id,onChange:function(e){s.value&&s.value===s.id?c(Pn(Pn({},s),{},{value:null})):c(Pn(Pn({},s),{},{value:e.target.value})),r(!0)}}),wp.element.createElement("label",{for:s.id},wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:s.name}}))):"":"")};function Fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){Hn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gn(e){return function(e){if(Array.isArray(e))return Kn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Bn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Bn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bn(e,t){if(e){if("string"==typeof e)return Kn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kn(e,t):void 0}}function Kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Vn=wp.element,Yn=(Vn.createElement,Vn.useState),Zn=Vn.useEffect,Qn=Vn.Fragment,Xn=(Vn.render,wp.data),er=(Xn.dispatch,Xn.select,function(e){var t=Wn(Yn(window.vibebp.settings.registration_fields),2),n=t[0],r=t[1],a=Wn(Yn(!1),2),i=a[0],o=a[1],l=Wn(Yn(!1),2),s=l[0],c=l[1],u=Wn(Yn(""),2),p=u[0],d=u[1],m=Wn(Yn(!0),2),f=m[0],b=m[1],v=Wn(Yn(!1),2),w=v[0],g=v[1],y=Wn(Yn(!1),2),h=(y[0],y[1]),_=Wn(Yn(!1),2),E=_[0],O=_[1],S=Wn(Yn(0),2),N=S[0],k=S[1],P=Wn(Yn(0),2),j=P[0],I=P[1],x=Wn(Yn(!1),2),A=x[0],T=x[1],C=Wn(Yn({}),2),D=C[0],U=C[1],M=Wn(Yn(""),2),L=M[0],R=M[1];Zn((function(){window.vibebp.translations.registration_checkbox.length&&b(!1),T(!0),fetch("".concat(window.vibebp.api.xprofile_url,"/get/allfields?client_id=").concat(window.vibebp.settings.client_id,"&register&force"),{method:"post"}).then((function(e){return e.json()})).then((function(e){e.status&&U(e.data),e.hasOwnProperty("default_member_type")&&e.default_member_type&&e.default_member_type.length&&e.data.hasOwnProperty(e.default_member_type)?I(e.default_member_type):e.data&&Object.keys(e.data).length&&I(Object.keys(e.data)[0]),T(!1)}))}),[]);var J=function(e){if(!e.length)return!1;var t=[],n=0;return e.length<window.vibebp.settings.password_length?t.push(window.vibebp.translations.password_6_chars):n++,e.search(/[a-z]/i)<0?t.push(window.vibebp.translations.password_one_letter):n++,e.search(/[0-9]/)<0?t.push(window.vibebp.translations.password_digit):n++,e.search(/[A-Z]/)<0?t.push(window.vibebp.translations.password_uppercase):n++,e.search(/[!@#$%^&*]/)<0?t.push(window.vibebp.translations.special_char):n++,k(n),t.length>0?(w.length&&g(t),t):(g(!1),!0)};return wp.element.createElement(Qn,null,wp.element.createElement("h2",null,window.vibebp.translations.register_account_heading),wp.element.createElement("p",null,window.vibebp.translations.register_account_description),wp.element.createElement("div",{className:"loginform"},p.length?wp.element.createElement("div",{className:"registration_message",dangerouslySetInnerHTML:{__html:p}}):n.length?wp.element.createElement(Qn,null,n.map((function(e,t){return wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,e.label)),"email"==e.type?wp.element.createElement("input",{className:e.class,type:"text",value:e.value,onChange:function(e){var a=Gn(n);a[t].value=e.target.value,n.map((function(e,t){"email"!=e.type||a[t].value.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i)||-1!=a[t].class.indexOf("is-danger")?a[t].class=a[t].class.split("is-danger").join(" "):a[t].class+=" is-danger"})),r(a)}}):"password"==e.type?wp.element.createElement("div",{className:"passwordfield"},wp.element.createElement("span",{className:E?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return O(!E)}}),wp.element.createElement("input",{className:e.class,type:E?"text":"password",value:e.value,onChange:function(e){!function(e,t){var a=Gn(n);a[t].value=e.target.value;J(a[t].value);r(a)}(e,t)}}),wp.element.createElement("div",{className:"password_strength_wrapper"},wp.element.createElement("span",{className:"password_strength"},wp.element.createElement("span",{className:N>=1?"pass_active":""}),wp.element.createElement("span",{className:N>=2?"pass_active":""}),wp.element.createElement("span",{className:N>=3?"pass_active":""}),wp.element.createElement("span",{className:N>=4?"pass_active":""}),wp.element.createElement("span",{className:N>=5?"pass_active":""})),wp.element.createElement("span",null,window.vibebp.translations.password_strength[N])),window.vibebp.settings.hasOwnProperty("strong_password")&&window.vibebp.settings.strong_password&&e.value.length&&w&&w.length?wp.element.createElement("span",{className:"passworderrorwrapper"},w.map((function(e){return wp.element.createElement("span",{className:"password_error"},wp.element.createElement("span",{className:"vicon vicon-alert"})," ",e)}))):""):"phone"==e.type||"mobile"==e.type?wp.element.createElement("input",{className:e.class,type:"telephone",value:e.value,onChange:function(e){var a=Gn(n);a[t].value=e.target.value,n.map((function(e,t){"phone"!=e.type&&"mobile"!=e.type||a[t].value.match(/^(\+\d{1,3}[- ]?)?\d{10}$/)||a[t].value.match(/0{5,}/)||-1!=a[t].class.indexOf("is-danger")?a[t].class=a[t].class.split("is-danger").join(" "):a[t].class+=" is-danger"})),r(a)}}):wp.element.createElement("input",{className:e.class,type:"text",value:e.value,onChange:function(e){var a=Gn(n);a[t].value=e.target.value,r(a)}})))})),window.vibebp.translations.registration_checkbox.length?wp.element.createElement("div",{className:f?"checkbox":"checkbox error"},wp.element.createElement("input",{id:"registration_checkbox",type:"checkbox",onClick:function(){return b(!f)}}),wp.element.createElement("label",{for:"registration_checkbox",dangerouslySetInnerHTML:{__html:window.vibebp.translations.registration_checkbox}})):"",A?wp.element.createElement("div",{className:"loader"},wp.element.createElement("div",{class:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null))):Object.keys(D).length?wp.element.createElement("div",{className:"register_member_type_wrap"},window.vibebp.settings.member_types_registration?wp.element.createElement("div",{className:"reg_header"},wp.element.createElement("label",null,window.vibebp.translations.register_as),wp.element.createElement("select",{onChange:function(e){I(e.target.value)}},Object.keys(D).map((function(e,t){return wp.element.createElement("option",{selected:j===e,value:e},D[e].label)})))):"",wp.element.createElement("div",{className:"field_wrap"},D.hasOwnProperty(j)&&D[j].hasOwnProperty("fields")&&D[j].fields.length?wp.element.createElement("div",{className:""},D[j].fields.map((function(e,t){return wp.element.createElement(zn,{field:e,update:function(e){return function(e){var t=$n({},D),n=t[j].fields.findIndex((function(t){return t.id===e.id}));n>-1&&(t[j].fields[n]=$n({},e),U(t))}(e)},registration:!0})}))):"")):"",window.vibebp.hasOwnProperty("settings")&&window.vibebp.settings.hasOwnProperty("registration_invite_codes")&&window.vibebp.settings.registration_invite_codes?wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,window.vibebp.translations.have_a_invitation_code)),wp.element.createElement("input",{className:"invitation_code input",type:"text",value:L,onChange:function(e){R(e.target.value)}}))):"",A?"":wp.element.createElement("a",{className:s?"button is-primary is-loading":"button is-primary",onClick:function(){g(!1);var e=!1;if(window.vibebp.settings.hasOwnProperty("strong_password")&&window.vibebp.settings.strong_password){var t=n[n.findIndex((function(e){return"password"==e.type}))].value,r=Gn(n),a=n.findIndex((function(e){return"password"==e.type})),i=J(t);!0!==i?t.length&&(r[a].class+=" is-danger",g(i),window.vibebp.settings.hasOwnProperty("password_strength_colors")&&window.vibebp.settings.password_strength_colors&&vibebp.settings.password_strength_colors.length&&h(vibebp.settings.password_strength_colors[i.length])):(r[a].class=r[a].class.split("is-danger").join(" "),g(!1),r[a].value.length&&window.vibebp.settings.hasOwnProperty("password_strength_colors")&&window.vibebp.settings.password_strength_colors&&vibebp.settings.password_strength_colors.length&&h(vibebp.settings.password_strength_colors[0])),r[a].value.length||(h(!1),g(!1)),i.length&&(e=!0)}if(f||(e=!0),!e){var l={};"undefined"!=typeof grecaptcha?grecaptcha.ready((function(){grecaptcha.execute(window.vibebp.settings.recaptcha_key,{action:"submit"}).then((function(e){c(!0),l=[].concat(Gn(n),[{type:"token",recaptchaToken:e}]),D.hasOwnProperty(j)&&D[j].fields&&D[j].fields.length&&(l=[].concat(Gn(l),Gn(D[j].fields))).push({id:"member_type",value:j}),L&&L.length&&l.push({id:"invite_code",value:L}),fetch("".concat(window.vibebp.api.url,"/registerUser?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify(l)}).then((function(e){return e.json()})).then((function(e){c(!1),e.status?d(e.message):o(e.message)}))}))})):(l=Gn(n),D.hasOwnProperty(j)&&D[j].fields&&D[j].fields.length&&(l=[].concat(Gn(l),Gn(D[j].fields))).push({id:"member_type",value:j}),L&&L.length&&l.push({id:"invite_code",value:L}),c(!0),fetch("".concat(window.vibebp.api.url,"/registerUser?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify(l)}).then((function(e){return e.json()})).then((function(e){c(!1),e.status?d(e.message):o(e.message)})))}}},window.vibebp.translations.create_account),i?wp.element.createElement("div",{className:"error",dangerouslySetInnerHTML:{__html:i}}):""):""),wp.element.createElement("div",{className:"extra_details"},wp.element.createElement("p",null,window.vibebp.translations.account_already,wp.element.createElement("a",{className:"vibebp_forward_link",onClick:function(){e.inviteRegister?e.setInviteRegistration(!1):e.setRegistration(!1)}},window.vibebp.translations.signin," ",wp.element.createElement("span",{className:"vicon vicon-arrow-right"}))),wp.element.createElement("p",null,window.vibebp.translations.login_terms)))});function tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rr=wp.element,ar=(rr.createElement,rr.useState),ir=rr.useEffect,or=(rr.Fragment,rr.render,wp.data),lr=or.dispatch,sr=or.select,cr=function(e){var t=tr(ar("user_menu"),2),n=t[0],r=t[1],a=tr(ar(""),2),i=(a[0],a[1],tr(ar(sr("vibebp").getData("loggedinMenu")),2)),o=i[0],l=(i[1],tr(ar(!1),2)),s=(l[0],l[1],sr("vibebp").getUser());ir((function(){setTimeout((function(){r(n.replace(/active/g,"")+" active")}),30)}),[]);var c=function(e){return window.vibebp.hasOwnProperty("profile_link")&&window.vibebp.profile_link&&window.vibebp.profile_link.length?window.vibebp.profile_link+"#component="+e.css_id:s.profile_link+"#component="+e.css_id};return wp.element.createElement("div",{className:n},wp.element.createElement("div",{className:"usermenu_content"},o.length?o.map((function(e){return wp.element.createElement("a",{href:c(e),className:e.classes.join(" "),onClick:function(t){t.preventDefault(),function(e){var t=sr("vibebp").getUser();e.classes.indexOf("bp-menu")>-1?window.location===t.profile_link?lr("vibebp").setComponent(e.css_id):(window.vibebp.hasOwnProperty("profile_link")&&window.vibebp.profile_link&&window.vibebp.profile_link.length,window.location=t.profile_link+"#component="+e.css_id):window.location.href=e.url}(e)},dangerouslySetInnerHTML:{__html:e.title}})})):wp.element.createElement("a",{href:s.profile_link},window.vibebp.translations.profile)),wp.element.createElement("a",{onClick:e.logout},wp.element.createElement("span",{className:"vicon vicon-power-off"}),window.vibebp.translations.logout))};function ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ur(Object(n),!0).forEach((function(t){dr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ur(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var br=wp.element,vr=(br.createElement,br.useState),wr=br.useEffect,gr=(br.Fragment,br.render,wp.data),yr=gr.dispatch,hr=(gr.select,function(e){var t=mr(vr(),2),n=(t[0],t[1],mr(vr({first:!0,second:!0}),2)),r=n[0],a=n[1],i=mr(vr(0),2),o=i[0],l=i[1],s=mr(vr({first:"",second:""}),2),c=s[0],u=s[1],p=mr(vr(!1),2),d=p[0],m=p[1],f=mr(vr(!1),2),b=(f[0],f[1],mr(vr(!1),2)),v=b[0],w=b[1],g=mr(vr({}),2),y=g[0],h=g[1],_=mr(vr({}),2),E=_[0],O=_[1];wr((function(){}),[e.resetPwdArgs]);var S=function(e,t){h({});var n=pr({},c);if(n[t]=e.target.value,"first"==t)(function(e){if(!e.length)return!1;var t=[],n=0;e.length<window.vibebp.settings.password_length?t.push(window.vibebp.translations.password_6_chars):n++,e.search(/[a-z]/i)<0?t.push(window.vibebp.translations.password_one_letter):n++,e.search(/[0-9]/)<0?t.push(window.vibebp.translations.password_digit):n++,e.search(/[A-Z]/)<0?t.push(window.vibebp.translations.password_uppercase):n++,e.search(/[!@#$%^&*]/)<0?t.push(window.vibebp.translations.special_char):n++,l(n),t.length>0?t.length&&m(t):m(!1)})(n[t]);u(n)};return wp.element.createElement("div",{className:"new_password_wrap"},wp.element.createElement("h1",null,window.vibebp.translations.set_new_password),wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control passwordfield"},wp.element.createElement("span",{className:r.first?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return a(pr(pr({},r),{},{first:!r.first}))}}),wp.element.createElement("input",{className:"input",type:r.first?"text":"password",onChange:function(e){S(e,"first")},placeholder:window.vibebp.translations.enter_password}),wp.element.createElement("div",{className:"password_strength_wrapper"},wp.element.createElement("span",{className:"password_strength"},wp.element.createElement("span",{className:o>=1?"pass_active":""}),wp.element.createElement("span",{className:o>=2?"pass_active":""}),wp.element.createElement("span",{className:o>=3?"pass_active":""}),wp.element.createElement("span",{className:o>=4?"pass_active":""}),wp.element.createElement("span",{className:o>=5?"pass_active":""})),wp.element.createElement("span",null,window.vibebp.translations.password_strength[o])))),wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control passwordfield"},wp.element.createElement("span",{className:r.second?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return a(pr(pr({},r),{},{second:!r.second}))}}),wp.element.createElement("input",{className:"input",type:r.second?"text":"password",onChange:function(e){S(e,"second")},placeholder:window.vibebp.translations.re_enter_password}))),y.hasOwnProperty("message")&&y.message.length?wp.element.createElement("span",{className:"password_error "+y.code},wp.element.createElement("span",{className:"vicon vicon-alert"})," ",y.message):"",wp.element.createElement("a",{className:v?"button is-primary is-loading":"button is-primary",onClick:function(t){if(c.first.length&&c.second.length)if(c.second===c.first){if(window.vibebp.settings.hasOwnProperty("strong_password")&&window.vibebp.settings.strong_password&&d&&d.length)return h({code:"restriction",message:d[0]}),!1;w(!0),fetch("".concat(window.vibebp.api.url,"/resetPassword?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({password:c,args:e.resetPwdArgs})}).then((function(e){return e.json()})).then((function(e){w(!1),console.log(e),e.hasOwnProperty("message")&&(yr("vibebp").addNotification({text:e.message}),e.status?O({icon:"success",message:e.message}):O({icon:"error",message:e.message}))}))}else h({code:"match",message:window.vibebp.translations.passwords_does_not_match});else h({code:"blank",message:window.vibebp.translations.please_enter_pwd})}},window.vibebp.translations.reset_password),E.hasOwnProperty("message")&&E.message.length?wp.element.createElement("div",{className:"message "+E.icon},E.message):"",wp.element.createElement("a",{className:"",onClick:e.back},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),window.vibebp.translations.back_to_signin))});function _r(e,t,n,r,a,i,o){try{var l=e[i](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,a)}function Er(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){_r(i,r,a,o,l,"next",e)}function l(e){_r(i,r,a,o,l,"throw",e)}o(void 0)}))}}var Or=wp.data,Sr=Or.dispatch,Nr=(Or.select,0),kr=function(e){var t=e.detail.userLoaded;if(!Nr&&"undefined"!=typeof firebase&&firebase.hasOwnProperty("database")&&t&&void 0!==t.id){var n=firebase.database().ref("stale_requests/global"),r=firebase.database().ref("stale_requests/".concat(t.id)),a=localforage.createInstance({name:"vibebp_stale_requests",storeName:"user"}),i=localforage.createInstance({name:"vibebp_stale_requests",storeName:"global"}),o=localforage.createInstance({name:"vibebp_last_requests"});Math.round((new Date).getTime()/1e3);n.on("value",(function(e){e.exists()&&Er(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.val(),[],t.next=4,o.keys();case 4:for(r in t.sent,n)a=decodeURIComponent(r),n[r].hasOwnProperty("time")?i.setItem(a,n[r].time):i.setItem(a,n[r]);case 6:case"end":return t.stop()}}),t)})))()})),r.on("value",(function(e){e.exists()&&Er(regeneratorRuntime.mark((function t(){var n,i,l,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.val(),i=[],t.next=4,o.keys();case 4:for(c in l=t.sent,s=function(e){var t=decodeURIComponent(e);i.push(a.keys().then((function(r){var i=r.findIndex((function(e){return e.indexOf(t)>-1}));i>-1?n[e].hasOwnProperty("time")?a.setItem(r[i],n[e].time):a.setItem(r[i],n[e]):n[e].hasOwnProperty("time")?a.setItem(t,n[e].time):a.setItem(t,n[e])}))),l&&l.length&&l[l.length-1].indexOf(t)>-1&&localforage.getItem(l[l.length-1]).then((function(t){(t=JSON.parse(t))&&parseInt(t.vibebp_timestamp)<parseInt(n[e].time)&&Sr("vibebp").addNotification({icon:"vicon vicon-reload",position:"topCenter",text:window.vibebp.translations.load_new_data,actions:[{label:window.vibebp.translations.refresh,event:"reload_last_request",url:l[l.length-1]}]})}))},n)s(c);Promise.all(i).then((function(){r.remove()}));case 8:case"end":return t.stop()}}),t)})))()})),Nr=1}};function Pr(e){return function(e){if(Array.isArray(e))return Mr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ur(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ir(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jr(Object(n),!0).forEach((function(t){xr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tr(e,t,n,r,a,i,o){try{var l=e[i](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,a)}function Cr(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Tr(i,r,a,o,l,"next",e)}function l(e){Tr(i,r,a,o,l,"throw",e)}o(void 0)}))}}function Dr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||Ur(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ur(e,t){if(e){if("string"==typeof e)return Mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mr(e,t):void 0}}function Mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Lr=wp.element,Rr=(Lr.createElement,Lr.useState),Jr=Lr.useEffect,qr=Lr.Fragment,zr=Lr.render,Fr=wp.data,$r=Fr.dispatch,Hr=Fr.select,Gr=1,Wr=function(e){var t=null,n=null,r=Dr(Rr(!1),2),a=r[0],i=r[1],l=Dr(Rr(!1),2),s=l[0],c=l[1],u=Dr(Rr({}),2),p=u[0],d=u[1],m=Dr(Rr(!0),2),f=m[0],b=m[1],w=Dr(Rr(!1),2),g=w[0],y=w[1],h=Dr(Rr(!1),2),_=h[0],E=h[1],O=Dr(Rr(!1),2),S=(O[0],O[1],Dr(Rr(!0),2)),N=S[0],k=S[1],P=Dr(Rr(!1),2),j=P[0],I=P[1],x=Dr(Rr(!1),2),A=x[0],C=x[1],D=Dr(Rr("login_popup "+window.vibebp.style),2),U=D[0],M=D[1],L=Dr(Rr(!1),2),R=(L[0],L[1],Dr(Rr([]),2)),J=(R[0],R[1],Dr(Rr(!1),2)),q=(J[0],J[1]),z=Dr(Rr(!0),2),$=z[0],H=z[1],G=Dr(Rr(!0),2),W=G[0],B=G[1],K=Dr(Rr(!1),2),V=K[0],Y=K[1],Z=Dr(Rr(!1),2),Q=Z[0],X=Z[1],ee=Dr(Rr(!1),2),te=ee[0],ne=ee[1],re=Dr(Rr({}),2),ae=re[0],ie=re[1];window.vibebp.settings.firebase_config&&(firebase.apps.length||firebase.initializeApp(JSON.parse(window.vibebp.settings.firebase_config)));Jr((function(){return function(){0}}),[]),Jr((function(){if(!f){var e=new URL(window.location.href),t=e.searchParams.get("action"),n=e.searchParams.get("key"),r=decodeURIComponent(e.searchParams.get("login"));"rp"==t&&n&&n.length&&r&&r.length&&(c(!0),M(U+" active"),ie({key:n,user_login:r}))}}),[f]),Jr((function(){return Cr(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new Date).getTime(),e.next=3,localforage.getItem("vibebp_last_post_requests_time");case 3:(r=e.sent)?(r=parseInt(r),window.vibebp.settings.post_data_check_interval=parseInt(window.vibebp.settings.post_data_check_interval),n=t-r<window.vibebp.settings.post_data_check_interval?setTimeout(ce,window.vibebp.settings.post_data_check_interval-(t-r)):setTimeout(ce,window.vibebp.settings.post_data_check_interval)):n=setTimeout(ce,window.vibebp.settings.post_data_check_interval);case 5:case"end":return e.stop()}}),e)})))(),function(){n&&clearTimeout(n)}}),[te]),Jr((function(){return Q&&(t=setTimeout((function(){fetch("".concat(window.vibebp.api.regenerate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify({token:Hr("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){$r("vibebp").setToken(e.token),localforage.setItem("bp_login_token",e.token),X(parseInt(e.expires))}))}),1e3*parseInt(Q)-(new Date).getTime()-12e4)),function(){t&&clearTimeout(t)}}),[Q]),Jr((function(){document.addEventListener("tokenGenerated",(function(){Y(!V)})),window.vibebp.settings.email_login&&I(!0),localforage.getItem("bp_user").then((function(e){e&&("object"!==Ar(e)?y(JSON.parse(e)):y(e))}));var e=setTimeout((function(){H(!1)}),5e3);return localforage.getItem("loggedInNumber").then((function(e){e&&$r("vibebp").setData("loggedInNumber",e)})),document.addEventListener("userLoaded",kr,{once:!0,passive:!0}),document.addEventListener("reload_last_request",oe,{once:!1,passive:!0}),function(){clearTimeout(e),document.removeEventListener("userLoaded",kr),document.removeEventListener("reload_last_request",oe)}}),[]),Jr((function(){new Promise((function(e){e(localforage.getItem("bp_login_token"))})).then((function(e){e?(b(!0),Hr("vibebp").setToken(e),Hr("vibebp").verifyUser("".concat(window.vibebp.api.validate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),e),T.subscribe((function(){if(N){void 0!==T.getState().user&&d(T.getState().user),Hr("vibebp").getUser()&&Object.keys(Hr("vibebp").getUser()).length&&document.dispatchEvent(new CustomEvent("userLoaded",{detail:{userLoaded:T.getState().user}}));var t=Hr("vibebp").getNotifications();t&&t.length?t.map((function(e,t){var n="var(--dark)",r="",a="var(--white)";if(e.hasOwnProperty("backgroundColor")&&e.backgroundColor)n=e.backgroundColor;else switch(e.type){case"error":n="var(--error)",r="vicon vicon-alert";break;case"success":n="var(--success)",r="vicon vicon-check";break;default:n="var(--dark)"}e.hasOwnProperty("textColor")&&e.textColor&&(a=e.textColor);var i="bottomRight";if(e.hasOwnProperty("position")&&e.position&&(i=e.position),!("object"!==Ar(window.iziToast)||e.hasOwnProperty("read")&&e.read)){var o={title:void 0!==e.title?e.title:"",message:void 0!==e.text?e.text:"",icon:r,backgroundColor:n,titleColor:a,messageColor:a,iconColor:a,progressBarColor:"var(--primary)",rtl:window.vibebp.settings.is_rtl,position:i,onOpened:function(){}};e.iconUrl&&(o.iconUrl=e.iconUrl),e.icon&&(o.icon=e.icon),e.hasOwnProperty("actions")&&e.actions&&e.actions.length&&(o.buttons=[],e.actions.map((function(t){o.buttons.push(['<a className="link">'+t.label+"</a>",function(n,r){var a=new CustomEvent(t.event,{detail:Ir(Ir({},t),{},{item_id:e.item_id,user_id:Hr("vibebp").getUser().id})});document.dispatchEvent(a)}])}))),window.iziToast.show(o)}se(e)})):q(!1),document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.add("logged-in"),k(!1),T.getState().user&&Object.keys(T.getState().user).length&&H(!1),!Hr("vibebp").getData("loggedinMenu")&&Gr&&(Gr=0,fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:e})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("data")&&e.data.hasOwnProperty("status")&&401===e.data.status&&b(!1),T.getState().user&&Object.keys(T.getState().user).length&&b(!1),e.status&&$r("vibebp").setData("loggedinMenu",e.menu)})))}}))):(H(!1),b(!1))}))}),[V]),Jr((function(){var e=[];return window.vibebp.settings.firebase_config&&"function"==typeof firebase.database&&Object.keys(p).length&&(W&&firebase.auth()&&firebase.auth().currentUser&&(firebase.database().ref("users/".concat(p.id,"/status")).once("value").then((function(e){if(e.exists()){var t=e.val();firebase.database().ref("users/".concat(p.id,"/status")).set(t+1)}else firebase.database().ref("users/".concat(p.id,"/status")).set(1)})),firebase.database().ref("users/".concat(p.id,"/status")).onDisconnect().set(0),fetch("".concat(window.vibebp.api.url,"/followers"),{method:"post",body:JSON.stringify({token:Hr("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&e.followers.map((function(e){firebase.database().ref("users/".concat(e.ID,"/status")).once("value").then((function(t){t.exists()&&t.val()&&firebase.database().ref("notifications/".concat(e.ID)).push({sender:Hr("vibebp").getUser().id,type:"user_online",status:1,time:(new Date).getTime()})}))}))})),B(!1)),window.addEventListener("online",(function(){$r("vibebp").addNotification({text:window.vibebp.translations.online})}),!1),window.addEventListener("offline",(function(){$r("vibebp").addNotification({text:window.vibebp.translations.offline})}),!1)),p.hasOwnProperty("exp")&&Q!=p.exp&&X(p.exp),function(){e.length&&e.map((function(e){clearTimeout(e)}))}}),[p]),Jr((function(){T.getState().user&&Object.keys(T.getState().user)&&d(T.getState().user)}),[T.getState().user]),Jr((function(){document.addEventListener("vibebp_show_login_popup",(function(){T.getState().user&&Object.keys(T.getState().user).length||(c(!0),setTimeout((function(){M(U+" active")}),30))})),window.innerWidth<1024&&"undefined"!=typeof firebase&&firebase.hasOwnProperty("auth")&&firebase.auth().getRedirectResult().then((function(e){if(e.credential){var t=e.user,n=e.credential;n.hasOwnProperty("providerId")&&n.providerId&&a!==n.providerId&&i(n.providerId);n.accessToken;$r("vibebp").setData("firebaseUser",t),t.getIdToken().then((function(t){le(e,t).then((function(e){$r("vibebp").setUser(e)}))}))}e.user})).catch((function(e){console.log(e)}))}),[]);var oe=function(e){e.detail.hasOwnProperty("url")&&e.detail.url&&(console.log(e.detail.url),localforage.removeItem(e.detail.url).then((function(){document.dispatchEvent(new Event("vibebp_component_reload"))})))},le=function(e,t){return fetch("".concat(window.vibebp.api.url,"/sociallogin?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:JSON.stringify({social:e.credential.signInMethod,client_id:window.vibebp.settings.client_id,user:{email:e.user.email,uid:e.user.uid,name:e.user.displayName,avatar:e.user.photoURL,phoneNumber:e.user.phoneNumber,last_login:e.user.metadata.lastSignInTime,create_time:e.user.metadata.creationTime},idToken:t})}).then((function(e){return e.json()})).then((function(t){if(t.status)return localforage.setItem("bp_login_token",t.token),fetch("".concat(window.vibebp.api.validate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:t.token}).then((function(e){return e.json()})).then((function(n){if(n.hasOwnProperty("data"))return"undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&window.vibebp.settings.firebase_config&&firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(e.user.uid),o(e.user.uid).then((function(e){if(!e||!e.length){if(localforage.setItem("bp_user",JSON.stringify(n.data.data.user)),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),d(n.data.data.user),$r("vibebp").setToken(t.token),$r("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.add("vibebp-logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var r="";r=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=r}var a=sessionStorage.getItem("loggedinmenu");return a?$r("vibebp").setData("loggedinMenu",JSON.parse(a)):fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&$r("vibebp").setData("loggedinMenu",e.menu)})),n.data.data.user}document.dispatchEvent(new Event("vibebp_logout"))}));document.dispatchEvent(new Event("vibebp_logout"))}))}))},se=function(e){if(e.hasOwnProperty("read")&&e.read)return!1;var t=Pr(Hr("vibebp").getNotifications()),n=t.findIndex((function(t){return t.id===e.id}));n>=0&&(t[n].read=!0,e.read=!0,Hr("vibebp").updateNotification(e))},ce=function(){Cr(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localforage.getItem("post_data");case 2:if(t=e.sent,console.log(t),!t){e.next=8;break}return e.delegateYield(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(t),Pr(t),r=[],!t||!t.length){e.next=24;break}n=0;case 5:if(!(n<t.length)){e.next=15;break}return console.log("make hit"),(a=t[n].data).hasOwnProperty("token")&&(a.token=Hr("vibebp").getToken()),e.next=11,fetch(t[n].url+"&nocache",{method:"post",headers:t[n].headers,body:JSON.stringify(a)}).then(function(){var e=Cr(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.ok||r.push(t[n]);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),r.push(t[n])}));case 11:console.log("hit ended");case 12:n++,e.next=5;break;case 15:return e.next=17,localforage.setItem("vibebp_last_post_requests_time",(new Date).getTime());case 17:if(console.log(r),r.length)for(n=r.length-1;n>=0;n--)r[n].hasOwnProperty("count")||(r[n].count=0),r[n].count++,r[n].count>10&&r.splice(n,1);return e.next=21,localforage.setItem("post_data",JSON.stringify(r));case 21:ne(Math.random()),e.next=27;break;case 24:return e.next=26,localforage.setItem("vibebp_last_post_requests_time",(new Date).getTime());case 26:ne(Math.random());case 27:case"end":return e.stop()}}),e)}))(),"t0",6);case 6:e.next=11;break;case 8:return e.next=10,localforage.setItem("vibebp_last_post_requests_time",(new Date).getTime());case 10:ne(Math.random());case 11:case"end":return e.stop()}}),e)})))()};return wp.element.createElement(qr,null,"static"!=e.type?p&&Object.keys(p).length?wp.element.createElement("div",{className:"loggedin_user_div"},wp.element.createElement("a",{className:"loggedin_user","data-id":p.id,onClick:function(){E(!_)}},wp.element.createElement("img",{src:p.avatar,alt:p.displayname}),wp.element.createElement("span",{className:"vibebp_name"},p.displayname)),_?wp.element.createElement(cr,{logout:function(){if("undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&window.vibebp.settings.firebase_config&&window.vibebp.settings.session_lock&&firebase.auth().currentUser){var e=new CustomEvent("userLogout",{detail:{userLoaded:!0,loggedOut:!0}});document.dispatchEvent(e),firebase.database().ref("users/".concat(p.id,"/status")).set(0).then((function(){document.querySelector("body").classList.add("vibebp_logout"),firebase.auth().signOut().then((function(){d({}),Hr("vibebp").logout()}),(function(e){console.log("logout failed")}))}))}else{e=new CustomEvent("userLogout",{detail:{userLoaded:!0,loggedOut:!0}});document.dispatchEvent(e),document.querySelector("body").classList.add("vibebp_logout"),window.vibebp.settings.firebase_config?firebase.auth().signOut().then((function(){d({}),Hr("vibebp").logout()}),(function(e){console.log("logout failed")})):(d({}),Hr("vibebp").logout())}}}):""):wp.element.createElement("a",{onClick:function(e){e.stopPropagation(),e.target.parentElement.classList.contains("is_loading")||(c(!0),setTimeout((function(){M(U+" active")}),30))}},$?"...":wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.title}})):"",s||"static"==e.type&&p&&!Object.keys(p).length?ReactDOM.createPortal(wp.element.createElement("div",{className:e.hasOwnProperty("type")&&"static"==e.type?"static_wrapper":"loginpopup_wrapper",onClick:function(e){e.stopPropagation(),-1!==e.target.className.indexOf("loginpopup_wrapper")&&(M(U.replace(/active/g)),c(!1))}},wp.element.createElement("div",{className:U},window.vibebp.settings.customizer.login_image.length?wp.element.createElement("div",{className:"login_popup_bg_img"},wp.element.createElement("img",{src:window.vibebp.settings.customizer.login_image})):"",e.hasOwnProperty("type")&&"static"==e.type&&f?wp.element.createElement("div",{className:"login_popup_content"},wp.element.createElement("h2",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_heading}}),g?wp.element.createElement("h2",{dangerouslySetInnerHTML:{__html:g.displayname}}):wp.element.createElement("h2",null,"...")):wp.element.createElement("div",{className:window.vibebp.settings.email_login?"login_popup_content email_login":"login_popup_content"},ae.hasOwnProperty("key")&&ae.key.length?wp.element.createElement(hr,{resetPwdArgs:ae,back:function(){ie({})}}):window.vibebp.settings.email_login?A?wp.element.createElement(er,{setRegistration:C}):wp.element.createElement(qr,null,wp.element.createElement(F,{setemailSignIn:I,setUser:function(e){d(e),c(!1)}}),j?wp.element.createElement(v,{setLoginpopupClass:M,setUser:function(e){d(e),c(!1)},setRegistration:C,setemailSignIn:I,childProviderId:a}):""):j?wp.element.createElement(F,{setemailSignIn:I,setUser:function(e){d(e),c(!1)}}):A?wp.element.createElement(er,{setRegistration:C}):wp.element.createElement(v,{setLoginpopupClass:M,setUser:function(e){d(e),c(!1)},setRegistration:C,setemailSignIn:I,childProviderId:a}),"static"!=e.type?wp.element.createElement("a",{onClick:function(e){e.stopPropagation(),M(U.replace(/active/g)),c(!1)},className:"vicon-close"}):""))),document.querySelector("#vibebp_login_wrapper")):"","")},Br=0;document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".vibebp-login")&&(Br||(document.querySelectorAll(".vibebp-login").forEach((function(e){zr(wp.element.createElement(Wr,{type:document.querySelector(".vibebp-login").getAttribute("type"),title:e.innerHTML}),e)})),Br=1)),document.addEventListener("wp_login_sync",(function(){document.querySelector(".vibebp-login")&&document.querySelectorAll(".vibebp-login").forEach((function(e){zr(wp.element.createElement(Wr,{type:document.querySelector(".vibebp-login").getAttribute("type"),title:e.innerHTML}),e)}))}))}),!1),document.addEventListener("vibebp_logout",(function(){window.vibebp.settings.firebase_config&&firebase&&firebase.auth()?firebase.auth().signOut().then((function(){Hr("vibebp").logout()}),(function(e){console.log("logout failed")})):Hr("vibebp").logout()})),document.querySelector(".vibebp-login")&&document.querySelector(".vibebp-login")&&(Br||(document.querySelectorAll(".vibebp-login").forEach((function(e){zr(wp.element.createElement(Wr,{type:document.querySelector(".vibebp-login").getAttribute("type"),title:e.innerHTML}),e)})),Br=1))}]);